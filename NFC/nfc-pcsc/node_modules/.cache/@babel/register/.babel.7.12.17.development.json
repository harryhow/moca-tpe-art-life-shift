{
  "{\"sourceRoot\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc\",\"filename\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/read-write.js\",\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{}},{\"key\":\"proposal-class-properties\",\"visitor\":{\"PrivateName\":{\"enter\":[null]},\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{}}],\"presets\":[]}:7.12.17": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/",
      "caller": {
        "name": "@babel/register"
      },
      "cwd": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc",
      "filename": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/read-write.js",
      "cloneInputAst": true,
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {}
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {}
        },
        {
          "key": "proposal-class-properties",
          "visitor": {
            "PrivateName": {
              "enter": [
                null
              ]
            },
            "ExportDefaultDeclaration": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true,
            "ClassExpression": {
              "enter": [
                null
              ]
            },
            "ClassDeclaration": {
              "enter": [
                null
              ]
            }
          },
          "options": {}
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/read-write.js",
        "plugins": [
          "objectRestSpread",
          "classProperties",
          "classPrivateProperties"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/read-write.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/",
        "sourceFileName": "read-write.js"
      }
    },
    "ast": null,
    "code": "\"use strict\"; // #############\n// Example: Reading and writing data\n// - should work well with any compatible PC/SC card reader\n// - tested with MIFARE Ultralight cards but should work with many others (e.g. NTAG)\n// - what is covered:\n//   - example reading and writing data on from/to card\n// - NOTE! for reading and writing data from/to MIFARE Classic please see examples/mifare-classic.js which explains MIFARE Classic specifics\n// #############\n\nvar _index = require(\"../src/index\");\n\nvar _prettyLogger = _interopRequireDefault(require(\"./pretty-logger\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nconst nfc = new _index.NFC(); // const nfc = new NFC(pretty); // optionally you can pass logger to see internal debug logs\n\nnfc.on('reader', async reader => {\n  _prettyLogger.default.info(`device attached`, reader); // enable when you want to auto-process ISO 14443-4 tags (standard=TAG_ISO_14443_4)\n  // when an ISO 14443-4 is detected, SELECT FILE command with the AID is issued\n  // the response is available as card.data in the card event\n  // you can set reader.aid to:\n  // 1. a HEX string (which will be parsed automatically to Buffer)\n\n\n  reader.aid = 'F222222222'; // 2. an instance of Buffer containing the AID bytes\n  // reader.aid = Buffer.from('F222222222', 'hex');\n  // 3. a function which must return an instance of a Buffer when invoked with card object (containing standard and atr)\n  //    the function may generate AIDs dynamically based on the detected card\n  // reader.aid = ({ standard, atr }) => {\n  //\n  // \treturn Buffer.from('F222222222', 'hex');\n  //\n  // };\n\n  reader.on('card', async card => {\n    _prettyLogger.default.info(`card detected`, reader, card); // example reading 4 bytes assuming containing 16bit integer\n    // !!! note that we don't need 4 bytes - 16bit integer takes just 2 bytes !!!\n\n\n    try {\n      // reader.read(blockNumber, length, blockSize = 4, packetSize = 16)\n      // - blockNumber - memory block number where to start reading\n      // - length - how many bytes to read\n      // - blockSize - 4 for MIFARE Ultralight, 16 for MIFARE Classic\n      // ! Caution! length must be divisible by blockSize (we have to read the whole block(s))\n      const data = await reader.read(4, 4);\n\n      _prettyLogger.default.info(`data read`, reader, data);\n\n      const payload = data.readInt16BE(0);\n\n      _prettyLogger.default.info(`data converted`, reader, payload);\n    } catch (err) {\n      _prettyLogger.default.error(`error when reading data`, reader, err);\n    } // example write 4 bytes containing 16bit integer\n    // !!! note that we don't need 16 bytes - 16bit integer takes just 2 bytes !!!\n\n\n    try {\n      // reader.write(blockNumber, data, blockSize = 4, packetSize = 16)\n      // - blockNumber - memory block number where to start writing\n      // - data - what to write\n      // - blockSize - 4 for MIFARE Ultralight, 16 for MIFARE Classic\n      // ! Caution! data.length must be divisible by blockSize (we have to write the whole block(s))\n      const data = Buffer.allocUnsafe(4).fill(0);\n      const randomNumber = Math.round(Math.random() * 1000);\n      data.writeInt16BE(randomNumber, 0);\n      await reader.write(4, data);\n\n      _prettyLogger.default.info(`data written`, reader, randomNumber, data);\n    } catch (err) {\n      _prettyLogger.default.error(`error when writing data`, reader, err);\n    }\n  });\n  reader.on('error', err => {\n    _prettyLogger.default.error(`an error occurred`, reader, err);\n  });\n  reader.on('end', () => {\n    _prettyLogger.default.info(`device removed`, reader);\n  });\n});\nnfc.on('error', err => {\n  _prettyLogger.default.error(`an error occurred`, err);\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlYWQtd3JpdGUuanMiXSwibmFtZXMiOlsibmZjIiwiTkZDIiwib24iLCJyZWFkZXIiLCJwcmV0dHkiLCJpbmZvIiwiYWlkIiwiY2FyZCIsImRhdGEiLCJyZWFkIiwicGF5bG9hZCIsInJlYWRJbnQxNkJFIiwiZXJyIiwiZXJyb3IiLCJCdWZmZXIiLCJhbGxvY1Vuc2FmZSIsImZpbGwiLCJyYW5kb21OdW1iZXIiLCJNYXRoIiwicm91bmQiLCJyYW5kb20iLCJ3cml0ZUludDE2QkUiLCJ3cml0ZSJdLCJtYXBwaW5ncyI6IkFBQUEsYSxDQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBQ0E7Ozs7QUFHQSxNQUFNQSxHQUFHLEdBQUcsSUFBSUMsVUFBSixFQUFaLEMsQ0FBdUI7O0FBRXZCRCxHQUFHLENBQUNFLEVBQUosQ0FBTyxRQUFQLEVBQWlCLE1BQU1DLE1BQU4sSUFBZ0I7QUFFaENDLHdCQUFPQyxJQUFQLENBQWEsaUJBQWIsRUFBK0JGLE1BQS9CLEVBRmdDLENBSWhDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUNBQSxFQUFBQSxNQUFNLENBQUNHLEdBQVAsR0FBYSxZQUFiLENBVGdDLENBVWhDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQUgsRUFBQUEsTUFBTSxDQUFDRCxFQUFQLENBQVUsTUFBVixFQUFrQixNQUFNSyxJQUFOLElBQWM7QUFFL0JILDBCQUFPQyxJQUFQLENBQWEsZUFBYixFQUE2QkYsTUFBN0IsRUFBcUNJLElBQXJDLEVBRitCLENBSS9CO0FBQ0E7OztBQUNBLFFBQUk7QUFFSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUEsWUFBTUMsSUFBSSxHQUFHLE1BQU1MLE1BQU0sQ0FBQ00sSUFBUCxDQUFZLENBQVosRUFBZSxDQUFmLENBQW5COztBQUVBTCw0QkFBT0MsSUFBUCxDQUFhLFdBQWIsRUFBeUJGLE1BQXpCLEVBQWlDSyxJQUFqQzs7QUFFQSxZQUFNRSxPQUFPLEdBQUdGLElBQUksQ0FBQ0csV0FBTCxDQUFpQixDQUFqQixDQUFoQjs7QUFFQVAsNEJBQU9DLElBQVAsQ0FBYSxnQkFBYixFQUE4QkYsTUFBOUIsRUFBc0NPLE9BQXRDO0FBRUEsS0FoQkQsQ0FnQkUsT0FBT0UsR0FBUCxFQUFZO0FBQ2JSLDRCQUFPUyxLQUFQLENBQWMseUJBQWQsRUFBd0NWLE1BQXhDLEVBQWdEUyxHQUFoRDtBQUNBLEtBeEI4QixDQTJCL0I7QUFDQTs7O0FBQ0EsUUFBSTtBQUVIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQSxZQUFNSixJQUFJLEdBQUdNLE1BQU0sQ0FBQ0MsV0FBUCxDQUFtQixDQUFuQixFQUFzQkMsSUFBdEIsQ0FBMkIsQ0FBM0IsQ0FBYjtBQUNBLFlBQU1DLFlBQVksR0FBR0MsSUFBSSxDQUFDQyxLQUFMLENBQVdELElBQUksQ0FBQ0UsTUFBTCxLQUFnQixJQUEzQixDQUFyQjtBQUNBWixNQUFBQSxJQUFJLENBQUNhLFlBQUwsQ0FBa0JKLFlBQWxCLEVBQWdDLENBQWhDO0FBRUEsWUFBTWQsTUFBTSxDQUFDbUIsS0FBUCxDQUFhLENBQWIsRUFBZ0JkLElBQWhCLENBQU47O0FBRUFKLDRCQUFPQyxJQUFQLENBQWEsY0FBYixFQUE0QkYsTUFBNUIsRUFBb0NjLFlBQXBDLEVBQWtEVCxJQUFsRDtBQUVBLEtBaEJELENBZ0JFLE9BQU9JLEdBQVAsRUFBWTtBQUNiUiw0QkFBT1MsS0FBUCxDQUFjLHlCQUFkLEVBQXdDVixNQUF4QyxFQUFnRFMsR0FBaEQ7QUFDQTtBQUdELEdBbEREO0FBb0RBVCxFQUFBQSxNQUFNLENBQUNELEVBQVAsQ0FBVSxPQUFWLEVBQW1CVSxHQUFHLElBQUk7QUFDekJSLDBCQUFPUyxLQUFQLENBQWMsbUJBQWQsRUFBa0NWLE1BQWxDLEVBQTBDUyxHQUExQztBQUNBLEdBRkQ7QUFJQVQsRUFBQUEsTUFBTSxDQUFDRCxFQUFQLENBQVUsS0FBVixFQUFpQixNQUFNO0FBQ3RCRSwwQkFBT0MsSUFBUCxDQUFhLGdCQUFiLEVBQThCRixNQUE5QjtBQUNBLEdBRkQ7QUFLQSxDQWpGRDtBQW1GQUgsR0FBRyxDQUFDRSxFQUFKLENBQU8sT0FBUCxFQUFnQlUsR0FBRyxJQUFJO0FBQ3RCUix3QkFBT1MsS0FBUCxDQUFjLG1CQUFkLEVBQWtDRCxHQUFsQztBQUNBLENBRkQiLCJzb3VyY2VSb290IjoiL1VzZXJzL2hhcnJ5aG93L0RvY3VtZW50cy8yMDIyL1BST0pFQ1RfTU9DQV9BUlQvTkZDL25mYy1wY3NjL2V4YW1wbGVzLyIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG4vLyAjIyMjIyMjIyMjIyMjXG4vLyBFeGFtcGxlOiBSZWFkaW5nIGFuZCB3cml0aW5nIGRhdGFcbi8vIC0gc2hvdWxkIHdvcmsgd2VsbCB3aXRoIGFueSBjb21wYXRpYmxlIFBDL1NDIGNhcmQgcmVhZGVyXG4vLyAtIHRlc3RlZCB3aXRoIE1JRkFSRSBVbHRyYWxpZ2h0IGNhcmRzIGJ1dCBzaG91bGQgd29yayB3aXRoIG1hbnkgb3RoZXJzIChlLmcuIE5UQUcpXG4vLyAtIHdoYXQgaXMgY292ZXJlZDpcbi8vICAgLSBleGFtcGxlIHJlYWRpbmcgYW5kIHdyaXRpbmcgZGF0YSBvbiBmcm9tL3RvIGNhcmRcbi8vIC0gTk9URSEgZm9yIHJlYWRpbmcgYW5kIHdyaXRpbmcgZGF0YSBmcm9tL3RvIE1JRkFSRSBDbGFzc2ljIHBsZWFzZSBzZWUgZXhhbXBsZXMvbWlmYXJlLWNsYXNzaWMuanMgd2hpY2ggZXhwbGFpbnMgTUlGQVJFIENsYXNzaWMgc3BlY2lmaWNzXG4vLyAjIyMjIyMjIyMjIyMjXG5cbmltcG9ydCB7IE5GQywgVEFHX0lTT18xNDQ0M18zLCBUQUdfSVNPXzE0NDQzXzQsIEtFWV9UWVBFX0EsIEtFWV9UWVBFX0IgfSBmcm9tICcuLi9zcmMvaW5kZXgnO1xuaW1wb3J0IHByZXR0eSBmcm9tICcuL3ByZXR0eS1sb2dnZXInO1xuXG5cbmNvbnN0IG5mYyA9IG5ldyBORkMoKTsgLy8gY29uc3QgbmZjID0gbmV3IE5GQyhwcmV0dHkpOyAvLyBvcHRpb25hbGx5IHlvdSBjYW4gcGFzcyBsb2dnZXIgdG8gc2VlIGludGVybmFsIGRlYnVnIGxvZ3NcblxubmZjLm9uKCdyZWFkZXInLCBhc3luYyByZWFkZXIgPT4ge1xuXG5cdHByZXR0eS5pbmZvKGBkZXZpY2UgYXR0YWNoZWRgLCByZWFkZXIpO1xuXG5cdC8vIGVuYWJsZSB3aGVuIHlvdSB3YW50IHRvIGF1dG8tcHJvY2VzcyBJU08gMTQ0NDMtNCB0YWdzIChzdGFuZGFyZD1UQUdfSVNPXzE0NDQzXzQpXG5cdC8vIHdoZW4gYW4gSVNPIDE0NDQzLTQgaXMgZGV0ZWN0ZWQsIFNFTEVDVCBGSUxFIGNvbW1hbmQgd2l0aCB0aGUgQUlEIGlzIGlzc3VlZFxuXHQvLyB0aGUgcmVzcG9uc2UgaXMgYXZhaWxhYmxlIGFzIGNhcmQuZGF0YSBpbiB0aGUgY2FyZCBldmVudFxuXHQvLyB5b3UgY2FuIHNldCByZWFkZXIuYWlkIHRvOlxuXHQvLyAxLiBhIEhFWCBzdHJpbmcgKHdoaWNoIHdpbGwgYmUgcGFyc2VkIGF1dG9tYXRpY2FsbHkgdG8gQnVmZmVyKVxuXHRyZWFkZXIuYWlkID0gJ0YyMjIyMjIyMjInO1xuXHQvLyAyLiBhbiBpbnN0YW5jZSBvZiBCdWZmZXIgY29udGFpbmluZyB0aGUgQUlEIGJ5dGVzXG5cdC8vIHJlYWRlci5haWQgPSBCdWZmZXIuZnJvbSgnRjIyMjIyMjIyMicsICdoZXgnKTtcblx0Ly8gMy4gYSBmdW5jdGlvbiB3aGljaCBtdXN0IHJldHVybiBhbiBpbnN0YW5jZSBvZiBhIEJ1ZmZlciB3aGVuIGludm9rZWQgd2l0aCBjYXJkIG9iamVjdCAoY29udGFpbmluZyBzdGFuZGFyZCBhbmQgYXRyKVxuXHQvLyAgICB0aGUgZnVuY3Rpb24gbWF5IGdlbmVyYXRlIEFJRHMgZHluYW1pY2FsbHkgYmFzZWQgb24gdGhlIGRldGVjdGVkIGNhcmRcblx0Ly8gcmVhZGVyLmFpZCA9ICh7IHN0YW5kYXJkLCBhdHIgfSkgPT4ge1xuXHQvL1xuXHQvLyBcdHJldHVybiBCdWZmZXIuZnJvbSgnRjIyMjIyMjIyMicsICdoZXgnKTtcblx0Ly9cblx0Ly8gfTtcblxuXHRyZWFkZXIub24oJ2NhcmQnLCBhc3luYyBjYXJkID0+IHtcblxuXHRcdHByZXR0eS5pbmZvKGBjYXJkIGRldGVjdGVkYCwgcmVhZGVyLCBjYXJkKTtcblxuXHRcdC8vIGV4YW1wbGUgcmVhZGluZyA0IGJ5dGVzIGFzc3VtaW5nIGNvbnRhaW5pbmcgMTZiaXQgaW50ZWdlclxuXHRcdC8vICEhISBub3RlIHRoYXQgd2UgZG9uJ3QgbmVlZCA0IGJ5dGVzIC0gMTZiaXQgaW50ZWdlciB0YWtlcyBqdXN0IDIgYnl0ZXMgISEhXG5cdFx0dHJ5IHtcblxuXHRcdFx0Ly8gcmVhZGVyLnJlYWQoYmxvY2tOdW1iZXIsIGxlbmd0aCwgYmxvY2tTaXplID0gNCwgcGFja2V0U2l6ZSA9IDE2KVxuXHRcdFx0Ly8gLSBibG9ja051bWJlciAtIG1lbW9yeSBibG9jayBudW1iZXIgd2hlcmUgdG8gc3RhcnQgcmVhZGluZ1xuXHRcdFx0Ly8gLSBsZW5ndGggLSBob3cgbWFueSBieXRlcyB0byByZWFkXG5cdFx0XHQvLyAtIGJsb2NrU2l6ZSAtIDQgZm9yIE1JRkFSRSBVbHRyYWxpZ2h0LCAxNiBmb3IgTUlGQVJFIENsYXNzaWNcblx0XHRcdC8vICEgQ2F1dGlvbiEgbGVuZ3RoIG11c3QgYmUgZGl2aXNpYmxlIGJ5IGJsb2NrU2l6ZSAod2UgaGF2ZSB0byByZWFkIHRoZSB3aG9sZSBibG9jayhzKSlcblxuXHRcdFx0Y29uc3QgZGF0YSA9IGF3YWl0IHJlYWRlci5yZWFkKDQsIDQpO1xuXG5cdFx0XHRwcmV0dHkuaW5mbyhgZGF0YSByZWFkYCwgcmVhZGVyLCBkYXRhKTtcblxuXHRcdFx0Y29uc3QgcGF5bG9hZCA9IGRhdGEucmVhZEludDE2QkUoMCk7XG5cblx0XHRcdHByZXR0eS5pbmZvKGBkYXRhIGNvbnZlcnRlZGAsIHJlYWRlciwgcGF5bG9hZCk7XG5cblx0XHR9IGNhdGNoIChlcnIpIHtcblx0XHRcdHByZXR0eS5lcnJvcihgZXJyb3Igd2hlbiByZWFkaW5nIGRhdGFgLCByZWFkZXIsIGVycik7XG5cdFx0fVxuXG5cblx0XHQvLyBleGFtcGxlIHdyaXRlIDQgYnl0ZXMgY29udGFpbmluZyAxNmJpdCBpbnRlZ2VyXG5cdFx0Ly8gISEhIG5vdGUgdGhhdCB3ZSBkb24ndCBuZWVkIDE2IGJ5dGVzIC0gMTZiaXQgaW50ZWdlciB0YWtlcyBqdXN0IDIgYnl0ZXMgISEhXG5cdFx0dHJ5IHtcblxuXHRcdFx0Ly8gcmVhZGVyLndyaXRlKGJsb2NrTnVtYmVyLCBkYXRhLCBibG9ja1NpemUgPSA0LCBwYWNrZXRTaXplID0gMTYpXG5cdFx0XHQvLyAtIGJsb2NrTnVtYmVyIC0gbWVtb3J5IGJsb2NrIG51bWJlciB3aGVyZSB0byBzdGFydCB3cml0aW5nXG5cdFx0XHQvLyAtIGRhdGEgLSB3aGF0IHRvIHdyaXRlXG5cdFx0XHQvLyAtIGJsb2NrU2l6ZSAtIDQgZm9yIE1JRkFSRSBVbHRyYWxpZ2h0LCAxNiBmb3IgTUlGQVJFIENsYXNzaWNcblx0XHRcdC8vICEgQ2F1dGlvbiEgZGF0YS5sZW5ndGggbXVzdCBiZSBkaXZpc2libGUgYnkgYmxvY2tTaXplICh3ZSBoYXZlIHRvIHdyaXRlIHRoZSB3aG9sZSBibG9jayhzKSlcblxuXHRcdFx0Y29uc3QgZGF0YSA9IEJ1ZmZlci5hbGxvY1Vuc2FmZSg0KS5maWxsKDApO1xuXHRcdFx0Y29uc3QgcmFuZG9tTnVtYmVyID0gTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpICogMTAwMCk7XG5cdFx0XHRkYXRhLndyaXRlSW50MTZCRShyYW5kb21OdW1iZXIsIDApO1xuXG5cdFx0XHRhd2FpdCByZWFkZXIud3JpdGUoNCwgZGF0YSk7XG5cblx0XHRcdHByZXR0eS5pbmZvKGBkYXRhIHdyaXR0ZW5gLCByZWFkZXIsIHJhbmRvbU51bWJlciwgZGF0YSk7XG5cblx0XHR9IGNhdGNoIChlcnIpIHtcblx0XHRcdHByZXR0eS5lcnJvcihgZXJyb3Igd2hlbiB3cml0aW5nIGRhdGFgLCByZWFkZXIsIGVycik7XG5cdFx0fVxuXG5cblx0fSk7XG5cblx0cmVhZGVyLm9uKCdlcnJvcicsIGVyciA9PiB7XG5cdFx0cHJldHR5LmVycm9yKGBhbiBlcnJvciBvY2N1cnJlZGAsIHJlYWRlciwgZXJyKTtcblx0fSk7XG5cblx0cmVhZGVyLm9uKCdlbmQnLCAoKSA9PiB7XG5cdFx0cHJldHR5LmluZm8oYGRldmljZSByZW1vdmVkYCwgcmVhZGVyKTtcblx0fSk7XG5cblxufSk7XG5cbm5mYy5vbignZXJyb3InLCBlcnIgPT4ge1xuXHRwcmV0dHkuZXJyb3IoYGFuIGVycm9yIG9jY3VycmVkYCwgZXJyKTtcbn0pO1xuIl19",
    "map": {
      "version": 3,
      "sources": [
        "read-write.js"
      ],
      "names": [
        "nfc",
        "NFC",
        "on",
        "reader",
        "pretty",
        "info",
        "aid",
        "card",
        "data",
        "read",
        "payload",
        "readInt16BE",
        "err",
        "error",
        "Buffer",
        "allocUnsafe",
        "fill",
        "randomNumber",
        "Math",
        "round",
        "random",
        "writeInt16BE",
        "write"
      ],
      "mappings": "AAAA,a,CAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AACA;;;;AAGA,MAAMA,GAAG,GAAG,IAAIC,UAAJ,EAAZ,C,CAAuB;;AAEvBD,GAAG,CAACE,EAAJ,CAAO,QAAP,EAAiB,MAAMC,MAAN,IAAgB;AAEhCC,wBAAOC,IAAP,CAAa,iBAAb,EAA+BF,MAA/B,EAFgC,CAIhC;AACA;AACA;AACA;AACA;;;AACAA,EAAAA,MAAM,CAACG,GAAP,GAAa,YAAb,CATgC,CAUhC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAH,EAAAA,MAAM,CAACD,EAAP,CAAU,MAAV,EAAkB,MAAMK,IAAN,IAAc;AAE/BH,0BAAOC,IAAP,CAAa,eAAb,EAA6BF,MAA7B,EAAqCI,IAArC,EAF+B,CAI/B;AACA;;;AACA,QAAI;AAEH;AACA;AACA;AACA;AACA;AAEA,YAAMC,IAAI,GAAG,MAAML,MAAM,CAACM,IAAP,CAAY,CAAZ,EAAe,CAAf,CAAnB;;AAEAL,4BAAOC,IAAP,CAAa,WAAb,EAAyBF,MAAzB,EAAiCK,IAAjC;;AAEA,YAAME,OAAO,GAAGF,IAAI,CAACG,WAAL,CAAiB,CAAjB,CAAhB;;AAEAP,4BAAOC,IAAP,CAAa,gBAAb,EAA8BF,MAA9B,EAAsCO,OAAtC;AAEA,KAhBD,CAgBE,OAAOE,GAAP,EAAY;AACbR,4BAAOS,KAAP,CAAc,yBAAd,EAAwCV,MAAxC,EAAgDS,GAAhD;AACA,KAxB8B,CA2B/B;AACA;;;AACA,QAAI;AAEH;AACA;AACA;AACA;AACA;AAEA,YAAMJ,IAAI,GAAGM,MAAM,CAACC,WAAP,CAAmB,CAAnB,EAAsBC,IAAtB,CAA2B,CAA3B,CAAb;AACA,YAAMC,YAAY,GAAGC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,KAAgB,IAA3B,CAArB;AACAZ,MAAAA,IAAI,CAACa,YAAL,CAAkBJ,YAAlB,EAAgC,CAAhC;AAEA,YAAMd,MAAM,CAACmB,KAAP,CAAa,CAAb,EAAgBd,IAAhB,CAAN;;AAEAJ,4BAAOC,IAAP,CAAa,cAAb,EAA4BF,MAA5B,EAAoCc,YAApC,EAAkDT,IAAlD;AAEA,KAhBD,CAgBE,OAAOI,GAAP,EAAY;AACbR,4BAAOS,KAAP,CAAc,yBAAd,EAAwCV,MAAxC,EAAgDS,GAAhD;AACA;AAGD,GAlDD;AAoDAT,EAAAA,MAAM,CAACD,EAAP,CAAU,OAAV,EAAmBU,GAAG,IAAI;AACzBR,0BAAOS,KAAP,CAAc,mBAAd,EAAkCV,MAAlC,EAA0CS,GAA1C;AACA,GAFD;AAIAT,EAAAA,MAAM,CAACD,EAAP,CAAU,KAAV,EAAiB,MAAM;AACtBE,0BAAOC,IAAP,CAAa,gBAAb,EAA8BF,MAA9B;AACA,GAFD;AAKA,CAjFD;AAmFAH,GAAG,CAACE,EAAJ,CAAO,OAAP,EAAgBU,GAAG,IAAI;AACtBR,wBAAOS,KAAP,CAAc,mBAAd,EAAkCD,GAAlC;AACA,CAFD",
      "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/",
      "sourcesContent": [
        "\"use strict\";\n\n// #############\n// Example: Reading and writing data\n// - should work well with any compatible PC/SC card reader\n// - tested with MIFARE Ultralight cards but should work with many others (e.g. NTAG)\n// - what is covered:\n//   - example reading and writing data on from/to card\n// - NOTE! for reading and writing data from/to MIFARE Classic please see examples/mifare-classic.js which explains MIFARE Classic specifics\n// #############\n\nimport { NFC, TAG_ISO_14443_3, TAG_ISO_14443_4, KEY_TYPE_A, KEY_TYPE_B } from '../src/index';\nimport pretty from './pretty-logger';\n\n\nconst nfc = new NFC(); // const nfc = new NFC(pretty); // optionally you can pass logger to see internal debug logs\n\nnfc.on('reader', async reader => {\n\n\tpretty.info(`device attached`, reader);\n\n\t// enable when you want to auto-process ISO 14443-4 tags (standard=TAG_ISO_14443_4)\n\t// when an ISO 14443-4 is detected, SELECT FILE command with the AID is issued\n\t// the response is available as card.data in the card event\n\t// you can set reader.aid to:\n\t// 1. a HEX string (which will be parsed automatically to Buffer)\n\treader.aid = 'F222222222';\n\t// 2. an instance of Buffer containing the AID bytes\n\t// reader.aid = Buffer.from('F222222222', 'hex');\n\t// 3. a function which must return an instance of a Buffer when invoked with card object (containing standard and atr)\n\t//    the function may generate AIDs dynamically based on the detected card\n\t// reader.aid = ({ standard, atr }) => {\n\t//\n\t// \treturn Buffer.from('F222222222', 'hex');\n\t//\n\t// };\n\n\treader.on('card', async card => {\n\n\t\tpretty.info(`card detected`, reader, card);\n\n\t\t// example reading 4 bytes assuming containing 16bit integer\n\t\t// !!! note that we don't need 4 bytes - 16bit integer takes just 2 bytes !!!\n\t\ttry {\n\n\t\t\t// reader.read(blockNumber, length, blockSize = 4, packetSize = 16)\n\t\t\t// - blockNumber - memory block number where to start reading\n\t\t\t// - length - how many bytes to read\n\t\t\t// - blockSize - 4 for MIFARE Ultralight, 16 for MIFARE Classic\n\t\t\t// ! Caution! length must be divisible by blockSize (we have to read the whole block(s))\n\n\t\t\tconst data = await reader.read(4, 4);\n\n\t\t\tpretty.info(`data read`, reader, data);\n\n\t\t\tconst payload = data.readInt16BE(0);\n\n\t\t\tpretty.info(`data converted`, reader, payload);\n\n\t\t} catch (err) {\n\t\t\tpretty.error(`error when reading data`, reader, err);\n\t\t}\n\n\n\t\t// example write 4 bytes containing 16bit integer\n\t\t// !!! note that we don't need 16 bytes - 16bit integer takes just 2 bytes !!!\n\t\ttry {\n\n\t\t\t// reader.write(blockNumber, data, blockSize = 4, packetSize = 16)\n\t\t\t// - blockNumber - memory block number where to start writing\n\t\t\t// - data - what to write\n\t\t\t// - blockSize - 4 for MIFARE Ultralight, 16 for MIFARE Classic\n\t\t\t// ! Caution! data.length must be divisible by blockSize (we have to write the whole block(s))\n\n\t\t\tconst data = Buffer.allocUnsafe(4).fill(0);\n\t\t\tconst randomNumber = Math.round(Math.random() * 1000);\n\t\t\tdata.writeInt16BE(randomNumber, 0);\n\n\t\t\tawait reader.write(4, data);\n\n\t\t\tpretty.info(`data written`, reader, randomNumber, data);\n\n\t\t} catch (err) {\n\t\t\tpretty.error(`error when writing data`, reader, err);\n\t\t}\n\n\n\t});\n\n\treader.on('error', err => {\n\t\tpretty.error(`an error occurred`, reader, err);\n\t});\n\n\treader.on('end', () => {\n\t\tpretty.info(`device removed`, reader);\n\t});\n\n\n});\n\nnfc.on('error', err => {\n\tpretty.error(`an error occurred`, err);\n});\n"
      ]
    },
    "sourceType": "script",
    "mtime": 1662229648498
  },
  "{\"sourceRoot\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc\",\"filename\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/index.js\",\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{}},{\"key\":\"proposal-class-properties\",\"visitor\":{\"PrivateName\":{\"enter\":[null]},\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{}}],\"presets\":[]}:7.12.17": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/",
      "caller": {
        "name": "@babel/register"
      },
      "cwd": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc",
      "filename": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/index.js",
      "cloneInputAst": true,
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {}
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {}
        },
        {
          "key": "proposal-class-properties",
          "visitor": {
            "PrivateName": {
              "enter": [
                null
              ]
            },
            "ExportDefaultDeclaration": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true,
            "ClassExpression": {
              "enter": [
                null
              ]
            },
            "ClassDeclaration": {
              "enter": [
                null
              ]
            }
          },
          "options": {}
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/index.js",
        "plugins": [
          "objectRestSpread",
          "classProperties",
          "classPrivateProperties"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/index.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/",
        "sourceFileName": "index.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nObject.defineProperty(exports, \"NFC\", {\n  enumerable: true,\n  get: function () {\n    return _NFC.default;\n  }\n});\nObject.defineProperty(exports, \"Reader\", {\n  enumerable: true,\n  get: function () {\n    return _Reader.default;\n  }\n});\nObject.defineProperty(exports, \"TAG_ISO_14443_3\", {\n  enumerable: true,\n  get: function () {\n    return _Reader.TAG_ISO_14443_3;\n  }\n});\nObject.defineProperty(exports, \"TAG_ISO_14443_4\", {\n  enumerable: true,\n  get: function () {\n    return _Reader.TAG_ISO_14443_4;\n  }\n});\nObject.defineProperty(exports, \"KEY_TYPE_A\", {\n  enumerable: true,\n  get: function () {\n    return _Reader.KEY_TYPE_A;\n  }\n});\nObject.defineProperty(exports, \"KEY_TYPE_B\", {\n  enumerable: true,\n  get: function () {\n    return _Reader.KEY_TYPE_B;\n  }\n});\nObject.defineProperty(exports, \"CONNECT_MODE_CARD\", {\n  enumerable: true,\n  get: function () {\n    return _Reader.CONNECT_MODE_CARD;\n  }\n});\nObject.defineProperty(exports, \"CONNECT_MODE_DIRECT\", {\n  enumerable: true,\n  get: function () {\n    return _Reader.CONNECT_MODE_DIRECT;\n  }\n});\nObject.defineProperty(exports, \"ACR122Reader\", {\n  enumerable: true,\n  get: function () {\n    return _ACR122Reader.default;\n  }\n});\nObject.defineProperty(exports, \"UNKNOWN_ERROR\", {\n  enumerable: true,\n  get: function () {\n    return _errors.UNKNOWN_ERROR;\n  }\n});\nObject.defineProperty(exports, \"FAILURE\", {\n  enumerable: true,\n  get: function () {\n    return _errors.FAILURE;\n  }\n});\nObject.defineProperty(exports, \"CARD_NOT_CONNECTED\", {\n  enumerable: true,\n  get: function () {\n    return _errors.CARD_NOT_CONNECTED;\n  }\n});\nObject.defineProperty(exports, \"OPERATION_FAILED\", {\n  enumerable: true,\n  get: function () {\n    return _errors.OPERATION_FAILED;\n  }\n});\nObject.defineProperty(exports, \"BaseError\", {\n  enumerable: true,\n  get: function () {\n    return _errors.BaseError;\n  }\n});\nObject.defineProperty(exports, \"TransmitError\", {\n  enumerable: true,\n  get: function () {\n    return _errors.TransmitError;\n  }\n});\nObject.defineProperty(exports, \"ControlError\", {\n  enumerable: true,\n  get: function () {\n    return _errors.ControlError;\n  }\n});\nObject.defineProperty(exports, \"ReadError\", {\n  enumerable: true,\n  get: function () {\n    return _errors.ReadError;\n  }\n});\nObject.defineProperty(exports, \"WriteError\", {\n  enumerable: true,\n  get: function () {\n    return _errors.WriteError;\n  }\n});\nObject.defineProperty(exports, \"LoadAuthenticationKeyError\", {\n  enumerable: true,\n  get: function () {\n    return _errors.LoadAuthenticationKeyError;\n  }\n});\nObject.defineProperty(exports, \"AuthenticationError\", {\n  enumerable: true,\n  get: function () {\n    return _errors.AuthenticationError;\n  }\n});\nObject.defineProperty(exports, \"ConnectError\", {\n  enumerable: true,\n  get: function () {\n    return _errors.ConnectError;\n  }\n});\nObject.defineProperty(exports, \"DisconnectError\", {\n  enumerable: true,\n  get: function () {\n    return _errors.DisconnectError;\n  }\n});\nObject.defineProperty(exports, \"GetUIDError\", {\n  enumerable: true,\n  get: function () {\n    return _errors.GetUIDError;\n  }\n});\n\nvar _NFC = _interopRequireDefault(require(\"./NFC\"));\n\nvar _Reader = _interopRequireWildcard(require(\"./Reader\"));\n\nvar _ACR122Reader = _interopRequireDefault(require(\"./ACR122Reader\"));\n\nvar _errors = require(\"./errors\");\n\nfunction _getRequireWildcardCache() { if (typeof WeakMap !== \"function\") return null; var cache = new WeakMap(); _getRequireWildcardCache = function () { return cache; }; return cache; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFFQTs7QUFDQTs7QUFRQTs7QUFDQSIsInNvdXJjZVJvb3QiOiIvVXNlcnMvaGFycnlob3cvRG9jdW1lbnRzLzIwMjIvUFJPSkVDVF9NT0NBX0FSVC9ORkMvbmZjLXBjc2Mvc3JjLyIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG5pbXBvcnQgTkZDIGZyb20gJy4vTkZDJztcbmltcG9ydCBSZWFkZXIsIHtcblx0VEFHX0lTT18xNDQ0M18zLFxuXHRUQUdfSVNPXzE0NDQzXzQsXG5cdEtFWV9UWVBFX0EsXG5cdEtFWV9UWVBFX0IsXG5cdENPTk5FQ1RfTU9ERV9DQVJELFxuXHRDT05ORUNUX01PREVfRElSRUNULFxufSBmcm9tICcuL1JlYWRlcic7XG5pbXBvcnQgQUNSMTIyUmVhZGVyIGZyb20gJy4vQUNSMTIyUmVhZGVyJztcbmltcG9ydCB7XG5cdFVOS05PV05fRVJST1IsXG5cdEZBSUxVUkUsXG5cdENBUkRfTk9UX0NPTk5FQ1RFRCxcblx0T1BFUkFUSU9OX0ZBSUxFRCxcblx0QmFzZUVycm9yLFxuXHRUcmFuc21pdEVycm9yLFxuXHRDb250cm9sRXJyb3IsXG5cdFJlYWRFcnJvcixcblx0V3JpdGVFcnJvcixcblx0TG9hZEF1dGhlbnRpY2F0aW9uS2V5RXJyb3IsXG5cdEF1dGhlbnRpY2F0aW9uRXJyb3IsXG5cdENvbm5lY3RFcnJvcixcblx0RGlzY29ubmVjdEVycm9yLFxuXHRHZXRVSURFcnJvcixcbn0gZnJvbSAnLi9lcnJvcnMnO1xuXG5leHBvcnQge1xuXHRORkMsXG5cdFJlYWRlcixcblx0VEFHX0lTT18xNDQ0M18zLFxuXHRUQUdfSVNPXzE0NDQzXzQsXG5cdEtFWV9UWVBFX0EsXG5cdEtFWV9UWVBFX0IsXG5cdENPTk5FQ1RfTU9ERV9DQVJELFxuXHRDT05ORUNUX01PREVfRElSRUNULFxuXHRBQ1IxMjJSZWFkZXIsXG5cdFVOS05PV05fRVJST1IsXG5cdEZBSUxVUkUsXG5cdENBUkRfTk9UX0NPTk5FQ1RFRCxcblx0T1BFUkFUSU9OX0ZBSUxFRCxcblx0QmFzZUVycm9yLFxuXHRUcmFuc21pdEVycm9yLFxuXHRDb250cm9sRXJyb3IsXG5cdFJlYWRFcnJvcixcblx0V3JpdGVFcnJvcixcblx0TG9hZEF1dGhlbnRpY2F0aW9uS2V5RXJyb3IsXG5cdEF1dGhlbnRpY2F0aW9uRXJyb3IsXG5cdENvbm5lY3RFcnJvcixcblx0RGlzY29ubmVjdEVycm9yLFxuXHRHZXRVSURFcnJvcixcbn07XG4iXX0=",
    "map": {
      "version": 3,
      "sources": [
        "index.js"
      ],
      "names": [],
      "mappings": "AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEA;;AACA;;AAQA;;AACA",
      "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/",
      "sourcesContent": [
        "\"use strict\";\n\nimport NFC from './NFC';\nimport Reader, {\n\tTAG_ISO_14443_3,\n\tTAG_ISO_14443_4,\n\tKEY_TYPE_A,\n\tKEY_TYPE_B,\n\tCONNECT_MODE_CARD,\n\tCONNECT_MODE_DIRECT,\n} from './Reader';\nimport ACR122Reader from './ACR122Reader';\nimport {\n\tUNKNOWN_ERROR,\n\tFAILURE,\n\tCARD_NOT_CONNECTED,\n\tOPERATION_FAILED,\n\tBaseError,\n\tTransmitError,\n\tControlError,\n\tReadError,\n\tWriteError,\n\tLoadAuthenticationKeyError,\n\tAuthenticationError,\n\tConnectError,\n\tDisconnectError,\n\tGetUIDError,\n} from './errors';\n\nexport {\n\tNFC,\n\tReader,\n\tTAG_ISO_14443_3,\n\tTAG_ISO_14443_4,\n\tKEY_TYPE_A,\n\tKEY_TYPE_B,\n\tCONNECT_MODE_CARD,\n\tCONNECT_MODE_DIRECT,\n\tACR122Reader,\n\tUNKNOWN_ERROR,\n\tFAILURE,\n\tCARD_NOT_CONNECTED,\n\tOPERATION_FAILED,\n\tBaseError,\n\tTransmitError,\n\tControlError,\n\tReadError,\n\tWriteError,\n\tLoadAuthenticationKeyError,\n\tAuthenticationError,\n\tConnectError,\n\tDisconnectError,\n\tGetUIDError,\n};\n"
      ]
    },
    "sourceType": "script",
    "mtime": 1662229648500
  },
  "{\"sourceRoot\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc\",\"filename\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/NFC.js\",\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{}},{\"key\":\"proposal-class-properties\",\"visitor\":{\"PrivateName\":{\"enter\":[null]},\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{}}],\"presets\":[]}:7.12.17": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/",
      "caller": {
        "name": "@babel/register"
      },
      "cwd": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc",
      "filename": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/NFC.js",
      "cloneInputAst": true,
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {}
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {}
        },
        {
          "key": "proposal-class-properties",
          "visitor": {
            "PrivateName": {
              "enter": [
                null
              ]
            },
            "ExportDefaultDeclaration": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true,
            "ClassExpression": {
              "enter": [
                null
              ]
            },
            "ClassDeclaration": {
              "enter": [
                null
              ]
            }
          },
          "options": {}
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/NFC.js",
        "plugins": [
          "objectRestSpread",
          "classProperties",
          "classPrivateProperties"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/NFC.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/",
        "sourceFileName": "NFC.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _pcsclite = _interopRequireDefault(require(\"@pokusew/pcsclite\"));\n\nvar _events = _interopRequireDefault(require(\"events\"));\n\nvar _Reader = _interopRequireDefault(require(\"./Reader\"));\n\nvar _ACR122Reader = _interopRequireDefault(require(\"./ACR122Reader\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nclass NFC extends _events.default {\n  constructor(logger) {\n    super();\n\n    _defineProperty(this, \"pcsc\", null);\n\n    _defineProperty(this, \"logger\", null);\n\n    this.pcsc = (0, _pcsclite.default)();\n\n    if (logger) {\n      this.logger = logger;\n    } else {\n      this.logger = {\n        log: function () {},\n        debug: function () {},\n        info: function () {},\n        warn: function () {},\n        error: function () {}\n      };\n    }\n\n    this.pcsc.on('reader', reader => {\n      this.logger.debug('new reader detected', reader.name); // create special object for ARC122U reader with commands specific to this reader\n\n      if ( // 'acr122' matches ARC122U\n      reader.name.toLowerCase().indexOf('acr122') !== -1 // 'acr125' matches ACR1252U reader because ACR1252U has some common commands with ARC122U\n      //   ACR1252U product page: https://www.acs.com.hk/en/products/342/acr1252u-usb-nfc-reader-iii-nfc-forum-certified-reader/\n      //   TODO: in the future, this should be refactored:\n      //         see discussion in PR#111 https://github.com/pokusew/nfc-pcsc/pull/111\n      || reader.name.toLowerCase().indexOf('acr125') !== -1) {\n        const device = new _ACR122Reader.default(reader, this.logger);\n        this.emit('reader', device);\n        return;\n      }\n\n      const device = new _Reader.default(reader, this.logger);\n      this.emit('reader', device);\n    });\n    this.pcsc.on('error', err => {\n      this.logger.error('PCSC error', err.message);\n      this.emit('error', err);\n    });\n  }\n\n  get readers() {\n    return this.pcsc.readers;\n  }\n\n  close() {\n    this.pcsc.close();\n  }\n\n}\n\nvar _default = NFC;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIk5GQy5qcyJdLCJuYW1lcyI6WyJORkMiLCJFdmVudEVtaXR0ZXIiLCJjb25zdHJ1Y3RvciIsImxvZ2dlciIsInBjc2MiLCJsb2ciLCJkZWJ1ZyIsImluZm8iLCJ3YXJuIiwiZXJyb3IiLCJvbiIsInJlYWRlciIsIm5hbWUiLCJ0b0xvd2VyQ2FzZSIsImluZGV4T2YiLCJkZXZpY2UiLCJBQ1IxMjJSZWFkZXIiLCJlbWl0IiwiUmVhZGVyIiwiZXJyIiwibWVzc2FnZSIsInJlYWRlcnMiLCJjbG9zZSJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7QUFFQTs7QUFDQTs7QUFDQTs7QUFDQTs7Ozs7O0FBR0EsTUFBTUEsR0FBTixTQUFrQkMsZUFBbEIsQ0FBK0I7QUFLOUJDLEVBQUFBLFdBQVcsQ0FBQ0MsTUFBRCxFQUFTO0FBQ25COztBQURtQixrQ0FIYixJQUdhOztBQUFBLG9DQUZYLElBRVc7O0FBR25CLFNBQUtDLElBQUwsR0FBWSx3QkFBWjs7QUFFQSxRQUFJRCxNQUFKLEVBQVk7QUFDWCxXQUFLQSxNQUFMLEdBQWNBLE1BQWQ7QUFDQSxLQUZELE1BR0s7QUFDSixXQUFLQSxNQUFMLEdBQWM7QUFDYkUsUUFBQUEsR0FBRyxFQUFFLFlBQVksQ0FDaEIsQ0FGWTtBQUdiQyxRQUFBQSxLQUFLLEVBQUUsWUFBWSxDQUNsQixDQUpZO0FBS2JDLFFBQUFBLElBQUksRUFBRSxZQUFZLENBQ2pCLENBTlk7QUFPYkMsUUFBQUEsSUFBSSxFQUFFLFlBQVksQ0FDakIsQ0FSWTtBQVNiQyxRQUFBQSxLQUFLLEVBQUUsWUFBWSxDQUNsQjtBQVZZLE9BQWQ7QUFZQTs7QUFFRCxTQUFLTCxJQUFMLENBQVVNLEVBQVYsQ0FBYSxRQUFiLEVBQXdCQyxNQUFELElBQVk7QUFFbEMsV0FBS1IsTUFBTCxDQUFZRyxLQUFaLENBQWtCLHFCQUFsQixFQUF5Q0ssTUFBTSxDQUFDQyxJQUFoRCxFQUZrQyxDQUlsQzs7QUFDQSxXQUVDO0FBQ0FELE1BQUFBLE1BQU0sQ0FBQ0MsSUFBUCxDQUFZQyxXQUFaLEdBQTBCQyxPQUExQixDQUFrQyxRQUFsQyxNQUFnRCxDQUFDLENBQWpELENBRUE7QUFDQTtBQUNBO0FBQ0E7QUFMQSxTQU1HSCxNQUFNLENBQUNDLElBQVAsQ0FBWUMsV0FBWixHQUEwQkMsT0FBMUIsQ0FBa0MsUUFBbEMsTUFBZ0QsQ0FBQyxDQVRyRCxFQVdFO0FBRUQsY0FBTUMsTUFBTSxHQUFHLElBQUlDLHFCQUFKLENBQWlCTCxNQUFqQixFQUF5QixLQUFLUixNQUE5QixDQUFmO0FBRUEsYUFBS2MsSUFBTCxDQUFVLFFBQVYsRUFBb0JGLE1BQXBCO0FBRUE7QUFFQTs7QUFFRCxZQUFNQSxNQUFNLEdBQUcsSUFBSUcsZUFBSixDQUFXUCxNQUFYLEVBQW1CLEtBQUtSLE1BQXhCLENBQWY7QUFFQSxXQUFLYyxJQUFMLENBQVUsUUFBVixFQUFvQkYsTUFBcEI7QUFFQSxLQTlCRDtBQWdDQSxTQUFLWCxJQUFMLENBQVVNLEVBQVYsQ0FBYSxPQUFiLEVBQXVCUyxHQUFELElBQVM7QUFFOUIsV0FBS2hCLE1BQUwsQ0FBWU0sS0FBWixDQUFrQixZQUFsQixFQUFnQ1UsR0FBRyxDQUFDQyxPQUFwQztBQUVBLFdBQUtILElBQUwsQ0FBVSxPQUFWLEVBQW1CRSxHQUFuQjtBQUVBLEtBTkQ7QUFRQTs7QUFFVSxNQUFQRSxPQUFPLEdBQUc7QUFDYixXQUFPLEtBQUtqQixJQUFMLENBQVVpQixPQUFqQjtBQUNBOztBQUVEQyxFQUFBQSxLQUFLLEdBQUc7QUFDUCxTQUFLbEIsSUFBTCxDQUFVa0IsS0FBVjtBQUNBOztBQTVFNkI7O2VBZ0ZoQnRCLEciLCJzb3VyY2VSb290IjoiL1VzZXJzL2hhcnJ5aG93L0RvY3VtZW50cy8yMDIyL1BST0pFQ1RfTU9DQV9BUlQvTkZDL25mYy1wY3NjL3NyYy8iLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxuaW1wb3J0IHBjc2NsaXRlIGZyb20gJ0Bwb2t1c2V3L3Bjc2NsaXRlJztcbmltcG9ydCBFdmVudEVtaXR0ZXIgZnJvbSAnZXZlbnRzJztcbmltcG9ydCBSZWFkZXIgZnJvbSAnLi9SZWFkZXInO1xuaW1wb3J0IEFDUjEyMlJlYWRlciBmcm9tICcuL0FDUjEyMlJlYWRlcic7XG5cblxuY2xhc3MgTkZDIGV4dGVuZHMgRXZlbnRFbWl0dGVyIHtcblxuXHRwY3NjID0gbnVsbDtcblx0bG9nZ2VyID0gbnVsbDtcblxuXHRjb25zdHJ1Y3Rvcihsb2dnZXIpIHtcblx0XHRzdXBlcigpO1xuXG5cdFx0dGhpcy5wY3NjID0gcGNzY2xpdGUoKTtcblxuXHRcdGlmIChsb2dnZXIpIHtcblx0XHRcdHRoaXMubG9nZ2VyID0gbG9nZ2VyO1xuXHRcdH1cblx0XHRlbHNlIHtcblx0XHRcdHRoaXMubG9nZ2VyID0ge1xuXHRcdFx0XHRsb2c6IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0fSxcblx0XHRcdFx0ZGVidWc6IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0fSxcblx0XHRcdFx0aW5mbzogZnVuY3Rpb24gKCkge1xuXHRcdFx0XHR9LFxuXHRcdFx0XHR3YXJuOiBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdH0sXG5cdFx0XHRcdGVycm9yOiBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdH0sXG5cdFx0XHR9O1xuXHRcdH1cblxuXHRcdHRoaXMucGNzYy5vbigncmVhZGVyJywgKHJlYWRlcikgPT4ge1xuXG5cdFx0XHR0aGlzLmxvZ2dlci5kZWJ1ZygnbmV3IHJlYWRlciBkZXRlY3RlZCcsIHJlYWRlci5uYW1lKTtcblxuXHRcdFx0Ly8gY3JlYXRlIHNwZWNpYWwgb2JqZWN0IGZvciBBUkMxMjJVIHJlYWRlciB3aXRoIGNvbW1hbmRzIHNwZWNpZmljIHRvIHRoaXMgcmVhZGVyXG5cdFx0XHRpZiAoXG5cblx0XHRcdFx0Ly8gJ2FjcjEyMicgbWF0Y2hlcyBBUkMxMjJVXG5cdFx0XHRcdHJlYWRlci5uYW1lLnRvTG93ZXJDYXNlKCkuaW5kZXhPZignYWNyMTIyJykgIT09IC0xXG5cblx0XHRcdFx0Ly8gJ2FjcjEyNScgbWF0Y2hlcyBBQ1IxMjUyVSByZWFkZXIgYmVjYXVzZSBBQ1IxMjUyVSBoYXMgc29tZSBjb21tb24gY29tbWFuZHMgd2l0aCBBUkMxMjJVXG5cdFx0XHRcdC8vICAgQUNSMTI1MlUgcHJvZHVjdCBwYWdlOiBodHRwczovL3d3dy5hY3MuY29tLmhrL2VuL3Byb2R1Y3RzLzM0Mi9hY3IxMjUydS11c2ItbmZjLXJlYWRlci1paWktbmZjLWZvcnVtLWNlcnRpZmllZC1yZWFkZXIvXG5cdFx0XHRcdC8vICAgVE9ETzogaW4gdGhlIGZ1dHVyZSwgdGhpcyBzaG91bGQgYmUgcmVmYWN0b3JlZDpcblx0XHRcdFx0Ly8gICAgICAgICBzZWUgZGlzY3Vzc2lvbiBpbiBQUiMxMTEgaHR0cHM6Ly9naXRodWIuY29tL3Bva3VzZXcvbmZjLXBjc2MvcHVsbC8xMTFcblx0XHRcdFx0fHwgcmVhZGVyLm5hbWUudG9Mb3dlckNhc2UoKS5pbmRleE9mKCdhY3IxMjUnKSAhPT0gLTFcblxuXHRcdFx0KSB7XG5cblx0XHRcdFx0Y29uc3QgZGV2aWNlID0gbmV3IEFDUjEyMlJlYWRlcihyZWFkZXIsIHRoaXMubG9nZ2VyKTtcblxuXHRcdFx0XHR0aGlzLmVtaXQoJ3JlYWRlcicsIGRldmljZSk7XG5cblx0XHRcdFx0cmV0dXJuO1xuXG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IGRldmljZSA9IG5ldyBSZWFkZXIocmVhZGVyLCB0aGlzLmxvZ2dlcik7XG5cblx0XHRcdHRoaXMuZW1pdCgncmVhZGVyJywgZGV2aWNlKTtcblxuXHRcdH0pO1xuXG5cdFx0dGhpcy5wY3NjLm9uKCdlcnJvcicsIChlcnIpID0+IHtcblxuXHRcdFx0dGhpcy5sb2dnZXIuZXJyb3IoJ1BDU0MgZXJyb3InLCBlcnIubWVzc2FnZSk7XG5cblx0XHRcdHRoaXMuZW1pdCgnZXJyb3InLCBlcnIpO1xuXG5cdFx0fSk7XG5cblx0fVxuXG5cdGdldCByZWFkZXJzKCkge1xuXHRcdHJldHVybiB0aGlzLnBjc2MucmVhZGVycztcblx0fVxuXG5cdGNsb3NlKCkge1xuXHRcdHRoaXMucGNzYy5jbG9zZSgpO1xuXHR9XG5cbn1cblxuZXhwb3J0IGRlZmF1bHQgTkZDO1xuIl19",
    "map": {
      "version": 3,
      "sources": [
        "NFC.js"
      ],
      "names": [
        "NFC",
        "EventEmitter",
        "constructor",
        "logger",
        "pcsc",
        "log",
        "debug",
        "info",
        "warn",
        "error",
        "on",
        "reader",
        "name",
        "toLowerCase",
        "indexOf",
        "device",
        "ACR122Reader",
        "emit",
        "Reader",
        "err",
        "message",
        "readers",
        "close"
      ],
      "mappings": "AAAA;;;;;;;AAEA;;AACA;;AACA;;AACA;;;;;;AAGA,MAAMA,GAAN,SAAkBC,eAAlB,CAA+B;AAK9BC,EAAAA,WAAW,CAACC,MAAD,EAAS;AACnB;;AADmB,kCAHb,IAGa;;AAAA,oCAFX,IAEW;;AAGnB,SAAKC,IAAL,GAAY,wBAAZ;;AAEA,QAAID,MAAJ,EAAY;AACX,WAAKA,MAAL,GAAcA,MAAd;AACA,KAFD,MAGK;AACJ,WAAKA,MAAL,GAAc;AACbE,QAAAA,GAAG,EAAE,YAAY,CAChB,CAFY;AAGbC,QAAAA,KAAK,EAAE,YAAY,CAClB,CAJY;AAKbC,QAAAA,IAAI,EAAE,YAAY,CACjB,CANY;AAObC,QAAAA,IAAI,EAAE,YAAY,CACjB,CARY;AASbC,QAAAA,KAAK,EAAE,YAAY,CAClB;AAVY,OAAd;AAYA;;AAED,SAAKL,IAAL,CAAUM,EAAV,CAAa,QAAb,EAAwBC,MAAD,IAAY;AAElC,WAAKR,MAAL,CAAYG,KAAZ,CAAkB,qBAAlB,EAAyCK,MAAM,CAACC,IAAhD,EAFkC,CAIlC;;AACA,WAEC;AACAD,MAAAA,MAAM,CAACC,IAAP,CAAYC,WAAZ,GAA0BC,OAA1B,CAAkC,QAAlC,MAAgD,CAAC,CAAjD,CAEA;AACA;AACA;AACA;AALA,SAMGH,MAAM,CAACC,IAAP,CAAYC,WAAZ,GAA0BC,OAA1B,CAAkC,QAAlC,MAAgD,CAAC,CATrD,EAWE;AAED,cAAMC,MAAM,GAAG,IAAIC,qBAAJ,CAAiBL,MAAjB,EAAyB,KAAKR,MAA9B,CAAf;AAEA,aAAKc,IAAL,CAAU,QAAV,EAAoBF,MAApB;AAEA;AAEA;;AAED,YAAMA,MAAM,GAAG,IAAIG,eAAJ,CAAWP,MAAX,EAAmB,KAAKR,MAAxB,CAAf;AAEA,WAAKc,IAAL,CAAU,QAAV,EAAoBF,MAApB;AAEA,KA9BD;AAgCA,SAAKX,IAAL,CAAUM,EAAV,CAAa,OAAb,EAAuBS,GAAD,IAAS;AAE9B,WAAKhB,MAAL,CAAYM,KAAZ,CAAkB,YAAlB,EAAgCU,GAAG,CAACC,OAApC;AAEA,WAAKH,IAAL,CAAU,OAAV,EAAmBE,GAAnB;AAEA,KAND;AAQA;;AAEU,MAAPE,OAAO,GAAG;AACb,WAAO,KAAKjB,IAAL,CAAUiB,OAAjB;AACA;;AAEDC,EAAAA,KAAK,GAAG;AACP,SAAKlB,IAAL,CAAUkB,KAAV;AACA;;AA5E6B;;eAgFhBtB,G",
      "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/",
      "sourcesContent": [
        "\"use strict\";\n\nimport pcsclite from '@pokusew/pcsclite';\nimport EventEmitter from 'events';\nimport Reader from './Reader';\nimport ACR122Reader from './ACR122Reader';\n\n\nclass NFC extends EventEmitter {\n\n\tpcsc = null;\n\tlogger = null;\n\n\tconstructor(logger) {\n\t\tsuper();\n\n\t\tthis.pcsc = pcsclite();\n\n\t\tif (logger) {\n\t\t\tthis.logger = logger;\n\t\t}\n\t\telse {\n\t\t\tthis.logger = {\n\t\t\t\tlog: function () {\n\t\t\t\t},\n\t\t\t\tdebug: function () {\n\t\t\t\t},\n\t\t\t\tinfo: function () {\n\t\t\t\t},\n\t\t\t\twarn: function () {\n\t\t\t\t},\n\t\t\t\terror: function () {\n\t\t\t\t},\n\t\t\t};\n\t\t}\n\n\t\tthis.pcsc.on('reader', (reader) => {\n\n\t\t\tthis.logger.debug('new reader detected', reader.name);\n\n\t\t\t// create special object for ARC122U reader with commands specific to this reader\n\t\t\tif (\n\n\t\t\t\t// 'acr122' matches ARC122U\n\t\t\t\treader.name.toLowerCase().indexOf('acr122') !== -1\n\n\t\t\t\t// 'acr125' matches ACR1252U reader because ACR1252U has some common commands with ARC122U\n\t\t\t\t//   ACR1252U product page: https://www.acs.com.hk/en/products/342/acr1252u-usb-nfc-reader-iii-nfc-forum-certified-reader/\n\t\t\t\t//   TODO: in the future, this should be refactored:\n\t\t\t\t//         see discussion in PR#111 https://github.com/pokusew/nfc-pcsc/pull/111\n\t\t\t\t|| reader.name.toLowerCase().indexOf('acr125') !== -1\n\n\t\t\t) {\n\n\t\t\t\tconst device = new ACR122Reader(reader, this.logger);\n\n\t\t\t\tthis.emit('reader', device);\n\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tconst device = new Reader(reader, this.logger);\n\n\t\t\tthis.emit('reader', device);\n\n\t\t});\n\n\t\tthis.pcsc.on('error', (err) => {\n\n\t\t\tthis.logger.error('PCSC error', err.message);\n\n\t\t\tthis.emit('error', err);\n\n\t\t});\n\n\t}\n\n\tget readers() {\n\t\treturn this.pcsc.readers;\n\t}\n\n\tclose() {\n\t\tthis.pcsc.close();\n\t}\n\n}\n\nexport default NFC;\n"
      ]
    },
    "sourceType": "script",
    "mtime": 1662229648499
  },
  "{\"sourceRoot\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc\",\"filename\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/Reader.js\",\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{}},{\"key\":\"proposal-class-properties\",\"visitor\":{\"PrivateName\":{\"enter\":[null]},\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{}}],\"presets\":[]}:7.12.17": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/",
      "caller": {
        "name": "@babel/register"
      },
      "cwd": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc",
      "filename": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/Reader.js",
      "cloneInputAst": true,
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {}
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {}
        },
        {
          "key": "proposal-class-properties",
          "visitor": {
            "PrivateName": {
              "enter": [
                null
              ]
            },
            "ExportDefaultDeclaration": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true,
            "ClassExpression": {
              "enter": [
                null
              ]
            },
            "ClassDeclaration": {
              "enter": [
                null
              ]
            }
          },
          "options": {}
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/Reader.js",
        "plugins": [
          "objectRestSpread",
          "classProperties",
          "classPrivateProperties"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/Reader.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/",
        "sourceFileName": "Reader.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = exports.CONNECT_MODE_CARD = exports.CONNECT_MODE_DIRECT = exports.KEY_TYPE_B = exports.KEY_TYPE_A = exports.TAG_ISO_14443_4 = exports.TAG_ISO_14443_3 = void 0;\n\nvar _events = _interopRequireDefault(require(\"events\"));\n\nvar _errors = require(\"./errors\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nconst TAG_ISO_14443_3 = 'TAG_ISO_14443_3'; // ISO/IEC 14443-3 tags\n\nexports.TAG_ISO_14443_3 = TAG_ISO_14443_3;\nconst TAG_ISO_14443_4 = 'TAG_ISO_14443_4'; // ISO/IEC 14443-4 tags\n\nexports.TAG_ISO_14443_4 = TAG_ISO_14443_4;\nconst KEY_TYPE_A = 0x60;\nexports.KEY_TYPE_A = KEY_TYPE_A;\nconst KEY_TYPE_B = 0x61;\nexports.KEY_TYPE_B = KEY_TYPE_B;\nconst CONNECT_MODE_DIRECT = 'CONNECT_MODE_DIRECT';\nexports.CONNECT_MODE_DIRECT = CONNECT_MODE_DIRECT;\nconst CONNECT_MODE_CARD = 'CONNECT_MODE_CARD';\nexports.CONNECT_MODE_CARD = CONNECT_MODE_CARD;\n\nclass Reader extends _events.default {\n  /**\n   * Reverses a copy of a given buffer\n   * Does NOT mutate the given buffer, returns a reversed COPY\n   * For mutating reverse use native .reverse() method on a buffer instance\n   * @param src {Buffer} a Buffer instance\n   * @returns {Buffer}\n   */\n  static reverseBuffer(src) {\n    const buffer = Buffer.allocUnsafe(src.length);\n\n    for (let i = 0, j = src.length - 1; i <= j; ++i, --j) {\n      buffer[i] = src[j];\n      buffer[j] = src[i];\n    }\n\n    return buffer;\n  }\n\n  static selectStandardByAtr(atr) {\n    // TODO: better detecting card types\n    if (atr[5] && atr[5] === 0x4f) {\n      return TAG_ISO_14443_3;\n    } else {\n      return TAG_ISO_14443_4;\n    }\n  }\n\n  get aid() {\n    return this._aid;\n  }\n\n  set aid(value) {\n    if (typeof value === 'function' || Buffer.isBuffer(value)) {\n      this._aid = value;\n      return;\n    }\n\n    if (typeof value !== 'string') {\n      throw new Error(`AID must be a HEX string or an instance of Buffer or a function.`);\n    }\n\n    this._aid = Buffer.from(value, 'hex');\n  }\n\n  get name() {\n    return this.reader.name;\n  }\n\n  constructor(reader, logger) {\n    super();\n\n    _defineProperty(this, \"reader\", null);\n\n    _defineProperty(this, \"logger\", null);\n\n    _defineProperty(this, \"connection\", null);\n\n    _defineProperty(this, \"card\", null);\n\n    _defineProperty(this, \"autoProcessing\", true);\n\n    _defineProperty(this, \"_aid\", null);\n\n    _defineProperty(this, \"keyStorage\", {\n      '0': null,\n      '1': null\n    });\n\n    _defineProperty(this, \"pendingLoadAuthenticationKey\", {});\n\n    this.reader = reader;\n\n    if (logger) {\n      this.logger = logger;\n    } else {\n      this.logger = {\n        log: function () {},\n        debug: function () {},\n        info: function () {},\n        warn: function () {},\n        error: function () {}\n      };\n    }\n\n    this.reader.on('error', err => {\n      this.logger.error(err);\n      this.emit('error', err);\n    });\n    this.reader.on('status', async status => {\n      this.logger.debug('status', status); // check what has changed\n\n      const changes = this.reader.state ^ status.state;\n      this.logger.debug('changes', changes);\n\n      if (changes) {\n        if (changes & this.reader.SCARD_STATE_EMPTY && status.state & this.reader.SCARD_STATE_EMPTY) {\n          this.logger.debug('card removed');\n\n          if (this.card) {\n            this.emit('card.off', { ...this.card\n            });\n          }\n\n          try {\n            this.card = null;\n\n            if (this.connection) {\n              await this.disconnect();\n            }\n          } catch (err) {\n            this.emit(err);\n          }\n        } else if (changes & this.reader.SCARD_STATE_PRESENT && status.state & this.reader.SCARD_STATE_PRESENT) {\n          const atr = status.atr;\n          this.logger.debug('card inserted', atr);\n          this.card = {};\n\n          if (atr) {\n            this.card.atr = atr;\n            this.card.standard = Reader.selectStandardByAtr(atr);\n            this.card.type = this.card.standard;\n          }\n\n          try {\n            await this.connect();\n\n            if (!this.autoProcessing) {\n              this.emit('card', { ...this.card\n              });\n              return;\n            }\n\n            this.handleTag();\n          } catch (err) {\n            this.emit(err);\n          }\n        }\n      }\n    });\n    this.reader.on('end', () => {\n      this.logger.debug('reader removed');\n      this.emit('end');\n    });\n  }\n\n  connect(mode = CONNECT_MODE_CARD) {\n    const modes = {\n      [CONNECT_MODE_DIRECT]: this.reader.SCARD_SHARE_DIRECT,\n      [CONNECT_MODE_CARD]: this.reader.SCARD_SHARE_SHARED\n    };\n\n    if (!modes[mode]) {\n      throw new _errors.ConnectError('invalid_mode', 'Invalid mode');\n    }\n\n    this.logger.debug('trying to connect', mode, modes[mode]);\n    return new Promise((resolve, reject) => {\n      // connect card\n      this.reader.connect({\n        share_mode: modes[mode] //protocol: this.reader.SCARD_PROTOCOL_UNDEFINED\n\n      }, (err, protocol) => {\n        if (err) {\n          const error = new _errors.ConnectError(_errors.FAILURE, 'An error occurred while connecting.', err);\n          this.logger.error(error);\n          return reject(error);\n        }\n\n        this.connection = {\n          type: modes[mode],\n          protocol: protocol\n        };\n        this.logger.debug('connected', this.connection);\n        return resolve(this.connection);\n      });\n    });\n  }\n\n  disconnect() {\n    if (!this.connection) {\n      throw new _errors.DisconnectError('not_connected', 'Reader in not connected. No need for disconnecting.');\n    }\n\n    this.logger.debug('trying to disconnect', this.connection);\n    return new Promise((resolve, reject) => {\n      // disconnect removed\n      this.reader.disconnect(this.reader.SCARD_LEAVE_CARD, err => {\n        if (err) {\n          const error = new _errors.DisconnectError(_errors.FAILURE, 'An error occurred while disconnecting.', err);\n          this.logger.error(error);\n          return reject(error);\n        }\n\n        this.connection = null;\n        this.logger.debug('disconnected');\n        return resolve(true);\n      });\n    });\n  }\n\n  transmit(data, responseMaxLength) {\n    if (!this.card || !this.connection) {\n      throw new _errors.TransmitError(_errors.CARD_NOT_CONNECTED, 'No card or connection available.');\n    }\n\n    return new Promise((resolve, reject) => {\n      this.logger.debug('transmitting', data, responseMaxLength);\n      this.reader.transmit(data, responseMaxLength, this.connection.protocol, (err, response) => {\n        if (err) {\n          const error = new _errors.TransmitError(_errors.FAILURE, 'An error occurred while transmitting.', err);\n          return reject(error);\n        }\n\n        this.logger.debug('transmit response received', response, response && response.length);\n        return resolve(response);\n      });\n    });\n  }\n\n  control(data, responseMaxLength) {\n    if (!this.connection) {\n      throw new _errors.ControlError('not_connected', 'No connection available.');\n    }\n\n    return new Promise((resolve, reject) => {\n      this.logger.debug('transmitting control', data, responseMaxLength);\n      this.reader.control(data, this.reader.IOCTL_CCID_ESCAPE, responseMaxLength, (err, response) => {\n        if (err) {\n          const error = new _errors.ControlError(_errors.FAILURE, 'An error occurred while transmitting control.', err);\n          return reject(error);\n        }\n\n        this.logger.debug('control response received', response, response && response.length);\n        return resolve(response);\n      });\n    });\n  }\n\n  async loadAuthenticationKey(keyNumber, key) {\n    if (!(keyNumber === 0 || keyNumber === 1)) {\n      throw new _errors.LoadAuthenticationKeyError('invalid_key_number');\n    }\n\n    if (!Buffer.isBuffer(key) && !Array.isArray(key)) {\n      if (typeof key !== 'string') {\n        throw new _errors.LoadAuthenticationKeyError('invalid_key', 'Key must an instance of Buffer or an array of bytes or a string.');\n      }\n\n      key = Buffer.from(key, 'hex');\n    }\n\n    if (key.length !== 6) {\n      throw new _errors.LoadAuthenticationKeyError('invalid_key', 'Key length must be 6 bytes.');\n    } // CMD: Load Authentication Keys\n\n\n    const packet = Buffer.from([0xff, // Class\n    0x82, // INS\n    0x00, // P1: Key Structure (0x00 = Key is loaded into the reader volatile memory.)\n    keyNumber, // P2: Key Number (00h ~ 01h = Key Location. The keys will disappear once the reader is disconnected from the PC)\n    key.length, // Lc: Length of the key (6)\n    ...key // Data In: Key (6 bytes)\n    ]);\n    let response = null;\n\n    try {\n      response = await this.transmit(packet, 2);\n    } catch (err) {\n      throw new _errors.LoadAuthenticationKeyError(null, null, err);\n    }\n\n    const statusCode = response.readUInt16BE(0);\n\n    if (statusCode !== 0x9000) {\n      throw new _errors.LoadAuthenticationKeyError(_errors.OPERATION_FAILED, `Load authentication key operation failed: Status code: ${statusCode}`);\n    }\n\n    this.keyStorage[keyNumber] = key;\n    return keyNumber;\n  } // for PC/SC V2.01 use obsolete = true\n  // for PC/SC V2.07 use obsolete = false [default]\n\n\n  async authenticate(blockNumber, keyType, key, obsolete = false) {\n    let keyNumber = Object.keys(this.keyStorage).find(n => this.keyStorage[n] === key); // key is not in the storage\n\n    if (!keyNumber) {\n      // If there isn't already an authentication process happening for this key, start it\n      if (!this.pendingLoadAuthenticationKey[key]) {\n        // set key number to first\n        keyNumber = Object.keys(this.keyStorage)[0]; // if this number is not free\n\n        if (this.keyStorage[keyNumber] !== null) {\n          // try to find any free number\n          const freeNumber = Object.keys(this.keyStorage).find(n => this.keyStorage[n] === null); // if we find, we use it, otherwise the first will be used and rewritten\n\n          if (freeNumber) {\n            keyNumber = freeNumber;\n          }\n        } // Store the authentication promise in case other blocks are in process of authentication\n\n\n        this.pendingLoadAuthenticationKey[key] = this.loadAuthenticationKey(parseInt(keyNumber), key);\n      }\n\n      try {\n        keyNumber = await this.pendingLoadAuthenticationKey[key];\n      } catch (err) {\n        throw new _errors.AuthenticationError('unable_to_load_key', 'Could not load authentication key into reader.', err);\n      } finally {\n        // remove the loadAuthenticationKey Promise from pendingLoadAuthenticationKey\n        // as it is already resolved or rejected at this point\n        delete this.pendingLoadAuthenticationKey[key];\n      }\n    }\n\n    const packet = !obsolete ? // CMD: Authentication\n    Buffer.from([0xff, // Class\n    0x86, // INS\n    0x00, // P1\n    0x00, // P2\n    0x05, // Lc\n    // Data In: Authenticate Data Bytes (5 bytes)\n    0x01, // Byte 1: Version\n    0x00, // Byte 2\n    blockNumber, // Byte 3: Block Number\n    keyType, // Byte 4: Key Type\n    keyNumber // Byte 5: Key Number\n    ]) : // CMD: Authentication (obsolete)\n    Buffer.from([0xff, // Class\n    0x88, // INS\n    0x00, // P1\n    blockNumber, // P2: Block Number\n    keyType, // P3: Key Type\n    keyNumber // Data In: Key Number\n    ]);\n    let response = null;\n\n    try {\n      response = await this.transmit(packet, 2);\n    } catch (err) {\n      throw new _errors.AuthenticationError(null, null, err);\n    }\n\n    const statusCode = response.readUInt16BE(0);\n\n    if (statusCode !== 0x9000) {\n      this.logger.error('[authentication operation failed][request packet]', packet);\n      throw new _errors.AuthenticationError(_errors.OPERATION_FAILED, `Authentication operation failed: Status code: 0x${statusCode.toString(16)}`);\n    }\n\n    return true;\n  }\n\n  async read(blockNumber, length, blockSize = 4, packetSize = 16, readClass = 0xff) {\n    if (!this.card) {\n      throw new _errors.ReadError(_errors.CARD_NOT_CONNECTED);\n    }\n\n    this.logger.debug('reading data from card', this.card);\n\n    if (length > packetSize) {\n      const p = Math.ceil(length / packetSize);\n      const commands = [];\n\n      for (let i = 0; i < p; i++) {\n        const block = blockNumber + i * packetSize / blockSize;\n        const size = (i + 1) * packetSize < length ? packetSize : length - i * packetSize; // console.log(i, block, size);\n\n        commands.push(this.read(block, size, blockSize, packetSize, readClass));\n      }\n\n      return Promise.all(commands).then(values => {\n        // console.log(values);\n        return Buffer.concat(values, length);\n      });\n    } // APDU CMD: Read Binary Blocks\n\n\n    const packet = Buffer.from([readClass, // Class\n    0xb0, // Ins\n    blockNumber >> 8 & 0xFF, // P1\n    blockNumber & 0xFF, // P2: Block Number\n    length // Le: Number of Bytes to Read (Maximum 16 bytes)\n    ]);\n    let response = null;\n\n    try {\n      response = await this.transmit(packet, length + 2);\n    } catch (err) {\n      throw new _errors.ReadError(null, null, err);\n    }\n\n    if (response.length < 2) {\n      throw new _errors.ReadError(_errors.OPERATION_FAILED, `Read operation failed: Invalid response length ${response.length}. Expected minimal length is 2 bytes.`);\n    }\n\n    const statusCode = response.slice(-2).readUInt16BE(0);\n\n    if (statusCode !== 0x9000) {\n      throw new _errors.ReadError(_errors.OPERATION_FAILED, `Read operation failed: Status code: 0x${statusCode.toString(16)}`);\n    }\n\n    const data = response.slice(0, -2);\n    this.logger.debug('data', data);\n    return data;\n  }\n\n  async write(blockNumber, data, blockSize = 4) {\n    if (!this.card) {\n      throw new _errors.WriteError(_errors.CARD_NOT_CONNECTED);\n    }\n\n    this.logger.debug('writing data to card', this.card);\n\n    if (data.length < blockSize || data.length % blockSize !== 0) {\n      throw new _errors.WriteError('invalid_data_length', 'Invalid data length. You can only update the entire data block(s).');\n    }\n\n    if (data.length > blockSize) {\n      const p = data.length / blockSize;\n      const commands = [];\n\n      for (let i = 0; i < p; i++) {\n        const block = blockNumber + i;\n        const start = i * blockSize;\n        const end = (i + 1) * blockSize;\n        const part = data.slice(start, end); // console.log(i, block, start, end, part);\n\n        commands.push(this.write(block, part, blockSize));\n      }\n\n      return Promise.all(commands).then(values => {\n        // console.log(values);\n        return values;\n      });\n    } // APDU CMD: Update Binary Block\n\n\n    const packetHeader = Buffer.from([0xff, // Class\n    0xd6, // Ins\n    0x00, // P1\n    blockNumber, // P2: Block Number\n    blockSize // Le: Number of Bytes to Update\n    ]);\n    const packet = Buffer.concat([packetHeader, data]);\n    let response = null;\n\n    try {\n      response = await this.transmit(packet, 2);\n    } catch (err) {\n      throw new _errors.WriteError(null, null, err);\n    }\n\n    if (response.length < 2) {\n      throw new _errors.WriteError(_errors.OPERATION_FAILED, `Write operation failed: Invalid response length ${response.length}. Expected minimal length is 2 bytes.`);\n    }\n\n    const statusCode = response.slice(-2).readUInt16BE(0);\n\n    if (statusCode !== 0x9000) {\n      throw new _errors.WriteError(_errors.OPERATION_FAILED, `Write operation failed: Status code: 0x${statusCode.toString(16)}`);\n    }\n\n    return true;\n  }\n\n  handleTag() {\n    if (!this.card) {\n      return false;\n    }\n\n    this.logger.debug('handling tag', this.card);\n\n    switch (this.card.standard) {\n      case TAG_ISO_14443_3:\n        return this.handle_Iso_14443_3_Tag();\n\n      case TAG_ISO_14443_4:\n        return this.handle_Iso_14443_4_Tag();\n\n      default:\n        return this.handle_Iso_14443_3_Tag();\n    }\n  } // TODO: improve error handling and debugging\n\n\n  async handle_Iso_14443_3_Tag() {\n    if (!this.card || !this.connection) {\n      return false;\n    }\n\n    this.logger.debug('processing ISO 14443-3 tag', this.card); // APDU CMD: Get Data\n\n    const packet = Buffer.from([0xff, // Class\n    0xca, // INS\n    0x00, // P1: Get current card UID\n    0x00, // P2\n    0x00 // Le: Full Length of UID\n    ]);\n\n    try {\n      const response = await this.transmit(packet, 12);\n\n      if (response.length < 2) {\n        const error = new _errors.GetUIDError('invalid_response', `Invalid response length ${response.length}. Expected minimal length is 2 bytes.`);\n        this.emit('error', error);\n        return;\n      } // last 2 bytes are the status code\n\n\n      const statusCode = response.slice(-2).readUInt16BE(0); // an error occurred\n\n      if (statusCode !== 0x9000) {\n        const error = new _errors.GetUIDError(_errors.OPERATION_FAILED, 'Could not get card UID.');\n        this.emit('error', error);\n        return;\n      } // strip out the status code (the rest is UID)\n\n\n      const uid = response.slice(0, -2).toString('hex'); // const uidReverse = Reader.reverseBuffer(response.slice(0, -2)).toString('hex');\n\n      this.card.uid = uid;\n      this.emit('card', { ...this.card\n      });\n    } catch (err) {\n      const error = new _errors.GetUIDError(null, null, err);\n      this.emit('error', error);\n    }\n  } // TODO: improve error handling and debugging\n\n\n  async handle_Iso_14443_4_Tag() {\n    if (!this.card || !this.connection) {\n      return false;\n    }\n\n    this.logger.debug('processing ISO 14443-4 tag', this.card);\n\n    if (!this.aid) {\n      this.emit('error', new Error('Cannot process ISO 14443-4 tag because AID was not set.'));\n      return;\n    }\n\n    const aid = typeof this.aid === 'function' ? this.aid(this.card) : this.aid;\n\n    if (!Buffer.isBuffer(aid)) {\n      this.emit('error', new Error('AID must be an instance of Buffer.'));\n      return;\n    } // APDU CMD: SELECT FILE\n    // see http://cardwerk.com/smart-card-standard-iso7816-4-section-6-basic-interindustry-commands/#chap6_11_3\n\n\n    const packet = Buffer.from([0x00, // Class\n    0xa4, // INS\n    0x04, // P1\n    0x00, // P2\n    aid.length, // Lc\n    ...aid, // AID\n    0x00 // Le\n    ]);\n\n    try {\n      const response = await this.transmit(packet, 40);\n\n      if (response.length === 2 && response.readUInt16BE(0) === 0x6a82) {\n        const err = new Error(`Not found response. Tag not compatible with AID ${aid.toString('hex').toUpperCase()}.`);\n        this.emit('error', err);\n        return;\n      }\n\n      if (response.length < 2) {\n        const err = new Error(`Invalid response length ${response.length}. Expected minimal length is 2 bytes.`);\n        this.emit('error', err);\n        return;\n      } // another possibility const statusCode = parseInt(response.slice(-2).toString('hex'), 16)\n\n\n      const statusCode = response.slice(-2).readUInt16BE(0); // an error occurred\n\n      if (statusCode !== 0x9000) {\n        const err = new Error(`Response status error.`);\n        this.emit('error', err);\n        return;\n      } // strip out the status code\n\n\n      const data = response.slice(0, -2);\n      this.logger.debug('Data cropped', data);\n      this.emit('card', { ...this.card,\n        data: data\n      });\n    } catch (err) {\n      const error = new _errors.GetUIDError(null, null, err);\n      this.emit('error', error);\n    }\n  }\n\n  close() {\n    this.reader.close();\n  }\n\n  toString() {\n    return this.name;\n  }\n\n}\n\nvar _default = Reader;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlJlYWRlci5qcyJdLCJuYW1lcyI6WyJUQUdfSVNPXzE0NDQzXzMiLCJUQUdfSVNPXzE0NDQzXzQiLCJLRVlfVFlQRV9BIiwiS0VZX1RZUEVfQiIsIkNPTk5FQ1RfTU9ERV9ESVJFQ1QiLCJDT05ORUNUX01PREVfQ0FSRCIsIlJlYWRlciIsIkV2ZW50RW1pdHRlciIsInJldmVyc2VCdWZmZXIiLCJzcmMiLCJidWZmZXIiLCJCdWZmZXIiLCJhbGxvY1Vuc2FmZSIsImxlbmd0aCIsImkiLCJqIiwic2VsZWN0U3RhbmRhcmRCeUF0ciIsImF0ciIsImFpZCIsIl9haWQiLCJ2YWx1ZSIsImlzQnVmZmVyIiwiRXJyb3IiLCJmcm9tIiwibmFtZSIsInJlYWRlciIsImNvbnN0cnVjdG9yIiwibG9nZ2VyIiwibG9nIiwiZGVidWciLCJpbmZvIiwid2FybiIsImVycm9yIiwib24iLCJlcnIiLCJlbWl0Iiwic3RhdHVzIiwiY2hhbmdlcyIsInN0YXRlIiwiU0NBUkRfU1RBVEVfRU1QVFkiLCJjYXJkIiwiY29ubmVjdGlvbiIsImRpc2Nvbm5lY3QiLCJTQ0FSRF9TVEFURV9QUkVTRU5UIiwic3RhbmRhcmQiLCJ0eXBlIiwiY29ubmVjdCIsImF1dG9Qcm9jZXNzaW5nIiwiaGFuZGxlVGFnIiwibW9kZSIsIm1vZGVzIiwiU0NBUkRfU0hBUkVfRElSRUNUIiwiU0NBUkRfU0hBUkVfU0hBUkVEIiwiQ29ubmVjdEVycm9yIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJzaGFyZV9tb2RlIiwicHJvdG9jb2wiLCJGQUlMVVJFIiwiRGlzY29ubmVjdEVycm9yIiwiU0NBUkRfTEVBVkVfQ0FSRCIsInRyYW5zbWl0IiwiZGF0YSIsInJlc3BvbnNlTWF4TGVuZ3RoIiwiVHJhbnNtaXRFcnJvciIsIkNBUkRfTk9UX0NPTk5FQ1RFRCIsInJlc3BvbnNlIiwiY29udHJvbCIsIkNvbnRyb2xFcnJvciIsIklPQ1RMX0NDSURfRVNDQVBFIiwibG9hZEF1dGhlbnRpY2F0aW9uS2V5Iiwia2V5TnVtYmVyIiwia2V5IiwiTG9hZEF1dGhlbnRpY2F0aW9uS2V5RXJyb3IiLCJBcnJheSIsImlzQXJyYXkiLCJwYWNrZXQiLCJzdGF0dXNDb2RlIiwicmVhZFVJbnQxNkJFIiwiT1BFUkFUSU9OX0ZBSUxFRCIsImtleVN0b3JhZ2UiLCJhdXRoZW50aWNhdGUiLCJibG9ja051bWJlciIsImtleVR5cGUiLCJvYnNvbGV0ZSIsIk9iamVjdCIsImtleXMiLCJmaW5kIiwibiIsInBlbmRpbmdMb2FkQXV0aGVudGljYXRpb25LZXkiLCJmcmVlTnVtYmVyIiwicGFyc2VJbnQiLCJBdXRoZW50aWNhdGlvbkVycm9yIiwidG9TdHJpbmciLCJyZWFkIiwiYmxvY2tTaXplIiwicGFja2V0U2l6ZSIsInJlYWRDbGFzcyIsIlJlYWRFcnJvciIsInAiLCJNYXRoIiwiY2VpbCIsImNvbW1hbmRzIiwiYmxvY2siLCJzaXplIiwicHVzaCIsImFsbCIsInRoZW4iLCJ2YWx1ZXMiLCJjb25jYXQiLCJzbGljZSIsIndyaXRlIiwiV3JpdGVFcnJvciIsInN0YXJ0IiwiZW5kIiwicGFydCIsInBhY2tldEhlYWRlciIsImhhbmRsZV9Jc29fMTQ0NDNfM19UYWciLCJoYW5kbGVfSXNvXzE0NDQzXzRfVGFnIiwiR2V0VUlERXJyb3IiLCJ1aWQiLCJ0b1VwcGVyQ2FzZSIsImNsb3NlIl0sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7OztBQUVBOztBQUNBOzs7Ozs7QUFpQk8sTUFBTUEsZUFBZSxHQUFHLGlCQUF4QixDLENBQTJDOzs7QUFDM0MsTUFBTUMsZUFBZSxHQUFHLGlCQUF4QixDLENBQTJDOzs7QUFFM0MsTUFBTUMsVUFBVSxHQUFHLElBQW5COztBQUNBLE1BQU1DLFVBQVUsR0FBRyxJQUFuQjs7QUFFQSxNQUFNQyxtQkFBbUIsR0FBRyxxQkFBNUI7O0FBQ0EsTUFBTUMsaUJBQWlCLEdBQUcsbUJBQTFCOzs7QUFHUCxNQUFNQyxNQUFOLFNBQXFCQyxlQUFyQixDQUFrQztBQWtCakM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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QUFZRSxLQUFaLENBQWtCLGNBQWxCLEVBQWtDa0MsSUFBbEM7QUFFQSxXQUFLNUIsSUFBTCxDQUFVLE1BQVYsRUFBa0IsRUFDakIsR0FBRyxLQUFLSyxJQURTO0FBRWpCdUIsUUFBQUEsSUFBSSxFQUFFQTtBQUZXLE9BQWxCO0FBS0EsS0ExQ0QsQ0EwQ0UsT0FBTzdCLEdBQVAsRUFBWTtBQUViLFlBQU1GLEtBQUssR0FBRyxJQUFJd0YsbUJBQUosQ0FBZ0IsSUFBaEIsRUFBc0IsSUFBdEIsRUFBNEJ0RixHQUE1QixDQUFkO0FBRUEsV0FBS0MsSUFBTCxDQUFVLE9BQVYsRUFBbUJILEtBQW5CO0FBRUE7QUFFRDs7QUFFRDJGLEVBQUFBLEtBQUssR0FBRztBQUNQLFNBQUtsRyxNQUFMLENBQVlrRyxLQUFaO0FBQ0E7O0FBRUQ3QixFQUFBQSxRQUFRLEdBQUc7QUFDVixXQUFPLEtBQUt0RSxJQUFaO0FBQ0E7O0FBcHhCZ0M7O2VBd3hCbkJsQixNIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9oYXJyeWhvdy9Eb2N1bWVudHMvMjAyMi9QUk9KRUNUX01PQ0FfQVJUL05GQy9uZmMtcGNzYy9zcmMvIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbmltcG9ydCBFdmVudEVtaXR0ZXIgZnJvbSAnZXZlbnRzJztcbmltcG9ydCB7XG5cdENvbm5lY3RFcnJvcixcblx0RGlzY29ubmVjdEVycm9yLFxuXHRUcmFuc21pdEVycm9yLFxuXHRDb250cm9sRXJyb3IsXG5cdEF1dGhlbnRpY2F0aW9uRXJyb3IsXG5cdExvYWRBdXRoZW50aWNhdGlvbktleUVycm9yLFxuXHRSZWFkRXJyb3IsXG5cdFdyaXRlRXJyb3IsXG5cdEdldFVJREVycm9yLFxuXHRDQVJEX05PVF9DT05ORUNURUQsXG5cdE9QRVJBVElPTl9GQUlMRUQsXG5cdFVOS05PV05fRVJST1IsXG5cdEZBSUxVUkUsXG59IGZyb20gJy4vZXJyb3JzJztcblxuXG5leHBvcnQgY29uc3QgVEFHX0lTT18xNDQ0M18zID0gJ1RBR19JU09fMTQ0NDNfMyc7IC8vIElTTy9JRUMgMTQ0NDMtMyB0YWdzXG5leHBvcnQgY29uc3QgVEFHX0lTT18xNDQ0M180ID0gJ1RBR19JU09fMTQ0NDNfNCc7IC8vIElTTy9JRUMgMTQ0NDMtNCB0YWdzXG5cbmV4cG9ydCBjb25zdCBLRVlfVFlQRV9BID0gMHg2MDtcbmV4cG9ydCBjb25zdCBLRVlfVFlQRV9CID0gMHg2MTtcblxuZXhwb3J0IGNvbnN0IENPTk5FQ1RfTU9ERV9ESVJFQ1QgPSAnQ09OTkVDVF9NT0RFX0RJUkVDVCc7XG5leHBvcnQgY29uc3QgQ09OTkVDVF9NT0RFX0NBUkQgPSAnQ09OTkVDVF9NT0RFX0NBUkQnO1xuXG5cbmNsYXNzIFJlYWRlciBleHRlbmRzIEV2ZW50RW1pdHRlciB7XG5cblx0cmVhZGVyID0gbnVsbDtcblx0bG9nZ2VyID0gbnVsbDtcblxuXHRjb25uZWN0aW9uID0gbnVsbDtcblx0Y2FyZCA9IG51bGw7XG5cblx0YXV0b1Byb2Nlc3NpbmcgPSB0cnVlO1xuXHRfYWlkID0gbnVsbDtcblxuXHRrZXlTdG9yYWdlID0ge1xuXHRcdCcwJzogbnVsbCxcblx0XHQnMSc6IG51bGwsXG5cdH07XG5cblx0cGVuZGluZ0xvYWRBdXRoZW50aWNhdGlvbktleSA9IHt9O1xuXG5cdC8qKlxuXHQgKiBSZXZlcnNlcyBhIGNvcHkgb2YgYSBnaXZlbiBidWZmZXJcblx0ICogRG9lcyBOT1QgbXV0YXRlIHRoZSBnaXZlbiBidWZmZXIsIHJldHVybnMgYSByZXZlcnNlZCBDT1BZXG5cdCAqIEZvciBtdXRhdGluZyByZXZlcnNlIHVzZSBuYXRpdmUgLnJldmVyc2UoKSBtZXRob2Qgb24gYSBidWZmZXIgaW5zdGFuY2Vcblx0ICogQHBhcmFtIHNyYyB7QnVmZmVyfSBhIEJ1ZmZlciBpbnN0YW5jZVxuXHQgKiBAcmV0dXJucyB7QnVmZmVyfVxuXHQgKi9cblx0c3RhdGljIHJldmVyc2VCdWZmZXIoc3JjKSB7XG5cblx0XHRjb25zdCBidWZmZXIgPSBCdWZmZXIuYWxsb2NVbnNhZmUoc3JjLmxlbmd0aCk7XG5cblx0XHRmb3IgKGxldCBpID0gMCwgaiA9IHNyYy5sZW5ndGggLSAxOyBpIDw9IGo7ICsraSwgLS1qKSB7XG5cdFx0XHRidWZmZXJbaV0gPSBzcmNbal07XG5cdFx0XHRidWZmZXJbal0gPSBzcmNbaV07XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGJ1ZmZlcjtcblxuXHR9XG5cblx0c3RhdGljIHNlbGVjdFN0YW5kYXJkQnlBdHIoYXRyKSB7XG5cblx0XHQvLyBUT0RPOiBiZXR0ZXIgZGV0ZWN0aW5nIGNhcmQgdHlwZXNcblx0XHRpZiAoYXRyWzVdICYmIGF0cls1XSA9PT0gMHg0Zikge1xuXHRcdFx0cmV0dXJuIFRBR19JU09fMTQ0NDNfMztcblx0XHR9XG5cdFx0ZWxzZSB7XG5cdFx0XHRyZXR1cm4gVEFHX0lTT18xNDQ0M180O1xuXHRcdH1cblxuXHR9XG5cblx0Z2V0IGFpZCgpIHtcblx0XHRyZXR1cm4gdGhpcy5fYWlkO1xuXHR9XG5cblx0c2V0IGFpZCh2YWx1ZSkge1xuXG5cdFx0aWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ2Z1bmN0aW9uJyB8fCBCdWZmZXIuaXNCdWZmZXIodmFsdWUpKSB7XG5cdFx0XHR0aGlzLl9haWQgPSB2YWx1ZTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRpZiAodHlwZW9mIHZhbHVlICE9PSAnc3RyaW5nJykge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBBSUQgbXVzdCBiZSBhIEhFWCBzdHJpbmcgb3IgYW4gaW5zdGFuY2Ugb2YgQnVmZmVyIG9yIGEgZnVuY3Rpb24uYCk7XG5cdFx0fVxuXG5cdFx0dGhpcy5fYWlkID0gQnVmZmVyLmZyb20odmFsdWUsICdoZXgnKTtcblxuXHR9XG5cblx0Z2V0IG5hbWUoKSB7XG5cdFx0cmV0dXJuIHRoaXMucmVhZGVyLm5hbWU7XG5cdH1cblxuXHRjb25zdHJ1Y3RvcihyZWFkZXIsIGxvZ2dlcikge1xuXG5cdFx0c3VwZXIoKTtcblxuXHRcdHRoaXMucmVhZGVyID0gcmVhZGVyO1xuXG5cdFx0aWYgKGxvZ2dlcikge1xuXHRcdFx0dGhpcy5sb2dnZXIgPSBsb2dnZXI7XG5cdFx0fVxuXHRcdGVsc2Uge1xuXHRcdFx0dGhpcy5sb2dnZXIgPSB7XG5cdFx0XHRcdGxvZzogZnVuY3Rpb24gKCkge1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRkZWJ1ZzogZnVuY3Rpb24gKCkge1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRpbmZvOiBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdH0sXG5cdFx0XHRcdHdhcm46IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0fSxcblx0XHRcdFx0ZXJyb3I6IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0fSxcblx0XHRcdH07XG5cdFx0fVxuXG5cdFx0dGhpcy5yZWFkZXIub24oJ2Vycm9yJywgKGVycikgPT4ge1xuXG5cdFx0XHR0aGlzLmxvZ2dlci5lcnJvcihlcnIpO1xuXG5cdFx0XHR0aGlzLmVtaXQoJ2Vycm9yJywgZXJyKTtcblxuXHRcdH0pO1xuXG5cdFx0dGhpcy5yZWFkZXIub24oJ3N0YXR1cycsIGFzeW5jIHN0YXR1cyA9PiB7XG5cblx0XHRcdHRoaXMubG9nZ2VyLmRlYnVnKCdzdGF0dXMnLCBzdGF0dXMpO1xuXG5cdFx0XHQvLyBjaGVjayB3aGF0IGhhcyBjaGFuZ2VkXG5cdFx0XHRjb25zdCBjaGFuZ2VzID0gdGhpcy5yZWFkZXIuc3RhdGUgXiBzdGF0dXMuc3RhdGU7XG5cblx0XHRcdHRoaXMubG9nZ2VyLmRlYnVnKCdjaGFuZ2VzJywgY2hhbmdlcyk7XG5cblx0XHRcdGlmIChjaGFuZ2VzKSB7XG5cblx0XHRcdFx0aWYgKChjaGFuZ2VzICYgdGhpcy5yZWFkZXIuU0NBUkRfU1RBVEVfRU1QVFkpICYmIChzdGF0dXMuc3RhdGUgJiB0aGlzLnJlYWRlci5TQ0FSRF9TVEFURV9FTVBUWSkpIHtcblxuXHRcdFx0XHRcdHRoaXMubG9nZ2VyLmRlYnVnKCdjYXJkIHJlbW92ZWQnKTtcblxuXHRcdFx0XHRcdGlmICh0aGlzLmNhcmQpIHtcblx0XHRcdFx0XHRcdHRoaXMuZW1pdCgnY2FyZC5vZmYnLCB7IC4uLnRoaXMuY2FyZCB9KTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHR0cnkge1xuXG5cdFx0XHRcdFx0XHR0aGlzLmNhcmQgPSBudWxsO1xuXHRcdFx0XHRcdFx0aWYgKHRoaXMuY29ubmVjdGlvbikge1xuXHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLmRpc2Nvbm5lY3QoKTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdH0gY2F0Y2ggKGVycikge1xuXG5cdFx0XHRcdFx0XHR0aGlzLmVtaXQoZXJyKTtcblxuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHR9XG5cdFx0XHRcdGVsc2UgaWYgKChjaGFuZ2VzICYgdGhpcy5yZWFkZXIuU0NBUkRfU1RBVEVfUFJFU0VOVCkgJiYgKHN0YXR1cy5zdGF0ZSAmIHRoaXMucmVhZGVyLlNDQVJEX1NUQVRFX1BSRVNFTlQpKSB7XG5cblx0XHRcdFx0XHRjb25zdCBhdHIgPSBzdGF0dXMuYXRyO1xuXG5cdFx0XHRcdFx0dGhpcy5sb2dnZXIuZGVidWcoJ2NhcmQgaW5zZXJ0ZWQnLCBhdHIpO1xuXG5cdFx0XHRcdFx0dGhpcy5jYXJkID0ge307XG5cblx0XHRcdFx0XHRpZiAoYXRyKSB7XG5cdFx0XHRcdFx0XHR0aGlzLmNhcmQuYXRyID0gYXRyO1xuXHRcdFx0XHRcdFx0dGhpcy5jYXJkLnN0YW5kYXJkID0gUmVhZGVyLnNlbGVjdFN0YW5kYXJkQnlBdHIoYXRyKTtcblx0XHRcdFx0XHRcdHRoaXMuY2FyZC50eXBlID0gdGhpcy5jYXJkLnN0YW5kYXJkO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHRyeSB7XG5cblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMuY29ubmVjdCgpO1xuXG5cdFx0XHRcdFx0XHRpZiAoIXRoaXMuYXV0b1Byb2Nlc3NpbmcpIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5lbWl0KCdjYXJkJywgeyAuLi50aGlzLmNhcmQgfSk7XG5cdFx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0dGhpcy5oYW5kbGVUYWcoKTtcblxuXHRcdFx0XHRcdH0gY2F0Y2ggKGVycikge1xuXG5cdFx0XHRcdFx0XHR0aGlzLmVtaXQoZXJyKTtcblxuXHRcdFx0XHRcdH1cblxuXG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHRoaXMucmVhZGVyLm9uKCdlbmQnLCAoKSA9PiB7XG5cblx0XHRcdHRoaXMubG9nZ2VyLmRlYnVnKCdyZWFkZXIgcmVtb3ZlZCcpO1xuXG5cdFx0XHR0aGlzLmVtaXQoJ2VuZCcpO1xuXG5cdFx0fSk7XG5cblx0fVxuXG5cdGNvbm5lY3QobW9kZSA9IENPTk5FQ1RfTU9ERV9DQVJEKSB7XG5cblx0XHRjb25zdCBtb2RlcyA9IHtcblx0XHRcdFtDT05ORUNUX01PREVfRElSRUNUXTogdGhpcy5yZWFkZXIuU0NBUkRfU0hBUkVfRElSRUNULFxuXHRcdFx0W0NPTk5FQ1RfTU9ERV9DQVJEXTogdGhpcy5yZWFkZXIuU0NBUkRfU0hBUkVfU0hBUkVELFxuXHRcdH07XG5cblx0XHRpZiAoIW1vZGVzW21vZGVdKSB7XG5cdFx0XHR0aHJvdyBuZXcgQ29ubmVjdEVycm9yKCdpbnZhbGlkX21vZGUnLCAnSW52YWxpZCBtb2RlJylcblx0XHR9XG5cblx0XHR0aGlzLmxvZ2dlci5kZWJ1ZygndHJ5aW5nIHRvIGNvbm5lY3QnLCBtb2RlLCBtb2Rlc1ttb2RlXSk7XG5cblx0XHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuXG5cdFx0XHQvLyBjb25uZWN0IGNhcmRcblx0XHRcdHRoaXMucmVhZGVyLmNvbm5lY3Qoe1xuXHRcdFx0XHRzaGFyZV9tb2RlOiBtb2Rlc1ttb2RlXSxcblx0XHRcdFx0Ly9wcm90b2NvbDogdGhpcy5yZWFkZXIuU0NBUkRfUFJPVE9DT0xfVU5ERUZJTkVEXG5cdFx0XHR9LCAoZXJyLCBwcm90b2NvbCkgPT4ge1xuXG5cdFx0XHRcdGlmIChlcnIpIHtcblx0XHRcdFx0XHRjb25zdCBlcnJvciA9IG5ldyBDb25uZWN0RXJyb3IoRkFJTFVSRSwgJ0FuIGVycm9yIG9jY3VycmVkIHdoaWxlIGNvbm5lY3RpbmcuJywgZXJyKTtcblx0XHRcdFx0XHR0aGlzLmxvZ2dlci5lcnJvcihlcnJvcik7XG5cdFx0XHRcdFx0cmV0dXJuIHJlamVjdChlcnJvcik7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR0aGlzLmNvbm5lY3Rpb24gPSB7XG5cdFx0XHRcdFx0dHlwZTogbW9kZXNbbW9kZV0sXG5cdFx0XHRcdFx0cHJvdG9jb2w6IHByb3RvY29sLFxuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdHRoaXMubG9nZ2VyLmRlYnVnKCdjb25uZWN0ZWQnLCB0aGlzLmNvbm5lY3Rpb24pO1xuXG5cdFx0XHRcdHJldHVybiByZXNvbHZlKHRoaXMuY29ubmVjdGlvbik7XG5cblx0XHRcdH0pO1xuXG5cdFx0fSk7XG5cblx0fVxuXG5cdGRpc2Nvbm5lY3QoKSB7XG5cblx0XHRpZiAoIXRoaXMuY29ubmVjdGlvbikge1xuXHRcdFx0dGhyb3cgbmV3IERpc2Nvbm5lY3RFcnJvcignbm90X2Nvbm5lY3RlZCcsICdSZWFkZXIgaW4gbm90IGNvbm5lY3RlZC4gTm8gbmVlZCBmb3IgZGlzY29ubmVjdGluZy4nKVxuXHRcdH1cblxuXHRcdHRoaXMubG9nZ2VyLmRlYnVnKCd0cnlpbmcgdG8gZGlzY29ubmVjdCcsIHRoaXMuY29ubmVjdGlvbik7XG5cblx0XHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuXG5cdFx0XHQvLyBkaXNjb25uZWN0IHJlbW92ZWRcblx0XHRcdHRoaXMucmVhZGVyLmRpc2Nvbm5lY3QodGhpcy5yZWFkZXIuU0NBUkRfTEVBVkVfQ0FSRCwgKGVycikgPT4ge1xuXG5cdFx0XHRcdGlmIChlcnIpIHtcblx0XHRcdFx0XHRjb25zdCBlcnJvciA9IG5ldyBEaXNjb25uZWN0RXJyb3IoRkFJTFVSRSwgJ0FuIGVycm9yIG9jY3VycmVkIHdoaWxlIGRpc2Nvbm5lY3RpbmcuJywgZXJyKTtcblx0XHRcdFx0XHR0aGlzLmxvZ2dlci5lcnJvcihlcnJvcik7XG5cdFx0XHRcdFx0cmV0dXJuIHJlamVjdChlcnJvcik7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR0aGlzLmNvbm5lY3Rpb24gPSBudWxsO1xuXG5cdFx0XHRcdHRoaXMubG9nZ2VyLmRlYnVnKCdkaXNjb25uZWN0ZWQnKTtcblxuXHRcdFx0XHRyZXR1cm4gcmVzb2x2ZSh0cnVlKTtcblxuXHRcdFx0fSk7XG5cblx0XHR9KTtcblxuXHR9XG5cblx0dHJhbnNtaXQoZGF0YSwgcmVzcG9uc2VNYXhMZW5ndGgpIHtcblxuXHRcdGlmICghdGhpcy5jYXJkIHx8ICF0aGlzLmNvbm5lY3Rpb24pIHtcblx0XHRcdHRocm93IG5ldyBUcmFuc21pdEVycm9yKENBUkRfTk9UX0NPTk5FQ1RFRCwgJ05vIGNhcmQgb3IgY29ubmVjdGlvbiBhdmFpbGFibGUuJyk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcblxuXHRcdFx0dGhpcy5sb2dnZXIuZGVidWcoJ3RyYW5zbWl0dGluZycsIGRhdGEsIHJlc3BvbnNlTWF4TGVuZ3RoKTtcblxuXHRcdFx0dGhpcy5yZWFkZXIudHJhbnNtaXQoZGF0YSwgcmVzcG9uc2VNYXhMZW5ndGgsIHRoaXMuY29ubmVjdGlvbi5wcm90b2NvbCwgKGVyciwgcmVzcG9uc2UpID0+IHtcblxuXHRcdFx0XHRpZiAoZXJyKSB7XG5cdFx0XHRcdFx0Y29uc3QgZXJyb3IgPSBuZXcgVHJhbnNtaXRFcnJvcihGQUlMVVJFLCAnQW4gZXJyb3Igb2NjdXJyZWQgd2hpbGUgdHJhbnNtaXR0aW5nLicsIGVycik7XG5cdFx0XHRcdFx0cmV0dXJuIHJlamVjdChlcnJvcik7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR0aGlzLmxvZ2dlci5kZWJ1ZygndHJhbnNtaXQgcmVzcG9uc2UgcmVjZWl2ZWQnLCByZXNwb25zZSwgcmVzcG9uc2UgJiYgcmVzcG9uc2UubGVuZ3RoKTtcblxuXHRcdFx0XHRyZXR1cm4gcmVzb2x2ZShyZXNwb25zZSk7XG5cblx0XHRcdH0pO1xuXG5cdFx0fSk7XG5cblx0fVxuXG5cdGNvbnRyb2woZGF0YSwgcmVzcG9uc2VNYXhMZW5ndGgpIHtcblxuXHRcdGlmICghdGhpcy5jb25uZWN0aW9uKSB7XG5cdFx0XHR0aHJvdyBuZXcgQ29udHJvbEVycm9yKCdub3RfY29ubmVjdGVkJywgJ05vIGNvbm5lY3Rpb24gYXZhaWxhYmxlLicpO1xuXHRcdH1cblxuXHRcdHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG5cblx0XHRcdHRoaXMubG9nZ2VyLmRlYnVnKCd0cmFuc21pdHRpbmcgY29udHJvbCcsIGRhdGEsIHJlc3BvbnNlTWF4TGVuZ3RoKTtcblxuXHRcdFx0dGhpcy5yZWFkZXIuY29udHJvbChkYXRhLCB0aGlzLnJlYWRlci5JT0NUTF9DQ0lEX0VTQ0FQRSwgcmVzcG9uc2VNYXhMZW5ndGgsIChlcnIsIHJlc3BvbnNlKSA9PiB7XG5cblx0XHRcdFx0aWYgKGVycikge1xuXHRcdFx0XHRcdGNvbnN0IGVycm9yID0gbmV3IENvbnRyb2xFcnJvcihGQUlMVVJFLCAnQW4gZXJyb3Igb2NjdXJyZWQgd2hpbGUgdHJhbnNtaXR0aW5nIGNvbnRyb2wuJywgZXJyKTtcblx0XHRcdFx0XHRyZXR1cm4gcmVqZWN0KGVycm9yKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHRoaXMubG9nZ2VyLmRlYnVnKCdjb250cm9sIHJlc3BvbnNlIHJlY2VpdmVkJywgcmVzcG9uc2UsIHJlc3BvbnNlICYmIHJlc3BvbnNlLmxlbmd0aCk7XG5cblx0XHRcdFx0cmV0dXJuIHJlc29sdmUocmVzcG9uc2UpO1xuXG5cdFx0XHR9KTtcblxuXHRcdH0pO1xuXG5cdH1cblxuXHRhc3luYyBsb2FkQXV0aGVudGljYXRpb25LZXkoa2V5TnVtYmVyLCBrZXkpIHtcblxuXHRcdGlmICghKGtleU51bWJlciA9PT0gMCB8fCBrZXlOdW1iZXIgPT09IDEpKSB7XG5cdFx0XHR0aHJvdyBuZXcgTG9hZEF1dGhlbnRpY2F0aW9uS2V5RXJyb3IoJ2ludmFsaWRfa2V5X251bWJlcicpO1xuXHRcdH1cblxuXHRcdGlmICghQnVmZmVyLmlzQnVmZmVyKGtleSkgJiYgIUFycmF5LmlzQXJyYXkoa2V5KSkge1xuXG5cdFx0XHRpZiAodHlwZW9mIGtleSAhPT0gJ3N0cmluZycpIHtcblx0XHRcdFx0dGhyb3cgbmV3IExvYWRBdXRoZW50aWNhdGlvbktleUVycm9yKFxuXHRcdFx0XHRcdCdpbnZhbGlkX2tleScsXG5cdFx0XHRcdFx0J0tleSBtdXN0IGFuIGluc3RhbmNlIG9mIEJ1ZmZlciBvciBhbiBhcnJheSBvZiBieXRlcyBvciBhIHN0cmluZy4nLFxuXHRcdFx0XHQpO1xuXHRcdFx0fVxuXG5cdFx0XHRrZXkgPSBCdWZmZXIuZnJvbShrZXksICdoZXgnKTtcblxuXHRcdH1cblxuXHRcdGlmIChrZXkubGVuZ3RoICE9PSA2KSB7XG5cdFx0XHR0aHJvdyBuZXcgTG9hZEF1dGhlbnRpY2F0aW9uS2V5RXJyb3IoJ2ludmFsaWRfa2V5JywgJ0tleSBsZW5ndGggbXVzdCBiZSA2IGJ5dGVzLicpO1xuXHRcdH1cblxuXHRcdC8vIENNRDogTG9hZCBBdXRoZW50aWNhdGlvbiBLZXlzXG5cdFx0Y29uc3QgcGFja2V0ID0gQnVmZmVyLmZyb20oW1xuXHRcdFx0MHhmZiwgLy8gQ2xhc3Ncblx0XHRcdDB4ODIsIC8vIElOU1xuXHRcdFx0MHgwMCwgLy8gUDE6IEtleSBTdHJ1Y3R1cmUgKDB4MDAgPSBLZXkgaXMgbG9hZGVkIGludG8gdGhlIHJlYWRlciB2b2xhdGlsZSBtZW1vcnkuKVxuXHRcdFx0a2V5TnVtYmVyLCAvLyBQMjogS2V5IE51bWJlciAoMDBoIH4gMDFoID0gS2V5IExvY2F0aW9uLiBUaGUga2V5cyB3aWxsIGRpc2FwcGVhciBvbmNlIHRoZSByZWFkZXIgaXMgZGlzY29ubmVjdGVkIGZyb20gdGhlIFBDKVxuXHRcdFx0a2V5Lmxlbmd0aCwgLy8gTGM6IExlbmd0aCBvZiB0aGUga2V5ICg2KVxuXHRcdFx0Li4ua2V5LCAvLyBEYXRhIEluOiBLZXkgKDYgYnl0ZXMpXG5cdFx0XSk7XG5cblx0XHRsZXQgcmVzcG9uc2UgPSBudWxsO1xuXG5cdFx0dHJ5IHtcblxuXHRcdFx0cmVzcG9uc2UgPSBhd2FpdCB0aGlzLnRyYW5zbWl0KHBhY2tldCwgMik7XG5cblxuXHRcdH0gY2F0Y2ggKGVycikge1xuXG5cdFx0XHR0aHJvdyBuZXcgTG9hZEF1dGhlbnRpY2F0aW9uS2V5RXJyb3IobnVsbCwgbnVsbCwgZXJyKTtcblxuXHRcdH1cblxuXHRcdGNvbnN0IHN0YXR1c0NvZGUgPSByZXNwb25zZS5yZWFkVUludDE2QkUoMCk7XG5cblx0XHRpZiAoc3RhdHVzQ29kZSAhPT0gMHg5MDAwKSB7XG5cdFx0XHR0aHJvdyBuZXcgTG9hZEF1dGhlbnRpY2F0aW9uS2V5RXJyb3IoT1BFUkFUSU9OX0ZBSUxFRCwgYExvYWQgYXV0aGVudGljYXRpb24ga2V5IG9wZXJhdGlvbiBmYWlsZWQ6IFN0YXR1cyBjb2RlOiAke3N0YXR1c0NvZGV9YCk7XG5cdFx0fVxuXG5cdFx0dGhpcy5rZXlTdG9yYWdlW2tleU51bWJlcl0gPSBrZXk7XG5cblx0XHRyZXR1cm4ga2V5TnVtYmVyO1xuXG5cdH1cblxuXHQvLyBmb3IgUEMvU0MgVjIuMDEgdXNlIG9ic29sZXRlID0gdHJ1ZVxuXHQvLyBmb3IgUEMvU0MgVjIuMDcgdXNlIG9ic29sZXRlID0gZmFsc2UgW2RlZmF1bHRdXG5cdGFzeW5jIGF1dGhlbnRpY2F0ZShibG9ja051bWJlciwga2V5VHlwZSwga2V5LCBvYnNvbGV0ZSA9IGZhbHNlKSB7XG5cblx0XHRsZXQga2V5TnVtYmVyID0gT2JqZWN0LmtleXModGhpcy5rZXlTdG9yYWdlKS5maW5kKG4gPT4gdGhpcy5rZXlTdG9yYWdlW25dID09PSBrZXkpO1xuXG5cdFx0Ly8ga2V5IGlzIG5vdCBpbiB0aGUgc3RvcmFnZVxuXHRcdGlmICgha2V5TnVtYmVyKSB7XG5cblx0XHRcdC8vIElmIHRoZXJlIGlzbid0IGFscmVhZHkgYW4gYXV0aGVudGljYXRpb24gcHJvY2VzcyBoYXBwZW5pbmcgZm9yIHRoaXMga2V5LCBzdGFydCBpdFxuXHRcdFx0aWYgKCF0aGlzLnBlbmRpbmdMb2FkQXV0aGVudGljYXRpb25LZXlba2V5XSkge1xuXG5cdFx0XHRcdC8vIHNldCBrZXkgbnVtYmVyIHRvIGZpcnN0XG5cdFx0XHRcdGtleU51bWJlciA9IE9iamVjdC5rZXlzKHRoaXMua2V5U3RvcmFnZSlbMF07XG5cblx0XHRcdFx0Ly8gaWYgdGhpcyBudW1iZXIgaXMgbm90IGZyZWVcblx0XHRcdFx0aWYgKHRoaXMua2V5U3RvcmFnZVtrZXlOdW1iZXJdICE9PSBudWxsKSB7XG5cdFx0XHRcdFx0Ly8gdHJ5IHRvIGZpbmQgYW55IGZyZWUgbnVtYmVyXG5cdFx0XHRcdFx0Y29uc3QgZnJlZU51bWJlciA9IE9iamVjdC5rZXlzKHRoaXMua2V5U3RvcmFnZSkuZmluZChuID0+IHRoaXMua2V5U3RvcmFnZVtuXSA9PT0gbnVsbCk7XG5cdFx0XHRcdFx0Ly8gaWYgd2UgZmluZCwgd2UgdXNlIGl0LCBvdGhlcndpc2UgdGhlIGZpcnN0IHdpbGwgYmUgdXNlZCBhbmQgcmV3cml0dGVuXG5cdFx0XHRcdFx0aWYgKGZyZWVOdW1iZXIpIHtcblx0XHRcdFx0XHRcdGtleU51bWJlciA9IGZyZWVOdW1iZXI7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gU3RvcmUgdGhlIGF1dGhlbnRpY2F0aW9uIHByb21pc2UgaW4gY2FzZSBvdGhlciBibG9ja3MgYXJlIGluIHByb2Nlc3Mgb2YgYXV0aGVudGljYXRpb25cblx0XHRcdFx0dGhpcy5wZW5kaW5nTG9hZEF1dGhlbnRpY2F0aW9uS2V5W2tleV0gPSB0aGlzLmxvYWRBdXRoZW50aWNhdGlvbktleShwYXJzZUludChrZXlOdW1iZXIpLCBrZXkpO1xuXG5cdFx0XHR9XG5cblx0XHRcdHRyeSB7XG5cdFx0XHRcdGtleU51bWJlciA9IGF3YWl0IHRoaXMucGVuZGluZ0xvYWRBdXRoZW50aWNhdGlvbktleVtrZXldO1xuXHRcdFx0fSBjYXRjaCAoZXJyKSB7XG5cdFx0XHRcdHRocm93IG5ldyBBdXRoZW50aWNhdGlvbkVycm9yKCd1bmFibGVfdG9fbG9hZF9rZXknLCAnQ291bGQgbm90IGxvYWQgYXV0aGVudGljYXRpb24ga2V5IGludG8gcmVhZGVyLicsIGVycik7XG5cdFx0XHR9IGZpbmFsbHkge1xuXHRcdFx0XHQvLyByZW1vdmUgdGhlIGxvYWRBdXRoZW50aWNhdGlvbktleSBQcm9taXNlIGZyb20gcGVuZGluZ0xvYWRBdXRoZW50aWNhdGlvbktleVxuXHRcdFx0XHQvLyBhcyBpdCBpcyBhbHJlYWR5IHJlc29sdmVkIG9yIHJlamVjdGVkIGF0IHRoaXMgcG9pbnRcblx0XHRcdFx0ZGVsZXRlIHRoaXMucGVuZGluZ0xvYWRBdXRoZW50aWNhdGlvbktleVtrZXldO1xuXHRcdFx0fVxuXG5cdFx0fVxuXG5cdFx0Y29uc3QgcGFja2V0ID0gIW9ic29sZXRlID8gKFxuXHRcdFx0Ly8gQ01EOiBBdXRoZW50aWNhdGlvblxuXHRcdFx0QnVmZmVyLmZyb20oW1xuXHRcdFx0XHQweGZmLCAvLyBDbGFzc1xuXHRcdFx0XHQweDg2LCAvLyBJTlNcblx0XHRcdFx0MHgwMCwgLy8gUDFcblx0XHRcdFx0MHgwMCwgLy8gUDJcblx0XHRcdFx0MHgwNSwgLy8gTGNcblx0XHRcdFx0Ly8gRGF0YSBJbjogQXV0aGVudGljYXRlIERhdGEgQnl0ZXMgKDUgYnl0ZXMpXG5cdFx0XHRcdDB4MDEsIC8vIEJ5dGUgMTogVmVyc2lvblxuXHRcdFx0XHQweDAwLCAvLyBCeXRlIDJcblx0XHRcdFx0YmxvY2tOdW1iZXIsIC8vIEJ5dGUgMzogQmxvY2sgTnVtYmVyXG5cdFx0XHRcdGtleVR5cGUsIC8vIEJ5dGUgNDogS2V5IFR5cGVcblx0XHRcdFx0a2V5TnVtYmVyLCAvLyBCeXRlIDU6IEtleSBOdW1iZXJcblx0XHRcdF0pXG5cdFx0KSA6IChcblx0XHRcdC8vIENNRDogQXV0aGVudGljYXRpb24gKG9ic29sZXRlKVxuXHRcdFx0QnVmZmVyLmZyb20oW1xuXHRcdFx0XHQweGZmLCAvLyBDbGFzc1xuXHRcdFx0XHQweDg4LCAvLyBJTlNcblx0XHRcdFx0MHgwMCwgLy8gUDFcblx0XHRcdFx0YmxvY2tOdW1iZXIsIC8vIFAyOiBCbG9jayBOdW1iZXJcblx0XHRcdFx0a2V5VHlwZSwgLy8gUDM6IEtleSBUeXBlXG5cdFx0XHRcdGtleU51bWJlciwgLy8gRGF0YSBJbjogS2V5IE51bWJlclxuXHRcdFx0XSlcblx0XHQpO1xuXG5cdFx0bGV0IHJlc3BvbnNlID0gbnVsbDtcblxuXHRcdHRyeSB7XG5cblx0XHRcdHJlc3BvbnNlID0gYXdhaXQgdGhpcy50cmFuc21pdChwYWNrZXQsIDIpO1xuXG5cdFx0fSBjYXRjaCAoZXJyKSB7XG5cblx0XHRcdHRocm93IG5ldyBBdXRoZW50aWNhdGlvbkVycm9yKG51bGwsIG51bGwsIGVycik7XG5cblx0XHR9XG5cblx0XHRjb25zdCBzdGF0dXNDb2RlID0gcmVzcG9uc2UucmVhZFVJbnQxNkJFKDApO1xuXG5cdFx0aWYgKHN0YXR1c0NvZGUgIT09IDB4OTAwMCkge1xuXHRcdFx0dGhpcy5sb2dnZXIuZXJyb3IoJ1thdXRoZW50aWNhdGlvbiBvcGVyYXRpb24gZmFpbGVkXVtyZXF1ZXN0IHBhY2tldF0nLCBwYWNrZXQpO1xuXHRcdFx0dGhyb3cgbmV3IEF1dGhlbnRpY2F0aW9uRXJyb3IoT1BFUkFUSU9OX0ZBSUxFRCwgYEF1dGhlbnRpY2F0aW9uIG9wZXJhdGlvbiBmYWlsZWQ6IFN0YXR1cyBjb2RlOiAweCR7c3RhdHVzQ29kZS50b1N0cmluZygxNil9YCk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRydWU7XG5cblx0fVxuXG5cdGFzeW5jIHJlYWQoYmxvY2tOdW1iZXIsIGxlbmd0aCwgYmxvY2tTaXplID0gNCwgcGFja2V0U2l6ZSA9IDE2LCByZWFkQ2xhc3MgPSAweGZmKSB7XG5cblx0XHRpZiAoIXRoaXMuY2FyZCkge1xuXHRcdFx0dGhyb3cgbmV3IFJlYWRFcnJvcihDQVJEX05PVF9DT05ORUNURUQpO1xuXHRcdH1cblxuXHRcdHRoaXMubG9nZ2VyLmRlYnVnKCdyZWFkaW5nIGRhdGEgZnJvbSBjYXJkJywgdGhpcy5jYXJkKTtcblxuXHRcdGlmIChsZW5ndGggPiBwYWNrZXRTaXplKSB7XG5cblx0XHRcdGNvbnN0IHAgPSBNYXRoLmNlaWwobGVuZ3RoIC8gcGFja2V0U2l6ZSk7XG5cblx0XHRcdGNvbnN0IGNvbW1hbmRzID0gW107XG5cblx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgcDsgaSsrKSB7XG5cblx0XHRcdFx0Y29uc3QgYmxvY2sgPSBibG9ja051bWJlciArICgoaSAqIHBhY2tldFNpemUpIC8gYmxvY2tTaXplKTtcblxuXHRcdFx0XHRjb25zdCBzaXplID0gKChpICsgMSkgKiBwYWNrZXRTaXplKSA8IGxlbmd0aCA/IHBhY2tldFNpemUgOiBsZW5ndGggLSAoKGkpICogcGFja2V0U2l6ZSk7XG5cblx0XHRcdFx0Ly8gY29uc29sZS5sb2coaSwgYmxvY2ssIHNpemUpO1xuXG5cdFx0XHRcdGNvbW1hbmRzLnB1c2godGhpcy5yZWFkKGJsb2NrLCBzaXplLCBibG9ja1NpemUsIHBhY2tldFNpemUsIHJlYWRDbGFzcykpO1xuXG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiBQcm9taXNlLmFsbChjb21tYW5kcylcblx0XHRcdFx0LnRoZW4odmFsdWVzID0+IHtcblx0XHRcdFx0XHQvLyBjb25zb2xlLmxvZyh2YWx1ZXMpO1xuXHRcdFx0XHRcdHJldHVybiBCdWZmZXIuY29uY2F0KHZhbHVlcywgbGVuZ3RoKTtcblx0XHRcdFx0fSk7XG5cblx0XHR9XG5cblx0XHQvLyBBUERVIENNRDogUmVhZCBCaW5hcnkgQmxvY2tzXG5cdFx0Y29uc3QgcGFja2V0ID0gQnVmZmVyLmZyb20oW1xuXHRcdFx0cmVhZENsYXNzLCAvLyBDbGFzc1xuXHRcdFx0MHhiMCwgLy8gSW5zXG5cdFx0XHQoYmxvY2tOdW1iZXIgPj4gOCkgJiAweEZGLCAvLyBQMVxuXHRcdFx0YmxvY2tOdW1iZXIgJiAweEZGLCAvLyBQMjogQmxvY2sgTnVtYmVyXG5cdFx0XHRsZW5ndGgsICAvLyBMZTogTnVtYmVyIG9mIEJ5dGVzIHRvIFJlYWQgKE1heGltdW0gMTYgYnl0ZXMpXG5cdFx0XSk7XG5cblx0XHRsZXQgcmVzcG9uc2UgPSBudWxsO1xuXG5cdFx0dHJ5IHtcblxuXHRcdFx0cmVzcG9uc2UgPSBhd2FpdCB0aGlzLnRyYW5zbWl0KHBhY2tldCwgbGVuZ3RoICsgMik7XG5cblx0XHR9IGNhdGNoIChlcnIpIHtcblxuXHRcdFx0dGhyb3cgbmV3IFJlYWRFcnJvcihudWxsLCBudWxsLCBlcnIpO1xuXG5cdFx0fVxuXG5cdFx0aWYgKHJlc3BvbnNlLmxlbmd0aCA8IDIpIHtcblx0XHRcdHRocm93IG5ldyBSZWFkRXJyb3IoT1BFUkFUSU9OX0ZBSUxFRCwgYFJlYWQgb3BlcmF0aW9uIGZhaWxlZDogSW52YWxpZCByZXNwb25zZSBsZW5ndGggJHtyZXNwb25zZS5sZW5ndGh9LiBFeHBlY3RlZCBtaW5pbWFsIGxlbmd0aCBpcyAyIGJ5dGVzLmApO1xuXHRcdH1cblxuXHRcdGNvbnN0IHN0YXR1c0NvZGUgPSByZXNwb25zZS5zbGljZSgtMikucmVhZFVJbnQxNkJFKDApO1xuXG5cdFx0aWYgKHN0YXR1c0NvZGUgIT09IDB4OTAwMCkge1xuXHRcdFx0dGhyb3cgbmV3IFJlYWRFcnJvcihPUEVSQVRJT05fRkFJTEVELCBgUmVhZCBvcGVyYXRpb24gZmFpbGVkOiBTdGF0dXMgY29kZTogMHgke3N0YXR1c0NvZGUudG9TdHJpbmcoMTYpfWApO1xuXHRcdH1cblxuXHRcdGNvbnN0IGRhdGEgPSByZXNwb25zZS5zbGljZSgwLCAtMik7XG5cblx0XHR0aGlzLmxvZ2dlci5kZWJ1ZygnZGF0YScsIGRhdGEpO1xuXG5cdFx0cmV0dXJuIGRhdGE7XG5cblx0fVxuXG5cdGFzeW5jIHdyaXRlKGJsb2NrTnVtYmVyLCBkYXRhLCBibG9ja1NpemUgPSA0KSB7XG5cblx0XHRpZiAoIXRoaXMuY2FyZCkge1xuXHRcdFx0dGhyb3cgbmV3IFdyaXRlRXJyb3IoQ0FSRF9OT1RfQ09OTkVDVEVEKTtcblx0XHR9XG5cblx0XHR0aGlzLmxvZ2dlci5kZWJ1Zygnd3JpdGluZyBkYXRhIHRvIGNhcmQnLCB0aGlzLmNhcmQpO1xuXG5cdFx0aWYgKGRhdGEubGVuZ3RoIDwgYmxvY2tTaXplIHx8IGRhdGEubGVuZ3RoICUgYmxvY2tTaXplICE9PSAwKSB7XG5cdFx0XHR0aHJvdyBuZXcgV3JpdGVFcnJvcignaW52YWxpZF9kYXRhX2xlbmd0aCcsICdJbnZhbGlkIGRhdGEgbGVuZ3RoLiBZb3UgY2FuIG9ubHkgdXBkYXRlIHRoZSBlbnRpcmUgZGF0YSBibG9jayhzKS4nKTtcblx0XHR9XG5cblx0XHRpZiAoZGF0YS5sZW5ndGggPiBibG9ja1NpemUpIHtcblxuXHRcdFx0Y29uc3QgcCA9IGRhdGEubGVuZ3RoIC8gYmxvY2tTaXplO1xuXG5cdFx0XHRjb25zdCBjb21tYW5kcyA9IFtdO1xuXG5cdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHA7IGkrKykge1xuXG5cdFx0XHRcdGNvbnN0IGJsb2NrID0gYmxvY2tOdW1iZXIgKyBpO1xuXG5cdFx0XHRcdGNvbnN0IHN0YXJ0ID0gaSAqIGJsb2NrU2l6ZTtcblx0XHRcdFx0Y29uc3QgZW5kID0gKGkgKyAxKSAqIGJsb2NrU2l6ZTtcblxuXHRcdFx0XHRjb25zdCBwYXJ0ID0gZGF0YS5zbGljZShzdGFydCwgZW5kKTtcblxuXHRcdFx0XHQvLyBjb25zb2xlLmxvZyhpLCBibG9jaywgc3RhcnQsIGVuZCwgcGFydCk7XG5cblx0XHRcdFx0Y29tbWFuZHMucHVzaCh0aGlzLndyaXRlKGJsb2NrLCBwYXJ0LCBibG9ja1NpemUpKTtcblxuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gUHJvbWlzZS5hbGwoY29tbWFuZHMpXG5cdFx0XHRcdC50aGVuKHZhbHVlcyA9PiB7XG5cdFx0XHRcdFx0Ly8gY29uc29sZS5sb2codmFsdWVzKTtcblx0XHRcdFx0XHRyZXR1cm4gdmFsdWVzO1xuXHRcdFx0XHR9KTtcblxuXHRcdH1cblxuXHRcdC8vIEFQRFUgQ01EOiBVcGRhdGUgQmluYXJ5IEJsb2NrXG5cdFx0Y29uc3QgcGFja2V0SGVhZGVyID0gQnVmZmVyLmZyb20oW1xuXHRcdFx0MHhmZiwgLy8gQ2xhc3Ncblx0XHRcdDB4ZDYsIC8vIEluc1xuXHRcdFx0MHgwMCwgLy8gUDFcblx0XHRcdGJsb2NrTnVtYmVyLCAvLyBQMjogQmxvY2sgTnVtYmVyXG5cdFx0XHRibG9ja1NpemUsIC8vIExlOiBOdW1iZXIgb2YgQnl0ZXMgdG8gVXBkYXRlXG5cdFx0XSk7XG5cblx0XHRjb25zdCBwYWNrZXQgPSBCdWZmZXIuY29uY2F0KFtwYWNrZXRIZWFkZXIsIGRhdGFdKTtcblxuXHRcdGxldCByZXNwb25zZSA9IG51bGw7XG5cblx0XHR0cnkge1xuXG5cdFx0XHRyZXNwb25zZSA9IGF3YWl0IHRoaXMudHJhbnNtaXQocGFja2V0LCAyKTtcblxuXHRcdH0gY2F0Y2ggKGVycikge1xuXG5cdFx0XHR0aHJvdyBuZXcgV3JpdGVFcnJvcihudWxsLCBudWxsLCBlcnIpO1xuXG5cdFx0fVxuXG5cdFx0aWYgKHJlc3BvbnNlLmxlbmd0aCA8IDIpIHtcblx0XHRcdHRocm93IG5ldyBXcml0ZUVycm9yKE9QRVJBVElPTl9GQUlMRUQsIGBXcml0ZSBvcGVyYXRpb24gZmFpbGVkOiBJbnZhbGlkIHJlc3BvbnNlIGxlbmd0aCAke3Jlc3BvbnNlLmxlbmd0aH0uIEV4cGVjdGVkIG1pbmltYWwgbGVuZ3RoIGlzIDIgYnl0ZXMuYCk7XG5cdFx0fVxuXG5cdFx0Y29uc3Qgc3RhdHVzQ29kZSA9IHJlc3BvbnNlLnNsaWNlKC0yKS5yZWFkVUludDE2QkUoMCk7XG5cblx0XHRpZiAoc3RhdHVzQ29kZSAhPT0gMHg5MDAwKSB7XG5cdFx0XHR0aHJvdyBuZXcgV3JpdGVFcnJvcihPUEVSQVRJT05fRkFJTEVELCBgV3JpdGUgb3BlcmF0aW9uIGZhaWxlZDogU3RhdHVzIGNvZGU6IDB4JHtzdGF0dXNDb2RlLnRvU3RyaW5nKDE2KX1gKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gdHJ1ZTtcblxuXHR9XG5cblx0aGFuZGxlVGFnKCkge1xuXG5cdFx0aWYgKCF0aGlzLmNhcmQpIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cblx0XHR0aGlzLmxvZ2dlci5kZWJ1ZygnaGFuZGxpbmcgdGFnJywgdGhpcy5jYXJkKTtcblxuXHRcdHN3aXRjaCAodGhpcy5jYXJkLnN0YW5kYXJkKSB7XG5cblx0XHRcdGNhc2UgVEFHX0lTT18xNDQ0M18zOlxuXHRcdFx0XHRyZXR1cm4gdGhpcy5oYW5kbGVfSXNvXzE0NDQzXzNfVGFnKCk7XG5cblx0XHRcdGNhc2UgVEFHX0lTT18xNDQ0M180OlxuXHRcdFx0XHRyZXR1cm4gdGhpcy5oYW5kbGVfSXNvXzE0NDQzXzRfVGFnKCk7XG5cblx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdHJldHVybiB0aGlzLmhhbmRsZV9Jc29fMTQ0NDNfM19UYWcoKTtcblxuXHRcdH1cblxuXHR9XG5cblx0Ly8gVE9ETzogaW1wcm92ZSBlcnJvciBoYW5kbGluZyBhbmQgZGVidWdnaW5nXG5cdGFzeW5jIGhhbmRsZV9Jc29fMTQ0NDNfM19UYWcoKSB7XG5cblx0XHRpZiAoIXRoaXMuY2FyZCB8fCAhdGhpcy5jb25uZWN0aW9uKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXG5cdFx0dGhpcy5sb2dnZXIuZGVidWcoJ3Byb2Nlc3NpbmcgSVNPIDE0NDQzLTMgdGFnJywgdGhpcy5jYXJkKTtcblxuXHRcdC8vIEFQRFUgQ01EOiBHZXQgRGF0YVxuXHRcdGNvbnN0IHBhY2tldCA9IEJ1ZmZlci5mcm9tKFtcblx0XHRcdDB4ZmYsIC8vIENsYXNzXG5cdFx0XHQweGNhLCAvLyBJTlNcblx0XHRcdDB4MDAsIC8vIFAxOiBHZXQgY3VycmVudCBjYXJkIFVJRFxuXHRcdFx0MHgwMCwgLy8gUDJcblx0XHRcdDB4MDAsIC8vIExlOiBGdWxsIExlbmd0aCBvZiBVSURcblx0XHRdKTtcblxuXHRcdHRyeSB7XG5cblx0XHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy50cmFuc21pdChwYWNrZXQsIDEyKTtcblxuXHRcdFx0aWYgKHJlc3BvbnNlLmxlbmd0aCA8IDIpIHtcblxuXHRcdFx0XHRjb25zdCBlcnJvciA9IG5ldyBHZXRVSURFcnJvcignaW52YWxpZF9yZXNwb25zZScsIGBJbnZhbGlkIHJlc3BvbnNlIGxlbmd0aCAke3Jlc3BvbnNlLmxlbmd0aH0uIEV4cGVjdGVkIG1pbmltYWwgbGVuZ3RoIGlzIDIgYnl0ZXMuYCk7XG5cdFx0XHRcdHRoaXMuZW1pdCgnZXJyb3InLCBlcnJvcik7XG5cblx0XHRcdFx0cmV0dXJuO1xuXG5cdFx0XHR9XG5cblx0XHRcdC8vIGxhc3QgMiBieXRlcyBhcmUgdGhlIHN0YXR1cyBjb2RlXG5cdFx0XHRjb25zdCBzdGF0dXNDb2RlID0gcmVzcG9uc2Uuc2xpY2UoLTIpLnJlYWRVSW50MTZCRSgwKTtcblxuXHRcdFx0Ly8gYW4gZXJyb3Igb2NjdXJyZWRcblx0XHRcdGlmIChzdGF0dXNDb2RlICE9PSAweDkwMDApIHtcblxuXHRcdFx0XHRjb25zdCBlcnJvciA9IG5ldyBHZXRVSURFcnJvcihPUEVSQVRJT05fRkFJTEVELCAnQ291bGQgbm90IGdldCBjYXJkIFVJRC4nKTtcblx0XHRcdFx0dGhpcy5lbWl0KCdlcnJvcicsIGVycm9yKTtcblxuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdC8vIHN0cmlwIG91dCB0aGUgc3RhdHVzIGNvZGUgKHRoZSByZXN0IGlzIFVJRClcblx0XHRcdGNvbnN0IHVpZCA9IHJlc3BvbnNlLnNsaWNlKDAsIC0yKS50b1N0cmluZygnaGV4Jyk7XG5cdFx0XHQvLyBjb25zdCB1aWRSZXZlcnNlID0gUmVhZGVyLnJldmVyc2VCdWZmZXIocmVzcG9uc2Uuc2xpY2UoMCwgLTIpKS50b1N0cmluZygnaGV4Jyk7XG5cblx0XHRcdHRoaXMuY2FyZC51aWQgPSB1aWQ7XG5cblx0XHRcdHRoaXMuZW1pdCgnY2FyZCcsIHsgLi4udGhpcy5jYXJkIH0pO1xuXG5cblx0XHR9IGNhdGNoIChlcnIpIHtcblxuXHRcdFx0Y29uc3QgZXJyb3IgPSBuZXcgR2V0VUlERXJyb3IobnVsbCwgbnVsbCwgZXJyKTtcblxuXHRcdFx0dGhpcy5lbWl0KCdlcnJvcicsIGVycm9yKTtcblxuXHRcdH1cblxuXHR9XG5cblx0Ly8gVE9ETzogaW1wcm92ZSBlcnJvciBoYW5kbGluZyBhbmQgZGVidWdnaW5nXG5cdGFzeW5jIGhhbmRsZV9Jc29fMTQ0NDNfNF9UYWcoKSB7XG5cblx0XHRpZiAoIXRoaXMuY2FyZCB8fCAhdGhpcy5jb25uZWN0aW9uKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXG5cdFx0dGhpcy5sb2dnZXIuZGVidWcoJ3Byb2Nlc3NpbmcgSVNPIDE0NDQzLTQgdGFnJywgdGhpcy5jYXJkKTtcblxuXHRcdGlmICghdGhpcy5haWQpIHtcblx0XHRcdHRoaXMuZW1pdCgnZXJyb3InLCBuZXcgRXJyb3IoJ0Nhbm5vdCBwcm9jZXNzIElTTyAxNDQ0My00IHRhZyBiZWNhdXNlIEFJRCB3YXMgbm90IHNldC4nKSk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Y29uc3QgYWlkID0gdHlwZW9mIHRoaXMuYWlkID09PSAnZnVuY3Rpb24nID8gdGhpcy5haWQodGhpcy5jYXJkKSA6IHRoaXMuYWlkO1xuXG5cdFx0aWYgKCFCdWZmZXIuaXNCdWZmZXIoYWlkKSkge1xuXHRcdFx0dGhpcy5lbWl0KCdlcnJvcicsIG5ldyBFcnJvcignQUlEIG11c3QgYmUgYW4gaW5zdGFuY2Ugb2YgQnVmZmVyLicpKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBBUERVIENNRDogU0VMRUNUIEZJTEVcblx0XHQvLyBzZWUgaHR0cDovL2NhcmR3ZXJrLmNvbS9zbWFydC1jYXJkLXN0YW5kYXJkLWlzbzc4MTYtNC1zZWN0aW9uLTYtYmFzaWMtaW50ZXJpbmR1c3RyeS1jb21tYW5kcy8jY2hhcDZfMTFfM1xuXHRcdGNvbnN0IHBhY2tldCA9IEJ1ZmZlci5mcm9tKFtcblx0XHRcdDB4MDAsIC8vIENsYXNzXG5cdFx0XHQweGE0LCAvLyBJTlNcblx0XHRcdDB4MDQsIC8vIFAxXG5cdFx0XHQweDAwLCAvLyBQMlxuXHRcdFx0YWlkLmxlbmd0aCwgLy8gTGNcblx0XHRcdC4uLmFpZCwgLy8gQUlEXG5cdFx0XHQweDAwLCAvLyBMZVxuXHRcdF0pO1xuXG5cdFx0dHJ5IHtcblxuXHRcdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLnRyYW5zbWl0KHBhY2tldCwgNDApO1xuXG5cdFx0XHRpZiAocmVzcG9uc2UubGVuZ3RoID09PSAyICYmIHJlc3BvbnNlLnJlYWRVSW50MTZCRSgwKSA9PT0gMHg2YTgyKSB7XG5cblx0XHRcdFx0Y29uc3QgZXJyID0gbmV3IEVycm9yKGBOb3QgZm91bmQgcmVzcG9uc2UuIFRhZyBub3QgY29tcGF0aWJsZSB3aXRoIEFJRCAke2FpZC50b1N0cmluZygnaGV4JykudG9VcHBlckNhc2UoKX0uYCk7XG5cdFx0XHRcdHRoaXMuZW1pdCgnZXJyb3InLCBlcnIpO1xuXG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0aWYgKHJlc3BvbnNlLmxlbmd0aCA8IDIpIHtcblxuXHRcdFx0XHRjb25zdCBlcnIgPSBuZXcgRXJyb3IoYEludmFsaWQgcmVzcG9uc2UgbGVuZ3RoICR7cmVzcG9uc2UubGVuZ3RofS4gRXhwZWN0ZWQgbWluaW1hbCBsZW5ndGggaXMgMiBieXRlcy5gKTtcblx0XHRcdFx0dGhpcy5lbWl0KCdlcnJvcicsIGVycik7XG5cblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBhbm90aGVyIHBvc3NpYmlsaXR5IGNvbnN0IHN0YXR1c0NvZGUgPSBwYXJzZUludChyZXNwb25zZS5zbGljZSgtMikudG9TdHJpbmcoJ2hleCcpLCAxNilcblx0XHRcdGNvbnN0IHN0YXR1c0NvZGUgPSByZXNwb25zZS5zbGljZSgtMikucmVhZFVJbnQxNkJFKDApO1xuXG5cdFx0XHQvLyBhbiBlcnJvciBvY2N1cnJlZFxuXHRcdFx0aWYgKHN0YXR1c0NvZGUgIT09IDB4OTAwMCkge1xuXG5cdFx0XHRcdGNvbnN0IGVyciA9IG5ldyBFcnJvcihgUmVzcG9uc2Ugc3RhdHVzIGVycm9yLmApO1xuXHRcdFx0XHR0aGlzLmVtaXQoJ2Vycm9yJywgZXJyKTtcblxuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdC8vIHN0cmlwIG91dCB0aGUgc3RhdHVzIGNvZGVcblx0XHRcdGNvbnN0IGRhdGEgPSByZXNwb25zZS5zbGljZSgwLCAtMik7XG5cblx0XHRcdHRoaXMubG9nZ2VyLmRlYnVnKCdEYXRhIGNyb3BwZWQnLCBkYXRhKTtcblxuXHRcdFx0dGhpcy5lbWl0KCdjYXJkJywge1xuXHRcdFx0XHQuLi50aGlzLmNhcmQsXG5cdFx0XHRcdGRhdGE6IGRhdGEsXG5cdFx0XHR9KTtcblxuXHRcdH0gY2F0Y2ggKGVycikge1xuXG5cdFx0XHRjb25zdCBlcnJvciA9IG5ldyBHZXRVSURFcnJvcihudWxsLCBudWxsLCBlcnIpO1xuXG5cdFx0XHR0aGlzLmVtaXQoJ2Vycm9yJywgZXJyb3IpO1xuXG5cdFx0fVxuXG5cdH1cblxuXHRjbG9zZSgpIHtcblx0XHR0aGlzLnJlYWRlci5jbG9zZSgpO1xuXHR9XG5cblx0dG9TdHJpbmcoKSB7XG5cdFx0cmV0dXJuIHRoaXMubmFtZTtcblx0fVxuXG59XG5cbmV4cG9ydCBkZWZhdWx0IFJlYWRlcjtcbiJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "Reader.js"
      ],
      "names": [
        "TAG_ISO_14443_3",
        "TAG_ISO_14443_4",
        "KEY_TYPE_A",
        "KEY_TYPE_B",
        "CONNECT_MODE_DIRECT",
        "CONNECT_MODE_CARD",
        "Reader",
        "EventEmitter",
        "reverseBuffer",
        "src",
        "buffer",
        "Buffer",
        "allocUnsafe",
        "length",
        "i",
        "j",
        "selectStandardByAtr",
        "atr",
        "aid",
        "_aid",
        "value",
        "isBuffer",
        "Error",
        "from",
        "name",
        "reader",
        "constructor",
        "logger",
        "log",
        "debug",
        "info",
        "warn",
        "error",
        "on",
        "err",
        "emit",
        "status",
        "changes",
        "state",
        "SCARD_STATE_EMPTY",
        "card",
        "connection",
        "disconnect",
        "SCARD_STATE_PRESENT",
        "standard",
        "type",
        "connect",
        "autoProcessing",
        "handleTag",
        "mode",
        "modes",
        "SCARD_SHARE_DIRECT",
        "SCARD_SHARE_SHARED",
        "ConnectError",
        "Promise",
        "resolve",
        "reject",
        "share_mode",
        "protocol",
        "FAILURE",
        "DisconnectError",
        "SCARD_LEAVE_CARD",
        "transmit",
        "data",
        "responseMaxLength",
        "TransmitError",
        "CARD_NOT_CONNECTED",
        "response",
        "control",
        "ControlError",
        "IOCTL_CCID_ESCAPE",
        "loadAuthenticationKey",
        "keyNumber",
        "key",
        "LoadAuthenticationKeyError",
        "Array",
        "isArray",
        "packet",
        "statusCode",
        "readUInt16BE",
        "OPERATION_FAILED",
        "keyStorage",
        "authenticate",
        "blockNumber",
        "keyType",
        "obsolete",
        "Object",
        "keys",
        "find",
        "n",
        "pendingLoadAuthenticationKey",
        "freeNumber",
        "parseInt",
        "AuthenticationError",
        "toString",
        "read",
        "blockSize",
        "packetSize",
        "readClass",
        "ReadError",
        "p",
        "Math",
        "ceil",
        "commands",
        "block",
        "size",
        "push",
        "all",
        "then",
        "values",
        "concat",
        "slice",
        "write",
        "WriteError",
        "start",
        "end",
        "part",
        "packetHeader",
        "handle_Iso_14443_3_Tag",
        "handle_Iso_14443_4_Tag",
        "GetUIDError",
        "uid",
        "toUpperCase",
        "close"
      ],
      "mappings": "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",
      "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/",
      "sourcesContent": [
        "\"use strict\";\n\nimport EventEmitter from 'events';\nimport {\n\tConnectError,\n\tDisconnectError,\n\tTransmitError,\n\tControlError,\n\tAuthenticationError,\n\tLoadAuthenticationKeyError,\n\tReadError,\n\tWriteError,\n\tGetUIDError,\n\tCARD_NOT_CONNECTED,\n\tOPERATION_FAILED,\n\tUNKNOWN_ERROR,\n\tFAILURE,\n} from './errors';\n\n\nexport const TAG_ISO_14443_3 = 'TAG_ISO_14443_3'; // ISO/IEC 14443-3 tags\nexport const TAG_ISO_14443_4 = 'TAG_ISO_14443_4'; // ISO/IEC 14443-4 tags\n\nexport const KEY_TYPE_A = 0x60;\nexport const KEY_TYPE_B = 0x61;\n\nexport const CONNECT_MODE_DIRECT = 'CONNECT_MODE_DIRECT';\nexport const CONNECT_MODE_CARD = 'CONNECT_MODE_CARD';\n\n\nclass Reader extends EventEmitter {\n\n\treader = null;\n\tlogger = null;\n\n\tconnection = null;\n\tcard = null;\n\n\tautoProcessing = true;\n\t_aid = null;\n\n\tkeyStorage = {\n\t\t'0': null,\n\t\t'1': null,\n\t};\n\n\tpendingLoadAuthenticationKey = {};\n\n\t/**\n\t * Reverses a copy of a given buffer\n\t * Does NOT mutate the given buffer, returns a reversed COPY\n\t * For mutating reverse use native .reverse() method on a buffer instance\n\t * @param src {Buffer} a Buffer instance\n\t * @returns {Buffer}\n\t */\n\tstatic reverseBuffer(src) {\n\n\t\tconst buffer = Buffer.allocUnsafe(src.length);\n\n\t\tfor (let i = 0, j = src.length - 1; i <= j; ++i, --j) {\n\t\t\tbuffer[i] = src[j];\n\t\t\tbuffer[j] = src[i];\n\t\t}\n\n\t\treturn buffer;\n\n\t}\n\n\tstatic selectStandardByAtr(atr) {\n\n\t\t// TODO: better detecting card types\n\t\tif (atr[5] && atr[5] === 0x4f) {\n\t\t\treturn TAG_ISO_14443_3;\n\t\t}\n\t\telse {\n\t\t\treturn TAG_ISO_14443_4;\n\t\t}\n\n\t}\n\n\tget aid() {\n\t\treturn this._aid;\n\t}\n\n\tset aid(value) {\n\n\t\tif (typeof value === 'function' || Buffer.isBuffer(value)) {\n\t\t\tthis._aid = value;\n\t\t\treturn;\n\t\t}\n\n\t\tif (typeof value !== 'string') {\n\t\t\tthrow new Error(`AID must be a HEX string or an instance of Buffer or a function.`);\n\t\t}\n\n\t\tthis._aid = Buffer.from(value, 'hex');\n\n\t}\n\n\tget name() {\n\t\treturn this.reader.name;\n\t}\n\n\tconstructor(reader, logger) {\n\n\t\tsuper();\n\n\t\tthis.reader = reader;\n\n\t\tif (logger) {\n\t\t\tthis.logger = logger;\n\t\t}\n\t\telse {\n\t\t\tthis.logger = {\n\t\t\t\tlog: function () {\n\t\t\t\t},\n\t\t\t\tdebug: function () {\n\t\t\t\t},\n\t\t\t\tinfo: function () {\n\t\t\t\t},\n\t\t\t\twarn: function () {\n\t\t\t\t},\n\t\t\t\terror: function () {\n\t\t\t\t},\n\t\t\t};\n\t\t}\n\n\t\tthis.reader.on('error', (err) => {\n\n\t\t\tthis.logger.error(err);\n\n\t\t\tthis.emit('error', err);\n\n\t\t});\n\n\t\tthis.reader.on('status', async status => {\n\n\t\t\tthis.logger.debug('status', status);\n\n\t\t\t// check what has changed\n\t\t\tconst changes = this.reader.state ^ status.state;\n\n\t\t\tthis.logger.debug('changes', changes);\n\n\t\t\tif (changes) {\n\n\t\t\t\tif ((changes & this.reader.SCARD_STATE_EMPTY) && (status.state & this.reader.SCARD_STATE_EMPTY)) {\n\n\t\t\t\t\tthis.logger.debug('card removed');\n\n\t\t\t\t\tif (this.card) {\n\t\t\t\t\t\tthis.emit('card.off', { ...this.card });\n\t\t\t\t\t}\n\n\t\t\t\t\ttry {\n\n\t\t\t\t\t\tthis.card = null;\n\t\t\t\t\t\tif (this.connection) {\n\t\t\t\t\t\t\tawait this.disconnect();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} catch (err) {\n\n\t\t\t\t\t\tthis.emit(err);\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\telse if ((changes & this.reader.SCARD_STATE_PRESENT) && (status.state & this.reader.SCARD_STATE_PRESENT)) {\n\n\t\t\t\t\tconst atr = status.atr;\n\n\t\t\t\t\tthis.logger.debug('card inserted', atr);\n\n\t\t\t\t\tthis.card = {};\n\n\t\t\t\t\tif (atr) {\n\t\t\t\t\t\tthis.card.atr = atr;\n\t\t\t\t\t\tthis.card.standard = Reader.selectStandardByAtr(atr);\n\t\t\t\t\t\tthis.card.type = this.card.standard;\n\t\t\t\t\t}\n\n\t\t\t\t\ttry {\n\n\t\t\t\t\t\tawait this.connect();\n\n\t\t\t\t\t\tif (!this.autoProcessing) {\n\t\t\t\t\t\t\tthis.emit('card', { ...this.card });\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.handleTag();\n\n\t\t\t\t\t} catch (err) {\n\n\t\t\t\t\t\tthis.emit(err);\n\n\t\t\t\t\t}\n\n\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis.reader.on('end', () => {\n\n\t\t\tthis.logger.debug('reader removed');\n\n\t\t\tthis.emit('end');\n\n\t\t});\n\n\t}\n\n\tconnect(mode = CONNECT_MODE_CARD) {\n\n\t\tconst modes = {\n\t\t\t[CONNECT_MODE_DIRECT]: this.reader.SCARD_SHARE_DIRECT,\n\t\t\t[CONNECT_MODE_CARD]: this.reader.SCARD_SHARE_SHARED,\n\t\t};\n\n\t\tif (!modes[mode]) {\n\t\t\tthrow new ConnectError('invalid_mode', 'Invalid mode')\n\t\t}\n\n\t\tthis.logger.debug('trying to connect', mode, modes[mode]);\n\n\t\treturn new Promise((resolve, reject) => {\n\n\t\t\t// connect card\n\t\t\tthis.reader.connect({\n\t\t\t\tshare_mode: modes[mode],\n\t\t\t\t//protocol: this.reader.SCARD_PROTOCOL_UNDEFINED\n\t\t\t}, (err, protocol) => {\n\n\t\t\t\tif (err) {\n\t\t\t\t\tconst error = new ConnectError(FAILURE, 'An error occurred while connecting.', err);\n\t\t\t\t\tthis.logger.error(error);\n\t\t\t\t\treturn reject(error);\n\t\t\t\t}\n\n\t\t\t\tthis.connection = {\n\t\t\t\t\ttype: modes[mode],\n\t\t\t\t\tprotocol: protocol,\n\t\t\t\t};\n\n\t\t\t\tthis.logger.debug('connected', this.connection);\n\n\t\t\t\treturn resolve(this.connection);\n\n\t\t\t});\n\n\t\t});\n\n\t}\n\n\tdisconnect() {\n\n\t\tif (!this.connection) {\n\t\t\tthrow new DisconnectError('not_connected', 'Reader in not connected. No need for disconnecting.')\n\t\t}\n\n\t\tthis.logger.debug('trying to disconnect', this.connection);\n\n\t\treturn new Promise((resolve, reject) => {\n\n\t\t\t// disconnect removed\n\t\t\tthis.reader.disconnect(this.reader.SCARD_LEAVE_CARD, (err) => {\n\n\t\t\t\tif (err) {\n\t\t\t\t\tconst error = new DisconnectError(FAILURE, 'An error occurred while disconnecting.', err);\n\t\t\t\t\tthis.logger.error(error);\n\t\t\t\t\treturn reject(error);\n\t\t\t\t}\n\n\t\t\t\tthis.connection = null;\n\n\t\t\t\tthis.logger.debug('disconnected');\n\n\t\t\t\treturn resolve(true);\n\n\t\t\t});\n\n\t\t});\n\n\t}\n\n\ttransmit(data, responseMaxLength) {\n\n\t\tif (!this.card || !this.connection) {\n\t\t\tthrow new TransmitError(CARD_NOT_CONNECTED, 'No card or connection available.');\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => {\n\n\t\t\tthis.logger.debug('transmitting', data, responseMaxLength);\n\n\t\t\tthis.reader.transmit(data, responseMaxLength, this.connection.protocol, (err, response) => {\n\n\t\t\t\tif (err) {\n\t\t\t\t\tconst error = new TransmitError(FAILURE, 'An error occurred while transmitting.', err);\n\t\t\t\t\treturn reject(error);\n\t\t\t\t}\n\n\t\t\t\tthis.logger.debug('transmit response received', response, response && response.length);\n\n\t\t\t\treturn resolve(response);\n\n\t\t\t});\n\n\t\t});\n\n\t}\n\n\tcontrol(data, responseMaxLength) {\n\n\t\tif (!this.connection) {\n\t\t\tthrow new ControlError('not_connected', 'No connection available.');\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => {\n\n\t\t\tthis.logger.debug('transmitting control', data, responseMaxLength);\n\n\t\t\tthis.reader.control(data, this.reader.IOCTL_CCID_ESCAPE, responseMaxLength, (err, response) => {\n\n\t\t\t\tif (err) {\n\t\t\t\t\tconst error = new ControlError(FAILURE, 'An error occurred while transmitting control.', err);\n\t\t\t\t\treturn reject(error);\n\t\t\t\t}\n\n\t\t\t\tthis.logger.debug('control response received', response, response && response.length);\n\n\t\t\t\treturn resolve(response);\n\n\t\t\t});\n\n\t\t});\n\n\t}\n\n\tasync loadAuthenticationKey(keyNumber, key) {\n\n\t\tif (!(keyNumber === 0 || keyNumber === 1)) {\n\t\t\tthrow new LoadAuthenticationKeyError('invalid_key_number');\n\t\t}\n\n\t\tif (!Buffer.isBuffer(key) && !Array.isArray(key)) {\n\n\t\t\tif (typeof key !== 'string') {\n\t\t\t\tthrow new LoadAuthenticationKeyError(\n\t\t\t\t\t'invalid_key',\n\t\t\t\t\t'Key must an instance of Buffer or an array of bytes or a string.',\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tkey = Buffer.from(key, 'hex');\n\n\t\t}\n\n\t\tif (key.length !== 6) {\n\t\t\tthrow new LoadAuthenticationKeyError('invalid_key', 'Key length must be 6 bytes.');\n\t\t}\n\n\t\t// CMD: Load Authentication Keys\n\t\tconst packet = Buffer.from([\n\t\t\t0xff, // Class\n\t\t\t0x82, // INS\n\t\t\t0x00, // P1: Key Structure (0x00 = Key is loaded into the reader volatile memory.)\n\t\t\tkeyNumber, // P2: Key Number (00h ~ 01h = Key Location. The keys will disappear once the reader is disconnected from the PC)\n\t\t\tkey.length, // Lc: Length of the key (6)\n\t\t\t...key, // Data In: Key (6 bytes)\n\t\t]);\n\n\t\tlet response = null;\n\n\t\ttry {\n\n\t\t\tresponse = await this.transmit(packet, 2);\n\n\n\t\t} catch (err) {\n\n\t\t\tthrow new LoadAuthenticationKeyError(null, null, err);\n\n\t\t}\n\n\t\tconst statusCode = response.readUInt16BE(0);\n\n\t\tif (statusCode !== 0x9000) {\n\t\t\tthrow new LoadAuthenticationKeyError(OPERATION_FAILED, `Load authentication key operation failed: Status code: ${statusCode}`);\n\t\t}\n\n\t\tthis.keyStorage[keyNumber] = key;\n\n\t\treturn keyNumber;\n\n\t}\n\n\t// for PC/SC V2.01 use obsolete = true\n\t// for PC/SC V2.07 use obsolete = false [default]\n\tasync authenticate(blockNumber, keyType, key, obsolete = false) {\n\n\t\tlet keyNumber = Object.keys(this.keyStorage).find(n => this.keyStorage[n] === key);\n\n\t\t// key is not in the storage\n\t\tif (!keyNumber) {\n\n\t\t\t// If there isn't already an authentication process happening for this key, start it\n\t\t\tif (!this.pendingLoadAuthenticationKey[key]) {\n\n\t\t\t\t// set key number to first\n\t\t\t\tkeyNumber = Object.keys(this.keyStorage)[0];\n\n\t\t\t\t// if this number is not free\n\t\t\t\tif (this.keyStorage[keyNumber] !== null) {\n\t\t\t\t\t// try to find any free number\n\t\t\t\t\tconst freeNumber = Object.keys(this.keyStorage).find(n => this.keyStorage[n] === null);\n\t\t\t\t\t// if we find, we use it, otherwise the first will be used and rewritten\n\t\t\t\t\tif (freeNumber) {\n\t\t\t\t\t\tkeyNumber = freeNumber;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Store the authentication promise in case other blocks are in process of authentication\n\t\t\t\tthis.pendingLoadAuthenticationKey[key] = this.loadAuthenticationKey(parseInt(keyNumber), key);\n\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tkeyNumber = await this.pendingLoadAuthenticationKey[key];\n\t\t\t} catch (err) {\n\t\t\t\tthrow new AuthenticationError('unable_to_load_key', 'Could not load authentication key into reader.', err);\n\t\t\t} finally {\n\t\t\t\t// remove the loadAuthenticationKey Promise from pendingLoadAuthenticationKey\n\t\t\t\t// as it is already resolved or rejected at this point\n\t\t\t\tdelete this.pendingLoadAuthenticationKey[key];\n\t\t\t}\n\n\t\t}\n\n\t\tconst packet = !obsolete ? (\n\t\t\t// CMD: Authentication\n\t\t\tBuffer.from([\n\t\t\t\t0xff, // Class\n\t\t\t\t0x86, // INS\n\t\t\t\t0x00, // P1\n\t\t\t\t0x00, // P2\n\t\t\t\t0x05, // Lc\n\t\t\t\t// Data In: Authenticate Data Bytes (5 bytes)\n\t\t\t\t0x01, // Byte 1: Version\n\t\t\t\t0x00, // Byte 2\n\t\t\t\tblockNumber, // Byte 3: Block Number\n\t\t\t\tkeyType, // Byte 4: Key Type\n\t\t\t\tkeyNumber, // Byte 5: Key Number\n\t\t\t])\n\t\t) : (\n\t\t\t// CMD: Authentication (obsolete)\n\t\t\tBuffer.from([\n\t\t\t\t0xff, // Class\n\t\t\t\t0x88, // INS\n\t\t\t\t0x00, // P1\n\t\t\t\tblockNumber, // P2: Block Number\n\t\t\t\tkeyType, // P3: Key Type\n\t\t\t\tkeyNumber, // Data In: Key Number\n\t\t\t])\n\t\t);\n\n\t\tlet response = null;\n\n\t\ttry {\n\n\t\t\tresponse = await this.transmit(packet, 2);\n\n\t\t} catch (err) {\n\n\t\t\tthrow new AuthenticationError(null, null, err);\n\n\t\t}\n\n\t\tconst statusCode = response.readUInt16BE(0);\n\n\t\tif (statusCode !== 0x9000) {\n\t\t\tthis.logger.error('[authentication operation failed][request packet]', packet);\n\t\t\tthrow new AuthenticationError(OPERATION_FAILED, `Authentication operation failed: Status code: 0x${statusCode.toString(16)}`);\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tasync read(blockNumber, length, blockSize = 4, packetSize = 16, readClass = 0xff) {\n\n\t\tif (!this.card) {\n\t\t\tthrow new ReadError(CARD_NOT_CONNECTED);\n\t\t}\n\n\t\tthis.logger.debug('reading data from card', this.card);\n\n\t\tif (length > packetSize) {\n\n\t\t\tconst p = Math.ceil(length / packetSize);\n\n\t\t\tconst commands = [];\n\n\t\t\tfor (let i = 0; i < p; i++) {\n\n\t\t\t\tconst block = blockNumber + ((i * packetSize) / blockSize);\n\n\t\t\t\tconst size = ((i + 1) * packetSize) < length ? packetSize : length - ((i) * packetSize);\n\n\t\t\t\t// console.log(i, block, size);\n\n\t\t\t\tcommands.push(this.read(block, size, blockSize, packetSize, readClass));\n\n\t\t\t}\n\n\t\t\treturn Promise.all(commands)\n\t\t\t\t.then(values => {\n\t\t\t\t\t// console.log(values);\n\t\t\t\t\treturn Buffer.concat(values, length);\n\t\t\t\t});\n\n\t\t}\n\n\t\t// APDU CMD: Read Binary Blocks\n\t\tconst packet = Buffer.from([\n\t\t\treadClass, // Class\n\t\t\t0xb0, // Ins\n\t\t\t(blockNumber >> 8) & 0xFF, // P1\n\t\t\tblockNumber & 0xFF, // P2: Block Number\n\t\t\tlength,  // Le: Number of Bytes to Read (Maximum 16 bytes)\n\t\t]);\n\n\t\tlet response = null;\n\n\t\ttry {\n\n\t\t\tresponse = await this.transmit(packet, length + 2);\n\n\t\t} catch (err) {\n\n\t\t\tthrow new ReadError(null, null, err);\n\n\t\t}\n\n\t\tif (response.length < 2) {\n\t\t\tthrow new ReadError(OPERATION_FAILED, `Read operation failed: Invalid response length ${response.length}. Expected minimal length is 2 bytes.`);\n\t\t}\n\n\t\tconst statusCode = response.slice(-2).readUInt16BE(0);\n\n\t\tif (statusCode !== 0x9000) {\n\t\t\tthrow new ReadError(OPERATION_FAILED, `Read operation failed: Status code: 0x${statusCode.toString(16)}`);\n\t\t}\n\n\t\tconst data = response.slice(0, -2);\n\n\t\tthis.logger.debug('data', data);\n\n\t\treturn data;\n\n\t}\n\n\tasync write(blockNumber, data, blockSize = 4) {\n\n\t\tif (!this.card) {\n\t\t\tthrow new WriteError(CARD_NOT_CONNECTED);\n\t\t}\n\n\t\tthis.logger.debug('writing data to card', this.card);\n\n\t\tif (data.length < blockSize || data.length % blockSize !== 0) {\n\t\t\tthrow new WriteError('invalid_data_length', 'Invalid data length. You can only update the entire data block(s).');\n\t\t}\n\n\t\tif (data.length > blockSize) {\n\n\t\t\tconst p = data.length / blockSize;\n\n\t\t\tconst commands = [];\n\n\t\t\tfor (let i = 0; i < p; i++) {\n\n\t\t\t\tconst block = blockNumber + i;\n\n\t\t\t\tconst start = i * blockSize;\n\t\t\t\tconst end = (i + 1) * blockSize;\n\n\t\t\t\tconst part = data.slice(start, end);\n\n\t\t\t\t// console.log(i, block, start, end, part);\n\n\t\t\t\tcommands.push(this.write(block, part, blockSize));\n\n\t\t\t}\n\n\t\t\treturn Promise.all(commands)\n\t\t\t\t.then(values => {\n\t\t\t\t\t// console.log(values);\n\t\t\t\t\treturn values;\n\t\t\t\t});\n\n\t\t}\n\n\t\t// APDU CMD: Update Binary Block\n\t\tconst packetHeader = Buffer.from([\n\t\t\t0xff, // Class\n\t\t\t0xd6, // Ins\n\t\t\t0x00, // P1\n\t\t\tblockNumber, // P2: Block Number\n\t\t\tblockSize, // Le: Number of Bytes to Update\n\t\t]);\n\n\t\tconst packet = Buffer.concat([packetHeader, data]);\n\n\t\tlet response = null;\n\n\t\ttry {\n\n\t\t\tresponse = await this.transmit(packet, 2);\n\n\t\t} catch (err) {\n\n\t\t\tthrow new WriteError(null, null, err);\n\n\t\t}\n\n\t\tif (response.length < 2) {\n\t\t\tthrow new WriteError(OPERATION_FAILED, `Write operation failed: Invalid response length ${response.length}. Expected minimal length is 2 bytes.`);\n\t\t}\n\n\t\tconst statusCode = response.slice(-2).readUInt16BE(0);\n\n\t\tif (statusCode !== 0x9000) {\n\t\t\tthrow new WriteError(OPERATION_FAILED, `Write operation failed: Status code: 0x${statusCode.toString(16)}`);\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\thandleTag() {\n\n\t\tif (!this.card) {\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.logger.debug('handling tag', this.card);\n\n\t\tswitch (this.card.standard) {\n\n\t\t\tcase TAG_ISO_14443_3:\n\t\t\t\treturn this.handle_Iso_14443_3_Tag();\n\n\t\t\tcase TAG_ISO_14443_4:\n\t\t\t\treturn this.handle_Iso_14443_4_Tag();\n\n\t\t\tdefault:\n\t\t\t\treturn this.handle_Iso_14443_3_Tag();\n\n\t\t}\n\n\t}\n\n\t// TODO: improve error handling and debugging\n\tasync handle_Iso_14443_3_Tag() {\n\n\t\tif (!this.card || !this.connection) {\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.logger.debug('processing ISO 14443-3 tag', this.card);\n\n\t\t// APDU CMD: Get Data\n\t\tconst packet = Buffer.from([\n\t\t\t0xff, // Class\n\t\t\t0xca, // INS\n\t\t\t0x00, // P1: Get current card UID\n\t\t\t0x00, // P2\n\t\t\t0x00, // Le: Full Length of UID\n\t\t]);\n\n\t\ttry {\n\n\t\t\tconst response = await this.transmit(packet, 12);\n\n\t\t\tif (response.length < 2) {\n\n\t\t\t\tconst error = new GetUIDError('invalid_response', `Invalid response length ${response.length}. Expected minimal length is 2 bytes.`);\n\t\t\t\tthis.emit('error', error);\n\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\t// last 2 bytes are the status code\n\t\t\tconst statusCode = response.slice(-2).readUInt16BE(0);\n\n\t\t\t// an error occurred\n\t\t\tif (statusCode !== 0x9000) {\n\n\t\t\t\tconst error = new GetUIDError(OPERATION_FAILED, 'Could not get card UID.');\n\t\t\t\tthis.emit('error', error);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// strip out the status code (the rest is UID)\n\t\t\tconst uid = response.slice(0, -2).toString('hex');\n\t\t\t// const uidReverse = Reader.reverseBuffer(response.slice(0, -2)).toString('hex');\n\n\t\t\tthis.card.uid = uid;\n\n\t\t\tthis.emit('card', { ...this.card });\n\n\n\t\t} catch (err) {\n\n\t\t\tconst error = new GetUIDError(null, null, err);\n\n\t\t\tthis.emit('error', error);\n\n\t\t}\n\n\t}\n\n\t// TODO: improve error handling and debugging\n\tasync handle_Iso_14443_4_Tag() {\n\n\t\tif (!this.card || !this.connection) {\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.logger.debug('processing ISO 14443-4 tag', this.card);\n\n\t\tif (!this.aid) {\n\t\t\tthis.emit('error', new Error('Cannot process ISO 14443-4 tag because AID was not set.'));\n\t\t\treturn;\n\t\t}\n\n\t\tconst aid = typeof this.aid === 'function' ? this.aid(this.card) : this.aid;\n\n\t\tif (!Buffer.isBuffer(aid)) {\n\t\t\tthis.emit('error', new Error('AID must be an instance of Buffer.'));\n\t\t\treturn;\n\t\t}\n\n\t\t// APDU CMD: SELECT FILE\n\t\t// see http://cardwerk.com/smart-card-standard-iso7816-4-section-6-basic-interindustry-commands/#chap6_11_3\n\t\tconst packet = Buffer.from([\n\t\t\t0x00, // Class\n\t\t\t0xa4, // INS\n\t\t\t0x04, // P1\n\t\t\t0x00, // P2\n\t\t\taid.length, // Lc\n\t\t\t...aid, // AID\n\t\t\t0x00, // Le\n\t\t]);\n\n\t\ttry {\n\n\t\t\tconst response = await this.transmit(packet, 40);\n\n\t\t\tif (response.length === 2 && response.readUInt16BE(0) === 0x6a82) {\n\n\t\t\t\tconst err = new Error(`Not found response. Tag not compatible with AID ${aid.toString('hex').toUpperCase()}.`);\n\t\t\t\tthis.emit('error', err);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (response.length < 2) {\n\n\t\t\t\tconst err = new Error(`Invalid response length ${response.length}. Expected minimal length is 2 bytes.`);\n\t\t\t\tthis.emit('error', err);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// another possibility const statusCode = parseInt(response.slice(-2).toString('hex'), 16)\n\t\t\tconst statusCode = response.slice(-2).readUInt16BE(0);\n\n\t\t\t// an error occurred\n\t\t\tif (statusCode !== 0x9000) {\n\n\t\t\t\tconst err = new Error(`Response status error.`);\n\t\t\t\tthis.emit('error', err);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// strip out the status code\n\t\t\tconst data = response.slice(0, -2);\n\n\t\t\tthis.logger.debug('Data cropped', data);\n\n\t\t\tthis.emit('card', {\n\t\t\t\t...this.card,\n\t\t\t\tdata: data,\n\t\t\t});\n\n\t\t} catch (err) {\n\n\t\t\tconst error = new GetUIDError(null, null, err);\n\n\t\t\tthis.emit('error', error);\n\n\t\t}\n\n\t}\n\n\tclose() {\n\t\tthis.reader.close();\n\t}\n\n\ttoString() {\n\t\treturn this.name;\n\t}\n\n}\n\nexport default Reader;\n"
      ]
    },
    "sourceType": "script",
    "mtime": 1662229648499
  },
  "{\"sourceRoot\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc\",\"filename\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/errors.js\",\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{}},{\"key\":\"proposal-class-properties\",\"visitor\":{\"PrivateName\":{\"enter\":[null]},\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{}}],\"presets\":[]}:7.12.17": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/",
      "caller": {
        "name": "@babel/register"
      },
      "cwd": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc",
      "filename": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/errors.js",
      "cloneInputAst": true,
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {}
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {}
        },
        {
          "key": "proposal-class-properties",
          "visitor": {
            "PrivateName": {
              "enter": [
                null
              ]
            },
            "ExportDefaultDeclaration": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true,
            "ClassExpression": {
              "enter": [
                null
              ]
            },
            "ClassDeclaration": {
              "enter": [
                null
              ]
            }
          },
          "options": {}
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/errors.js",
        "plugins": [
          "objectRestSpread",
          "classProperties",
          "classPrivateProperties"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/errors.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/",
        "sourceFileName": "errors.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.GetUIDError = exports.DisconnectError = exports.ConnectError = exports.AuthenticationError = exports.LoadAuthenticationKeyError = exports.WriteError = exports.ReadError = exports.ControlError = exports.TransmitError = exports.OPERATION_FAILED = exports.CARD_NOT_CONNECTED = exports.FAILURE = exports.BaseError = exports.UNKNOWN_ERROR = void 0;\nconst UNKNOWN_ERROR = 'unknown_error';\nexports.UNKNOWN_ERROR = UNKNOWN_ERROR;\n\nclass BaseError extends Error {\n  constructor(code, message, previousError) {\n    super(message);\n    Error.captureStackTrace(this, this.constructor);\n    this.name = 'BaseError';\n\n    if (!message && previousError) {\n      this.message = previousError.message;\n    }\n\n    this.code = code;\n\n    if (previousError) {\n      this.previous = previousError;\n    }\n  }\n\n}\n\nexports.BaseError = BaseError;\nconst FAILURE = 'failure';\nexports.FAILURE = FAILURE;\nconst CARD_NOT_CONNECTED = 'card_not_connected';\nexports.CARD_NOT_CONNECTED = CARD_NOT_CONNECTED;\nconst OPERATION_FAILED = 'operation_failed';\nexports.OPERATION_FAILED = OPERATION_FAILED;\n\nclass TransmitError extends BaseError {\n  constructor(code, message, previousError) {\n    super(code, message, previousError);\n    this.name = 'TransmitError';\n  }\n\n}\n\nexports.TransmitError = TransmitError;\n\nclass ControlError extends BaseError {\n  constructor(code, message, previousError) {\n    super(code, message, previousError);\n    this.name = 'ControlError';\n  }\n\n}\n\nexports.ControlError = ControlError;\n\nclass ReadError extends BaseError {\n  constructor(code, message, previousError) {\n    super(code, message, previousError);\n    this.name = 'ReadError';\n  }\n\n}\n\nexports.ReadError = ReadError;\n\nclass WriteError extends BaseError {\n  constructor(code, message, previousError) {\n    super(code, message, previousError);\n    this.name = 'WriteError';\n  }\n\n}\n\nexports.WriteError = WriteError;\n\nclass LoadAuthenticationKeyError extends BaseError {\n  constructor(code, message, previousError) {\n    super(code, message, previousError);\n    this.name = 'LoadAuthenticationKeyError';\n  }\n\n}\n\nexports.LoadAuthenticationKeyError = LoadAuthenticationKeyError;\n\nclass AuthenticationError extends BaseError {\n  constructor(code, message, previousError) {\n    super(code, message, previousError);\n    this.name = 'AuthenticationError';\n  }\n\n}\n\nexports.AuthenticationError = AuthenticationError;\n\nclass ConnectError extends BaseError {\n  constructor(code, message, previousError) {\n    super(code, message, previousError);\n    this.name = 'ConnectError';\n  }\n\n}\n\nexports.ConnectError = ConnectError;\n\nclass DisconnectError extends BaseError {\n  constructor(code, message, previousError) {\n    super(code, message, previousError);\n    this.name = 'DisconnectError';\n  }\n\n}\n\nexports.DisconnectError = DisconnectError;\n\nclass GetUIDError extends BaseError {\n  constructor(code, message, previousError) {\n    super(code, message, previousError);\n    this.name = 'GetUIDError';\n  }\n\n}\n\nexports.GetUIDError = GetUIDError;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImVycm9ycy5qcyJdLCJuYW1lcyI6WyJVTktOT1dOX0VSUk9SIiwiQmFzZUVycm9yIiwiRXJyb3IiLCJjb25zdHJ1Y3RvciIsImNvZGUiLCJtZXNzYWdlIiwicHJldmlvdXNFcnJvciIsImNhcHR1cmVTdGFja1RyYWNlIiwibmFtZSIsInByZXZpb3VzIiwiRkFJTFVSRSIsIkNBUkRfTk9UX0NPTk5FQ1RFRCIsIk9QRVJBVElPTl9GQUlMRUQiLCJUcmFuc21pdEVycm9yIiwiQ29udHJvbEVycm9yIiwiUmVhZEVycm9yIiwiV3JpdGVFcnJvciIsIkxvYWRBdXRoZW50aWNhdGlvbktleUVycm9yIiwiQXV0aGVudGljYXRpb25FcnJvciIsIkNvbm5lY3RFcnJvciIsIkRpc2Nvbm5lY3RFcnJvciIsIkdldFVJREVycm9yIl0sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7O0FBR08sTUFBTUEsYUFBYSxHQUFHLGVBQXRCOzs7QUFFQSxNQUFNQyxTQUFOLFNBQXdCQyxLQUF4QixDQUE4QjtBQUVwQ0MsRUFBQUEsV0FBVyxDQUFDQyxJQUFELEVBQU9DLE9BQVAsRUFBZ0JDLGFBQWhCLEVBQStCO0FBRXpDLFVBQU1ELE9BQU47QUFFQUgsSUFBQUEsS0FBSyxDQUFDSyxpQkFBTixDQUF3QixJQUF4QixFQUE4QixLQUFLSixXQUFuQztBQUVBLFNBQUtLLElBQUwsR0FBWSxXQUFaOztBQUVBLFFBQUksQ0FBQ0gsT0FBRCxJQUFZQyxhQUFoQixFQUErQjtBQUM5QixXQUFLRCxPQUFMLEdBQWVDLGFBQWEsQ0FBQ0QsT0FBN0I7QUFDQTs7QUFFRCxTQUFLRCxJQUFMLEdBQVlBLElBQVo7O0FBRUEsUUFBSUUsYUFBSixFQUFtQjtBQUNsQixXQUFLRyxRQUFMLEdBQWdCSCxhQUFoQjtBQUNBO0FBRUQ7O0FBcEJtQzs7O0FBd0I5QixNQUFNSSxPQUFPLEdBQUcsU0FBaEI7O0FBQ0EsTUFBTUMsa0JBQWtCLEdBQUcsb0JBQTNCOztBQUNBLE1BQU1DLGdCQUFnQixHQUFHLGtCQUF6Qjs7O0FBRUEsTUFBTUMsYUFBTixTQUE0QlosU0FBNUIsQ0FBc0M7QUFFNUNFLEVBQUFBLFdBQVcsQ0FBQ0MsSUFBRCxFQUFPQyxPQUFQLEVBQWdCQyxhQUFoQixFQUErQjtBQUV6QyxVQUFNRixJQUFOLEVBQVlDLE9BQVosRUFBcUJDLGFBQXJCO0FBRUEsU0FBS0UsSUFBTCxHQUFZLGVBQVo7QUFFQTs7QUFSMkM7Ozs7QUFZdEMsTUFBTU0sWUFBTixTQUEyQmIsU0FBM0IsQ0FBcUM7QUFFM0NFLEVBQUFBLFdBQVcsQ0FBQ0MsSUFBRCxFQUFPQyxPQUFQLEVBQWdCQyxhQUFoQixFQUErQjtBQUV6QyxVQUFNRixJQUFOLEVBQVlDLE9BQVosRUFBcUJDLGFBQXJCO0FBRUEsU0FBS0UsSUFBTCxHQUFZLGNBQVo7QUFFQTs7QUFSMEM7Ozs7QUFZckMsTUFBTU8sU0FBTixTQUF3QmQsU0FBeEIsQ0FBa0M7QUFFeENFLEVBQUFBLFdBQVcsQ0FBQ0MsSUFBRCxFQUFPQyxPQUFQLEVBQWdCQyxhQUFoQixFQUErQjtBQUV6QyxVQUFNRixJQUFOLEVBQVlDLE9BQVosRUFBcUJDLGFBQXJCO0FBRUEsU0FBS0UsSUFBTCxHQUFZLFdBQVo7QUFFQTs7QUFSdUM7Ozs7QUFZbEMsTUFBTVEsVUFBTixTQUF5QmYsU0FBekIsQ0FBbUM7QUFFekNFLEVBQUFBLFdBQVcsQ0FBQ0MsSUFBRCxFQUFPQyxPQUFQLEVBQWdCQyxhQUFoQixFQUErQjtBQUV6QyxVQUFNRixJQUFOLEVBQVlDLE9BQVosRUFBcUJDLGFBQXJCO0FBRUEsU0FBS0UsSUFBTCxHQUFZLFlBQVo7QUFFQTs7QUFSd0M7Ozs7QUFZbkMsTUFBTVMsMEJBQU4sU0FBeUNoQixTQUF6QyxDQUFtRDtBQUV6REUsRUFBQUEsV0FBVyxDQUFDQyxJQUFELEVBQU9DLE9BQVAsRUFBZ0JDLGFBQWhCLEVBQStCO0FBRXpDLFVBQU1GLElBQU4sRUFBWUMsT0FBWixFQUFxQkMsYUFBckI7QUFFQSxTQUFLRSxJQUFMLEdBQVksNEJBQVo7QUFFQTs7QUFSd0Q7Ozs7QUFZbkQsTUFBTVUsbUJBQU4sU0FBa0NqQixTQUFsQyxDQUE0QztBQUVsREUsRUFBQUEsV0FBVyxDQUFDQyxJQUFELEVBQU9DLE9BQVAsRUFBZ0JDLGFBQWhCLEVBQStCO0FBRXpDLFVBQU1GLElBQU4sRUFBWUMsT0FBWixFQUFxQkMsYUFBckI7QUFFQSxTQUFLRSxJQUFMLEdBQVkscUJBQVo7QUFFQTs7QUFSaUQ7Ozs7QUFZNUMsTUFBTVcsWUFBTixTQUEyQmxCLFNBQTNCLENBQXFDO0FBRTNDRSxFQUFBQSxXQUFXLENBQUNDLElBQUQsRUFBT0MsT0FBUCxFQUFnQkMsYUFBaEIsRUFBK0I7QUFFekMsVUFBTUYsSUFBTixFQUFZQyxPQUFaLEVBQXFCQyxhQUFyQjtBQUVBLFNBQUtFLElBQUwsR0FBWSxjQUFaO0FBRUE7O0FBUjBDOzs7O0FBWXJDLE1BQU1ZLGVBQU4sU0FBOEJuQixTQUE5QixDQUF3QztBQUU5Q0UsRUFBQUEsV0FBVyxDQUFDQyxJQUFELEVBQU9DLE9BQVAsRUFBZ0JDLGFBQWhCLEVBQStCO0FBRXpDLFVBQU1GLElBQU4sRUFBWUMsT0FBWixFQUFxQkMsYUFBckI7QUFFQSxTQUFLRSxJQUFMLEdBQVksaUJBQVo7QUFFQTs7QUFSNkM7Ozs7QUFZeEMsTUFBTWEsV0FBTixTQUEwQnBCLFNBQTFCLENBQW9DO0FBRTFDRSxFQUFBQSxXQUFXLENBQUNDLElBQUQsRUFBT0MsT0FBUCxFQUFnQkMsYUFBaEIsRUFBK0I7QUFFekMsVUFBTUYsSUFBTixFQUFZQyxPQUFaLEVBQXFCQyxhQUFyQjtBQUVBLFNBQUtFLElBQUwsR0FBWSxhQUFaO0FBRUE7O0FBUnlDIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9oYXJyeWhvdy9Eb2N1bWVudHMvMjAyMi9QUk9KRUNUX01PQ0FfQVJUL05GQy9uZmMtcGNzYy9zcmMvIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cblxuZXhwb3J0IGNvbnN0IFVOS05PV05fRVJST1IgPSAndW5rbm93bl9lcnJvcic7XG5cbmV4cG9ydCBjbGFzcyBCYXNlRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG5cblx0Y29uc3RydWN0b3IoY29kZSwgbWVzc2FnZSwgcHJldmlvdXNFcnJvcikge1xuXG5cdFx0c3VwZXIobWVzc2FnZSk7XG5cblx0XHRFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSh0aGlzLCB0aGlzLmNvbnN0cnVjdG9yKTtcblxuXHRcdHRoaXMubmFtZSA9ICdCYXNlRXJyb3InO1xuXG5cdFx0aWYgKCFtZXNzYWdlICYmIHByZXZpb3VzRXJyb3IpIHtcblx0XHRcdHRoaXMubWVzc2FnZSA9IHByZXZpb3VzRXJyb3IubWVzc2FnZTtcblx0XHR9XG5cblx0XHR0aGlzLmNvZGUgPSBjb2RlO1xuXG5cdFx0aWYgKHByZXZpb3VzRXJyb3IpIHtcblx0XHRcdHRoaXMucHJldmlvdXMgPSBwcmV2aW91c0Vycm9yO1xuXHRcdH1cblxuXHR9XG5cbn1cblxuZXhwb3J0IGNvbnN0IEZBSUxVUkUgPSAnZmFpbHVyZSc7XG5leHBvcnQgY29uc3QgQ0FSRF9OT1RfQ09OTkVDVEVEID0gJ2NhcmRfbm90X2Nvbm5lY3RlZCc7XG5leHBvcnQgY29uc3QgT1BFUkFUSU9OX0ZBSUxFRCA9ICdvcGVyYXRpb25fZmFpbGVkJztcblxuZXhwb3J0IGNsYXNzIFRyYW5zbWl0RXJyb3IgZXh0ZW5kcyBCYXNlRXJyb3Ige1xuXG5cdGNvbnN0cnVjdG9yKGNvZGUsIG1lc3NhZ2UsIHByZXZpb3VzRXJyb3IpIHtcblxuXHRcdHN1cGVyKGNvZGUsIG1lc3NhZ2UsIHByZXZpb3VzRXJyb3IpO1xuXG5cdFx0dGhpcy5uYW1lID0gJ1RyYW5zbWl0RXJyb3InO1xuXG5cdH1cblxufVxuXG5leHBvcnQgY2xhc3MgQ29udHJvbEVycm9yIGV4dGVuZHMgQmFzZUVycm9yIHtcblxuXHRjb25zdHJ1Y3Rvcihjb2RlLCBtZXNzYWdlLCBwcmV2aW91c0Vycm9yKSB7XG5cblx0XHRzdXBlcihjb2RlLCBtZXNzYWdlLCBwcmV2aW91c0Vycm9yKTtcblxuXHRcdHRoaXMubmFtZSA9ICdDb250cm9sRXJyb3InO1xuXG5cdH1cblxufVxuXG5leHBvcnQgY2xhc3MgUmVhZEVycm9yIGV4dGVuZHMgQmFzZUVycm9yIHtcblxuXHRjb25zdHJ1Y3Rvcihjb2RlLCBtZXNzYWdlLCBwcmV2aW91c0Vycm9yKSB7XG5cblx0XHRzdXBlcihjb2RlLCBtZXNzYWdlLCBwcmV2aW91c0Vycm9yKTtcblxuXHRcdHRoaXMubmFtZSA9ICdSZWFkRXJyb3InO1xuXG5cdH1cblxufVxuXG5leHBvcnQgY2xhc3MgV3JpdGVFcnJvciBleHRlbmRzIEJhc2VFcnJvciB7XG5cblx0Y29uc3RydWN0b3IoY29kZSwgbWVzc2FnZSwgcHJldmlvdXNFcnJvcikge1xuXG5cdFx0c3VwZXIoY29kZSwgbWVzc2FnZSwgcHJldmlvdXNFcnJvcik7XG5cblx0XHR0aGlzLm5hbWUgPSAnV3JpdGVFcnJvcic7XG5cblx0fVxuXG59XG5cbmV4cG9ydCBjbGFzcyBMb2FkQXV0aGVudGljYXRpb25LZXlFcnJvciBleHRlbmRzIEJhc2VFcnJvciB7XG5cblx0Y29uc3RydWN0b3IoY29kZSwgbWVzc2FnZSwgcHJldmlvdXNFcnJvcikge1xuXG5cdFx0c3VwZXIoY29kZSwgbWVzc2FnZSwgcHJldmlvdXNFcnJvcik7XG5cblx0XHR0aGlzLm5hbWUgPSAnTG9hZEF1dGhlbnRpY2F0aW9uS2V5RXJyb3InO1xuXG5cdH1cblxufVxuXG5leHBvcnQgY2xhc3MgQXV0aGVudGljYXRpb25FcnJvciBleHRlbmRzIEJhc2VFcnJvciB7XG5cblx0Y29uc3RydWN0b3IoY29kZSwgbWVzc2FnZSwgcHJldmlvdXNFcnJvcikge1xuXG5cdFx0c3VwZXIoY29kZSwgbWVzc2FnZSwgcHJldmlvdXNFcnJvcik7XG5cblx0XHR0aGlzLm5hbWUgPSAnQXV0aGVudGljYXRpb25FcnJvcic7XG5cblx0fVxuXG59XG5cbmV4cG9ydCBjbGFzcyBDb25uZWN0RXJyb3IgZXh0ZW5kcyBCYXNlRXJyb3Ige1xuXG5cdGNvbnN0cnVjdG9yKGNvZGUsIG1lc3NhZ2UsIHByZXZpb3VzRXJyb3IpIHtcblxuXHRcdHN1cGVyKGNvZGUsIG1lc3NhZ2UsIHByZXZpb3VzRXJyb3IpO1xuXG5cdFx0dGhpcy5uYW1lID0gJ0Nvbm5lY3RFcnJvcic7XG5cblx0fVxuXG59XG5cbmV4cG9ydCBjbGFzcyBEaXNjb25uZWN0RXJyb3IgZXh0ZW5kcyBCYXNlRXJyb3Ige1xuXG5cdGNvbnN0cnVjdG9yKGNvZGUsIG1lc3NhZ2UsIHByZXZpb3VzRXJyb3IpIHtcblxuXHRcdHN1cGVyKGNvZGUsIG1lc3NhZ2UsIHByZXZpb3VzRXJyb3IpO1xuXG5cdFx0dGhpcy5uYW1lID0gJ0Rpc2Nvbm5lY3RFcnJvcic7XG5cblx0fVxuXG59XG5cbmV4cG9ydCBjbGFzcyBHZXRVSURFcnJvciBleHRlbmRzIEJhc2VFcnJvciB7XG5cblx0Y29uc3RydWN0b3IoY29kZSwgbWVzc2FnZSwgcHJldmlvdXNFcnJvcikge1xuXG5cdFx0c3VwZXIoY29kZSwgbWVzc2FnZSwgcHJldmlvdXNFcnJvcik7XG5cblx0XHR0aGlzLm5hbWUgPSAnR2V0VUlERXJyb3InO1xuXG5cdH1cblxufVxuIl19",
    "map": {
      "version": 3,
      "sources": [
        "errors.js"
      ],
      "names": [
        "UNKNOWN_ERROR",
        "BaseError",
        "Error",
        "constructor",
        "code",
        "message",
        "previousError",
        "captureStackTrace",
        "name",
        "previous",
        "FAILURE",
        "CARD_NOT_CONNECTED",
        "OPERATION_FAILED",
        "TransmitError",
        "ControlError",
        "ReadError",
        "WriteError",
        "LoadAuthenticationKeyError",
        "AuthenticationError",
        "ConnectError",
        "DisconnectError",
        "GetUIDError"
      ],
      "mappings": "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",
      "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/",
      "sourcesContent": [
        "\"use strict\";\n\n\nexport const UNKNOWN_ERROR = 'unknown_error';\n\nexport class BaseError extends Error {\n\n\tconstructor(code, message, previousError) {\n\n\t\tsuper(message);\n\n\t\tError.captureStackTrace(this, this.constructor);\n\n\t\tthis.name = 'BaseError';\n\n\t\tif (!message && previousError) {\n\t\t\tthis.message = previousError.message;\n\t\t}\n\n\t\tthis.code = code;\n\n\t\tif (previousError) {\n\t\t\tthis.previous = previousError;\n\t\t}\n\n\t}\n\n}\n\nexport const FAILURE = 'failure';\nexport const CARD_NOT_CONNECTED = 'card_not_connected';\nexport const OPERATION_FAILED = 'operation_failed';\n\nexport class TransmitError extends BaseError {\n\n\tconstructor(code, message, previousError) {\n\n\t\tsuper(code, message, previousError);\n\n\t\tthis.name = 'TransmitError';\n\n\t}\n\n}\n\nexport class ControlError extends BaseError {\n\n\tconstructor(code, message, previousError) {\n\n\t\tsuper(code, message, previousError);\n\n\t\tthis.name = 'ControlError';\n\n\t}\n\n}\n\nexport class ReadError extends BaseError {\n\n\tconstructor(code, message, previousError) {\n\n\t\tsuper(code, message, previousError);\n\n\t\tthis.name = 'ReadError';\n\n\t}\n\n}\n\nexport class WriteError extends BaseError {\n\n\tconstructor(code, message, previousError) {\n\n\t\tsuper(code, message, previousError);\n\n\t\tthis.name = 'WriteError';\n\n\t}\n\n}\n\nexport class LoadAuthenticationKeyError extends BaseError {\n\n\tconstructor(code, message, previousError) {\n\n\t\tsuper(code, message, previousError);\n\n\t\tthis.name = 'LoadAuthenticationKeyError';\n\n\t}\n\n}\n\nexport class AuthenticationError extends BaseError {\n\n\tconstructor(code, message, previousError) {\n\n\t\tsuper(code, message, previousError);\n\n\t\tthis.name = 'AuthenticationError';\n\n\t}\n\n}\n\nexport class ConnectError extends BaseError {\n\n\tconstructor(code, message, previousError) {\n\n\t\tsuper(code, message, previousError);\n\n\t\tthis.name = 'ConnectError';\n\n\t}\n\n}\n\nexport class DisconnectError extends BaseError {\n\n\tconstructor(code, message, previousError) {\n\n\t\tsuper(code, message, previousError);\n\n\t\tthis.name = 'DisconnectError';\n\n\t}\n\n}\n\nexport class GetUIDError extends BaseError {\n\n\tconstructor(code, message, previousError) {\n\n\t\tsuper(code, message, previousError);\n\n\t\tthis.name = 'GetUIDError';\n\n\t}\n\n}\n"
      ]
    },
    "sourceType": "script",
    "mtime": 1662229648500
  },
  "{\"sourceRoot\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc\",\"filename\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/ACR122Reader.js\",\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{}},{\"key\":\"proposal-class-properties\",\"visitor\":{\"PrivateName\":{\"enter\":[null]},\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{}}],\"presets\":[]}:7.12.17": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/",
      "caller": {
        "name": "@babel/register"
      },
      "cwd": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc",
      "filename": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/ACR122Reader.js",
      "cloneInputAst": true,
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {}
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {}
        },
        {
          "key": "proposal-class-properties",
          "visitor": {
            "PrivateName": {
              "enter": [
                null
              ]
            },
            "ExportDefaultDeclaration": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true,
            "ClassExpression": {
              "enter": [
                null
              ]
            },
            "ClassDeclaration": {
              "enter": [
                null
              ]
            }
          },
          "options": {}
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/ACR122Reader.js",
        "plugins": [
          "objectRestSpread",
          "classProperties",
          "classPrivateProperties"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/ACR122Reader.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/",
        "sourceFileName": "ACR122Reader.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _Reader = _interopRequireDefault(require(\"./Reader\"));\n\nvar _errors = require(\"./errors\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nclass ACR122Reader extends _Reader.default {\n  async inAutoPoll() {\n    const payload = [0xD4, 0x60, 0xFF, // PollNr (0xFF = Endless polling)\n    0x01, // Period (0x01 – 0x0F) indicates the polling period in units of 150 ms\n    0x00 // Type 1 0x00 = Generic passive 106 kbps (ISO/IEC14443-4A, Mifare and DEP)\n    ]; // CMD: Direct Transmit (to inner PN532 chip InAutoPoll CMD)\n\n    const packet = Buffer.from([0xff, // Class\n    0x00, // INS\n    0x00, // P1\n    0x00, // P2\n    payload.length, // Lc: Number of Bytes to send (Maximum 255 bytes)\n    ...payload]);\n    console.log(packet);\n    let response = null;\n\n    try {\n      response = await this.control(packet, 2);\n      this.logger.debug('response received', response); // Red OFF Green OFF  0x00\n      // Red ON  Green OFF  0x01\n      // Red OFF Green ON   0x02\n      // Red ON  Green ON   0x03\n\n      console.log(response.slice(1));\n    } catch (err) {\n      throw err;\n    } // const statusCode = response.readUInt16BE(0);\n    //\n    // if (statusCode !== 0x9000) {\n    // \t//throw new LoadAuthenticationKeyError(OPERATION_FAILED, `Load authentication key operation failed: Status code: ${statusCode}`);\n    // }\n\n  }\n\n  async led(led, blinking) {\n    // P2: LED State Control (1 byte = 8 bits)\n    // format:\n\n    /*\n     +-----+----------------------------------+-------------------------------------+\n     | Bit |               Item               |             Description             |\n     +-----+----------------------------------+-------------------------------------+\n     |   0 | Final Red LED State              | 1 = On; 0 = Off                     |\n     |   1 | Final Green LED State            | 1 = On; 0 = Off                     |\n     |   2 | Red LED State Mask               | 1 = Update the State; 0 = No change |\n     |   3 | Green LED State Mask             | 1 = Update the State; 0 = No change |\n     |   4 | Initial Red LED Blinking State   | 1 = On; 0 = Off                     |\n     |   5 | Initial Green LED Blinking State | 1 = On; 0 = Off                     |\n     |   6 | Red LED Blinking Mask            | 1 = Blink; 0 = Not Blink            |\n     |   7 | Green LED Blinking Mask          | 1 = Blink; 0 = Not Blink            |\n     +-----+----------------------------------+-------------------------------------+\n     */\n    //const led = 0b00001111;\n    //const led = 0x50;\n    // Data In: Blinking Duration Control (4 bytes)\n    // Byte 0: T1 Duration Initial Blinking State (Unit = 100 ms)\n    // Byte 1: T2 Duration Toggle Blinking State (Unit = 100 ms)\n    // Byte 2: Number of repetition\n    // Byte 3: Link to Buzzer\n    // - 00: The buzzer will not turn on\n    // - 01: The buzzer will turn on during the T1 Duration\n    // - 02: The buzzer will turn on during the T2 Duration\n    // - 03: The buzzer will turn on during the T1 and T2 Duration\n    // const blinking = [\n    // \t0x00,\n    // \t0x00,\n    // \t0x00,\n    // \t0x00\n    // ];\n    // CMD: Bi-Color LED and Buzzer Control\n    const packet = Buffer.from([0xff, // Class\n    0x00, // INS\n    0x40, // P1\n    led, // P2: LED State Control\n    0x04, // Lc\n    ...blinking // Data In: Blinking Duration Control (4 bytes)\n    ]);\n    console.log(packet);\n    let response = null;\n\n    try {\n      response = await this.control(packet, 2);\n      this.logger.debug('response received', response); // Red OFF Green OFF  0x00\n      // Red ON  Green OFF  0x01\n      // Red OFF Green ON   0x02\n      // Red ON  Green ON   0x03\n\n      console.log(response.slice(1));\n    } catch (err) {\n      throw err;\n    } // const statusCode = response.readUInt16BE(0);\n    //\n    // if (statusCode !== 0x9000) {\n    // \t//throw new LoadAuthenticationKeyError(OPERATION_FAILED, `Load authentication key operation failed: Status code: ${statusCode}`);\n    // }\n\n  }\n\n  async setBuzzerOutput(enabled = true) {\n    // CMD: Set Buzzer Output Enable for Card Detection\n    const packet = Buffer.from([0xff, // Class\n    0x00, // INS\n    0x52, // P1\n    enabled ? 0xff : 0x00, // P2: PollBuzzStatus\n    0x00 // Le\n    ]);\n    console.log(packet);\n    let response = null;\n\n    try {\n      response = await this.control(packet, 2);\n      this.logger.debug('response received', response);\n    } catch (err) {\n      throw err;\n    }\n\n    const statusCode = response.readUInt16BE(0);\n\n    if (statusCode !== 0x9000) {//throw new LoadAuthenticationKeyError(OPERATION_FAILED, `Load authentication key operation failed: Status code: ${statusCode}`);\n    }\n  }\n\n  async setPICC(picc) {\n    // just enable Auto ATS Generation\n    // const picc = 0b01000000;\n    // CMD: Set PICC Operating Parameter\n    const packet = Buffer.from([0xff, // Class\n    0x00, // INS\n    0x51, // P1\n    picc, // P2: New PICC Operating Parameter\n    0x00 // Le\n    ]);\n    console.log(packet);\n    let response = null;\n\n    try {\n      response = await this.control(packet, 1);\n      this.logger.debug('response received', response);\n    } catch (err) {\n      throw err;\n    } // const statusCode = response.readUInt16BE(0);\n    //\n    // if (statusCode !== 0x9000) {\n    // \t//throw new LoadAuthenticationKeyError(OPERATION_FAILED, `Load authentication key operation failed: Status code: ${statusCode}`);\n    // }\n\n  }\n\n}\n\nvar _default = ACR122Reader;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkFDUjEyMlJlYWRlci5qcyJdLCJuYW1lcyI6WyJBQ1IxMjJSZWFkZXIiLCJSZWFkZXIiLCJpbkF1dG9Qb2xsIiwicGF5bG9hZCIsInBhY2tldCIsIkJ1ZmZlciIsImZyb20iLCJsZW5ndGgiLCJjb25zb2xlIiwibG9nIiwicmVzcG9uc2UiLCJjb250cm9sIiwibG9nZ2VyIiwiZGVidWciLCJzbGljZSIsImVyciIsImxlZCIsImJsaW5raW5nIiwic2V0QnV6emVyT3V0cHV0IiwiZW5hYmxlZCIsInN0YXR1c0NvZGUiLCJyZWFkVUludDE2QkUiLCJzZXRQSUNDIiwicGljYyJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7QUFFQTs7QUFDQTs7OztBQWlCQSxNQUFNQSxZQUFOLFNBQTJCQyxlQUEzQixDQUFrQztBQUVqQixRQUFWQyxVQUFVLEdBQUc7QUFFbEIsVUFBTUMsT0FBTyxHQUFHLENBQ2YsSUFEZSxFQUVmLElBRmUsRUFHZixJQUhlLEVBR1Q7QUFDTixRQUplLEVBSVQ7QUFDTixRQUxlLENBS1Q7QUFMUyxLQUFoQixDQUZrQixDQVVsQjs7QUFDQSxVQUFNQyxNQUFNLEdBQUdDLE1BQU0sQ0FBQ0MsSUFBUCxDQUFZLENBQzFCLElBRDBCLEVBQ3BCO0FBQ04sUUFGMEIsRUFFcEI7QUFDTixRQUgwQixFQUdwQjtBQUNOLFFBSjBCLEVBSXBCO0FBQ05ILElBQUFBLE9BQU8sQ0FBQ0ksTUFMa0IsRUFLVjtBQUNoQixPQUFHSixPQU51QixDQUFaLENBQWY7QUFTQUssSUFBQUEsT0FBTyxDQUFDQyxHQUFSLENBQVlMLE1BQVo7QUFFQSxRQUFJTSxRQUFRLEdBQUcsSUFBZjs7QUFFQSxRQUFJO0FBRUhBLE1BQUFBLFFBQVEsR0FBRyxNQUFNLEtBQUtDLE9BQUwsQ0FBYVAsTUFBYixFQUFxQixDQUFyQixDQUFqQjtBQUVBLFdBQUtRLE1BQUwsQ0FBWUMsS0FBWixDQUFrQixtQkFBbEIsRUFBdUNILFFBQXZDLEVBSkcsQ0FNSDtBQUNBO0FBQ0E7QUFDQTs7QUFFQUYs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QU0sS0FBS0MsT0FBTCxDQUFhUCxNQUFiLEVBQXFCLENBQXJCLENBQWpCO0FBRUEsV0FBS1EsTUFBTCxDQUFZQyxLQUFaLENBQWtCLG1CQUFsQixFQUF1Q0gsUUFBdkM7QUFHQSxLQVBELENBT0UsT0FBT0ssR0FBUCxFQUFZO0FBRWIsWUFBTUEsR0FBTjtBQUVBLEtBN0JrQixDQStCbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFsTmdDOztlQXNObkJmLFkiLCJzb3VyY2VSb290IjoiL1VzZXJzL2hhcnJ5aG93L0RvY3VtZW50cy8yMDIyL1BST0pFQ1RfTU9DQV9BUlQvTkZDL25mYy1wY3NjL3NyYy8iLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxuaW1wb3J0IFJlYWRlciBmcm9tICcuL1JlYWRlcic7XG5pbXBvcnQge1xuXHRDb25uZWN0RXJyb3IsXG5cdERpc2Nvbm5lY3RFcnJvcixcblx0VHJhbnNtaXRFcnJvcixcblx0Q29udHJvbEVycm9yLFxuXHRBdXRoZW50aWNhdGlvbkVycm9yLFxuXHRMb2FkQXV0aGVudGljYXRpb25LZXlFcnJvcixcblx0UmVhZEVycm9yLFxuXHRXcml0ZUVycm9yLFxuXHRHZXRVSURFcnJvcixcblx0Q0FSRF9OT1RfQ09OTkVDVEVELFxuXHRPUEVSQVRJT05fRkFJTEVELFxuXHRVTktOT1dOX0VSUk9SLFxuXHRGQUlMVVJFLFxufSBmcm9tICcuL2Vycm9ycyc7XG5cblxuY2xhc3MgQUNSMTIyUmVhZGVyIGV4dGVuZHMgUmVhZGVyIHtcblxuXHRhc3luYyBpbkF1dG9Qb2xsKCkge1xuXG5cdFx0Y29uc3QgcGF5bG9hZCA9IFtcblx0XHRcdDB4RDQsXG5cdFx0XHQweDYwLFxuXHRcdFx0MHhGRiwgLy8gUG9sbE5yICgweEZGID0gRW5kbGVzcyBwb2xsaW5nKVxuXHRcdFx0MHgwMSwgLy8gUGVyaW9kICgweDAxIOKAkyAweDBGKSBpbmRpY2F0ZXMgdGhlIHBvbGxpbmcgcGVyaW9kIGluIHVuaXRzIG9mIDE1MCBtc1xuXHRcdFx0MHgwMCwgLy8gVHlwZSAxIDB4MDAgPSBHZW5lcmljIHBhc3NpdmUgMTA2IGticHMgKElTTy9JRUMxNDQ0My00QSwgTWlmYXJlIGFuZCBERVApXG5cdFx0XTtcblxuXHRcdC8vIENNRDogRGlyZWN0IFRyYW5zbWl0ICh0byBpbm5lciBQTjUzMiBjaGlwIEluQXV0b1BvbGwgQ01EKVxuXHRcdGNvbnN0IHBhY2tldCA9IEJ1ZmZlci5mcm9tKFtcblx0XHRcdDB4ZmYsIC8vIENsYXNzXG5cdFx0XHQweDAwLCAvLyBJTlNcblx0XHRcdDB4MDAsIC8vIFAxXG5cdFx0XHQweDAwLCAvLyBQMlxuXHRcdFx0cGF5bG9hZC5sZW5ndGgsIC8vIExjOiBOdW1iZXIgb2YgQnl0ZXMgdG8gc2VuZCAoTWF4aW11bSAyNTUgYnl0ZXMpXG5cdFx0XHQuLi5wYXlsb2FkLFxuXHRcdF0pO1xuXG5cdFx0Y29uc29sZS5sb2cocGFja2V0KTtcblxuXHRcdGxldCByZXNwb25zZSA9IG51bGw7XG5cblx0XHR0cnkge1xuXG5cdFx0XHRyZXNwb25zZSA9IGF3YWl0IHRoaXMuY29udHJvbChwYWNrZXQsIDIpO1xuXG5cdFx0XHR0aGlzLmxvZ2dlci5kZWJ1ZygncmVzcG9uc2UgcmVjZWl2ZWQnLCByZXNwb25zZSk7XG5cblx0XHRcdC8vIFJlZCBPRkYgR3JlZW4gT0ZGICAweDAwXG5cdFx0XHQvLyBSZWQgT04gIEdyZWVuIE9GRiAgMHgwMVxuXHRcdFx0Ly8gUmVkIE9GRiBHcmVlbiBPTiAgIDB4MDJcblx0XHRcdC8vIFJlZCBPTiAgR3JlZW4gT04gICAweDAzXG5cblx0XHRcdGNvbnNvbGUubG9nKHJlc3BvbnNlLnNsaWNlKDEpKTtcblxuXG5cdFx0fSBjYXRjaCAoZXJyKSB7XG5cblx0XHRcdHRocm93IGVycjtcblxuXHRcdH1cblxuXHRcdC8vIGNvbnN0IHN0YXR1c0NvZGUgPSByZXNwb25zZS5yZWFkVUludDE2QkUoMCk7XG5cdFx0Ly9cblx0XHQvLyBpZiAoc3RhdHVzQ29kZSAhPT0gMHg5MDAwKSB7XG5cdFx0Ly8gXHQvL3Rocm93IG5ldyBMb2FkQXV0aGVudGljYXRpb25LZXlFcnJvcihPUEVSQVRJT05fRkFJTEVELCBgTG9hZCBhdXRoZW50aWNhdGlvbiBrZXkgb3BlcmF0aW9uIGZhaWxlZDogU3RhdHVzIGNvZGU6ICR7c3RhdHVzQ29kZX1gKTtcblx0XHQvLyB9XG5cblx0fVxuXG5cdGFzeW5jIGxlZChsZWQsIGJsaW5raW5nKSB7XG5cblx0XHQvLyBQMjogTEVEIFN0YXRlIENvbnRyb2wgKDEgYnl0ZSA9IDggYml0cylcblx0XHQvLyBmb3JtYXQ6XG5cdFx0Lypcblx0XHQgKy0tLS0tKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLStcblx0XHQgfCBCaXQgfCAgICAgICAgICAgICAgIEl0ZW0gICAgICAgICAgICAgICB8ICAgICAgICAgICAgIERlc2NyaXB0aW9uICAgICAgICAgICAgIHxcblx0XHQgKy0tLS0tKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLStcblx0XHQgfCAgIDAgfCBGaW5hbCBSZWQgTEVEIFN0YXRlICAgICAgICAgICAgICB8IDEgPSBPbjsgMCA9IE9mZiAgICAgICAgICAgICAgICAgICAgIHxcblx0XHQgfCAgIDEgfCBGaW5hbCBHcmVlbiBMRUQgU3RhdGUgICAgICAgICAgICB8IDEgPSBPbjsgMCA9IE9mZiAgICAgICAgICAgICAgICAgICAgIHxcblx0XHQgfCAgIDIgfCBSZWQgTEVEIFN0YXRlIE1hc2sgICAgICAgICAgICAgICB8IDEgPSBVcGRhdGUgdGhlIFN0YXRlOyAwID0gTm8gY2hhbmdlIHxcblx0XHQgfCAgIDMgfCBHcmVlbiBMRUQgU3RhdGUgTWFzayAgICAgICAgICAgICB8IDEgPSBVcGRhdGUgdGhlIFN0YXRlOyAwID0gTm8gY2hhbmdlIHxcblx0XHQgfCAgIDQgfCBJbml0aWFsIFJlZCBMRUQgQmxpbmtpbmcgU3RhdGUgICB8IDEgPSBPbjsgMCA9IE9mZiAgICAgICAgICAgICAgICAgICAgIHxcblx0XHQgfCAgIDUgfCBJbml0aWFsIEdyZWVuIExFRCBCbGlua2luZyBTdGF0ZSB8IDEgPSBPbjsgMCA9IE9mZiAgICAgICAgICAgICAgICAgICAgIHxcblx0XHQgfCAgIDYgfCBSZWQgTEVEIEJsaW5raW5nIE1hc2sgICAgICAgICAgICB8IDEgPSBCbGluazsgMCA9IE5vdCBCbGluayAgICAgICAgICAgIHxcblx0XHQgfCAgIDcgfCBHcmVlbiBMRUQgQmxpbmtpbmcgTWFzayAgICAgICAgICB8IDEgPSBCbGluazsgMCA9IE5vdCBCbGluayAgICAgICAgICAgIHxcblx0XHQgKy0tLS0tKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLStcblx0XHQgKi9cblxuXHRcdC8vY29uc3QgbGVkID0gMGIwMDAwMTExMTtcblx0XHQvL2NvbnN0IGxlZCA9IDB4NTA7XG5cblx0XHQvLyBEYXRhIEluOiBCbGlua2luZyBEdXJhdGlvbiBDb250cm9sICg0IGJ5dGVzKVxuXHRcdC8vIEJ5dGUgMDogVDEgRHVyYXRpb24gSW5pdGlhbCBCbGlua2luZyBTdGF0ZSAoVW5pdCA9IDEwMCBtcylcblx0XHQvLyBCeXRlIDE6IFQyIER1cmF0aW9uIFRvZ2dsZSBCbGlua2luZyBTdGF0ZSAoVW5pdCA9IDEwMCBtcylcblx0XHQvLyBCeXRlIDI6IE51bWJlciBvZiByZXBldGl0aW9uXG5cdFx0Ly8gQnl0ZSAzOiBMaW5rIHRvIEJ1enplclxuXHRcdC8vIC0gMDA6IFRoZSBidXp6ZXIgd2lsbCBub3QgdHVybiBvblxuXHRcdC8vIC0gMDE6IFRoZSBidXp6ZXIgd2lsbCB0dXJuIG9uIGR1cmluZyB0aGUgVDEgRHVyYXRpb25cblx0XHQvLyAtIDAyOiBUaGUgYnV6emVyIHdpbGwgdHVybiBvbiBkdXJpbmcgdGhlIFQyIER1cmF0aW9uXG5cdFx0Ly8gLSAwMzogVGhlIGJ1enplciB3aWxsIHR1cm4gb24gZHVyaW5nIHRoZSBUMSBhbmQgVDIgRHVyYXRpb25cblxuXHRcdC8vIGNvbnN0IGJsaW5raW5nID0gW1xuXHRcdC8vIFx0MHgwMCxcblx0XHQvLyBcdDB4MDAsXG5cdFx0Ly8gXHQweDAwLFxuXHRcdC8vIFx0MHgwMFxuXHRcdC8vIF07XG5cblxuXHRcdC8vIENNRDogQmktQ29sb3IgTEVEIGFuZCBCdXp6ZXIgQ29udHJvbFxuXHRcdGNvbnN0IHBhY2tldCA9IEJ1ZmZlci5mcm9tKFtcblx0XHRcdDB4ZmYsIC8vIENsYXNzXG5cdFx0XHQweDAwLCAvLyBJTlNcblx0XHRcdDB4NDAsIC8vIFAxXG5cdFx0XHRsZWQsIC8vIFAyOiBMRUQgU3RhdGUgQ29udHJvbFxuXHRcdFx0MHgwNCwgLy8gTGNcblx0XHRcdC4uLmJsaW5raW5nLCAvLyBEYXRhIEluOiBCbGlua2luZyBEdXJhdGlvbiBDb250cm9sICg0IGJ5dGVzKVxuXHRcdF0pO1xuXG5cdFx0Y29uc29sZS5sb2cocGFja2V0KTtcblxuXHRcdGxldCByZXNwb25zZSA9IG51bGw7XG5cblx0XHR0cnkge1xuXG5cdFx0XHRyZXNwb25zZSA9IGF3YWl0IHRoaXMuY29udHJvbChwYWNrZXQsIDIpO1xuXG5cdFx0XHR0aGlzLmxvZ2dlci5kZWJ1ZygncmVzcG9uc2UgcmVjZWl2ZWQnLCByZXNwb25zZSk7XG5cblx0XHRcdC8vIFJlZCBPRkYgR3JlZW4gT0ZGICAweDAwXG5cdFx0XHQvLyBSZWQgT04gIEdyZWVuIE9GRiAgMHgwMVxuXHRcdFx0Ly8gUmVkIE9GRiBHcmVlbiBPTiAgIDB4MDJcblx0XHRcdC8vIFJlZCBPTiAgR3JlZW4gT04gICAweDAzXG5cblx0XHRcdGNvbnNvbGUubG9nKHJlc3BvbnNlLnNsaWNlKDEpKTtcblxuXG5cdFx0fSBjYXRjaCAoZXJyKSB7XG5cblx0XHRcdHRocm93IGVycjtcblxuXHRcdH1cblxuXHRcdC8vIGNvbnN0IHN0YXR1c0NvZGUgPSByZXNwb25zZS5yZWFkVUludDE2QkUoMCk7XG5cdFx0Ly9cblx0XHQvLyBpZiAoc3RhdHVzQ29kZSAhPT0gMHg5MDAwKSB7XG5cdFx0Ly8gXHQvL3Rocm93IG5ldyBMb2FkQXV0aGVudGljYXRpb25LZXlFcnJvcihPUEVSQVRJT05fRkFJTEVELCBgTG9hZCBhdXRoZW50aWNhdGlvbiBrZXkgb3BlcmF0aW9uIGZhaWxlZDogU3RhdHVzIGNvZGU6ICR7c3RhdHVzQ29kZX1gKTtcblx0XHQvLyB9XG5cblx0fVxuXG5cdGFzeW5jIHNldEJ1enplck91dHB1dChlbmFibGVkID0gdHJ1ZSkge1xuXG5cblx0XHQvLyBDTUQ6IFNldCBCdXp6ZXIgT3V0cHV0IEVuYWJsZSBmb3IgQ2FyZCBEZXRlY3Rpb25cblx0XHRjb25zdCBwYWNrZXQgPSBCdWZmZXIuZnJvbShbXG5cdFx0XHQweGZmLCAvLyBDbGFzc1xuXHRcdFx0MHgwMCwgLy8gSU5TXG5cdFx0XHQweDUyLCAvLyBQMVxuXHRcdFx0ZW5hYmxlZCA/IDB4ZmYgOiAweDAwLCAvLyBQMjogUG9sbEJ1enpTdGF0dXNcblx0XHRcdDB4MDAsIC8vIExlXG5cdFx0XSk7XG5cblx0XHRjb25zb2xlLmxvZyhwYWNrZXQpO1xuXG5cdFx0bGV0IHJlc3BvbnNlID0gbnVsbDtcblxuXHRcdHRyeSB7XG5cblx0XHRcdHJlc3BvbnNlID0gYXdhaXQgdGhpcy5jb250cm9sKHBhY2tldCwgMik7XG5cblx0XHRcdHRoaXMubG9nZ2VyLmRlYnVnKCdyZXNwb25zZSByZWNlaXZlZCcsIHJlc3BvbnNlKTtcblxuXG5cdFx0fSBjYXRjaCAoZXJyKSB7XG5cblx0XHRcdHRocm93IGVycjtcblxuXHRcdH1cblxuXHRcdGNvbnN0IHN0YXR1c0NvZGUgPSByZXNwb25zZS5yZWFkVUludDE2QkUoMCk7XG5cblx0XHRpZiAoc3RhdHVzQ29kZSAhPT0gMHg5MDAwKSB7XG5cdFx0XHQvL3Rocm93IG5ldyBMb2FkQXV0aGVudGljYXRpb25LZXlFcnJvcihPUEVSQVRJT05fRkFJTEVELCBgTG9hZCBhdXRoZW50aWNhdGlvbiBrZXkgb3BlcmF0aW9uIGZhaWxlZDogU3RhdHVzIGNvZGU6ICR7c3RhdHVzQ29kZX1gKTtcblx0XHR9XG5cblx0fVxuXG5cdGFzeW5jIHNldFBJQ0MocGljYykge1xuXG5cdFx0Ly8ganVzdCBlbmFibGUgQXV0byBBVFMgR2VuZXJhdGlvblxuXHRcdC8vIGNvbnN0IHBpY2MgPSAwYjAxMDAwMDAwO1xuXG5cdFx0Ly8gQ01EOiBTZXQgUElDQyBPcGVyYXRpbmcgUGFyYW1ldGVyXG5cdFx0Y29uc3QgcGFja2V0ID0gQnVmZmVyLmZyb20oW1xuXHRcdFx0MHhmZiwgLy8gQ2xhc3Ncblx0XHRcdDB4MDAsIC8vIElOU1xuXHRcdFx0MHg1MSwgLy8gUDFcblx0XHRcdHBpY2MsIC8vIFAyOiBOZXcgUElDQyBPcGVyYXRpbmcgUGFyYW1ldGVyXG5cdFx0XHQweDAwLCAvLyBMZVxuXHRcdF0pO1xuXG5cdFx0Y29uc29sZS5sb2cocGFja2V0KTtcblxuXHRcdGxldCByZXNwb25zZSA9IG51bGw7XG5cblx0XHR0cnkge1xuXG5cdFx0XHRyZXNwb25zZSA9IGF3YWl0IHRoaXMuY29udHJvbChwYWNrZXQsIDEpO1xuXG5cdFx0XHR0aGlzLmxvZ2dlci5kZWJ1ZygncmVzcG9uc2UgcmVjZWl2ZWQnLCByZXNwb25zZSk7XG5cblxuXHRcdH0gY2F0Y2ggKGVycikge1xuXG5cdFx0XHR0aHJvdyBlcnI7XG5cblx0XHR9XG5cblx0XHQvLyBjb25zdCBzdGF0dXNDb2RlID0gcmVzcG9uc2UucmVhZFVJbnQxNkJFKDApO1xuXHRcdC8vXG5cdFx0Ly8gaWYgKHN0YXR1c0NvZGUgIT09IDB4OTAwMCkge1xuXHRcdC8vIFx0Ly90aHJvdyBuZXcgTG9hZEF1dGhlbnRpY2F0aW9uS2V5RXJyb3IoT1BFUkFUSU9OX0ZBSUxFRCwgYExvYWQgYXV0aGVudGljYXRpb24ga2V5IG9wZXJhdGlvbiBmYWlsZWQ6IFN0YXR1cyBjb2RlOiAke3N0YXR1c0NvZGV9YCk7XG5cdFx0Ly8gfVxuXG5cdH1cblxufVxuXG5leHBvcnQgZGVmYXVsdCBBQ1IxMjJSZWFkZXI7XG4iXX0=",
    "map": {
      "version": 3,
      "sources": [
        "ACR122Reader.js"
      ],
      "names": [
        "ACR122Reader",
        "Reader",
        "inAutoPoll",
        "payload",
        "packet",
        "Buffer",
        "from",
        "length",
        "console",
        "log",
        "response",
        "control",
        "logger",
        "debug",
        "slice",
        "err",
        "led",
        "blinking",
        "setBuzzerOutput",
        "enabled",
        "statusCode",
        "readUInt16BE",
        "setPICC",
        "picc"
      ],
      "mappings": "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",
      "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/",
      "sourcesContent": [
        "\"use strict\";\n\nimport Reader from './Reader';\nimport {\n\tConnectError,\n\tDisconnectError,\n\tTransmitError,\n\tControlError,\n\tAuthenticationError,\n\tLoadAuthenticationKeyError,\n\tReadError,\n\tWriteError,\n\tGetUIDError,\n\tCARD_NOT_CONNECTED,\n\tOPERATION_FAILED,\n\tUNKNOWN_ERROR,\n\tFAILURE,\n} from './errors';\n\n\nclass ACR122Reader extends Reader {\n\n\tasync inAutoPoll() {\n\n\t\tconst payload = [\n\t\t\t0xD4,\n\t\t\t0x60,\n\t\t\t0xFF, // PollNr (0xFF = Endless polling)\n\t\t\t0x01, // Period (0x01 – 0x0F) indicates the polling period in units of 150 ms\n\t\t\t0x00, // Type 1 0x00 = Generic passive 106 kbps (ISO/IEC14443-4A, Mifare and DEP)\n\t\t];\n\n\t\t// CMD: Direct Transmit (to inner PN532 chip InAutoPoll CMD)\n\t\tconst packet = Buffer.from([\n\t\t\t0xff, // Class\n\t\t\t0x00, // INS\n\t\t\t0x00, // P1\n\t\t\t0x00, // P2\n\t\t\tpayload.length, // Lc: Number of Bytes to send (Maximum 255 bytes)\n\t\t\t...payload,\n\t\t]);\n\n\t\tconsole.log(packet);\n\n\t\tlet response = null;\n\n\t\ttry {\n\n\t\t\tresponse = await this.control(packet, 2);\n\n\t\t\tthis.logger.debug('response received', response);\n\n\t\t\t// Red OFF Green OFF  0x00\n\t\t\t// Red ON  Green OFF  0x01\n\t\t\t// Red OFF Green ON   0x02\n\t\t\t// Red ON  Green ON   0x03\n\n\t\t\tconsole.log(response.slice(1));\n\n\n\t\t} catch (err) {\n\n\t\t\tthrow err;\n\n\t\t}\n\n\t\t// const statusCode = response.readUInt16BE(0);\n\t\t//\n\t\t// if (statusCode !== 0x9000) {\n\t\t// \t//throw new LoadAuthenticationKeyError(OPERATION_FAILED, `Load authentication key operation failed: Status code: ${statusCode}`);\n\t\t// }\n\n\t}\n\n\tasync led(led, blinking) {\n\n\t\t// P2: LED State Control (1 byte = 8 bits)\n\t\t// format:\n\t\t/*\n\t\t +-----+----------------------------------+-------------------------------------+\n\t\t | Bit |               Item               |             Description             |\n\t\t +-----+----------------------------------+-------------------------------------+\n\t\t |   0 | Final Red LED State              | 1 = On; 0 = Off                     |\n\t\t |   1 | Final Green LED State            | 1 = On; 0 = Off                     |\n\t\t |   2 | Red LED State Mask               | 1 = Update the State; 0 = No change |\n\t\t |   3 | Green LED State Mask             | 1 = Update the State; 0 = No change |\n\t\t |   4 | Initial Red LED Blinking State   | 1 = On; 0 = Off                     |\n\t\t |   5 | Initial Green LED Blinking State | 1 = On; 0 = Off                     |\n\t\t |   6 | Red LED Blinking Mask            | 1 = Blink; 0 = Not Blink            |\n\t\t |   7 | Green LED Blinking Mask          | 1 = Blink; 0 = Not Blink            |\n\t\t +-----+----------------------------------+-------------------------------------+\n\t\t */\n\n\t\t//const led = 0b00001111;\n\t\t//const led = 0x50;\n\n\t\t// Data In: Blinking Duration Control (4 bytes)\n\t\t// Byte 0: T1 Duration Initial Blinking State (Unit = 100 ms)\n\t\t// Byte 1: T2 Duration Toggle Blinking State (Unit = 100 ms)\n\t\t// Byte 2: Number of repetition\n\t\t// Byte 3: Link to Buzzer\n\t\t// - 00: The buzzer will not turn on\n\t\t// - 01: The buzzer will turn on during the T1 Duration\n\t\t// - 02: The buzzer will turn on during the T2 Duration\n\t\t// - 03: The buzzer will turn on during the T1 and T2 Duration\n\n\t\t// const blinking = [\n\t\t// \t0x00,\n\t\t// \t0x00,\n\t\t// \t0x00,\n\t\t// \t0x00\n\t\t// ];\n\n\n\t\t// CMD: Bi-Color LED and Buzzer Control\n\t\tconst packet = Buffer.from([\n\t\t\t0xff, // Class\n\t\t\t0x00, // INS\n\t\t\t0x40, // P1\n\t\t\tled, // P2: LED State Control\n\t\t\t0x04, // Lc\n\t\t\t...blinking, // Data In: Blinking Duration Control (4 bytes)\n\t\t]);\n\n\t\tconsole.log(packet);\n\n\t\tlet response = null;\n\n\t\ttry {\n\n\t\t\tresponse = await this.control(packet, 2);\n\n\t\t\tthis.logger.debug('response received', response);\n\n\t\t\t// Red OFF Green OFF  0x00\n\t\t\t// Red ON  Green OFF  0x01\n\t\t\t// Red OFF Green ON   0x02\n\t\t\t// Red ON  Green ON   0x03\n\n\t\t\tconsole.log(response.slice(1));\n\n\n\t\t} catch (err) {\n\n\t\t\tthrow err;\n\n\t\t}\n\n\t\t// const statusCode = response.readUInt16BE(0);\n\t\t//\n\t\t// if (statusCode !== 0x9000) {\n\t\t// \t//throw new LoadAuthenticationKeyError(OPERATION_FAILED, `Load authentication key operation failed: Status code: ${statusCode}`);\n\t\t// }\n\n\t}\n\n\tasync setBuzzerOutput(enabled = true) {\n\n\n\t\t// CMD: Set Buzzer Output Enable for Card Detection\n\t\tconst packet = Buffer.from([\n\t\t\t0xff, // Class\n\t\t\t0x00, // INS\n\t\t\t0x52, // P1\n\t\t\tenabled ? 0xff : 0x00, // P2: PollBuzzStatus\n\t\t\t0x00, // Le\n\t\t]);\n\n\t\tconsole.log(packet);\n\n\t\tlet response = null;\n\n\t\ttry {\n\n\t\t\tresponse = await this.control(packet, 2);\n\n\t\t\tthis.logger.debug('response received', response);\n\n\n\t\t} catch (err) {\n\n\t\t\tthrow err;\n\n\t\t}\n\n\t\tconst statusCode = response.readUInt16BE(0);\n\n\t\tif (statusCode !== 0x9000) {\n\t\t\t//throw new LoadAuthenticationKeyError(OPERATION_FAILED, `Load authentication key operation failed: Status code: ${statusCode}`);\n\t\t}\n\n\t}\n\n\tasync setPICC(picc) {\n\n\t\t// just enable Auto ATS Generation\n\t\t// const picc = 0b01000000;\n\n\t\t// CMD: Set PICC Operating Parameter\n\t\tconst packet = Buffer.from([\n\t\t\t0xff, // Class\n\t\t\t0x00, // INS\n\t\t\t0x51, // P1\n\t\t\tpicc, // P2: New PICC Operating Parameter\n\t\t\t0x00, // Le\n\t\t]);\n\n\t\tconsole.log(packet);\n\n\t\tlet response = null;\n\n\t\ttry {\n\n\t\t\tresponse = await this.control(packet, 1);\n\n\t\t\tthis.logger.debug('response received', response);\n\n\n\t\t} catch (err) {\n\n\t\t\tthrow err;\n\n\t\t}\n\n\t\t// const statusCode = response.readUInt16BE(0);\n\t\t//\n\t\t// if (statusCode !== 0x9000) {\n\t\t// \t//throw new LoadAuthenticationKeyError(OPERATION_FAILED, `Load authentication key operation failed: Status code: ${statusCode}`);\n\t\t// }\n\n\t}\n\n}\n\nexport default ACR122Reader;\n"
      ]
    },
    "sourceType": "script",
    "mtime": 1662229648499
  },
  "{\"sourceRoot\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc\",\"filename\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/pretty-logger.js\",\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{}},{\"key\":\"proposal-class-properties\",\"visitor\":{\"PrivateName\":{\"enter\":[null]},\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{}}],\"presets\":[]}:7.12.17": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/",
      "caller": {
        "name": "@babel/register"
      },
      "cwd": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc",
      "filename": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/pretty-logger.js",
      "cloneInputAst": true,
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {}
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {}
        },
        {
          "key": "proposal-class-properties",
          "visitor": {
            "PrivateName": {
              "enter": [
                null
              ]
            },
            "ExportDefaultDeclaration": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true,
            "ClassExpression": {
              "enter": [
                null
              ]
            },
            "ClassDeclaration": {
              "enter": [
                null
              ]
            }
          },
          "options": {}
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/pretty-logger.js",
        "plugins": [
          "objectRestSpread",
          "classProperties",
          "classPrivateProperties"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/pretty-logger.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/",
        "sourceFileName": "pretty-logger.js"
      }
    },
    "ast": null,
    "code": "\"use strict\"; // pretty-logger for debugging\n// uses great winston logger library, visit https://github.com/winstonjs/winston\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _util = _interopRequireDefault(require(\"util\"));\n\nvar _chalk = _interopRequireDefault(require(\"chalk\"));\n\nvar _winston = _interopRequireDefault(require(\"winston\"));\n\nvar _tripleBeam = require(\"triple-beam\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nconst colors = {\n  exception: 'red',\n  error: 'red',\n  warn: 'yellow',\n  info: 'green',\n  verbose: 'blue',\n  debug: 'blue',\n  silly: 'gray'\n};\n\n_winston.default.addColors(colors); // we could use instanceof but to avoid import we simply check obj structure\n\n\nconst isReader = obj => typeof obj === 'object' && obj.reader && obj.name;\n\nconst printf = _winston.default.format.printf(({\n  timestamp,\n  level,\n  message,\n  [_tripleBeam.SPLAT]: splat\n}) => {\n  let splatString = '';\n  let reader = '';\n\n  if (splat) {\n    let readerObj = splat.find(isReader);\n\n    if (readerObj) {\n      reader = _chalk.default.cyan(readerObj.name) + ' ';\n      splat = splat.filter(obj => !isReader(obj));\n    }\n\n    if (splat.length > 1) {\n      splatString = ' ' + _util.default.inspect(splat, {\n        colors: true\n      });\n    } else if (splat.length > 0) {\n      splatString = ' ' + _util.default.inspect(splat[0], {\n        colors: true\n      });\n    }\n  } // see https://stackoverflow.com/questions/10729276/how-can-i-get-the-full-object-in-node-jss-console-log-rather-than-object\n\n\n  return `${timestamp ? timestamp + ' – ' : ''}${reader}${level}: ${message}${splatString}`;\n});\n\nconst FORMAT = _winston.default.format.combine(_winston.default.format.timestamp({\n  format: () => _chalk.default.gray(new Date().toLocaleTimeString())\n}), _winston.default.format.colorize(), printf);\n\nconst logger = _winston.default.createLogger({\n  transports: [new _winston.default.transports.Console({\n    level: 'silly',\n    format: FORMAT\n  })],\n  exitOnError: true\n});\n\nvar _default = logger;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInByZXR0eS1sb2dnZXIuanMiXSwibmFtZXMiOlsiY29sb3JzIiwiZXhjZXB0aW9uIiwiZXJyb3IiLCJ3YXJuIiwiaW5mbyIsInZlcmJvc2UiLCJkZWJ1ZyIsInNpbGx5Iiwid2luc3RvbiIsImFkZENvbG9ycyIsImlzUmVhZGVyIiwib2JqIiwicmVhZGVyIiwibmFtZSIsInByaW50ZiIsImZvcm1hdCIsInRpbWVzdGFtcCIsImxldmVsIiwibWVzc2FnZSIsIlNQTEFUIiwic3BsYXQiLCJzcGxhdFN0cmluZyIsInJlYWRlck9iaiIsImZpbmQiLCJjaGFsayIsImN5YW4iLCJmaWx0ZXIiLCJsZW5ndGgiLCJ1dGlsIiwiaW5zcGVjdCIsIkZPUk1BVCIsImNvbWJpbmUiLCJncmF5IiwiRGF0ZSIsInRvTG9jYWxlVGltZVN0cmluZyIsImNvbG9yaXplIiwibG9nZ2VyIiwiY3JlYXRlTG9nZ2VyIiwidHJhbnNwb3J0cyIsIkNvbnNvbGUiLCJleGl0T25FcnJvciJdLCJtYXBwaW5ncyI6IkFBQUEsYSxDQUVBO0FBQ0E7Ozs7Ozs7QUFFQTs7QUFDQTs7QUFDQTs7QUFDQTs7OztBQUdBLE1BQU1BLE1BQU0sR0FBRztBQUNkQyxFQUFBQSxTQUFTLEVBQUUsS0FERztBQUVkQyxFQUFBQSxLQUFLLEVBQUUsS0FGTztBQUdkQyxFQUFBQSxJQUFJLEVBQUUsUUFIUTtBQUlkQyxFQUFBQSxJQUFJLEVBQUUsT0FKUTtBQUtkQyxFQUFBQSxPQUFPLEVBQUUsTUFMSztBQU1kQyxFQUFBQSxLQUFLLEVBQUUsTUFOTztBQU9kQyxFQUFBQSxLQUFLLEVBQUU7QUFQTyxDQUFmOztBQVVBQyxpQkFBUUMsU0FBUixDQUFrQlQsTUFBbEIsRSxDQUVBOzs7QUFDQSxNQUFNVSxRQUFRLEdBQUdDLEdBQUcsSUFBSSxPQUFPQSxHQUFQLEtBQWUsUUFBZixJQUEyQkEsR0FBRyxDQUFDQyxNQUEvQixJQUF5Q0QsR0FBRyxDQUFDRSxJQUFyRTs7QUFFQSxNQUFNQyxNQUFNLEdBQUdOLGlCQUFRTyxNQUFSLENBQWVELE1BQWYsQ0FBc0IsQ0FBQztBQUFFRSxFQUFBQSxTQUFGO0FBQWFDLEVBQUFBLEtBQWI7QUFBb0JDLEVBQUFBLE9BQXBCO0FBQTZCLEdBQUNDLGlCQUFELEdBQVNDO0FBQXRDLENBQUQsS0FBbUQ7QUFFdkYsTUFBSUMsV0FBVyxHQUFHLEVBQWxCO0FBRUEsTUFBSVQsTUFBTSxHQUFHLEVBQWI7O0FBRUEsTUFBSVEsS0FBSixFQUFXO0FBRVYsUUFBSUUsU0FBUyxHQUFHRixLQUFLLENBQUNHLElBQU4sQ0FBV2IsUUFBWCxDQUFoQjs7QUFFQSxRQUFJWSxTQUFKLEVBQWU7QUFDZFYsTUFBQUEsTUFBTSxHQUFHWSxlQUFNQyxJQUFOLENBQVdILFNBQVMsQ0FBQ1QsSUFBckIsSUFBNkIsR0FBdEM7QUFDQU8sTUFBQUEsS0FBSyxHQUFHQSxLQUFLLENBQUNNLE1BQU4sQ0FBYWYsR0FBRyxJQUFJLENBQUNELFFBQVEsQ0FBQ0MsR0FBRCxDQUE3QixDQUFSO0FBQ0E7O0FBRUQsUUFBSVMsS0FBSyxDQUFDTyxNQUFOLEdBQWUsQ0FBbkIsRUFBc0I7QUFDckJOLE1BQUFBLFdBQVcsR0FBRyxNQUFNTyxjQUFLQyxPQUFMLENBQWFULEtBQWIsRUFBb0I7QUFBRXBCLFFBQUFBLE1BQU0sRUFBRTtBQUFWLE9BQXBCLENBQXBCO0FBQ0EsS0FGRCxNQUdLLElBQUlvQixLQUFLLENBQUNPLE1BQU4sR0FBZSxDQUFuQixFQUFzQjtBQUMxQk4sTUFBQUEsV0FBVyxHQUFHLE1BQU1PLGNBQUtDLE9BQUwsQ0FBYVQsS0FBSyxDQUFDLENBQUQsQ0FBbEIsRUFBdUI7QUFBRXBCLFFBQUFBLE1BQU0sRUFBRTtBQUFWLE9BQXZCLENBQXBCO0FBQ0E7QUFFRCxHQXRCc0YsQ0F3QnZGOzs7QUFDQSxTQUFRLEdBQUVnQixTQUFTLEdBQUdBLFNBQVMsR0FBRyxLQUFmLEdBQXVCLEVBQUcsR0FBRUosTUFBTyxHQUFFSyxLQUFNLEtBQUlDLE9BQVEsR0FBRUcsV0FBWSxFQUF4RjtBQUVBLENBM0JjLENBQWY7O0FBNkJBLE1BQU1TLE1BQU0sR0FBR3RCLGlCQUFRTyxNQUFSLENBQWVnQixPQUFmLENBQ2R2QixpQkFBUU8sTUFBUixDQUFlQyxTQUFmLENBQXlCO0FBQ3hCRCxFQUFBQSxNQUFNLEVBQUUsTUFBTVMsZUFBTVEsSUFBTixDQUFXLElBQUlDLElBQUosR0FBV0Msa0JBQVgsRUFBWDtBQURVLENBQXpCLENBRGMsRUFJZDFCLGlCQUFRTyxNQUFSLENBQWVvQixRQUFmLEVBSmMsRUFLZHJCLE1BTGMsQ0FBZjs7QUFRQSxNQUFNc0IsTUFBTSxHQUFHNUIsaUJBQVE2QixZQUFSLENBQXFCO0FBQ25DQyxFQUFBQSxVQUFVLEVBQUUsQ0FDWCxJQUFLOUIsaUJBQVE4QixVQUFSLENBQW1CQyxPQUF4QixDQUFpQztBQUNoQ3RCLElBQUFBLEtBQUssRUFBRSxPQUR5QjtBQUVoQ0YsSUFBQUEsTUFBTSxFQUFFZTtBQUZ3QixHQUFqQyxDQURXLENBRHVCO0FBT25DVSxFQUFBQSxXQUFXLEVBQUU7QUFQc0IsQ0FBckIsQ0FBZjs7ZUFZZUosTSIsInNvdXJjZVJvb3QiOiIvVXNlcnMvaGFycnlob3cvRG9jdW1lbnRzLzIwMjIvUFJPSkVDVF9NT0NBX0FSVC9ORkMvbmZjLXBjc2MvZXhhbXBsZXMvIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbi8vIHByZXR0eS1sb2dnZXIgZm9yIGRlYnVnZ2luZ1xuLy8gdXNlcyBncmVhdCB3aW5zdG9uIGxvZ2dlciBsaWJyYXJ5LCB2aXNpdCBodHRwczovL2dpdGh1Yi5jb20vd2luc3RvbmpzL3dpbnN0b25cblxuaW1wb3J0IHV0aWwgZnJvbSAndXRpbCc7XG5pbXBvcnQgY2hhbGsgZnJvbSAnY2hhbGsnO1xuaW1wb3J0IHdpbnN0b24gZnJvbSAnd2luc3Rvbic7XG5pbXBvcnQgeyBTUExBVCB9IGZyb20gJ3RyaXBsZS1iZWFtJztcblxuXG5jb25zdCBjb2xvcnMgPSB7XG5cdGV4Y2VwdGlvbjogJ3JlZCcsXG5cdGVycm9yOiAncmVkJyxcblx0d2FybjogJ3llbGxvdycsXG5cdGluZm86ICdncmVlbicsXG5cdHZlcmJvc2U6ICdibHVlJyxcblx0ZGVidWc6ICdibHVlJyxcblx0c2lsbHk6ICdncmF5Jyxcbn07XG5cbndpbnN0b24uYWRkQ29sb3JzKGNvbG9ycyk7XG5cbi8vIHdlIGNvdWxkIHVzZSBpbnN0YW5jZW9mIGJ1dCB0byBhdm9pZCBpbXBvcnQgd2Ugc2ltcGx5IGNoZWNrIG9iaiBzdHJ1Y3R1cmVcbmNvbnN0IGlzUmVhZGVyID0gb2JqID0+IHR5cGVvZiBvYmogPT09ICdvYmplY3QnICYmIG9iai5yZWFkZXIgJiYgb2JqLm5hbWU7XG5cbmNvbnN0IHByaW50ZiA9IHdpbnN0b24uZm9ybWF0LnByaW50ZigoeyB0aW1lc3RhbXAsIGxldmVsLCBtZXNzYWdlLCBbU1BMQVRdOiBzcGxhdCB9KSA9PiB7XG5cblx0bGV0IHNwbGF0U3RyaW5nID0gJyc7XG5cblx0bGV0IHJlYWRlciA9ICcnO1xuXG5cdGlmIChzcGxhdCkge1xuXG5cdFx0bGV0IHJlYWRlck9iaiA9IHNwbGF0LmZpbmQoaXNSZWFkZXIpO1xuXG5cdFx0aWYgKHJlYWRlck9iaikge1xuXHRcdFx0cmVhZGVyID0gY2hhbGsuY3lhbihyZWFkZXJPYmoubmFtZSkgKyAnICc7XG5cdFx0XHRzcGxhdCA9IHNwbGF0LmZpbHRlcihvYmogPT4gIWlzUmVhZGVyKG9iaikpO1xuXHRcdH1cblxuXHRcdGlmIChzcGxhdC5sZW5ndGggPiAxKSB7XG5cdFx0XHRzcGxhdFN0cmluZyA9ICcgJyArIHV0aWwuaW5zcGVjdChzcGxhdCwgeyBjb2xvcnM6IHRydWUgfSk7XG5cdFx0fVxuXHRcdGVsc2UgaWYgKHNwbGF0Lmxlbmd0aCA+IDApIHtcblx0XHRcdHNwbGF0U3RyaW5nID0gJyAnICsgdXRpbC5pbnNwZWN0KHNwbGF0WzBdLCB7IGNvbG9yczogdHJ1ZSB9KTtcblx0XHR9XG5cblx0fVxuXG5cdC8vIHNlZSBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8xMDcyOTI3Ni9ob3ctY2FuLWktZ2V0LXRoZS1mdWxsLW9iamVjdC1pbi1ub2RlLWpzcy1jb25zb2xlLWxvZy1yYXRoZXItdGhhbi1vYmplY3Rcblx0cmV0dXJuIGAke3RpbWVzdGFtcCA/IHRpbWVzdGFtcCArICcg4oCTICcgOiAnJ30ke3JlYWRlcn0ke2xldmVsfTogJHttZXNzYWdlfSR7c3BsYXRTdHJpbmd9YDtcblxufSk7XG5cbmNvbnN0IEZPUk1BVCA9IHdpbnN0b24uZm9ybWF0LmNvbWJpbmUoXG5cdHdpbnN0b24uZm9ybWF0LnRpbWVzdGFtcCh7XG5cdFx0Zm9ybWF0OiAoKSA9PiBjaGFsay5ncmF5KG5ldyBEYXRlKCkudG9Mb2NhbGVUaW1lU3RyaW5nKCkpLFxuXHR9KSxcblx0d2luc3Rvbi5mb3JtYXQuY29sb3JpemUoKSxcblx0cHJpbnRmLFxuKTtcblxuY29uc3QgbG9nZ2VyID0gd2luc3Rvbi5jcmVhdGVMb2dnZXIoe1xuXHR0cmFuc3BvcnRzOiBbXG5cdFx0bmV3ICh3aW5zdG9uLnRyYW5zcG9ydHMuQ29uc29sZSkoe1xuXHRcdFx0bGV2ZWw6ICdzaWxseScsXG5cdFx0XHRmb3JtYXQ6IEZPUk1BVCxcblx0XHR9KSxcblx0XSxcblx0ZXhpdE9uRXJyb3I6IHRydWUsXG5cbn0pO1xuXG5cbmV4cG9ydCBkZWZhdWx0IGxvZ2dlcjtcbiJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "pretty-logger.js"
      ],
      "names": [
        "colors",
        "exception",
        "error",
        "warn",
        "info",
        "verbose",
        "debug",
        "silly",
        "winston",
        "addColors",
        "isReader",
        "obj",
        "reader",
        "name",
        "printf",
        "format",
        "timestamp",
        "level",
        "message",
        "SPLAT",
        "splat",
        "splatString",
        "readerObj",
        "find",
        "chalk",
        "cyan",
        "filter",
        "length",
        "util",
        "inspect",
        "FORMAT",
        "combine",
        "gray",
        "Date",
        "toLocaleTimeString",
        "colorize",
        "logger",
        "createLogger",
        "transports",
        "Console",
        "exitOnError"
      ],
      "mappings": "AAAA,a,CAEA;AACA;;;;;;;AAEA;;AACA;;AACA;;AACA;;;;AAGA,MAAMA,MAAM,GAAG;AACdC,EAAAA,SAAS,EAAE,KADG;AAEdC,EAAAA,KAAK,EAAE,KAFO;AAGdC,EAAAA,IAAI,EAAE,QAHQ;AAIdC,EAAAA,IAAI,EAAE,OAJQ;AAKdC,EAAAA,OAAO,EAAE,MALK;AAMdC,EAAAA,KAAK,EAAE,MANO;AAOdC,EAAAA,KAAK,EAAE;AAPO,CAAf;;AAUAC,iBAAQC,SAAR,CAAkBT,MAAlB,E,CAEA;;;AACA,MAAMU,QAAQ,GAAGC,GAAG,IAAI,OAAOA,GAAP,KAAe,QAAf,IAA2BA,GAAG,CAACC,MAA/B,IAAyCD,GAAG,CAACE,IAArE;;AAEA,MAAMC,MAAM,GAAGN,iBAAQO,MAAR,CAAeD,MAAf,CAAsB,CAAC;AAAEE,EAAAA,SAAF;AAAaC,EAAAA,KAAb;AAAoBC,EAAAA,OAApB;AAA6B,GAACC,iBAAD,GAASC;AAAtC,CAAD,KAAmD;AAEvF,MAAIC,WAAW,GAAG,EAAlB;AAEA,MAAIT,MAAM,GAAG,EAAb;;AAEA,MAAIQ,KAAJ,EAAW;AAEV,QAAIE,SAAS,GAAGF,KAAK,CAACG,IAAN,CAAWb,QAAX,CAAhB;;AAEA,QAAIY,SAAJ,EAAe;AACdV,MAAAA,MAAM,GAAGY,eAAMC,IAAN,CAAWH,SAAS,CAACT,IAArB,IAA6B,GAAtC;AACAO,MAAAA,KAAK,GAAGA,KAAK,CAACM,MAAN,CAAaf,GAAG,IAAI,CAACD,QAAQ,CAACC,GAAD,CAA7B,CAAR;AACA;;AAED,QAAIS,KAAK,CAACO,MAAN,GAAe,CAAnB,EAAsB;AACrBN,MAAAA,WAAW,GAAG,MAAMO,cAAKC,OAAL,CAAaT,KAAb,EAAoB;AAAEpB,QAAAA,MAAM,EAAE;AAAV,OAApB,CAApB;AACA,KAFD,MAGK,IAAIoB,KAAK,CAACO,MAAN,GAAe,CAAnB,EAAsB;AAC1BN,MAAAA,WAAW,GAAG,MAAMO,cAAKC,OAAL,CAAaT,KAAK,CAAC,CAAD,CAAlB,EAAuB;AAAEpB,QAAAA,MAAM,EAAE;AAAV,OAAvB,CAApB;AACA;AAED,GAtBsF,CAwBvF;;;AACA,SAAQ,GAAEgB,SAAS,GAAGA,SAAS,GAAG,KAAf,GAAuB,EAAG,GAAEJ,MAAO,GAAEK,KAAM,KAAIC,OAAQ,GAAEG,WAAY,EAAxF;AAEA,CA3Bc,CAAf;;AA6BA,MAAMS,MAAM,GAAGtB,iBAAQO,MAAR,CAAegB,OAAf,CACdvB,iBAAQO,MAAR,CAAeC,SAAf,CAAyB;AACxBD,EAAAA,MAAM,EAAE,MAAMS,eAAMQ,IAAN,CAAW,IAAIC,IAAJ,GAAWC,kBAAX,EAAX;AADU,CAAzB,CADc,EAId1B,iBAAQO,MAAR,CAAeoB,QAAf,EAJc,EAKdrB,MALc,CAAf;;AAQA,MAAMsB,MAAM,GAAG5B,iBAAQ6B,YAAR,CAAqB;AACnCC,EAAAA,UAAU,EAAE,CACX,IAAK9B,iBAAQ8B,UAAR,CAAmBC,OAAxB,CAAiC;AAChCtB,IAAAA,KAAK,EAAE,OADyB;AAEhCF,IAAAA,MAAM,EAAEe;AAFwB,GAAjC,CADW,CADuB;AAOnCU,EAAAA,WAAW,EAAE;AAPsB,CAArB,CAAf;;eAYeJ,M",
      "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/",
      "sourcesContent": [
        "\"use strict\";\n\n// pretty-logger for debugging\n// uses great winston logger library, visit https://github.com/winstonjs/winston\n\nimport util from 'util';\nimport chalk from 'chalk';\nimport winston from 'winston';\nimport { SPLAT } from 'triple-beam';\n\n\nconst colors = {\n\texception: 'red',\n\terror: 'red',\n\twarn: 'yellow',\n\tinfo: 'green',\n\tverbose: 'blue',\n\tdebug: 'blue',\n\tsilly: 'gray',\n};\n\nwinston.addColors(colors);\n\n// we could use instanceof but to avoid import we simply check obj structure\nconst isReader = obj => typeof obj === 'object' && obj.reader && obj.name;\n\nconst printf = winston.format.printf(({ timestamp, level, message, [SPLAT]: splat }) => {\n\n\tlet splatString = '';\n\n\tlet reader = '';\n\n\tif (splat) {\n\n\t\tlet readerObj = splat.find(isReader);\n\n\t\tif (readerObj) {\n\t\t\treader = chalk.cyan(readerObj.name) + ' ';\n\t\t\tsplat = splat.filter(obj => !isReader(obj));\n\t\t}\n\n\t\tif (splat.length > 1) {\n\t\t\tsplatString = ' ' + util.inspect(splat, { colors: true });\n\t\t}\n\t\telse if (splat.length > 0) {\n\t\t\tsplatString = ' ' + util.inspect(splat[0], { colors: true });\n\t\t}\n\n\t}\n\n\t// see https://stackoverflow.com/questions/10729276/how-can-i-get-the-full-object-in-node-jss-console-log-rather-than-object\n\treturn `${timestamp ? timestamp + ' – ' : ''}${reader}${level}: ${message}${splatString}`;\n\n});\n\nconst FORMAT = winston.format.combine(\n\twinston.format.timestamp({\n\t\tformat: () => chalk.gray(new Date().toLocaleTimeString()),\n\t}),\n\twinston.format.colorize(),\n\tprintf,\n);\n\nconst logger = winston.createLogger({\n\ttransports: [\n\t\tnew (winston.transports.Console)({\n\t\t\tlevel: 'silly',\n\t\t\tformat: FORMAT,\n\t\t}),\n\t],\n\texitOnError: true,\n\n});\n\n\nexport default logger;\n"
      ]
    },
    "sourceType": "script",
    "mtime": 1662229648498
  },
  "{\"sourceRoot\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc\",\"filename\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/uid-logger.js\",\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{}},{\"key\":\"proposal-class-properties\",\"visitor\":{\"PrivateName\":{\"enter\":[null]},\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{}}],\"presets\":[]}:7.12.17": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/",
      "caller": {
        "name": "@babel/register"
      },
      "cwd": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc",
      "filename": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/uid-logger.js",
      "cloneInputAst": true,
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {}
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {}
        },
        {
          "key": "proposal-class-properties",
          "visitor": {
            "PrivateName": {
              "enter": [
                null
              ]
            },
            "ExportDefaultDeclaration": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true,
            "ClassExpression": {
              "enter": [
                null
              ]
            },
            "ClassDeclaration": {
              "enter": [
                null
              ]
            }
          },
          "options": {}
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/uid-logger.js",
        "plugins": [
          "objectRestSpread",
          "classProperties",
          "classPrivateProperties"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/uid-logger.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/",
        "sourceFileName": "uid-logger.js"
      }
    },
    "ast": null,
    "code": "\"use strict\"; // #############\n// Logs cards' uid\n// #############\n\nvar _index = require(\"../src/index\");\n\nconst nfc = new _index.NFC();\nnfc.on('reader', reader => {\n  console.log(reader.name + ' reader attached, waiting for cards ...');\n  reader.on('card', card => {\n    console.log(card.uid);\n  });\n  reader.on('error', err => {\n    console.error('reader error', err);\n  });\n  reader.on('end', () => {\n    console.log(reader.name + ' reader disconnected.');\n  });\n});\nnfc.on('error', err => {\n  console.error(err);\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVpZC1sb2dnZXIuanMiXSwibmFtZXMiOlsibmZjIiwiTkZDIiwib24iLCJyZWFkZXIiLCJjb25zb2xlIiwibG9nIiwibmFtZSIsImNhcmQiLCJ1aWQiLCJlcnIiLCJlcnJvciJdLCJtYXBwaW5ncyI6IkFBQUEsYSxDQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFHQSxNQUFNQSxHQUFHLEdBQUcsSUFBSUMsVUFBSixFQUFaO0FBRUFELEdBQUcsQ0FBQ0UsRUFBSixDQUFPLFFBQVAsRUFBaUJDLE1BQU0sSUFBSTtBQUUxQkMsRUFBQUEsT0FBTyxDQUFDQyxHQUFSLENBQVlGLE1BQU0sQ0FBQ0csSUFBUCxHQUFjLHlDQUExQjtBQUVBSCxFQUFBQSxNQUFNLENBQUNELEVBQVAsQ0FBVSxNQUFWLEVBQWtCSyxJQUFJLElBQUk7QUFDekJILElBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZRSxJQUFJLENBQUNDLEdBQWpCO0FBQ0EsR0FGRDtBQUlBTCxFQUFBQSxNQUFNLENBQUNELEVBQVAsQ0FBVSxPQUFWLEVBQW1CTyxHQUFHLElBQUk7QUFDekJMLElBQUFBLE9BQU8sQ0FBQ00sS0FBUixDQUFjLGNBQWQsRUFBOEJELEdBQTlCO0FBQ0EsR0FGRDtBQUlBTixFQUFBQSxNQUFNLENBQUNELEVBQVAsQ0FBVSxLQUFWLEVBQWlCLE1BQU07QUFDdEJFLElBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZRixNQUFNLENBQUNHLElBQVAsR0FBYyx1QkFBMUI7QUFDQSxHQUZEO0FBS0EsQ0FqQkQ7QUFtQkFOLEdBQUcsQ0FBQ0UsRUFBSixDQUFPLE9BQVAsRUFBZ0JPLEdBQUcsSUFBSTtBQUN0QkwsRUFBQUEsT0FBTyxDQUFDTSxLQUFSLENBQWNELEdBQWQ7QUFDQSxDQUZEIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9oYXJyeWhvdy9Eb2N1bWVudHMvMjAyMi9QUk9KRUNUX01PQ0FfQVJUL05GQy9uZmMtcGNzYy9leGFtcGxlcy8iLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxuLy8gIyMjIyMjIyMjIyMjI1xuLy8gTG9ncyBjYXJkcycgdWlkXG4vLyAjIyMjIyMjIyMjIyMjXG5cbmltcG9ydCB7IE5GQyB9IGZyb20gJy4uL3NyYy9pbmRleCc7XG5cblxuY29uc3QgbmZjID0gbmV3IE5GQygpO1xuXG5uZmMub24oJ3JlYWRlcicsIHJlYWRlciA9PiB7XG5cblx0Y29uc29sZS5sb2cocmVhZGVyLm5hbWUgKyAnIHJlYWRlciBhdHRhY2hlZCwgd2FpdGluZyBmb3IgY2FyZHMgLi4uJyk7XG5cblx0cmVhZGVyLm9uKCdjYXJkJywgY2FyZCA9PiB7XG5cdFx0Y29uc29sZS5sb2coY2FyZC51aWQpO1xuXHR9KTtcblxuXHRyZWFkZXIub24oJ2Vycm9yJywgZXJyID0+IHtcblx0XHRjb25zb2xlLmVycm9yKCdyZWFkZXIgZXJyb3InLCBlcnIpO1xuXHR9KTtcblxuXHRyZWFkZXIub24oJ2VuZCcsICgpID0+IHtcblx0XHRjb25zb2xlLmxvZyhyZWFkZXIubmFtZSArICcgcmVhZGVyIGRpc2Nvbm5lY3RlZC4nKTtcblx0fSk7XG5cblxufSk7XG5cbm5mYy5vbignZXJyb3InLCBlcnIgPT4ge1xuXHRjb25zb2xlLmVycm9yKGVycik7XG59KTtcbiJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "uid-logger.js"
      ],
      "names": [
        "nfc",
        "NFC",
        "on",
        "reader",
        "console",
        "log",
        "name",
        "card",
        "uid",
        "err",
        "error"
      ],
      "mappings": "AAAA,a,CAEA;AACA;AACA;;AAEA;;AAGA,MAAMA,GAAG,GAAG,IAAIC,UAAJ,EAAZ;AAEAD,GAAG,CAACE,EAAJ,CAAO,QAAP,EAAiBC,MAAM,IAAI;AAE1BC,EAAAA,OAAO,CAACC,GAAR,CAAYF,MAAM,CAACG,IAAP,GAAc,yCAA1B;AAEAH,EAAAA,MAAM,CAACD,EAAP,CAAU,MAAV,EAAkBK,IAAI,IAAI;AACzBH,IAAAA,OAAO,CAACC,GAAR,CAAYE,IAAI,CAACC,GAAjB;AACA,GAFD;AAIAL,EAAAA,MAAM,CAACD,EAAP,CAAU,OAAV,EAAmBO,GAAG,IAAI;AACzBL,IAAAA,OAAO,CAACM,KAAR,CAAc,cAAd,EAA8BD,GAA9B;AACA,GAFD;AAIAN,EAAAA,MAAM,CAACD,EAAP,CAAU,KAAV,EAAiB,MAAM;AACtBE,IAAAA,OAAO,CAACC,GAAR,CAAYF,MAAM,CAACG,IAAP,GAAc,uBAA1B;AACA,GAFD;AAKA,CAjBD;AAmBAN,GAAG,CAACE,EAAJ,CAAO,OAAP,EAAgBO,GAAG,IAAI;AACtBL,EAAAA,OAAO,CAACM,KAAR,CAAcD,GAAd;AACA,CAFD",
      "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/",
      "sourcesContent": [
        "\"use strict\";\n\n// #############\n// Logs cards' uid\n// #############\n\nimport { NFC } from '../src/index';\n\n\nconst nfc = new NFC();\n\nnfc.on('reader', reader => {\n\n\tconsole.log(reader.name + ' reader attached, waiting for cards ...');\n\n\treader.on('card', card => {\n\t\tconsole.log(card.uid);\n\t});\n\n\treader.on('error', err => {\n\t\tconsole.error('reader error', err);\n\t});\n\n\treader.on('end', () => {\n\t\tconsole.log(reader.name + ' reader disconnected.');\n\t});\n\n\n});\n\nnfc.on('error', err => {\n\tconsole.error(err);\n});\n"
      ]
    },
    "sourceType": "script",
    "mtime": 1662229648498
  },
  "{\"sourceRoot\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc\",\"filename\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/basic.js\",\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{}},{\"key\":\"proposal-class-properties\",\"visitor\":{\"PrivateName\":{\"enter\":[null]},\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{}}],\"presets\":[]}:7.12.17": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/",
      "caller": {
        "name": "@babel/register"
      },
      "cwd": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc",
      "filename": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/basic.js",
      "cloneInputAst": true,
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {}
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {}
        },
        {
          "key": "proposal-class-properties",
          "visitor": {
            "PrivateName": {
              "enter": [
                null
              ]
            },
            "ExportDefaultDeclaration": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true,
            "ClassExpression": {
              "enter": [
                null
              ]
            },
            "ClassDeclaration": {
              "enter": [
                null
              ]
            }
          },
          "options": {}
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/basic.js",
        "plugins": [
          "objectRestSpread",
          "classProperties",
          "classPrivateProperties"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/basic.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/",
        "sourceFileName": "basic.js"
      }
    },
    "ast": null,
    "code": "\"use strict\"; // #############\n// Example: Basic usage\n// - see \"Basic usage\" section in README for an explanation\n// #############\n\nvar _index = require(\"../src/index\");\n\nconst nfc = new _index.NFC(); // optionally you can pass logger\n\nnfc.on('reader', reader => {\n  console.log(`${reader.reader.name}  device attached`); // enable when you want to auto-process ISO 14443-4 tags (standard=TAG_ISO_14443_4)\n  // when an ISO 14443-4 is detected, SELECT FILE command with the AID is issued\n  // the response is available as card.data in the card event\n  // you can set reader.aid to:\n  // 1. a HEX string (which will be parsed automatically to Buffer)\n\n  reader.aid = 'F222222222'; // 2. an instance of Buffer containing the AID bytes\n  // reader.aid = Buffer.from('F222222222', 'hex');\n  // 3. a function which must return an instance of a Buffer when invoked with card object (containing standard and atr)\n  //    the function may generate AIDs dynamically based on the detected card\n  // reader.aid = ({ standard, atr }) => {\n  //\n  // \treturn Buffer.from('F222222222', 'hex');\n  //\n  // };\n\n  reader.on('card', card => {\n    // card is object containing following data\n    // [always] String type: TAG_ISO_14443_3 (standard nfc tags like MIFARE) or TAG_ISO_14443_4 (Android HCE and others)\n    // [always] String standard: same as type\n    // [only TAG_ISO_14443_3] String uid: tag uid\n    // [only TAG_ISO_14443_4] Buffer data: raw data from select APDU response\n    console.log(`${reader.reader.name}  card detected`, card);\n  });\n  reader.on('card.off', card => {\n    console.log(`${reader.reader.name}  card removed`, card);\n  });\n  reader.on('error', err => {\n    console.log(`${reader.reader.name}  an error occurred`, err);\n  });\n  reader.on('end', () => {\n    console.log(`${reader.reader.name}  device removed`);\n  });\n});\nnfc.on('error', err => {\n  console.log('an error occurred', err);\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJhc2ljLmpzIl0sIm5hbWVzIjpbIm5mYyIsIk5GQyIsIm9uIiwicmVhZGVyIiwiY29uc29sZSIsImxvZyIsIm5hbWUiLCJhaWQiLCJjYXJkIiwiZXJyIl0sIm1hcHBpbmdzIjoiQUFBQSxhLENBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBR0EsTUFBTUEsR0FBRyxHQUFHLElBQUlDLFVBQUosRUFBWixDLENBQXVCOztBQUV2QkQsR0FBRyxDQUFDRSxFQUFKLENBQU8sUUFBUCxFQUFpQkMsTUFBTSxJQUFJO0FBRTFCQyxFQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBYSxHQUFFRixNQUFNLENBQUNBLE1BQVAsQ0FBY0csSUFBSyxtQkFBbEMsRUFGMEIsQ0FJMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQUgsRUFBQUEsTUFBTSxDQUFDSSxHQUFQLEdBQWEsWUFBYixDQVQwQixDQVUxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUFKLEVBQUFBLE1BQU0sQ0FBQ0QsRUFBUCxDQUFVLE1BQVYsRUFBa0JNLElBQUksSUFBSTtBQUV6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUFKLElBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFhLEdBQUVGLE1BQU0sQ0FBQ0EsTUFBUCxDQUFjRyxJQUFLLGlCQUFsQyxFQUFvREUsSUFBcEQ7QUFFQSxHQVZEO0FBWUFMLEVBQUFBLE1BQU0sQ0FBQ0QsRUFBUCxDQUFVLFVBQVYsRUFBc0JNLElBQUksSUFBSTtBQUM3QkosSUFBQUEsT0FBTyxDQUFDQyxHQUFSLENBQWEsR0FBRUYsTUFBTSxDQUFDQSxNQUFQLENBQWNHLElBQUssZ0JBQWxDLEVBQW1ERSxJQUFuRDtBQUNBLEdBRkQ7QUFJQUwsRUFBQUEsTUFBTSxDQUFDRCxFQUFQLENBQVUsT0FBVixFQUFtQk8sR0FBRyxJQUFJO0FBQ3pCTCxJQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBYSxHQUFFRixNQUFNLENBQUNBLE1BQVAsQ0FBY0csSUFBSyxxQkFBbEMsRUFBd0RHLEdBQXhEO0FBQ0EsR0FGRDtBQUlBTixFQUFBQSxNQUFNLENBQUNELEVBQVAsQ0FBVSxLQUFWLEVBQWlCLE1BQU07QUFDdEJFLElBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFhLEdBQUVGLE1BQU0sQ0FBQ0EsTUFBUCxDQUFjRyxJQUFLLGtCQUFsQztBQUNBLEdBRkQ7QUFJQSxDQTVDRDtBQThDQU4sR0FBRyxDQUFDRSxFQUFKLENBQU8sT0FBUCxFQUFnQk8sR0FBRyxJQUFJO0FBQ3RCTCxFQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBWSxtQkFBWixFQUFpQ0ksR0FBakM7QUFDQSxDQUZEIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9oYXJyeWhvdy9Eb2N1bWVudHMvMjAyMi9QUk9KRUNUX01PQ0FfQVJUL05GQy9uZmMtcGNzYy9leGFtcGxlcy8iLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxuLy8gIyMjIyMjIyMjIyMjI1xuLy8gRXhhbXBsZTogQmFzaWMgdXNhZ2Vcbi8vIC0gc2VlIFwiQmFzaWMgdXNhZ2VcIiBzZWN0aW9uIGluIFJFQURNRSBmb3IgYW4gZXhwbGFuYXRpb25cbi8vICMjIyMjIyMjIyMjIyNcblxuaW1wb3J0IHsgTkZDIH0gZnJvbSAnLi4vc3JjL2luZGV4JztcblxuXG5jb25zdCBuZmMgPSBuZXcgTkZDKCk7IC8vIG9wdGlvbmFsbHkgeW91IGNhbiBwYXNzIGxvZ2dlclxuXG5uZmMub24oJ3JlYWRlcicsIHJlYWRlciA9PiB7XG5cblx0Y29uc29sZS5sb2coYCR7cmVhZGVyLnJlYWRlci5uYW1lfSAgZGV2aWNlIGF0dGFjaGVkYCk7XG5cblx0Ly8gZW5hYmxlIHdoZW4geW91IHdhbnQgdG8gYXV0by1wcm9jZXNzIElTTyAxNDQ0My00IHRhZ3MgKHN0YW5kYXJkPVRBR19JU09fMTQ0NDNfNClcblx0Ly8gd2hlbiBhbiBJU08gMTQ0NDMtNCBpcyBkZXRlY3RlZCwgU0VMRUNUIEZJTEUgY29tbWFuZCB3aXRoIHRoZSBBSUQgaXMgaXNzdWVkXG5cdC8vIHRoZSByZXNwb25zZSBpcyBhdmFpbGFibGUgYXMgY2FyZC5kYXRhIGluIHRoZSBjYXJkIGV2ZW50XG5cdC8vIHlvdSBjYW4gc2V0IHJlYWRlci5haWQgdG86XG5cdC8vIDEuIGEgSEVYIHN0cmluZyAod2hpY2ggd2lsbCBiZSBwYXJzZWQgYXV0b21hdGljYWxseSB0byBCdWZmZXIpXG5cdHJlYWRlci5haWQgPSAnRjIyMjIyMjIyMic7XG5cdC8vIDIuIGFuIGluc3RhbmNlIG9mIEJ1ZmZlciBjb250YWluaW5nIHRoZSBBSUQgYnl0ZXNcblx0Ly8gcmVhZGVyLmFpZCA9IEJ1ZmZlci5mcm9tKCdGMjIyMjIyMjIyJywgJ2hleCcpO1xuXHQvLyAzLiBhIGZ1bmN0aW9uIHdoaWNoIG11c3QgcmV0dXJuIGFuIGluc3RhbmNlIG9mIGEgQnVmZmVyIHdoZW4gaW52b2tlZCB3aXRoIGNhcmQgb2JqZWN0IChjb250YWluaW5nIHN0YW5kYXJkIGFuZCBhdHIpXG5cdC8vICAgIHRoZSBmdW5jdGlvbiBtYXkgZ2VuZXJhdGUgQUlEcyBkeW5hbWljYWxseSBiYXNlZCBvbiB0aGUgZGV0ZWN0ZWQgY2FyZFxuXHQvLyByZWFkZXIuYWlkID0gKHsgc3RhbmRhcmQsIGF0ciB9KSA9PiB7XG5cdC8vXG5cdC8vIFx0cmV0dXJuIEJ1ZmZlci5mcm9tKCdGMjIyMjIyMjIyJywgJ2hleCcpO1xuXHQvL1xuXHQvLyB9O1xuXG5cdHJlYWRlci5vbignY2FyZCcsIGNhcmQgPT4ge1xuXG5cdFx0Ly8gY2FyZCBpcyBvYmplY3QgY29udGFpbmluZyBmb2xsb3dpbmcgZGF0YVxuXHRcdC8vIFthbHdheXNdIFN0cmluZyB0eXBlOiBUQUdfSVNPXzE0NDQzXzMgKHN0YW5kYXJkIG5mYyB0YWdzIGxpa2UgTUlGQVJFKSBvciBUQUdfSVNPXzE0NDQzXzQgKEFuZHJvaWQgSENFIGFuZCBvdGhlcnMpXG5cdFx0Ly8gW2Fsd2F5c10gU3RyaW5nIHN0YW5kYXJkOiBzYW1lIGFzIHR5cGVcblx0XHQvLyBbb25seSBUQUdfSVNPXzE0NDQzXzNdIFN0cmluZyB1aWQ6IHRhZyB1aWRcblx0XHQvLyBbb25seSBUQUdfSVNPXzE0NDQzXzRdIEJ1ZmZlciBkYXRhOiByYXcgZGF0YSBmcm9tIHNlbGVjdCBBUERVIHJlc3BvbnNlXG5cblx0XHRjb25zb2xlLmxvZyhgJHtyZWFkZXIucmVhZGVyLm5hbWV9ICBjYXJkIGRldGVjdGVkYCwgY2FyZCk7XG5cblx0fSk7XG5cblx0cmVhZGVyLm9uKCdjYXJkLm9mZicsIGNhcmQgPT4ge1xuXHRcdGNvbnNvbGUubG9nKGAke3JlYWRlci5yZWFkZXIubmFtZX0gIGNhcmQgcmVtb3ZlZGAsIGNhcmQpO1xuXHR9KTtcblxuXHRyZWFkZXIub24oJ2Vycm9yJywgZXJyID0+IHtcblx0XHRjb25zb2xlLmxvZyhgJHtyZWFkZXIucmVhZGVyLm5hbWV9ICBhbiBlcnJvciBvY2N1cnJlZGAsIGVycik7XG5cdH0pO1xuXG5cdHJlYWRlci5vbignZW5kJywgKCkgPT4ge1xuXHRcdGNvbnNvbGUubG9nKGAke3JlYWRlci5yZWFkZXIubmFtZX0gIGRldmljZSByZW1vdmVkYCk7XG5cdH0pO1xuXG59KTtcblxubmZjLm9uKCdlcnJvcicsIGVyciA9PiB7XG5cdGNvbnNvbGUubG9nKCdhbiBlcnJvciBvY2N1cnJlZCcsIGVycik7XG59KTtcbiJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "basic.js"
      ],
      "names": [
        "nfc",
        "NFC",
        "on",
        "reader",
        "console",
        "log",
        "name",
        "aid",
        "card",
        "err"
      ],
      "mappings": "AAAA,a,CAEA;AACA;AACA;AACA;;AAEA;;AAGA,MAAMA,GAAG,GAAG,IAAIC,UAAJ,EAAZ,C,CAAuB;;AAEvBD,GAAG,CAACE,EAAJ,CAAO,QAAP,EAAiBC,MAAM,IAAI;AAE1BC,EAAAA,OAAO,CAACC,GAAR,CAAa,GAAEF,MAAM,CAACA,MAAP,CAAcG,IAAK,mBAAlC,EAF0B,CAI1B;AACA;AACA;AACA;AACA;;AACAH,EAAAA,MAAM,CAACI,GAAP,GAAa,YAAb,CAT0B,CAU1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAJ,EAAAA,MAAM,CAACD,EAAP,CAAU,MAAV,EAAkBM,IAAI,IAAI;AAEzB;AACA;AACA;AACA;AACA;AAEAJ,IAAAA,OAAO,CAACC,GAAR,CAAa,GAAEF,MAAM,CAACA,MAAP,CAAcG,IAAK,iBAAlC,EAAoDE,IAApD;AAEA,GAVD;AAYAL,EAAAA,MAAM,CAACD,EAAP,CAAU,UAAV,EAAsBM,IAAI,IAAI;AAC7BJ,IAAAA,OAAO,CAACC,GAAR,CAAa,GAAEF,MAAM,CAACA,MAAP,CAAcG,IAAK,gBAAlC,EAAmDE,IAAnD;AACA,GAFD;AAIAL,EAAAA,MAAM,CAACD,EAAP,CAAU,OAAV,EAAmBO,GAAG,IAAI;AACzBL,IAAAA,OAAO,CAACC,GAAR,CAAa,GAAEF,MAAM,CAACA,MAAP,CAAcG,IAAK,qBAAlC,EAAwDG,GAAxD;AACA,GAFD;AAIAN,EAAAA,MAAM,CAACD,EAAP,CAAU,KAAV,EAAiB,MAAM;AACtBE,IAAAA,OAAO,CAACC,GAAR,CAAa,GAAEF,MAAM,CAACA,MAAP,CAAcG,IAAK,kBAAlC;AACA,GAFD;AAIA,CA5CD;AA8CAN,GAAG,CAACE,EAAJ,CAAO,OAAP,EAAgBO,GAAG,IAAI;AACtBL,EAAAA,OAAO,CAACC,GAAR,CAAY,mBAAZ,EAAiCI,GAAjC;AACA,CAFD",
      "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/",
      "sourcesContent": [
        "\"use strict\";\n\n// #############\n// Example: Basic usage\n// - see \"Basic usage\" section in README for an explanation\n// #############\n\nimport { NFC } from '../src/index';\n\n\nconst nfc = new NFC(); // optionally you can pass logger\n\nnfc.on('reader', reader => {\n\n\tconsole.log(`${reader.reader.name}  device attached`);\n\n\t// enable when you want to auto-process ISO 14443-4 tags (standard=TAG_ISO_14443_4)\n\t// when an ISO 14443-4 is detected, SELECT FILE command with the AID is issued\n\t// the response is available as card.data in the card event\n\t// you can set reader.aid to:\n\t// 1. a HEX string (which will be parsed automatically to Buffer)\n\treader.aid = 'F222222222';\n\t// 2. an instance of Buffer containing the AID bytes\n\t// reader.aid = Buffer.from('F222222222', 'hex');\n\t// 3. a function which must return an instance of a Buffer when invoked with card object (containing standard and atr)\n\t//    the function may generate AIDs dynamically based on the detected card\n\t// reader.aid = ({ standard, atr }) => {\n\t//\n\t// \treturn Buffer.from('F222222222', 'hex');\n\t//\n\t// };\n\n\treader.on('card', card => {\n\n\t\t// card is object containing following data\n\t\t// [always] String type: TAG_ISO_14443_3 (standard nfc tags like MIFARE) or TAG_ISO_14443_4 (Android HCE and others)\n\t\t// [always] String standard: same as type\n\t\t// [only TAG_ISO_14443_3] String uid: tag uid\n\t\t// [only TAG_ISO_14443_4] Buffer data: raw data from select APDU response\n\n\t\tconsole.log(`${reader.reader.name}  card detected`, card);\n\n\t});\n\n\treader.on('card.off', card => {\n\t\tconsole.log(`${reader.reader.name}  card removed`, card);\n\t});\n\n\treader.on('error', err => {\n\t\tconsole.log(`${reader.reader.name}  an error occurred`, err);\n\t});\n\n\treader.on('end', () => {\n\t\tconsole.log(`${reader.reader.name}  device removed`);\n\t});\n\n});\n\nnfc.on('error', err => {\n\tconsole.log('an error occurred', err);\n});\n"
      ]
    },
    "sourceType": "script",
    "mtime": 1662229648497
  },
  "{\"sourceRoot\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc\",\"filename\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/from-readme-3.js\",\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{}},{\"key\":\"proposal-class-properties\",\"visitor\":{\"PrivateName\":{\"enter\":[null]},\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{}}],\"presets\":[]}:7.12.17": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/",
      "caller": {
        "name": "@babel/register"
      },
      "cwd": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc",
      "filename": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/from-readme-3.js",
      "cloneInputAst": true,
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {}
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {}
        },
        {
          "key": "proposal-class-properties",
          "visitor": {
            "PrivateName": {
              "enter": [
                null
              ]
            },
            "ExportDefaultDeclaration": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true,
            "ClassExpression": {
              "enter": [
                null
              ]
            },
            "ClassDeclaration": {
              "enter": [
                null
              ]
            }
          },
          "options": {}
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/from-readme-3.js",
        "plugins": [
          "objectRestSpread",
          "classProperties",
          "classPrivateProperties"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/from-readme-3.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/",
        "sourceFileName": "from-readme-3.js"
      }
    },
    "ast": null,
    "code": "\"use strict\"; // #############\n// Example from \"Reading and writing data\" section of project's README\n// #############\n\nvar _index = require(\"../src/index\");\n\nconst nfc = new _index.NFC();\nnfc.on('reader', reader => {\n  console.log(`${reader.reader.name}  device attached`);\n  reader.on('card', async card => {\n    console.log();\n    console.log(`card detected`, card); // example reading 12 bytes assuming containing text in utf8\n\n    try {\n      // reader.read(blockNumber, length, blockSize = 4, packetSize = 16)\n      const data = await reader.read(4, 12); // starts reading in block 4, continues to 5 and 6 in order to read 12 bytes\n\n      console.log(`data read`, data);\n      const payload = data.toString(); // utf8 is default encoding\n\n      console.log(`data converted`, payload);\n    } catch (err) {\n      console.error(`error when reading data`, err);\n    } // example write 12 bytes containing text in utf8\n\n\n    try {\n      const data = Buffer.allocUnsafe(12);\n      data.fill(0);\n      const text = new Date().toTimeString();\n      data.write(text); // if text is longer than 12 bytes, it will be cut off\n      // reader.write(blockNumber, data, blockSize = 4)\n\n      await reader.write(4, data); // starts writing in block 4, continues to 5 and 6 in order to write 12 bytes\n\n      console.log(`data written`);\n    } catch (err) {\n      console.error(`error when writing data`, err);\n    }\n  });\n  reader.on('error', err => {\n    console.log(`${reader.reader.name}  an error occurred`, err);\n  });\n  reader.on('end', () => {\n    console.log(`${reader.reader.name}  device removed`);\n  });\n});\nnfc.on('error', err => {\n  console.log('an error occurred', err);\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZyb20tcmVhZG1lLTMuanMiXSwibmFtZXMiOlsibmZjIiwiTkZDIiwib24iLCJyZWFkZXIiLCJjb25zb2xlIiwibG9nIiwibmFtZSIsImNhcmQiLCJkYXRhIiwicmVhZCIsInBheWxvYWQiLCJ0b1N0cmluZyIsImVyciIsImVycm9yIiwiQnVmZmVyIiwiYWxsb2NVbnNhZmUiLCJmaWxsIiwidGV4dCIsIkRhdGUiLCJ0b1RpbWVTdHJpbmciLCJ3cml0ZSJdLCJtYXBwaW5ncyI6IkFBQUEsYSxDQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFHQSxNQUFNQSxHQUFHLEdBQUcsSUFBSUMsVUFBSixFQUFaO0FBRUFELEdBQUcsQ0FBQ0UsRUFBSixDQUFPLFFBQVAsRUFBaUJDLE1BQU0sSUFBSTtBQUUxQkMsRUFBQUEsT0FBTyxDQUFDQyxHQUFSLENBQWEsR0FBRUYsTUFBTSxDQUFDQSxNQUFQLENBQWNHLElBQUssbUJBQWxDO0FBRUFILEVBQUFBLE1BQU0sQ0FBQ0QsRUFBUCxDQUFVLE1BQVYsRUFBa0IsTUFBTUssSUFBTixJQUFjO0FBRS9CSCxJQUFBQSxPQUFPLENBQUNDLEdBQVI7QUFDQUQsSUFBQUEsT0FBTyxDQUFDQyxHQUFSLENBQWEsZUFBYixFQUE2QkUsSUFBN0IsRUFIK0IsQ0FLL0I7O0FBQ0EsUUFBSTtBQUVIO0FBQ0EsWUFBTUMsSUFBSSxHQUFHLE1BQU1MLE1BQU0sQ0FBQ00sSUFBUCxDQUFZLENBQVosRUFBZSxFQUFmLENBQW5CLENBSEcsQ0FHb0M7O0FBQ3ZDTCxNQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBYSxXQUFiLEVBQXlCRyxJQUF6QjtBQUNBLFlBQU1FLE9BQU8sR0FBR0YsSUFBSSxDQUFDRyxRQUFMLEVBQWhCLENBTEcsQ0FLOEI7O0FBQ2pDUCxNQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBYSxnQkFBYixFQUE4QkssT0FBOUI7QUFFQSxLQVJELENBUUUsT0FBT0UsR0FBUCxFQUFZO0FBQ2JSLE1BQUFBLE9BQU8sQ0FBQ1MsS0FBUixDQUFlLHlCQUFmLEVBQXlDRCxHQUF6QztBQUNBLEtBaEI4QixDQWtCL0I7OztBQUNBLFFBQUk7QUFFSCxZQUFNSixJQUFJLEdBQUdNLE1BQU0sQ0FBQ0MsV0FBUCxDQUFtQixFQUFuQixDQUFiO0FBQ0FQLE1BQUFBLElBQUksQ0FBQ1EsSUFBTCxDQUFVLENBQVY7QUFDQSxZQUFNQyxJQUFJLEdBQUksSUFBSUMsSUFBSixFQUFELENBQWFDLFlBQWIsRUFBYjtBQUNBWCxNQUFBQSxJQUFJLENBQUNZLEtBQUwsQ0FBV0gsSUFBWCxFQUxHLENBS2U7QUFDbEI7O0FBQ0EsWUFBTWQsTUFBTSxDQUFDaUIsS0FBUCxDQUFhLENBQWIsRUFBZ0JaLElBQWhCLENBQU4sQ0FQRyxDQU8wQjs7QUFDN0JKLE1BQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFhLGNBQWI7QUFFQSxLQVZELENBVUUsT0FBT08sR0FBUCxFQUFZO0FBQ2JSLE1BQUFBLE9BQU8sQ0FBQ1MsS0FBUixDQUFlLHlCQUFmLEVBQXlDRCxHQUF6QztBQUNBO0FBRUQsR0FqQ0Q7QUFtQ0FULEVBQUFBLE1BQU0sQ0FBQ0QsRUFBUCxDQUFVLE9BQVYsRUFBbUJVLEdBQUcsSUFBSTtBQUN6QlIsSUFBQUEsT0FBTyxDQUFDQyxHQUFSLENBQWEsR0FBRUYsTUFBTSxDQUFDQSxNQUFQLENBQWNHLElBQUsscUJBQWxDLEVBQXdETSxHQUF4RDtBQUNBLEdBRkQ7QUFJQVQsRUFBQUEsTUFBTSxDQUFDRCxFQUFQLENBQVUsS0FBVixFQUFpQixNQUFNO0FBQ3RCRSxJQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBYSxHQUFFRixNQUFNLENBQUNBLE1BQVAsQ0FBY0csSUFBSyxrQkFBbEM7QUFDQSxHQUZEO0FBSUEsQ0EvQ0Q7QUFpREFOLEdBQUcsQ0FBQ0UsRUFBSixDQUFPLE9BQVAsRUFBZ0JVLEdBQUcsSUFBSTtBQUN0QlIsRUFBQUEsT0FBTyxDQUFDQyxHQUFSLENBQVksbUJBQVosRUFBaUNPLEdBQWpDO0FBQ0EsQ0FGRCIsInNvdXJjZVJvb3QiOiIvVXNlcnMvaGFycnlob3cvRG9jdW1lbnRzLzIwMjIvUFJPSkVDVF9NT0NBX0FSVC9ORkMvbmZjLXBjc2MvZXhhbXBsZXMvIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbi8vICMjIyMjIyMjIyMjIyNcbi8vIEV4YW1wbGUgZnJvbSBcIlJlYWRpbmcgYW5kIHdyaXRpbmcgZGF0YVwiIHNlY3Rpb24gb2YgcHJvamVjdCdzIFJFQURNRVxuLy8gIyMjIyMjIyMjIyMjI1xuXG5pbXBvcnQgeyBORkMgfSBmcm9tICcuLi9zcmMvaW5kZXgnO1xuXG5cbmNvbnN0IG5mYyA9IG5ldyBORkMoKTtcblxubmZjLm9uKCdyZWFkZXInLCByZWFkZXIgPT4ge1xuXG5cdGNvbnNvbGUubG9nKGAke3JlYWRlci5yZWFkZXIubmFtZX0gIGRldmljZSBhdHRhY2hlZGApO1xuXG5cdHJlYWRlci5vbignY2FyZCcsIGFzeW5jIGNhcmQgPT4ge1xuXG5cdFx0Y29uc29sZS5sb2coKTtcblx0XHRjb25zb2xlLmxvZyhgY2FyZCBkZXRlY3RlZGAsIGNhcmQpO1xuXG5cdFx0Ly8gZXhhbXBsZSByZWFkaW5nIDEyIGJ5dGVzIGFzc3VtaW5nIGNvbnRhaW5pbmcgdGV4dCBpbiB1dGY4XG5cdFx0dHJ5IHtcblxuXHRcdFx0Ly8gcmVhZGVyLnJlYWQoYmxvY2tOdW1iZXIsIGxlbmd0aCwgYmxvY2tTaXplID0gNCwgcGFja2V0U2l6ZSA9IDE2KVxuXHRcdFx0Y29uc3QgZGF0YSA9IGF3YWl0IHJlYWRlci5yZWFkKDQsIDEyKTsgLy8gc3RhcnRzIHJlYWRpbmcgaW4gYmxvY2sgNCwgY29udGludWVzIHRvIDUgYW5kIDYgaW4gb3JkZXIgdG8gcmVhZCAxMiBieXRlc1xuXHRcdFx0Y29uc29sZS5sb2coYGRhdGEgcmVhZGAsIGRhdGEpO1xuXHRcdFx0Y29uc3QgcGF5bG9hZCA9IGRhdGEudG9TdHJpbmcoKTsgLy8gdXRmOCBpcyBkZWZhdWx0IGVuY29kaW5nXG5cdFx0XHRjb25zb2xlLmxvZyhgZGF0YSBjb252ZXJ0ZWRgLCBwYXlsb2FkKTtcblxuXHRcdH0gY2F0Y2ggKGVycikge1xuXHRcdFx0Y29uc29sZS5lcnJvcihgZXJyb3Igd2hlbiByZWFkaW5nIGRhdGFgLCBlcnIpO1xuXHRcdH1cblxuXHRcdC8vIGV4YW1wbGUgd3JpdGUgMTIgYnl0ZXMgY29udGFpbmluZyB0ZXh0IGluIHV0Zjhcblx0XHR0cnkge1xuXG5cdFx0XHRjb25zdCBkYXRhID0gQnVmZmVyLmFsbG9jVW5zYWZlKDEyKTtcblx0XHRcdGRhdGEuZmlsbCgwKTtcblx0XHRcdGNvbnN0IHRleHQgPSAobmV3IERhdGUoKSkudG9UaW1lU3RyaW5nKCk7XG5cdFx0XHRkYXRhLndyaXRlKHRleHQpOyAvLyBpZiB0ZXh0IGlzIGxvbmdlciB0aGFuIDEyIGJ5dGVzLCBpdCB3aWxsIGJlIGN1dCBvZmZcblx0XHRcdC8vIHJlYWRlci53cml0ZShibG9ja051bWJlciwgZGF0YSwgYmxvY2tTaXplID0gNClcblx0XHRcdGF3YWl0IHJlYWRlci53cml0ZSg0LCBkYXRhKTsgLy8gc3RhcnRzIHdyaXRpbmcgaW4gYmxvY2sgNCwgY29udGludWVzIHRvIDUgYW5kIDYgaW4gb3JkZXIgdG8gd3JpdGUgMTIgYnl0ZXNcblx0XHRcdGNvbnNvbGUubG9nKGBkYXRhIHdyaXR0ZW5gKTtcblxuXHRcdH0gY2F0Y2ggKGVycikge1xuXHRcdFx0Y29uc29sZS5lcnJvcihgZXJyb3Igd2hlbiB3cml0aW5nIGRhdGFgLCBlcnIpO1xuXHRcdH1cblxuXHR9KTtcblxuXHRyZWFkZXIub24oJ2Vycm9yJywgZXJyID0+IHtcblx0XHRjb25zb2xlLmxvZyhgJHtyZWFkZXIucmVhZGVyLm5hbWV9ICBhbiBlcnJvciBvY2N1cnJlZGAsIGVycik7XG5cdH0pO1xuXG5cdHJlYWRlci5vbignZW5kJywgKCkgPT4ge1xuXHRcdGNvbnNvbGUubG9nKGAke3JlYWRlci5yZWFkZXIubmFtZX0gIGRldmljZSByZW1vdmVkYCk7XG5cdH0pO1xuXG59KTtcblxubmZjLm9uKCdlcnJvcicsIGVyciA9PiB7XG5cdGNvbnNvbGUubG9nKCdhbiBlcnJvciBvY2N1cnJlZCcsIGVycik7XG59KTtcbiJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "from-readme-3.js"
      ],
      "names": [
        "nfc",
        "NFC",
        "on",
        "reader",
        "console",
        "log",
        "name",
        "card",
        "data",
        "read",
        "payload",
        "toString",
        "err",
        "error",
        "Buffer",
        "allocUnsafe",
        "fill",
        "text",
        "Date",
        "toTimeString",
        "write"
      ],
      "mappings": "AAAA,a,CAEA;AACA;AACA;;AAEA;;AAGA,MAAMA,GAAG,GAAG,IAAIC,UAAJ,EAAZ;AAEAD,GAAG,CAACE,EAAJ,CAAO,QAAP,EAAiBC,MAAM,IAAI;AAE1BC,EAAAA,OAAO,CAACC,GAAR,CAAa,GAAEF,MAAM,CAACA,MAAP,CAAcG,IAAK,mBAAlC;AAEAH,EAAAA,MAAM,CAACD,EAAP,CAAU,MAAV,EAAkB,MAAMK,IAAN,IAAc;AAE/BH,IAAAA,OAAO,CAACC,GAAR;AACAD,IAAAA,OAAO,CAACC,GAAR,CAAa,eAAb,EAA6BE,IAA7B,EAH+B,CAK/B;;AACA,QAAI;AAEH;AACA,YAAMC,IAAI,GAAG,MAAML,MAAM,CAACM,IAAP,CAAY,CAAZ,EAAe,EAAf,CAAnB,CAHG,CAGoC;;AACvCL,MAAAA,OAAO,CAACC,GAAR,CAAa,WAAb,EAAyBG,IAAzB;AACA,YAAME,OAAO,GAAGF,IAAI,CAACG,QAAL,EAAhB,CALG,CAK8B;;AACjCP,MAAAA,OAAO,CAACC,GAAR,CAAa,gBAAb,EAA8BK,OAA9B;AAEA,KARD,CAQE,OAAOE,GAAP,EAAY;AACbR,MAAAA,OAAO,CAACS,KAAR,CAAe,yBAAf,EAAyCD,GAAzC;AACA,KAhB8B,CAkB/B;;;AACA,QAAI;AAEH,YAAMJ,IAAI,GAAGM,MAAM,CAACC,WAAP,CAAmB,EAAnB,CAAb;AACAP,MAAAA,IAAI,CAACQ,IAAL,CAAU,CAAV;AACA,YAAMC,IAAI,GAAI,IAAIC,IAAJ,EAAD,CAAaC,YAAb,EAAb;AACAX,MAAAA,IAAI,CAACY,KAAL,CAAWH,IAAX,EALG,CAKe;AAClB;;AACA,YAAMd,MAAM,CAACiB,KAAP,CAAa,CAAb,EAAgBZ,IAAhB,CAAN,CAPG,CAO0B;;AAC7BJ,MAAAA,OAAO,CAACC,GAAR,CAAa,cAAb;AAEA,KAVD,CAUE,OAAOO,GAAP,EAAY;AACbR,MAAAA,OAAO,CAACS,KAAR,CAAe,yBAAf,EAAyCD,GAAzC;AACA;AAED,GAjCD;AAmCAT,EAAAA,MAAM,CAACD,EAAP,CAAU,OAAV,EAAmBU,GAAG,IAAI;AACzBR,IAAAA,OAAO,CAACC,GAAR,CAAa,GAAEF,MAAM,CAACA,MAAP,CAAcG,IAAK,qBAAlC,EAAwDM,GAAxD;AACA,GAFD;AAIAT,EAAAA,MAAM,CAACD,EAAP,CAAU,KAAV,EAAiB,MAAM;AACtBE,IAAAA,OAAO,CAACC,GAAR,CAAa,GAAEF,MAAM,CAACA,MAAP,CAAcG,IAAK,kBAAlC;AACA,GAFD;AAIA,CA/CD;AAiDAN,GAAG,CAACE,EAAJ,CAAO,OAAP,EAAgBU,GAAG,IAAI;AACtBR,EAAAA,OAAO,CAACC,GAAR,CAAY,mBAAZ,EAAiCO,GAAjC;AACA,CAFD",
      "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/",
      "sourcesContent": [
        "\"use strict\";\n\n// #############\n// Example from \"Reading and writing data\" section of project's README\n// #############\n\nimport { NFC } from '../src/index';\n\n\nconst nfc = new NFC();\n\nnfc.on('reader', reader => {\n\n\tconsole.log(`${reader.reader.name}  device attached`);\n\n\treader.on('card', async card => {\n\n\t\tconsole.log();\n\t\tconsole.log(`card detected`, card);\n\n\t\t// example reading 12 bytes assuming containing text in utf8\n\t\ttry {\n\n\t\t\t// reader.read(blockNumber, length, blockSize = 4, packetSize = 16)\n\t\t\tconst data = await reader.read(4, 12); // starts reading in block 4, continues to 5 and 6 in order to read 12 bytes\n\t\t\tconsole.log(`data read`, data);\n\t\t\tconst payload = data.toString(); // utf8 is default encoding\n\t\t\tconsole.log(`data converted`, payload);\n\n\t\t} catch (err) {\n\t\t\tconsole.error(`error when reading data`, err);\n\t\t}\n\n\t\t// example write 12 bytes containing text in utf8\n\t\ttry {\n\n\t\t\tconst data = Buffer.allocUnsafe(12);\n\t\t\tdata.fill(0);\n\t\t\tconst text = (new Date()).toTimeString();\n\t\t\tdata.write(text); // if text is longer than 12 bytes, it will be cut off\n\t\t\t// reader.write(blockNumber, data, blockSize = 4)\n\t\t\tawait reader.write(4, data); // starts writing in block 4, continues to 5 and 6 in order to write 12 bytes\n\t\t\tconsole.log(`data written`);\n\n\t\t} catch (err) {\n\t\t\tconsole.error(`error when writing data`, err);\n\t\t}\n\n\t});\n\n\treader.on('error', err => {\n\t\tconsole.log(`${reader.reader.name}  an error occurred`, err);\n\t});\n\n\treader.on('end', () => {\n\t\tconsole.log(`${reader.reader.name}  device removed`);\n\t});\n\n});\n\nnfc.on('error', err => {\n\tconsole.log('an error occurred', err);\n});\n"
      ]
    },
    "sourceType": "script",
    "mtime": 1662229648497
  },
  "{\"sourceRoot\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc\",\"filename\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/led.js\",\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{}},{\"key\":\"proposal-class-properties\",\"visitor\":{\"PrivateName\":{\"enter\":[null]},\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{}}],\"presets\":[]}:7.12.17": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/",
      "caller": {
        "name": "@babel/register"
      },
      "cwd": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc",
      "filename": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/led.js",
      "cloneInputAst": true,
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {}
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {}
        },
        {
          "key": "proposal-class-properties",
          "visitor": {
            "PrivateName": {
              "enter": [
                null
              ]
            },
            "ExportDefaultDeclaration": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true,
            "ClassExpression": {
              "enter": [
                null
              ]
            },
            "ClassDeclaration": {
              "enter": [
                null
              ]
            }
          },
          "options": {}
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/led.js",
        "plugins": [
          "objectRestSpread",
          "classProperties",
          "classPrivateProperties"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/led.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/",
        "sourceFileName": "led.js"
      }
    },
    "ast": null,
    "code": "\"use strict\"; // #############\n// Example: Controlling LED and buzzer on ACR122U\n// - what is covered:\n//   - custom led blinks\n//   - custom buzzer output\n//   - repeated beeping on unsuccessful read/write operation\n// - TODO:\n//   - document how to allow escape commands (direct communication without card)\n//   - meanwhile please see https://github.com/pokusew/nfc-pcsc/issues/13\n// #############\n\nvar _index = require(\"../src/index\");\n\nvar _prettyLogger = _interopRequireDefault(require(\"./pretty-logger\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nconst nfc = new _index.NFC(_prettyLogger.default); // const nfc = new NFC(pretty); // optionally you can pass logger to see internal debug logs\n\nnfc.on('reader', async reader => {\n  _prettyLogger.default.info(`device attached`, reader);\n\n  try {\n    await reader.connect(_index.CONNECT_MODE_DIRECT);\n    await reader.setBuzzerOutput(false);\n    await reader.disconnect();\n  } catch (err) {\n    _prettyLogger.default.info(`initial sequence error`, reader, err);\n  }\n\n  reader.on('card', async card => {\n    _prettyLogger.default.info(`card detected`, reader, card);\n\n    try {\n      // red error\n      await reader.led(0b01011101, [0x02, 0x01, 0x05, 0x01]); // green success\n\n      await reader.led(0b00101110, [0x01, 0x00, 0x01, 0x01]);\n    } catch (err) {\n      _prettyLogger.default.error(`error when writing led`, reader, err);\n    }\n  });\n  reader.on('error', err => {\n    _prettyLogger.default.error(`an error occurred`, reader, err);\n  });\n  reader.on('end', () => {\n    _prettyLogger.default.info(`device removed`, reader);\n  });\n});\nnfc.on('error', err => {\n  _prettyLogger.default.error(`an error occurred`, err);\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxlZC5qcyJdLCJuYW1lcyI6WyJuZmMiLCJORkMiLCJwcmV0dHkiLCJvbiIsInJlYWRlciIsImluZm8iLCJjb25uZWN0IiwiQ09OTkVDVF9NT0RFX0RJUkVDVCIsInNldEJ1enplck91dHB1dCIsImRpc2Nvbm5lY3QiLCJlcnIiLCJjYXJkIiwibGVkIiwiZXJyb3IiXSwibWFwcGluZ3MiOiJBQUFBLGEsQ0FFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFDQTs7OztBQUdBLE1BQU1BLEdBQUcsR0FBRyxJQUFJQyxVQUFKLENBQVFDLHFCQUFSLENBQVosQyxDQUE2Qjs7QUFFN0JGLEdBQUcsQ0FBQ0csRUFBSixDQUFPLFFBQVAsRUFBaUIsTUFBTUMsTUFBTixJQUFnQjtBQUVoQ0Ysd0JBQU9HLElBQVAsQ0FBYSxpQkFBYixFQUErQkQsTUFBL0I7O0FBRUEsTUFBSTtBQUNILFVBQU1BLE1BQU0sQ0FBQ0UsT0FBUCxDQUFlQywwQkFBZixDQUFOO0FBQ0EsVUFBTUgsTUFBTSxDQUFDSSxlQUFQLENBQXVCLEtBQXZCLENBQU47QUFDQSxVQUFNSixNQUFNLENBQUNLLFVBQVAsRUFBTjtBQUNBLEdBSkQsQ0FJRSxPQUFPQyxHQUFQLEVBQVk7QUFDYlIsMEJBQU9HLElBQVAsQ0FBYSx3QkFBYixFQUFzQ0QsTUFBdEMsRUFBOENNLEdBQTlDO0FBQ0E7O0FBRUROLEVBQUFBLE1BQU0sQ0FBQ0QsRUFBUCxDQUFVLE1BQVYsRUFBa0IsTUFBTVEsSUFBTixJQUFjO0FBRS9CVCwwQkFBT0csSUFBUCxDQUFhLGVBQWIsRUFBNkJELE1BQTdCLEVBQXFDTyxJQUFyQzs7QUFFQSxRQUFJO0FBRUg7QUFDQSxZQUFNUCxNQUFNLENBQUNRLEdBQVAsQ0FBVyxVQUFYLEVBQXVCLENBQUMsSUFBRCxFQUFPLElBQVAsRUFBYSxJQUFiLEVBQW1CLElBQW5CLENBQXZCLENBQU4sQ0FIRyxDQUtIOztBQUNBLFlBQU1SLE1BQU0sQ0FBQ1EsR0FBUCxDQUFXLFVBQVgsRUFBdUIsQ0FBQyxJQUFELEVBQU8sSUFBUCxFQUFhLElBQWIsRUFBbUIsSUFBbkIsQ0FBdkIsQ0FBTjtBQUVBLEtBUkQsQ0FRRSxPQUFPRixHQUFQLEVBQVk7QUFDYlIsNEJBQU9XLEtBQVAsQ0FBYyx3QkFBZCxFQUF1Q1QsTUFBdkMsRUFBK0NNLEdBQS9DO0FBQ0E7QUFFRCxHQWhCRDtBQWtCQU4sRUFBQUEsTUFBTSxDQUFDRCxFQUFQLENBQVUsT0FBVixFQUFtQk8sR0FBRyxJQUFJO0FBQ3pCUiwwQkFBT1csS0FBUCxDQUFjLG1CQUFkLEVBQWtDVCxNQUFsQyxFQUEwQ00sR0FBMUM7QUFDQSxHQUZEO0FBSUFOLEVBQUFBLE1BQU0sQ0FBQ0QsRUFBUCxDQUFVLEtBQVYsRUFBaUIsTUFBTTtBQUN0QkQsMEJBQU9HLElBQVAsQ0FBYSxnQkFBYixFQUE4QkQsTUFBOUI7QUFDQSxHQUZEO0FBSUEsQ0F0Q0Q7QUF3Q0FKLEdBQUcsQ0FBQ0csRUFBSixDQUFPLE9BQVAsRUFBZ0JPLEdBQUcsSUFBSTtBQUN0QlIsd0JBQU9XLEtBQVAsQ0FBYyxtQkFBZCxFQUFrQ0gsR0FBbEM7QUFDQSxDQUZEIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9oYXJyeWhvdy9Eb2N1bWVudHMvMjAyMi9QUk9KRUNUX01PQ0FfQVJUL05GQy9uZmMtcGNzYy9leGFtcGxlcy8iLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxuLy8gIyMjIyMjIyMjIyMjI1xuLy8gRXhhbXBsZTogQ29udHJvbGxpbmcgTEVEIGFuZCBidXp6ZXIgb24gQUNSMTIyVVxuLy8gLSB3aGF0IGlzIGNvdmVyZWQ6XG4vLyAgIC0gY3VzdG9tIGxlZCBibGlua3Ncbi8vICAgLSBjdXN0b20gYnV6emVyIG91dHB1dFxuLy8gICAtIHJlcGVhdGVkIGJlZXBpbmcgb24gdW5zdWNjZXNzZnVsIHJlYWQvd3JpdGUgb3BlcmF0aW9uXG4vLyAtIFRPRE86XG4vLyAgIC0gZG9jdW1lbnQgaG93IHRvIGFsbG93IGVzY2FwZSBjb21tYW5kcyAoZGlyZWN0IGNvbW11bmljYXRpb24gd2l0aG91dCBjYXJkKVxuLy8gICAtIG1lYW53aGlsZSBwbGVhc2Ugc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9wb2t1c2V3L25mYy1wY3NjL2lzc3Vlcy8xM1xuLy8gIyMjIyMjIyMjIyMjI1xuXG5pbXBvcnQgeyBORkMsIENPTk5FQ1RfTU9ERV9ESVJFQ1QgfSBmcm9tICcuLi9zcmMvaW5kZXgnO1xuaW1wb3J0IHByZXR0eSBmcm9tICcuL3ByZXR0eS1sb2dnZXInO1xuXG5cbmNvbnN0IG5mYyA9IG5ldyBORkMocHJldHR5KTsgLy8gY29uc3QgbmZjID0gbmV3IE5GQyhwcmV0dHkpOyAvLyBvcHRpb25hbGx5IHlvdSBjYW4gcGFzcyBsb2dnZXIgdG8gc2VlIGludGVybmFsIGRlYnVnIGxvZ3NcblxubmZjLm9uKCdyZWFkZXInLCBhc3luYyByZWFkZXIgPT4ge1xuXG5cdHByZXR0eS5pbmZvKGBkZXZpY2UgYXR0YWNoZWRgLCByZWFkZXIpO1xuXG5cdHRyeSB7XG5cdFx0YXdhaXQgcmVhZGVyLmNvbm5lY3QoQ09OTkVDVF9NT0RFX0RJUkVDVCk7XG5cdFx0YXdhaXQgcmVhZGVyLnNldEJ1enplck91dHB1dChmYWxzZSk7XG5cdFx0YXdhaXQgcmVhZGVyLmRpc2Nvbm5lY3QoKTtcblx0fSBjYXRjaCAoZXJyKSB7XG5cdFx0cHJldHR5LmluZm8oYGluaXRpYWwgc2VxdWVuY2UgZXJyb3JgLCByZWFkZXIsIGVycik7XG5cdH1cblxuXHRyZWFkZXIub24oJ2NhcmQnLCBhc3luYyBjYXJkID0+IHtcblxuXHRcdHByZXR0eS5pbmZvKGBjYXJkIGRldGVjdGVkYCwgcmVhZGVyLCBjYXJkKTtcblxuXHRcdHRyeSB7XG5cblx0XHRcdC8vIHJlZCBlcnJvclxuXHRcdFx0YXdhaXQgcmVhZGVyLmxlZCgwYjAxMDExMTAxLCBbMHgwMiwgMHgwMSwgMHgwNSwgMHgwMV0pO1xuXG5cdFx0XHQvLyBncmVlbiBzdWNjZXNzXG5cdFx0XHRhd2FpdCByZWFkZXIubGVkKDBiMDAxMDExMTAsIFsweDAxLCAweDAwLCAweDAxLCAweDAxXSk7XG5cblx0XHR9IGNhdGNoIChlcnIpIHtcblx0XHRcdHByZXR0eS5lcnJvcihgZXJyb3Igd2hlbiB3cml0aW5nIGxlZGAsIHJlYWRlciwgZXJyKTtcblx0XHR9XG5cblx0fSk7XG5cblx0cmVhZGVyLm9uKCdlcnJvcicsIGVyciA9PiB7XG5cdFx0cHJldHR5LmVycm9yKGBhbiBlcnJvciBvY2N1cnJlZGAsIHJlYWRlciwgZXJyKTtcblx0fSk7XG5cblx0cmVhZGVyLm9uKCdlbmQnLCAoKSA9PiB7XG5cdFx0cHJldHR5LmluZm8oYGRldmljZSByZW1vdmVkYCwgcmVhZGVyKTtcblx0fSk7XG5cbn0pO1xuXG5uZmMub24oJ2Vycm9yJywgZXJyID0+IHtcblx0cHJldHR5LmVycm9yKGBhbiBlcnJvciBvY2N1cnJlZGAsIGVycik7XG59KTtcbiJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "led.js"
      ],
      "names": [
        "nfc",
        "NFC",
        "pretty",
        "on",
        "reader",
        "info",
        "connect",
        "CONNECT_MODE_DIRECT",
        "setBuzzerOutput",
        "disconnect",
        "err",
        "card",
        "led",
        "error"
      ],
      "mappings": "AAAA,a,CAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AACA;;;;AAGA,MAAMA,GAAG,GAAG,IAAIC,UAAJ,CAAQC,qBAAR,CAAZ,C,CAA6B;;AAE7BF,GAAG,CAACG,EAAJ,CAAO,QAAP,EAAiB,MAAMC,MAAN,IAAgB;AAEhCF,wBAAOG,IAAP,CAAa,iBAAb,EAA+BD,MAA/B;;AAEA,MAAI;AACH,UAAMA,MAAM,CAACE,OAAP,CAAeC,0BAAf,CAAN;AACA,UAAMH,MAAM,CAACI,eAAP,CAAuB,KAAvB,CAAN;AACA,UAAMJ,MAAM,CAACK,UAAP,EAAN;AACA,GAJD,CAIE,OAAOC,GAAP,EAAY;AACbR,0BAAOG,IAAP,CAAa,wBAAb,EAAsCD,MAAtC,EAA8CM,GAA9C;AACA;;AAEDN,EAAAA,MAAM,CAACD,EAAP,CAAU,MAAV,EAAkB,MAAMQ,IAAN,IAAc;AAE/BT,0BAAOG,IAAP,CAAa,eAAb,EAA6BD,MAA7B,EAAqCO,IAArC;;AAEA,QAAI;AAEH;AACA,YAAMP,MAAM,CAACQ,GAAP,CAAW,UAAX,EAAuB,CAAC,IAAD,EAAO,IAAP,EAAa,IAAb,EAAmB,IAAnB,CAAvB,CAAN,CAHG,CAKH;;AACA,YAAMR,MAAM,CAACQ,GAAP,CAAW,UAAX,EAAuB,CAAC,IAAD,EAAO,IAAP,EAAa,IAAb,EAAmB,IAAnB,CAAvB,CAAN;AAEA,KARD,CAQE,OAAOF,GAAP,EAAY;AACbR,4BAAOW,KAAP,CAAc,wBAAd,EAAuCT,MAAvC,EAA+CM,GAA/C;AACA;AAED,GAhBD;AAkBAN,EAAAA,MAAM,CAACD,EAAP,CAAU,OAAV,EAAmBO,GAAG,IAAI;AACzBR,0BAAOW,KAAP,CAAc,mBAAd,EAAkCT,MAAlC,EAA0CM,GAA1C;AACA,GAFD;AAIAN,EAAAA,MAAM,CAACD,EAAP,CAAU,KAAV,EAAiB,MAAM;AACtBD,0BAAOG,IAAP,CAAa,gBAAb,EAA8BD,MAA9B;AACA,GAFD;AAIA,CAtCD;AAwCAJ,GAAG,CAACG,EAAJ,CAAO,OAAP,EAAgBO,GAAG,IAAI;AACtBR,wBAAOW,KAAP,CAAc,mBAAd,EAAkCH,GAAlC;AACA,CAFD",
      "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/",
      "sourcesContent": [
        "\"use strict\";\n\n// #############\n// Example: Controlling LED and buzzer on ACR122U\n// - what is covered:\n//   - custom led blinks\n//   - custom buzzer output\n//   - repeated beeping on unsuccessful read/write operation\n// - TODO:\n//   - document how to allow escape commands (direct communication without card)\n//   - meanwhile please see https://github.com/pokusew/nfc-pcsc/issues/13\n// #############\n\nimport { NFC, CONNECT_MODE_DIRECT } from '../src/index';\nimport pretty from './pretty-logger';\n\n\nconst nfc = new NFC(pretty); // const nfc = new NFC(pretty); // optionally you can pass logger to see internal debug logs\n\nnfc.on('reader', async reader => {\n\n\tpretty.info(`device attached`, reader);\n\n\ttry {\n\t\tawait reader.connect(CONNECT_MODE_DIRECT);\n\t\tawait reader.setBuzzerOutput(false);\n\t\tawait reader.disconnect();\n\t} catch (err) {\n\t\tpretty.info(`initial sequence error`, reader, err);\n\t}\n\n\treader.on('card', async card => {\n\n\t\tpretty.info(`card detected`, reader, card);\n\n\t\ttry {\n\n\t\t\t// red error\n\t\t\tawait reader.led(0b01011101, [0x02, 0x01, 0x05, 0x01]);\n\n\t\t\t// green success\n\t\t\tawait reader.led(0b00101110, [0x01, 0x00, 0x01, 0x01]);\n\n\t\t} catch (err) {\n\t\t\tpretty.error(`error when writing led`, reader, err);\n\t\t}\n\n\t});\n\n\treader.on('error', err => {\n\t\tpretty.error(`an error occurred`, reader, err);\n\t});\n\n\treader.on('end', () => {\n\t\tpretty.info(`device removed`, reader);\n\t});\n\n});\n\nnfc.on('error', err => {\n\tpretty.error(`an error occurred`, err);\n});\n"
      ]
    },
    "sourceType": "script",
    "mtime": 1662229648497
  },
  "{\"sourceRoot\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc\",\"filename\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/index.js\",\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{}},{\"key\":\"proposal-class-properties\",\"visitor\":{\"PrivateName\":{\"enter\":[null]},\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{}}],\"presets\":[]}:7.12.17": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/",
      "caller": {
        "name": "@babel/register"
      },
      "cwd": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc",
      "filename": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/index.js",
      "cloneInputAst": true,
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {}
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {}
        },
        {
          "key": "proposal-class-properties",
          "visitor": {
            "PrivateName": {
              "enter": [
                null
              ]
            },
            "ExportDefaultDeclaration": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true,
            "ClassExpression": {
              "enter": [
                null
              ]
            },
            "ClassDeclaration": {
              "enter": [
                null
              ]
            }
          },
          "options": {}
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/index.js",
        "plugins": [
          "objectRestSpread",
          "classProperties",
          "classPrivateProperties"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/index.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/",
        "sourceFileName": "index.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nObject.defineProperty(exports, \"NFC\", {\n  enumerable: true,\n  get: function () {\n    return _NFC.default;\n  }\n});\nObject.defineProperty(exports, \"Reader\", {\n  enumerable: true,\n  get: function () {\n    return _Reader.default;\n  }\n});\nObject.defineProperty(exports, \"TAG_ISO_14443_3\", {\n  enumerable: true,\n  get: function () {\n    return _Reader.TAG_ISO_14443_3;\n  }\n});\nObject.defineProperty(exports, \"TAG_ISO_14443_4\", {\n  enumerable: true,\n  get: function () {\n    return _Reader.TAG_ISO_14443_4;\n  }\n});\nObject.defineProperty(exports, \"KEY_TYPE_A\", {\n  enumerable: true,\n  get: function () {\n    return _Reader.KEY_TYPE_A;\n  }\n});\nObject.defineProperty(exports, \"KEY_TYPE_B\", {\n  enumerable: true,\n  get: function () {\n    return _Reader.KEY_TYPE_B;\n  }\n});\nObject.defineProperty(exports, \"CONNECT_MODE_CARD\", {\n  enumerable: true,\n  get: function () {\n    return _Reader.CONNECT_MODE_CARD;\n  }\n});\nObject.defineProperty(exports, \"CONNECT_MODE_DIRECT\", {\n  enumerable: true,\n  get: function () {\n    return _Reader.CONNECT_MODE_DIRECT;\n  }\n});\nObject.defineProperty(exports, \"ACR122Reader\", {\n  enumerable: true,\n  get: function () {\n    return _ACR122Reader.default;\n  }\n});\nObject.defineProperty(exports, \"UNKNOWN_ERROR\", {\n  enumerable: true,\n  get: function () {\n    return _errors.UNKNOWN_ERROR;\n  }\n});\nObject.defineProperty(exports, \"FAILURE\", {\n  enumerable: true,\n  get: function () {\n    return _errors.FAILURE;\n  }\n});\nObject.defineProperty(exports, \"CARD_NOT_CONNECTED\", {\n  enumerable: true,\n  get: function () {\n    return _errors.CARD_NOT_CONNECTED;\n  }\n});\nObject.defineProperty(exports, \"OPERATION_FAILED\", {\n  enumerable: true,\n  get: function () {\n    return _errors.OPERATION_FAILED;\n  }\n});\nObject.defineProperty(exports, \"BaseError\", {\n  enumerable: true,\n  get: function () {\n    return _errors.BaseError;\n  }\n});\nObject.defineProperty(exports, \"TransmitError\", {\n  enumerable: true,\n  get: function () {\n    return _errors.TransmitError;\n  }\n});\nObject.defineProperty(exports, \"ControlError\", {\n  enumerable: true,\n  get: function () {\n    return _errors.ControlError;\n  }\n});\nObject.defineProperty(exports, \"ReadError\", {\n  enumerable: true,\n  get: function () {\n    return _errors.ReadError;\n  }\n});\nObject.defineProperty(exports, \"WriteError\", {\n  enumerable: true,\n  get: function () {\n    return _errors.WriteError;\n  }\n});\nObject.defineProperty(exports, \"LoadAuthenticationKeyError\", {\n  enumerable: true,\n  get: function () {\n    return _errors.LoadAuthenticationKeyError;\n  }\n});\nObject.defineProperty(exports, \"AuthenticationError\", {\n  enumerable: true,\n  get: function () {\n    return _errors.AuthenticationError;\n  }\n});\nObject.defineProperty(exports, \"ConnectError\", {\n  enumerable: true,\n  get: function () {\n    return _errors.ConnectError;\n  }\n});\nObject.defineProperty(exports, \"DisconnectError\", {\n  enumerable: true,\n  get: function () {\n    return _errors.DisconnectError;\n  }\n});\nObject.defineProperty(exports, \"GetUIDError\", {\n  enumerable: true,\n  get: function () {\n    return _errors.GetUIDError;\n  }\n});\n\nvar _NFC = _interopRequireDefault(require(\"./NFC\"));\n\nvar _Reader = _interopRequireWildcard(require(\"./Reader\"));\n\nvar _ACR122Reader = _interopRequireDefault(require(\"./ACR122Reader\"));\n\nvar _errors = require(\"./errors\");\n\nfunction _getRequireWildcardCache() { if (typeof WeakMap !== \"function\") return null; var cache = new WeakMap(); _getRequireWildcardCache = function () { return cache; }; return cache; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFFQTs7QUFDQTs7QUFRQTs7QUFDQSIsInNvdXJjZVJvb3QiOiIvVXNlcnMvaGFycnlob3cvRG9jdW1lbnRzLzIwMjIvUFJPSkVDVF9NT0NBX0FSVC9ORkMvbmZjLXBjc2Mvc3JjLyIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG5pbXBvcnQgTkZDIGZyb20gJy4vTkZDJztcbmltcG9ydCBSZWFkZXIsIHtcblx0VEFHX0lTT18xNDQ0M18zLFxuXHRUQUdfSVNPXzE0NDQzXzQsXG5cdEtFWV9UWVBFX0EsXG5cdEtFWV9UWVBFX0IsXG5cdENPTk5FQ1RfTU9ERV9DQVJELFxuXHRDT05ORUNUX01PREVfRElSRUNULFxufSBmcm9tICcuL1JlYWRlcic7XG5pbXBvcnQgQUNSMTIyUmVhZGVyIGZyb20gJy4vQUNSMTIyUmVhZGVyJztcbmltcG9ydCB7XG5cdFVOS05PV05fRVJST1IsXG5cdEZBSUxVUkUsXG5cdENBUkRfTk9UX0NPTk5FQ1RFRCxcblx0T1BFUkFUSU9OX0ZBSUxFRCxcblx0QmFzZUVycm9yLFxuXHRUcmFuc21pdEVycm9yLFxuXHRDb250cm9sRXJyb3IsXG5cdFJlYWRFcnJvcixcblx0V3JpdGVFcnJvcixcblx0TG9hZEF1dGhlbnRpY2F0aW9uS2V5RXJyb3IsXG5cdEF1dGhlbnRpY2F0aW9uRXJyb3IsXG5cdENvbm5lY3RFcnJvcixcblx0RGlzY29ubmVjdEVycm9yLFxuXHRHZXRVSURFcnJvcixcbn0gZnJvbSAnLi9lcnJvcnMnO1xuXG5leHBvcnQge1xuXHRORkMsXG5cdFJlYWRlcixcblx0VEFHX0lTT18xNDQ0M18zLFxuXHRUQUdfSVNPXzE0NDQzXzQsXG5cdEtFWV9UWVBFX0EsXG5cdEtFWV9UWVBFX0IsXG5cdENPTk5FQ1RfTU9ERV9DQVJELFxuXHRDT05ORUNUX01PREVfRElSRUNULFxuXHRBQ1IxMjJSZWFkZXIsXG5cdFVOS05PV05fRVJST1IsXG5cdEZBSUxVUkUsXG5cdENBUkRfTk9UX0NPTk5FQ1RFRCxcblx0T1BFUkFUSU9OX0ZBSUxFRCxcblx0QmFzZUVycm9yLFxuXHRUcmFuc21pdEVycm9yLFxuXHRDb250cm9sRXJyb3IsXG5cdFJlYWRFcnJvcixcblx0V3JpdGVFcnJvcixcblx0TG9hZEF1dGhlbnRpY2F0aW9uS2V5RXJyb3IsXG5cdEF1dGhlbnRpY2F0aW9uRXJyb3IsXG5cdENvbm5lY3RFcnJvcixcblx0RGlzY29ubmVjdEVycm9yLFxuXHRHZXRVSURFcnJvcixcbn07XG4iXX0=",
    "map": {
      "version": 3,
      "sources": [
        "index.js"
      ],
      "names": [],
      "mappings": "AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEA;;AACA;;AAQA;;AACA",
      "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/",
      "sourcesContent": [
        "\"use strict\";\n\nimport NFC from './NFC';\nimport Reader, {\n\tTAG_ISO_14443_3,\n\tTAG_ISO_14443_4,\n\tKEY_TYPE_A,\n\tKEY_TYPE_B,\n\tCONNECT_MODE_CARD,\n\tCONNECT_MODE_DIRECT,\n} from './Reader';\nimport ACR122Reader from './ACR122Reader';\nimport {\n\tUNKNOWN_ERROR,\n\tFAILURE,\n\tCARD_NOT_CONNECTED,\n\tOPERATION_FAILED,\n\tBaseError,\n\tTransmitError,\n\tControlError,\n\tReadError,\n\tWriteError,\n\tLoadAuthenticationKeyError,\n\tAuthenticationError,\n\tConnectError,\n\tDisconnectError,\n\tGetUIDError,\n} from './errors';\n\nexport {\n\tNFC,\n\tReader,\n\tTAG_ISO_14443_3,\n\tTAG_ISO_14443_4,\n\tKEY_TYPE_A,\n\tKEY_TYPE_B,\n\tCONNECT_MODE_CARD,\n\tCONNECT_MODE_DIRECT,\n\tACR122Reader,\n\tUNKNOWN_ERROR,\n\tFAILURE,\n\tCARD_NOT_CONNECTED,\n\tOPERATION_FAILED,\n\tBaseError,\n\tTransmitError,\n\tControlError,\n\tReadError,\n\tWriteError,\n\tLoadAuthenticationKeyError,\n\tAuthenticationError,\n\tConnectError,\n\tDisconnectError,\n\tGetUIDError,\n};\n"
      ]
    },
    "sourceType": "script",
    "mtime": 1662229648500
  },
  "{\"sourceRoot\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc\",\"filename\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/mifare-classic.js\",\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{}},{\"key\":\"proposal-class-properties\",\"visitor\":{\"PrivateName\":{\"enter\":[null]},\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{}}],\"presets\":[]}:7.12.17": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/",
      "caller": {
        "name": "@babel/register"
      },
      "cwd": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc",
      "filename": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/mifare-classic.js",
      "cloneInputAst": true,
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {}
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {}
        },
        {
          "key": "proposal-class-properties",
          "visitor": {
            "PrivateName": {
              "enter": [
                null
              ]
            },
            "ExportDefaultDeclaration": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true,
            "ClassExpression": {
              "enter": [
                null
              ]
            },
            "ClassDeclaration": {
              "enter": [
                null
              ]
            }
          },
          "options": {}
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/mifare-classic.js",
        "plugins": [
          "objectRestSpread",
          "classProperties",
          "classPrivateProperties"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/mifare-classic.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/",
        "sourceFileName": "mifare-classic.js"
      }
    },
    "ast": null,
    "code": "\"use strict\"; // #############\n// Example: MIFARE Classic\n// - should work well with any compatible PC/SC card reader\n// - what is covered:\n//   - authentication\n//   - reading data from card\n//   - writing data to card\n// - what is NOT covered yet:\n//   - using sector trailers to update access rights\n// #############\n// ## Note about the card's data structure\n//\n// ### MIFARE Classic EV1 1K\n// - 1024 × 8 bit EEPROM memory\n// - 16 sectors of 4 blocks\n// - see https://www.nxp.com/docs/en/data-sheet/MF1S50YYX_V1.pdf\n//\n// ### MIFARE Classic EV1 4K\n// - 4096 × 8 bit EEPROM memory\n// - 32 sectors of 4 blocks and 8 sectors of 16 blocks\n// - see https://www.nxp.com/docs/en/data-sheet/MF1S70YYX_V1.pdf\n//\n// One block contains 16 bytes.\n// Don't forget specify the blockSize argument blockSize=16 in reader.read and reader.write calls.\n// The smallest amount of data to write is one block. You can write only the entire blocks (card limitation).\n//\n// sector 0\n// \tblock 0 - manufacturer data (read only)\n// \tblock 1 - data block\n// \tblock 2 - data block\n// \tblock 3 - sector trailer 0\n// \t\tbytes 00-05: Key A (default 0xFFFFFFFFFFFF) (6 bytes)\n// \t\tbytes 06-09: Access Bits (default 0xFF0780) (4 bytes)\n// \t\tbytes 10-15: Key B (optional) (default 0xFFFFFFFFFFFF) (6 bytes)\n// sector 1:\n// \tblock 4 - data block\n// \tblock 5 - data block\n// \tblock 6 - data block\n// \tblock 7 - sector trailer 1\n// sector 2:\n// \tblock 8 - data block\n// \tblock 9 - data block\n// \tblock 10 - data block\n// \tblock 11 - sector trailer 2\n// ... and so on ...\n\nvar _index = require(\"../src/index\");\n\nvar _prettyLogger = _interopRequireDefault(require(\"./pretty-logger\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nconst nfc = new _index.NFC(); // const nfc = new NFC(pretty); // optionally you can pass logger to see internal debug logs\n\nnfc.on('reader', async reader => {\n  _prettyLogger.default.info(`device attached`, reader);\n\n  reader.on('card', async card => {\n    // MIFARE Classic is ISO/IEC 14443-3 tag\n    // skip other standards\n    if (card.type !== _index.TAG_ISO_14443_3) {\n      return;\n    }\n\n    _prettyLogger.default.info(`card detected`, reader, card); // Reading and writing data from/to MIFARE Classic cards (e.g. MIFARE 1K) ALWAYS requires authentication!\n    // How does the MIFARE Classic authentication work?\n    // 1. You authenticate to a specific sector using a specific key (key + keyType).\n    // 2. After the successful authentication, you are granted permissions according to the access conditions\n    //    for the given key (access conditions are specified in the trailer section of each sector).\n    //    Depending on the access conditions, you can read from / write to the blocks of this sector.\n    // 3. If you want to access data in another sectors, you have to authenticate to that sector.\n    //    Then you can access the data from the block within that sector (only from that sector).\n    // summary: MIFARE Classic will only grant permissions based on the last authentication attempt.\n    //          Consequently, if multiple reader.authenticate(...) commands are used,\n    //          only the last one has an effect on all subsequent read/write operations.\n    // reader.authenticate(blockNumber, keyType, key, obsolete = false)\n    // - blockNumber - the number of any block withing the sector we want to authenticate\n    // - keyType - type of key - either KEY_TYPE_A or KEY_TYPE_B\n    // - key - 6 bytes - a Buffer instance, an array of bytes, or 12-chars HEX string\n    // - obsolete - (default - false for PC/SC V2.07) use true for PC/SC V2.01\n    // Don't forget to fill YOUR keys and types! (default ones are stated below)\n\n\n    const key = 'FFFFFFFFFFFF'; // key must be a 12-chars HEX string, an instance of Buffer, or array of bytes\n\n    const keyType = _index.KEY_TYPE_A;\n\n    try {\n      // we want to authenticate sector 1\n      // authenticating one block within the sector will authenticate all blocks within that sector\n      // so in our case, we choose block 4 that is within the sector 1, all blocks (4, 5, 6, 7)\n      // will be authenticated with the given key\n      await reader.authenticate(4, keyType, key); // Note: writing might require to authenticate with a different key (based on the sector access conditions)\n\n      _prettyLogger.default.info(`sector 1 successfully authenticated`, reader);\n    } catch (err) {\n      _prettyLogger.default.error(`error when authenticating block 4 within the sector 1`, reader, err);\n\n      return;\n    } // example reading 16 bytes (one block) assuming containing 32bit integer\n    // !!! note that we don't need 16 bytes - 32bit integer takes only 4 bytes !!!\n\n\n    try {\n      // reader.read(blockNumber, length, blockSize = 4, packetSize = 16)\n      // - blockNumber - memory block number where to start reading\n      // - length - how many bytes to read\n      // - blockSize - 4 for MIFARE Ultralight, 16 for MIFARE Classic\n      // ! Caution! length must be divisible by blockSize\n      // ! Caution! MIFARE Classic cards have sector trailers\n      //   containing access bits instead of data, each last block in sector is sector trailer\n      //   (e.g. block 3, 7, 11, 14)\n      //   see memory structure above or https://github.com/pokusew/nfc-pcsc/issues/16#issuecomment-304989178\n      const data = await reader.read(4, 16, 16); // blockSize=16 must specified for MIFARE Classic cards\n\n      _prettyLogger.default.info(`data read`, reader, data);\n\n      const payload = data.readInt32BE(0);\n\n      _prettyLogger.default.info(`data converted`, reader, payload);\n    } catch (err) {\n      _prettyLogger.default.error(`error when reading data`, reader, err);\n    } // example write 16 bytes containing 32bit integer\n    // !!! note that we don't need 16 bytes - 32bit integer takes just 4 bytes !!!\n\n\n    try {\n      // reader.write(blockNumber, data, blockSize = 4, packetSize = 16)\n      // - blockNumber - memory block number where to start writing\n      // - data - what to write\n      // - blockSize - 4 for MIFARE Ultralight, 16 for MIFARE Classic\n      // ! Caution! data.length must be divisible by blockSize\n      // ! Caution! MIFARE Classic cards have sector trailers\n      //   containing access bits instead of data, each last block in sector is sector trailer\n      //   (e.g. block 3, 7, 11, 14)\n      //   ee memory structure above or https://github.com/pokusew/nfc-pcsc/issues/16#issuecomment-304989178\n      const data = Buffer.allocUnsafe(16);\n      data.fill(0);\n      const randomNumber = Math.round(Math.random() * 1000);\n      data.writeInt32BE(randomNumber, 0);\n      await reader.write(4, data, 16); // blockSize=16 must specified for MIFARE Classic cards\n\n      _prettyLogger.default.info(`data written`, reader, randomNumber, data);\n    } catch (err) {\n      _prettyLogger.default.error(`error when writing data`, reader, err);\n    }\n  });\n  reader.on('error', err => {\n    _prettyLogger.default.error(`an error occurred`, reader, err);\n  });\n  reader.on('end', () => {\n    _prettyLogger.default.info(`device removed`, reader);\n  });\n});\nnfc.on('error', err => {\n  _prettyLogger.default.error(`an error occurred`, err);\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1pZmFyZS1jbGFzc2ljLmpzIl0sIm5hbWVzIjpbIm5mYyIsIk5GQyIsIm9uIiwicmVhZGVyIiwicHJldHR5IiwiaW5mbyIsImNhcmQiLCJ0eXBlIiwiVEFHX0lTT18xNDQ0M18zIiwia2V5Iiwia2V5VHlwZSIsIktFWV9UWVBFX0EiLCJhdXRoZW50aWNhdGUiLCJlcnIiLCJlcnJvciIsImRhdGEiLCJyZWFkIiwicGF5bG9hZCIsInJlYWRJbnQzMkJFIiwiQnVmZmVyIiwiYWxsb2NVbnNhZmUiLCJmaWxsIiwicmFuZG9tTnVtYmVyIiwiTWF0aCIsInJvdW5kIiwicmFuZG9tIiwid3JpdGVJbnQzMkJFIiwid3JpdGUiXSwibWFwcGluZ3MiOiJBQUFBLGEsQ0FFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBQ0E7Ozs7QUFHQSxNQUFNQSxHQUFHLEdBQUcsSUFBSUMsVUFBSixFQUFaLEMsQ0FBdUI7O0FBRXZCRCxHQUFHLENBQUNFLEVBQUosQ0FBTyxRQUFQLEVBQWlCLE1BQU1DLE1BQU4sSUFBZ0I7QUFFaENDLHdCQUFPQyxJQUFQLENBQWEsaUJBQWIsRUFBK0JGLE1BQS9COztBQUVBQSxFQUFBQSxNQUFNLENBQUNELEVBQVAsQ0FBVSxNQUFWLEVBQWtCLE1BQU1JLElBQU4sSUFBYztBQUUvQjtBQUNBO0FBQ0EsUUFBSUEsSUFBSSxDQUFDQyxJQUFMLEtBQWNDLHNCQUFsQixFQUFtQztBQUNsQztBQUNBOztBQUVESiwwQkFBT0MsSUFBUCxDQUFhLGVBQWIsRUFBNkJGLE1BQTdCLEVBQXFDRyxJ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Q0FfQVJUL05GQy9uZmMtcGNzYy9leGFtcGxlcy8iLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxuLy8gIyMjIyMjIyMjIyMjI1xuLy8gRXhhbXBsZTogTUlGQVJFIENsYXNzaWNcbi8vIC0gc2hvdWxkIHdvcmsgd2VsbCB3aXRoIGFueSBjb21wYXRpYmxlIFBDL1NDIGNhcmQgcmVhZGVyXG4vLyAtIHdoYXQgaXMgY292ZXJlZDpcbi8vICAgLSBhdXRoZW50aWNhdGlvblxuLy8gICAtIHJlYWRpbmcgZGF0YSBmcm9tIGNhcmRcbi8vICAgLSB3cml0aW5nIGRhdGEgdG8gY2FyZFxuLy8gLSB3aGF0IGlzIE5PVCBjb3ZlcmVkIHlldDpcbi8vICAgLSB1c2luZyBzZWN0b3IgdHJhaWxlcnMgdG8gdXBkYXRlIGFjY2VzcyByaWdodHNcbi8vICMjIyMjIyMjIyMjIyNcblxuLy8gIyMgTm90ZSBhYm91dCB0aGUgY2FyZCdzIGRhdGEgc3RydWN0dXJlXG4vL1xuLy8gIyMjIE1JRkFSRSBDbGFzc2ljIEVWMSAxS1xuLy8gLSAxMDI0IMOXIDggYml0IEVFUFJPTSBtZW1vcnlcbi8vIC0gMTYgc2VjdG9ycyBvZiA0IGJsb2Nrc1xuLy8gLSBzZWUgaHR0cHM6Ly93d3cubnhwLmNvbS9kb2NzL2VuL2RhdGEtc2hlZXQvTUYxUzUwWVlYX1YxLnBkZlxuLy9cbi8vICMjIyBNSUZBUkUgQ2xhc3NpYyBFVjEgNEtcbi8vIC0gNDA5NiDDlyA4IGJpdCBFRVBST00gbWVtb3J5XG4vLyAtIDMyIHNlY3RvcnMgb2YgNCBibG9ja3MgYW5kIDggc2VjdG9ycyBvZiAxNiBibG9ja3Ncbi8vIC0gc2VlIGh0dHBzOi8vd3d3Lm54cC5jb20vZG9jcy9lbi9kYXRhLXNoZWV0L01GMVM3MFlZWF9WMS5wZGZcbi8vXG4vLyBPbmUgYmxvY2sgY29udGFpbnMgMTYgYnl0ZXMuXG4vLyBEb24ndCBmb3JnZXQgc3BlY2lmeSB0aGUgYmxvY2tTaXplIGFyZ3VtZW50IGJsb2NrU2l6ZT0xNiBpbiByZWFkZXIucmVhZCBhbmQgcmVhZGVyLndyaXRlIGNhbGxzLlxuLy8gVGhlIHNtYWxsZXN0IGFtb3VudCBvZiBkYXRhIHRvIHdyaXRlIGlzIG9uZSBibG9jay4gWW91IGNhbiB3cml0ZSBvbmx5IHRoZSBlbnRpcmUgYmxvY2tzIChjYXJkIGxpbWl0YXRpb24pLlxuLy9cbi8vIHNlY3RvciAwXG4vLyBcdGJsb2NrIDAgLSBtYW51ZmFjdHVyZXIgZGF0YSAocmVhZCBvbmx5KVxuLy8gXHRibG9jayAxIC0gZGF0YSBibG9ja1xuLy8gXHRibG9jayAyIC0gZGF0YSBibG9ja1xuLy8gXHRibG9jayAzIC0gc2VjdG9yIHRyYWlsZXIgMFxuLy8gXHRcdGJ5dGVzIDAwLTA1OiBLZXkgQSAoZGVmYXVsdCAweEZGRkZGRkZGRkZGRikgKDYgYnl0ZXMpXG4vLyBcdFx0Ynl0ZXMgMDYtMDk6IEFjY2VzcyBCaXRzIChkZWZhdWx0IDB4RkYwNzgwKSAoNCBieXRlcylcbi8vIFx0XHRieXRlcyAxMC0xNTogS2V5IEIgKG9wdGlvbmFsKSAoZGVmYXVsdCAweEZGRkZGRkZGRkZGRikgKDYgYnl0ZXMpXG4vLyBzZWN0b3IgMTpcbi8vIFx0YmxvY2sgNCAtIGRhdGEgYmxvY2tcbi8vIFx0YmxvY2sgNSAtIGRhdGEgYmxvY2tcbi8vIFx0YmxvY2sgNiAtIGRhdGEgYmxvY2tcbi8vIFx0YmxvY2sgNyAtIHNlY3RvciB0cmFpbGVyIDFcbi8vIHNlY3RvciAyOlxuLy8gXHRibG9jayA4IC0gZGF0YSBibG9ja1xuLy8gXHRibG9jayA5IC0gZGF0YSBibG9ja1xuLy8gXHRibG9jayAxMCAtIGRhdGEgYmxvY2tcbi8vIFx0YmxvY2sgMTEgLSBzZWN0b3IgdHJhaWxlciAyXG4vLyAuLi4gYW5kIHNvIG9uIC4uLlxuXG5pbXBvcnQgeyBORkMsIFRBR19JU09fMTQ0NDNfMywgVEFHX0lTT18xNDQ0M180LCBLRVlfVFlQRV9BLCBLRVlfVFlQRV9CIH0gZnJvbSAnLi4vc3JjL2luZGV4JztcbmltcG9ydCBwcmV0dHkgZnJvbSAnLi9wcmV0dHktbG9nZ2VyJztcblxuXG5jb25zdCBuZmMgPSBuZXcgTkZDKCk7IC8vIGNvbnN0IG5mYyA9IG5ldyBORkMocHJldHR5KTsgLy8gb3B0aW9uYWxseSB5b3UgY2FuIHBhc3MgbG9nZ2VyIHRvIHNlZSBpbnRlcm5hbCBkZWJ1ZyBsb2dzXG5cbm5mYy5vbigncmVhZGVyJywgYXN5bmMgcmVhZGVyID0+IHtcblxuXHRwcmV0dHkuaW5mbyhgZGV2aWNlIGF0dGFjaGVkYCwgcmVhZGVyKTtcblxuXHRyZWFkZXIub24oJ2NhcmQnLCBhc3luYyBjYXJkID0+IHtcblxuXHRcdC8vIE1JRkFSRSBDbGFzc2ljIGlzIElTTy9JRUMgMTQ0NDMtMyB0YWdcblx0XHQvLyBza2lwIG90aGVyIHN0YW5kYXJkc1xuXHRcdGlmIChjYXJkLnR5cGUgIT09IFRBR19JU09fMTQ0NDNfMykge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdHByZXR0eS5pbmZvKGBjYXJkIGRldGVjdGVkYCwgcmVhZGVyLCBjYXJkKTtcblxuXHRcdC8vIFJlYWRpbmcgYW5kIHdyaXRpbmcgZGF0YSBmcm9tL3RvIE1JRkFSRSBDbGFzc2ljIGNhcmRzIChlLmcuIE1JRkFSRSAxSykgQUxXQVlTIHJlcXVpcmVzIGF1dGhlbnRpY2F0aW9uIVxuXG5cdFx0Ly8gSG93IGRvZXMgdGhlIE1JRkFSRSBDbGFzc2ljIGF1dGhlbnRpY2F0aW9uIHdvcms/XG5cdFx0Ly8gMS4gWW91IGF1dGhlbnRpY2F0ZSB0byBhIHNwZWNpZmljIHNlY3RvciB1c2luZyBhIHNwZWNpZmljIGtleSAoa2V5ICsga2V5VHlwZSkuXG5cdFx0Ly8gMi4gQWZ0ZXIgdGhlIHN1Y2Nlc3NmdWwgYXV0aGVudGljYXRpb24sIHlvdSBhcmUgZ3JhbnRlZCBwZXJtaXNzaW9ucyBhY2NvcmRpbmcgdG8gdGhlIGFjY2VzcyBjb25kaXRpb25zXG5cdFx0Ly8gICAgZm9yIHRoZSBnaXZlbiBrZXkgKGFjY2VzcyBjb25kaXRpb25zIGFyZSBzcGVjaWZpZWQgaW4gdGhlIHRyYWlsZXIgc2VjdGlvbiBvZiBlYWNoIHNlY3RvcikuXG5cdFx0Ly8gICAgRGVwZW5kaW5nIG9uIHRoZSBhY2Nlc3MgY29uZGl0aW9ucywgeW91IGNhbiByZWFkIGZyb20gLyB3cml0ZSB0byB0aGUgYmxvY2tzIG9mIHRoaXMgc2VjdG9yLlxuXHRcdC8vIDMuIElmIHlvdSB3YW50IHRvIGFjY2VzcyBkYXRhIGluIGFub3RoZXIgc2VjdG9ycywgeW91IGhhdmUgdG8gYXV0aGVudGljYXRlIHRvIHRoYXQgc2VjdG9yLlxuXHRcdC8vICAgIFRoZW4geW91IGNhbiBhY2Nlc3MgdGhlIGRhdGEgZnJvbSB0aGUgYmxvY2sgd2l0aGluIHRoYXQgc2VjdG9yIChvbmx5IGZyb20gdGhhdCBzZWN0b3IpLlxuXHRcdC8vIHN1bW1hcnk6IE1JRkFSRSBDbGFzc2ljIHdpbGwgb25seSBncmFudCBwZXJtaXNzaW9ucyBiYXNlZCBvbiB0aGUgbGFzdCBhdXRoZW50aWNhdGlvbiBhdHRlbXB0LlxuXHRcdC8vICAgICAgICAgIENvbnNlcXVlbnRseSwgaWYgbXVsdGlwbGUgcmVhZGVyLmF1dGhlbnRpY2F0ZSguLi4pIGNvbW1hbmRzIGFyZSB1c2VkLFxuXHRcdC8vICAgICAgICAgIG9ubHkgdGhlIGxhc3Qgb25lIGhhcyBhbiBlZmZlY3Qgb24gYWxsIHN1YnNlcXVlbnQgcmVhZC93cml0ZSBvcGVyYXRpb25zLlxuXG5cdFx0Ly8gcmVhZGVyLmF1dGhlbnRpY2F0ZShibG9ja051bWJlciwga2V5VHlwZSwga2V5LCBvYnNvbGV0ZSA9IGZhbHNlKVxuXHRcdC8vIC0gYmxvY2tOdW1iZXIgLSB0aGUgbnVtYmVyIG9mIGFueSBibG9jayB3aXRoaW5nIHRoZSBzZWN0b3Igd2Ugd2FudCB0byBhdXRoZW50aWNhdGVcblx0XHQvLyAtIGtleVR5cGUgLSB0eXBlIG9mIGtleSAtIGVpdGhlciBLRVlfVFlQRV9BIG9yIEtFWV9UWVBFX0Jcblx0XHQvLyAtIGtleSAtIDYgYnl0ZXMgLSBhIEJ1ZmZlciBpbnN0YW5jZSwgYW4gYXJyYXkgb2YgYnl0ZXMsIG9yIDEyLWNoYXJzIEhFWCBzdHJpbmdcblx0XHQvLyAtIG9ic29sZXRlIC0gKGRlZmF1bHQgLSBmYWxzZSBmb3IgUEMvU0MgVjIuMDcpIHVzZSB0cnVlIGZvciBQQy9TQyBWMi4wMVxuXG5cdFx0Ly8gRG9uJ3QgZm9yZ2V0IHRvIGZpbGwgWU9VUiBrZXlzIGFuZCB0eXBlcyEgKGRlZmF1bHQgb25lcyBhcmUgc3RhdGVkIGJlbG93KVxuXHRcdGNvbnN0IGtleSA9ICdGRkZGRkZGRkZGRkYnOyAvLyBrZXkgbXVzdCBiZSBhIDEyLWNoYXJzIEhFWCBzdHJpbmcsIGFuIGluc3RhbmNlIG9mIEJ1ZmZlciwgb3IgYXJyYXkgb2YgYnl0ZXNcblx0XHRjb25zdCBrZXlUeXBlID0gS0VZX1RZUEVfQTtcblxuXHRcdHRyeSB7XG5cblx0XHRcdC8vIHdlIHdhbnQgdG8gYXV0aGVudGljYXRlIHNlY3RvciAxXG5cdFx0XHQvLyBhdXRoZW50aWNhdGluZyBvbmUgYmxvY2sgd2l0aGluIHRoZSBzZWN0b3Igd2lsbCBhdXRoZW50aWNhdGUgYWxsIGJsb2NrcyB3aXRoaW4gdGhhdCBzZWN0b3Jcblx0XHRcdC8vIHNvIGluIG91ciBjYXNlLCB3ZSBjaG9vc2UgYmxvY2sgNCB0aGF0IGlzIHdpdGhpbiB0aGUgc2VjdG9yIDEsIGFsbCBibG9ja3MgKDQsIDUsIDYsIDcpXG5cdFx0XHQvLyB3aWxsIGJlIGF1dGhlbnRpY2F0ZWQgd2l0aCB0aGUgZ2l2ZW4ga2V5XG5cdFx0XHRhd2FpdCByZWFkZXIuYXV0aGVudGljYXRlKDQsIGtleVR5cGUsIGtleSk7XG5cblx0XHRcdC8vIE5vdGU6IHdyaXRpbmcgbWlnaHQgcmVxdWlyZSB0byBhdXRoZW50aWNhdGUgd2l0aCBhIGRpZmZlcmVudCBrZXkgKGJhc2VkIG9uIHRoZSBzZWN0b3IgYWNjZXNzIGNvbmRpdGlvbnMpXG5cblx0XHRcdHByZXR0eS5pbmZvKGBzZWN0b3IgMSBzdWNjZXNzZnVsbHkgYXV0aGVudGljYXRlZGAsIHJlYWRlcik7XG5cblx0XHR9IGNhdGNoIChlcnIpIHtcblx0XHRcdHByZXR0eS5lcnJvcihgZXJyb3Igd2hlbiBhdXRoZW50aWNhdGluZyBibG9jayA0IHdpdGhpbiB0aGUgc2VjdG9yIDFgLCByZWFkZXIsIGVycik7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cblx0XHQvLyBleGFtcGxlIHJlYWRpbmcgMTYgYnl0ZXMgKG9uZSBibG9jaykgYXNzdW1pbmcgY29udGFpbmluZyAzMmJpdCBpbnRlZ2VyXG5cdFx0Ly8gISEhIG5vdGUgdGhhdCB3ZSBkb24ndCBuZWVkIDE2IGJ5dGVzIC0gMzJiaXQgaW50ZWdlciB0YWtlcyBvbmx5IDQgYnl0ZXMgISEhXG5cdFx0dHJ5IHtcblxuXHRcdFx0Ly8gcmVhZGVyLnJlYWQoYmxvY2tOdW1iZXIsIGxlbmd0aCwgYmxvY2tTaXplID0gNCwgcGFja2V0U2l6ZSA9IDE2KVxuXHRcdFx0Ly8gLSBibG9ja051bWJlciAtIG1lbW9yeSBibG9jayBudW1iZXIgd2hlcmUgdG8gc3RhcnQgcmVhZGluZ1xuXHRcdFx0Ly8gLSBsZW5ndGggLSBob3cgbWFueSBieXRlcyB0byByZWFkXG5cdFx0XHQvLyAtIGJsb2NrU2l6ZSAtIDQgZm9yIE1JRkFSRSBVbHRyYWxpZ2h0LCAxNiBmb3IgTUlGQVJFIENsYXNzaWNcblx0XHRcdC8vICEgQ2F1dGlvbiEgbGVuZ3RoIG11c3QgYmUgZGl2aXNpYmxlIGJ5IGJsb2NrU2l6ZVxuXHRcdFx0Ly8gISBDYXV0aW9uISBNSUZBUkUgQ2xhc3NpYyBjYXJkcyBoYXZlIHNlY3RvciB0cmFpbGVyc1xuXHRcdFx0Ly8gICBjb250YWluaW5nIGFjY2VzcyBiaXRzIGluc3RlYWQgb2YgZGF0YSwgZWFjaCBsYXN0IGJsb2NrIGluIHNlY3RvciBpcyBzZWN0b3IgdHJhaWxlclxuXHRcdFx0Ly8gICAoZS5nLiBibG9jayAzLCA3LCAxMSwgMTQpXG5cdFx0XHQvLyAgIHNlZSBtZW1vcnkgc3RydWN0dXJlIGFib3ZlIG9yIGh0dHBzOi8vZ2l0aHViLmNvbS9wb2t1c2V3L25mYy1wY3NjL2lzc3Vlcy8xNiNpc3N1ZWNvbW1lbnQtMzA0OTg5MTc4XG5cblx0XHRcdGNvbnN0IGRhdGEgPSBhd2FpdCByZWFkZXIucmVhZCg0LCAxNiwgMTYpOyAvLyBibG9ja1NpemU9MTYgbXVzdCBzcGVjaWZpZWQgZm9yIE1JRkFSRSBDbGFzc2ljIGNhcmRzXG5cblx0XHRcdHByZXR0eS5pbmZvKGBkYXRhIHJlYWRgLCByZWFkZXIsIGRhdGEpO1xuXG5cdFx0XHRjb25zdCBwYXlsb2FkID0gZGF0YS5yZWFkSW50MzJCRSgwKTtcblxuXHRcdFx0cHJldHR5LmluZm8oYGRhdGEgY29udmVydGVkYCwgcmVhZGVyLCBwYXlsb2FkKTtcblxuXHRcdH0gY2F0Y2ggKGVycikge1xuXHRcdFx0cHJldHR5LmVycm9yKGBlcnJvciB3aGVuIHJlYWRpbmcgZGF0YWAsIHJlYWRlciwgZXJyKTtcblx0XHR9XG5cblxuXHRcdC8vIGV4YW1wbGUgd3JpdGUgMTYgYnl0ZXMgY29udGFpbmluZyAzMmJpdCBpbnRlZ2VyXG5cdFx0Ly8gISEhIG5vdGUgdGhhdCB3ZSBkb24ndCBuZWVkIDE2IGJ5dGVzIC0gMzJiaXQgaW50ZWdlciB0YWtlcyBqdXN0IDQgYnl0ZXMgISEhXG5cdFx0dHJ5IHtcblxuXHRcdFx0Ly8gcmVhZGVyLndyaXRlKGJsb2NrTnVtYmVyLCBkYXRhLCBibG9ja1NpemUgPSA0LCBwYWNrZXRTaXplID0gMTYpXG5cdFx0XHQvLyAtIGJsb2NrTnVtYmVyIC0gbWVtb3J5IGJsb2NrIG51bWJlciB3aGVyZSB0byBzdGFydCB3cml0aW5nXG5cdFx0XHQvLyAtIGRhdGEgLSB3aGF0IHRvIHdyaXRlXG5cdFx0XHQvLyAtIGJsb2NrU2l6ZSAtIDQgZm9yIE1JRkFSRSBVbHRyYWxpZ2h0LCAxNiBmb3IgTUlGQVJFIENsYXNzaWNcblx0XHRcdC8vICEgQ2F1dGlvbiEgZGF0YS5sZW5ndGggbXVzdCBiZSBkaXZpc2libGUgYnkgYmxvY2tTaXplXG5cdFx0XHQvLyAhIENhdXRpb24hIE1JRkFSRSBDbGFzc2ljIGNhcmRzIGhhdmUgc2VjdG9yIHRyYWlsZXJzXG5cdFx0XHQvLyAgIGNvbnRhaW5pbmcgYWNjZXNzIGJpdHMgaW5zdGVhZCBvZiBkYXRhLCBlYWNoIGxhc3QgYmxvY2sgaW4gc2VjdG9yIGlzIHNlY3RvciB0cmFpbGVyXG5cdFx0XHQvLyAgIChlLmcuIGJsb2NrIDMsIDcsIDExLCAxNClcblx0XHRcdC8vICAgZWUgbWVtb3J5IHN0cnVjdHVyZSBhYm92ZSBvciBodHRwczovL2dpdGh1Yi5jb20vcG9rdXNldy9uZmMtcGNzYy9pc3N1ZXMvMTYjaXNzdWVjb21tZW50LTMwNDk4OTE3OFxuXG5cdFx0XHRjb25zdCBkYXRhID0gQnVmZmVyLmFsbG9jVW5zYWZlKDE2KTtcblx0XHRcdGRhdGEuZmlsbCgwKTtcblx0XHRcdGNvbnN0IHJhbmRvbU51bWJlciA9IE1hdGgucm91bmQoTWF0aC5yYW5kb20oKSAqIDEwMDApO1xuXHRcdFx0ZGF0YS53cml0ZUludDMyQkUocmFuZG9tTnVtYmVyLCAwKTtcblxuXHRcdFx0YXdhaXQgcmVhZGVyLndyaXRlKDQsIGRhdGEsIDE2KTsgLy8gYmxvY2tTaXplPTE2IG11c3Qgc3BlY2lmaWVkIGZvciBNSUZBUkUgQ2xhc3NpYyBjYXJkc1xuXG5cdFx0XHRwcmV0dHkuaW5mbyhgZGF0YSB3cml0dGVuYCwgcmVhZGVyLCByYW5kb21OdW1iZXIsIGRhdGEpO1xuXG5cdFx0fSBjYXRjaCAoZXJyKSB7XG5cdFx0XHRwcmV0dHkuZXJyb3IoYGVycm9yIHdoZW4gd3JpdGluZyBkYXRhYCwgcmVhZGVyLCBlcnIpO1xuXHRcdH1cblxuXG5cdH0pO1xuXG5cdHJlYWRlci5vbignZXJyb3InLCBlcnIgPT4ge1xuXHRcdHByZXR0eS5lcnJvcihgYW4gZXJyb3Igb2NjdXJyZWRgLCByZWFkZXIsIGVycik7XG5cdH0pO1xuXG5cdHJlYWRlci5vbignZW5kJywgKCkgPT4ge1xuXHRcdHByZXR0eS5pbmZvKGBkZXZpY2UgcmVtb3ZlZGAsIHJlYWRlcik7XG5cdH0pO1xuXG5cbn0pO1xuXG5uZmMub24oJ2Vycm9yJywgZXJyID0+IHtcblx0cHJldHR5LmVycm9yKGBhbiBlcnJvciBvY2N1cnJlZGAsIGVycik7XG59KTtcbiJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "mifare-classic.js"
      ],
      "names": [
        "nfc",
        "NFC",
        "on",
        "reader",
        "pretty",
        "info",
        "card",
        "type",
        "TAG_ISO_14443_3",
        "key",
        "keyType",
        "KEY_TYPE_A",
        "authenticate",
        "err",
        "error",
        "data",
        "read",
        "payload",
        "readInt32BE",
        "Buffer",
        "allocUnsafe",
        "fill",
        "randomNumber",
        "Math",
        "round",
        "random",
        "writeInt32BE",
        "write"
      ],
      "mappings": "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",
      "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/",
      "sourcesContent": [
        "\"use strict\";\n\n// #############\n// Example: MIFARE Classic\n// - should work well with any compatible PC/SC card reader\n// - what is covered:\n//   - authentication\n//   - reading data from card\n//   - writing data to card\n// - what is NOT covered yet:\n//   - using sector trailers to update access rights\n// #############\n\n// ## Note about the card's data structure\n//\n// ### MIFARE Classic EV1 1K\n// - 1024 × 8 bit EEPROM memory\n// - 16 sectors of 4 blocks\n// - see https://www.nxp.com/docs/en/data-sheet/MF1S50YYX_V1.pdf\n//\n// ### MIFARE Classic EV1 4K\n// - 4096 × 8 bit EEPROM memory\n// - 32 sectors of 4 blocks and 8 sectors of 16 blocks\n// - see https://www.nxp.com/docs/en/data-sheet/MF1S70YYX_V1.pdf\n//\n// One block contains 16 bytes.\n// Don't forget specify the blockSize argument blockSize=16 in reader.read and reader.write calls.\n// The smallest amount of data to write is one block. You can write only the entire blocks (card limitation).\n//\n// sector 0\n// \tblock 0 - manufacturer data (read only)\n// \tblock 1 - data block\n// \tblock 2 - data block\n// \tblock 3 - sector trailer 0\n// \t\tbytes 00-05: Key A (default 0xFFFFFFFFFFFF) (6 bytes)\n// \t\tbytes 06-09: Access Bits (default 0xFF0780) (4 bytes)\n// \t\tbytes 10-15: Key B (optional) (default 0xFFFFFFFFFFFF) (6 bytes)\n// sector 1:\n// \tblock 4 - data block\n// \tblock 5 - data block\n// \tblock 6 - data block\n// \tblock 7 - sector trailer 1\n// sector 2:\n// \tblock 8 - data block\n// \tblock 9 - data block\n// \tblock 10 - data block\n// \tblock 11 - sector trailer 2\n// ... and so on ...\n\nimport { NFC, TAG_ISO_14443_3, TAG_ISO_14443_4, KEY_TYPE_A, KEY_TYPE_B } from '../src/index';\nimport pretty from './pretty-logger';\n\n\nconst nfc = new NFC(); // const nfc = new NFC(pretty); // optionally you can pass logger to see internal debug logs\n\nnfc.on('reader', async reader => {\n\n\tpretty.info(`device attached`, reader);\n\n\treader.on('card', async card => {\n\n\t\t// MIFARE Classic is ISO/IEC 14443-3 tag\n\t\t// skip other standards\n\t\tif (card.type !== TAG_ISO_14443_3) {\n\t\t\treturn;\n\t\t}\n\n\t\tpretty.info(`card detected`, reader, card);\n\n\t\t// Reading and writing data from/to MIFARE Classic cards (e.g. MIFARE 1K) ALWAYS requires authentication!\n\n\t\t// How does the MIFARE Classic authentication work?\n\t\t// 1. You authenticate to a specific sector using a specific key (key + keyType).\n\t\t// 2. After the successful authentication, you are granted permissions according to the access conditions\n\t\t//    for the given key (access conditions are specified in the trailer section of each sector).\n\t\t//    Depending on the access conditions, you can read from / write to the blocks of this sector.\n\t\t// 3. If you want to access data in another sectors, you have to authenticate to that sector.\n\t\t//    Then you can access the data from the block within that sector (only from that sector).\n\t\t// summary: MIFARE Classic will only grant permissions based on the last authentication attempt.\n\t\t//          Consequently, if multiple reader.authenticate(...) commands are used,\n\t\t//          only the last one has an effect on all subsequent read/write operations.\n\n\t\t// reader.authenticate(blockNumber, keyType, key, obsolete = false)\n\t\t// - blockNumber - the number of any block withing the sector we want to authenticate\n\t\t// - keyType - type of key - either KEY_TYPE_A or KEY_TYPE_B\n\t\t// - key - 6 bytes - a Buffer instance, an array of bytes, or 12-chars HEX string\n\t\t// - obsolete - (default - false for PC/SC V2.07) use true for PC/SC V2.01\n\n\t\t// Don't forget to fill YOUR keys and types! (default ones are stated below)\n\t\tconst key = 'FFFFFFFFFFFF'; // key must be a 12-chars HEX string, an instance of Buffer, or array of bytes\n\t\tconst keyType = KEY_TYPE_A;\n\n\t\ttry {\n\n\t\t\t// we want to authenticate sector 1\n\t\t\t// authenticating one block within the sector will authenticate all blocks within that sector\n\t\t\t// so in our case, we choose block 4 that is within the sector 1, all blocks (4, 5, 6, 7)\n\t\t\t// will be authenticated with the given key\n\t\t\tawait reader.authenticate(4, keyType, key);\n\n\t\t\t// Note: writing might require to authenticate with a different key (based on the sector access conditions)\n\n\t\t\tpretty.info(`sector 1 successfully authenticated`, reader);\n\n\t\t} catch (err) {\n\t\t\tpretty.error(`error when authenticating block 4 within the sector 1`, reader, err);\n\t\t\treturn;\n\t\t}\n\n\n\t\t// example reading 16 bytes (one block) assuming containing 32bit integer\n\t\t// !!! note that we don't need 16 bytes - 32bit integer takes only 4 bytes !!!\n\t\ttry {\n\n\t\t\t// reader.read(blockNumber, length, blockSize = 4, packetSize = 16)\n\t\t\t// - blockNumber - memory block number where to start reading\n\t\t\t// - length - how many bytes to read\n\t\t\t// - blockSize - 4 for MIFARE Ultralight, 16 for MIFARE Classic\n\t\t\t// ! Caution! length must be divisible by blockSize\n\t\t\t// ! Caution! MIFARE Classic cards have sector trailers\n\t\t\t//   containing access bits instead of data, each last block in sector is sector trailer\n\t\t\t//   (e.g. block 3, 7, 11, 14)\n\t\t\t//   see memory structure above or https://github.com/pokusew/nfc-pcsc/issues/16#issuecomment-304989178\n\n\t\t\tconst data = await reader.read(4, 16, 16); // blockSize=16 must specified for MIFARE Classic cards\n\n\t\t\tpretty.info(`data read`, reader, data);\n\n\t\t\tconst payload = data.readInt32BE(0);\n\n\t\t\tpretty.info(`data converted`, reader, payload);\n\n\t\t} catch (err) {\n\t\t\tpretty.error(`error when reading data`, reader, err);\n\t\t}\n\n\n\t\t// example write 16 bytes containing 32bit integer\n\t\t// !!! note that we don't need 16 bytes - 32bit integer takes just 4 bytes !!!\n\t\ttry {\n\n\t\t\t// reader.write(blockNumber, data, blockSize = 4, packetSize = 16)\n\t\t\t// - blockNumber - memory block number where to start writing\n\t\t\t// - data - what to write\n\t\t\t// - blockSize - 4 for MIFARE Ultralight, 16 for MIFARE Classic\n\t\t\t// ! Caution! data.length must be divisible by blockSize\n\t\t\t// ! Caution! MIFARE Classic cards have sector trailers\n\t\t\t//   containing access bits instead of data, each last block in sector is sector trailer\n\t\t\t//   (e.g. block 3, 7, 11, 14)\n\t\t\t//   ee memory structure above or https://github.com/pokusew/nfc-pcsc/issues/16#issuecomment-304989178\n\n\t\t\tconst data = Buffer.allocUnsafe(16);\n\t\t\tdata.fill(0);\n\t\t\tconst randomNumber = Math.round(Math.random() * 1000);\n\t\t\tdata.writeInt32BE(randomNumber, 0);\n\n\t\t\tawait reader.write(4, data, 16); // blockSize=16 must specified for MIFARE Classic cards\n\n\t\t\tpretty.info(`data written`, reader, randomNumber, data);\n\n\t\t} catch (err) {\n\t\t\tpretty.error(`error when writing data`, reader, err);\n\t\t}\n\n\n\t});\n\n\treader.on('error', err => {\n\t\tpretty.error(`an error occurred`, reader, err);\n\t});\n\n\treader.on('end', () => {\n\t\tpretty.info(`device removed`, reader);\n\t});\n\n\n});\n\nnfc.on('error', err => {\n\tpretty.error(`an error occurred`, err);\n});\n"
      ]
    },
    "sourceType": "script",
    "mtime": 1662229648497
  },
  "{\"sourceRoot\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc\",\"filename\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/mifare-desfire.js\",\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{}},{\"key\":\"proposal-class-properties\",\"visitor\":{\"PrivateName\":{\"enter\":[null]},\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{}}],\"presets\":[]}:7.12.17": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/",
      "caller": {
        "name": "@babel/register"
      },
      "cwd": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc",
      "filename": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/mifare-desfire.js",
      "cloneInputAst": true,
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {}
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {}
        },
        {
          "key": "proposal-class-properties",
          "visitor": {
            "PrivateName": {
              "enter": [
                null
              ]
            },
            "ExportDefaultDeclaration": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true,
            "ClassExpression": {
              "enter": [
                null
              ]
            },
            "ClassDeclaration": {
              "enter": [
                null
              ]
            }
          },
          "options": {}
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/mifare-desfire.js",
        "plugins": [
          "objectRestSpread",
          "classProperties",
          "classPrivateProperties"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/mifare-desfire.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/",
        "sourceFileName": "mifare-desfire.js"
      }
    },
    "ast": null,
    "code": "\"use strict\"; // #############\n// Example: MIFARE DESFire\n// - what is covered:\n//   - 3DES authentication\n//   - reading data files\n// - known issue:\n//   - [mac0S Sierra and greater] when an error occurs during the authentication process,\n//     the NFC must be reinitialized or the reader reconnected\n//     in order to allow subsequent successful operations (TODO: add appropriate links, fix and test)\n// #############\n\nvar _index = require(\"../src/index\");\n\nvar _prettyLogger = _interopRequireDefault(require(\"./pretty-logger\"));\n\nvar _crypto = _interopRequireDefault(require(\"crypto\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// config\nconst desfire = {\n  key: '00000000000000000000000000000000',\n  appId: [0x00, 0x00, 0x00],\n  keyId: [0x00],\n  read: {\n    // supply location of an existing data\n    fileId: [0x02],\n    offset: [0x00, 0x00, 0x00],\n    length: [14, 0x00, 0x00]\n  }\n};\n\nfunction decrypt(key, data, iv = Buffer.alloc(8).fill(0)) {\n  const decipher = _crypto.default.createDecipheriv('DES-EDE-CBC', key, iv);\n\n  decipher.setAutoPadding(false);\n  return Buffer.concat([decipher.update(data), decipher.final()]);\n}\n\nfunction encrypt(key, data, iv = Buffer.alloc(8).fill(0)) {\n  const decipher = _crypto.default.createCipheriv('DES-EDE-CBC', key, iv);\n\n  decipher.setAutoPadding(false);\n  return Buffer.concat([decipher.update(data), decipher.final()]);\n}\n\nconst nfc = new _index.NFC();\nnfc.on('reader', async reader => {\n  _prettyLogger.default.info(`device attached`, reader); // we have to handle MIFARE DESFire\n\n\n  reader.autoProcessing = false; // just handy shortcut to send data\n\n  const send = async (cmd, comment = null, responseMaxLength = 40) => {\n    const b = Buffer.from(cmd);\n    console.log((comment ? `[${comment}] ` : '') + `sending`, b);\n    const data = await reader.transmit(b, responseMaxLength);\n    console.log((comment ? `[${comment}] ` : '') + `received data`, data);\n    return data;\n  };\n\n  const wrap = (cmd, dataIn) => [0x90, cmd, 0x00, 0x00, dataIn.length, ...dataIn, 0x00];\n\n  reader.on('card', async card => {\n    _prettyLogger.default.info(`card detected`, reader, card);\n\n    const selectApplication = async () => {\n      // 1: [0x5A] SelectApplication(appId) [4 bytes] - Selects one specific application for further access\n      // DataIn: appId (3 bytes)\n      const res = await send(wrap(0x5a, desfire.appId), 'step 1 - select app'); // something went wrong\n\n      if (res.slice(-1)[0] !== 0x00) {\n        throw new Error('error in step 1');\n      }\n    };\n\n    const authenticate = async key => {\n      // 2: [0x0a] Authenticate(keyId) [2bytes]\n      // DataIn: keyId (1 byte)\n      const res1 = await send(wrap(0x0a, desfire.keyId), 'step 2 - authenticate'); // something went wrong\n\n      if (res1.slice(-1)[0] !== 0xaf) {\n        throw new Error('error in step 2 - authenticate');\n      } // encrypted RndB from reader\n      // cut out status code (last 2 bytes)\n\n\n      const ecRndB = res1.slice(0, -2); // decrypt it\n\n      const RndB = decrypt(key, ecRndB); // rotate RndB\n\n      const RndBp = Buffer.concat([RndB.slice(1, 8), RndB.slice(0, 1)]); // generate a 8 byte Random Number A\n\n      const RndA = _crypto.default.randomBytes(8); // concat RndA and RndBp\n\n\n      const msg = encrypt(key, Buffer.concat([RndA, RndBp])); // send it back to the reader\n\n      const res2 = await send(wrap(0xaf, msg), 'step 2 - set up RndA'); // something went wrong\n\n      if (res2.slice(-1)[0] !== 0x00) {\n        throw new Error('error in step 2 - set up RndA');\n      } // encrypted RndAp from reader\n      // cut out status code (last 2 bytes)\n\n\n      const ecRndAp = res2.slice(0, -2); // decrypt to get rotated value of RndA2\n\n      const RndAp = decrypt(key, ecRndAp); // rotate\n\n      const RndA2 = Buffer.concat([RndAp.slice(7, 8), RndAp.slice(0, 7)]); // compare decrypted RndA2 response from reader with our RndA\n      // if it equals authentication process was successful\n\n      if (!RndA.equals(RndA2)) {\n        throw new Error('error in step 2 - match RndA random bytes');\n      }\n\n      return {\n        RndA,\n        RndB\n      };\n    };\n\n    const readData = async () => {\n      // 3: [0xBD] ReadData(FileNo,Offset,Length) [8bytes] - Reads data from Standard Data Files or Backup Data Files\n      const res = await send(wrap(0xbd, [desfire.read.fileId, ...desfire.read.offset, ...desfire.read.length]), 'step 3 - read', 255); // something went wrong\n\n      if (res.slice(-1)[0] !== 0x00) {\n        throw new Error('error in step 3 - read');\n      }\n\n      console.log('data', res);\n    };\n\n    try {\n      // step 1\n      await selectApplication(); // step 2\n\n      const key = Buffer.from(desfire.key, 'hex');\n      await authenticate(key); // step 3\n\n      await readData();\n    } catch (err) {\n      _prettyLogger.default.error(`error occurred during processing steps`, reader, err);\n    }\n  });\n  reader.on('error', err => {\n    _prettyLogger.default.error(`an error occurred`, reader, err);\n  });\n  reader.on('end', () => {\n    _prettyLogger.default.info(`device removed`, reader);\n  });\n});\nnfc.on('error', err => {\n  _prettyLogger.default.error(`an error occurred`, err);\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1pZmFyZS1kZXNmaXJlLmpzIl0sIm5hbWVzIjpbImRlc2ZpcmUiLCJrZXkiLCJhcHBJZCIsImtleUlkIiwicmVhZCIsImZpbGVJZCIsIm9mZnNldCIsImxlbmd0aCIsImRlY3J5cHQiLCJkYXRhIiwiaXYiLCJCdWZmZXIiLCJhbGxvYyIsImZpbGwiLCJkZWNpcGhlciIsImNyeXB0byIsImNyZWF0ZURlY2lwaGVyaXYiLCJzZXRBdXRvUGFkZGluZyIsImNvbmNhdCIsInVwZGF0ZSIsImZpbmFsIiwiZW5jcnlwdCIsImNyZWF0ZUNpcGhlcml2IiwibmZjIiwiTkZDIiwib24iLCJyZWFkZXIiLCJwcmV0dHkiLCJpbmZvIiwiYXV0b1Byb2Nlc3NpbmciLCJzZW5kIiwiY21kIiwiY29tbWVudCIsInJlc3BvbnNlTWF4TGVuZ3RoIiwiYiIsImZyb20iLCJjb25zb2xlIiwibG9nIiwidHJhbnNtaXQiLCJ3cmFwIiwiZGF0YUluIiwiY2FyZCIsInNlbGVjdEFwcGxpY2F0aW9uIiwicmVzIiwic2xpY2UiLCJFcnJvciIsImF1dGhlbnRpY2F0ZSIsInJlczEiLCJlY1JuZEIiLCJSbmRCIiwiUm5kQnAiLCJSbmRBIiwicmFuZG9tQnl0ZXMiLCJtc2ciLCJyZXMyIiwiZWNSbmRBcCIsIlJuZEFwIiwiUm5kQTIiLCJlcXVhbHMiLCJyZWFkRGF0YSIsImVyciIsImVycm9yIl0sIm1hcHBpbmdzIjoiQUFBQSxhLENBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBQ0E7O0FBQ0E7Ozs7QUFHQTtBQUNBLE1BQU1BLE9BQU8sR0FBRztBQUNmQyxFQUFBQSxHQUFHLEVBQUUsa0NBRFU7QUFFZkMsRUFBQUEsS0FBSyxFQUFFLENBQUMsSUFBRCxFQUFPLElBQVAsRUFBYSxJQUFiLENBRlE7QUFHZkMsRUFBQUEsS0FBSyxFQUFFLENBQUMsSUFBRCxDQUhRO0FBSWZDLEVBQUFBLElBQUksRUFBRTtBQUFFO0FBQ1BDLElBQUFBLE1B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QUFQLENBQVUsS0FBVixFQUFpQixNQUFNO0FBQ3RCRSwwQkFBT0MsSUFBUCxDQUFhLGdCQUFiLEVBQThCRixNQUE5QjtBQUNBLEdBRkQ7QUFLQSxDQWhKRDtBQWtKQUgsR0FBRyxDQUFDRSxFQUFKLENBQU8sT0FBUCxFQUFnQm1DLEdBQUcsSUFBSTtBQUN0QmpDLHdCQUFPa0MsS0FBUCxDQUFjLG1CQUFkLEVBQWtDRCxHQUFsQztBQUNBLENBRkQiLCJzb3VyY2VSb290IjoiL1VzZXJzL2hhcnJ5aG93L0RvY3VtZW50cy8yMDIyL1BST0pFQ1RfTU9DQV9BUlQvTkZDL25mYy1wY3NjL2V4YW1wbGVzLyIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG4vLyAjIyMjIyMjIyMjIyMjXG4vLyBFeGFtcGxlOiBNSUZBUkUgREVTRmlyZVxuLy8gLSB3aGF0IGlzIGNvdmVyZWQ6XG4vLyAgIC0gM0RFUyBhdXRoZW50aWNhdGlvblxuLy8gICAtIHJlYWRpbmcgZGF0YSBmaWxlc1xuLy8gLSBrbm93biBpc3N1ZTpcbi8vICAgLSBbbWFjMFMgU2llcnJhIGFuZCBncmVhdGVyXSB3aGVuIGFuIGVycm9yIG9jY3VycyBkdXJpbmcgdGhlIGF1dGhlbnRpY2F0aW9uIHByb2Nlc3MsXG4vLyAgICAgdGhlIE5GQyBtdXN0IGJlIHJlaW5pdGlhbGl6ZWQgb3IgdGhlIHJlYWRlciByZWNvbm5lY3RlZFxuLy8gICAgIGluIG9yZGVyIHRvIGFsbG93IHN1YnNlcXVlbnQgc3VjY2Vzc2Z1bCBvcGVyYXRpb25zIChUT0RPOiBhZGQgYXBwcm9wcmlhdGUgbGlua3MsIGZpeCBhbmQgdGVzdClcbi8vICMjIyMjIyMjIyMjIyNcblxuaW1wb3J0IHsgTkZDIH0gZnJvbSAnLi4vc3JjL2luZGV4JztcbmltcG9ydCBwcmV0dHkgZnJvbSAnLi9wcmV0dHktbG9nZ2VyJztcbmltcG9ydCBjcnlwdG8gZnJvbSAnY3J5cHRvJztcblxuXG4vLyBjb25maWdcbmNvbnN0IGRlc2ZpcmUgPSB7XG5cdGtleTogJzAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwJyxcblx0YXBwSWQ6IFsweDAwLCAweDAwLCAweDAwXSxcblx0a2V5SWQ6IFsweDAwXSxcblx0cmVhZDogeyAvLyBzdXBwbHkgbG9jYXRpb24gb2YgYW4gZXhpc3RpbmcgZGF0YVxuXHRcdGZpbGVJZDogWzB4MDJdLFxuXHRcdG9mZnNldDogWzB4MDAsIDB4MDAsIDB4MDBdLFxuXHRcdGxlbmd0aDogWzE0LCAweDAwLCAweDAwXSxcblx0fSxcbn07XG5cblxuZnVuY3Rpb24gZGVjcnlwdChrZXksIGRhdGEsIGl2ID0gQnVmZmVyLmFsbG9jKDgpLmZpbGwoMCkpIHtcblxuXHRjb25zdCBkZWNpcGhlciA9IGNyeXB0by5jcmVhdGVEZWNpcGhlcml2KCdERVMtRURFLUNCQycsIGtleSwgaXYpO1xuXHRkZWNpcGhlci5zZXRBdXRvUGFkZGluZyhmYWxzZSk7XG5cblx0cmV0dXJuIEJ1ZmZlci5jb25jYXQoW2RlY2lwaGVyLnVwZGF0ZShkYXRhKSwgZGVjaXBoZXIuZmluYWwoKV0pO1xuXG59XG5cbmZ1bmN0aW9uIGVuY3J5cHQoa2V5LCBkYXRhLCBpdiA9IEJ1ZmZlci5hbGxvYyg4KS5maWxsKDApKSB7XG5cblx0Y29uc3QgZGVjaXBoZXIgPSBjcnlwdG8uY3JlYXRlQ2lwaGVyaXYoJ0RFUy1FREUtQ0JDJywga2V5LCBpdik7XG5cdGRlY2lwaGVyLnNldEF1dG9QYWRkaW5nKGZhbHNlKTtcblxuXHRyZXR1cm4gQnVmZmVyLmNvbmNhdChbZGVjaXBoZXIudXBkYXRlKGRhdGEpLCBkZWNpcGhlci5maW5hbCgpXSk7XG5cbn1cblxuXG5jb25zdCBuZmMgPSBuZXcgTkZDKCk7XG5cbm5mYy5vbigncmVhZGVyJywgYXN5bmMgcmVhZGVyID0+IHtcblxuXHRwcmV0dHkuaW5mbyhgZGV2aWNlIGF0dGFjaGVkYCwgcmVhZGVyKTtcblxuXHQvLyB3ZSBoYXZlIHRvIGhhbmRsZSBNSUZBUkUgREVTRmlyZVxuXHRyZWFkZXIuYXV0b1Byb2Nlc3NpbmcgPSBmYWxzZTtcblxuXHQvLyBqdXN0IGhhbmR5IHNob3J0Y3V0IHRvIHNlbmQgZGF0YVxuXHRjb25zdCBzZW5kID0gYXN5bmMgKGNtZCwgY29tbWVudCA9IG51bGwsIHJlc3BvbnNlTWF4TGVuZ3RoID0gNDApID0+IHtcblxuXHRcdGNvbnN0IGIgPSBCdWZmZXIuZnJvbShjbWQpO1xuXG5cdFx0Y29uc29sZS5sb2coKGNvbW1lbnQgPyBgWyR7Y29tbWVudH1dIGAgOiAnJykgKyBgc2VuZGluZ2AsIGIpO1xuXG5cdFx0Y29uc3QgZGF0YSA9IGF3YWl0IHJlYWRlci50cmFuc21pdChiLCByZXNwb25zZU1heExlbmd0aCk7XG5cblx0XHRjb25zb2xlLmxvZygoY29tbWVudCA/IGBbJHtjb21tZW50fV0gYCA6ICcnKSArIGByZWNlaXZlZCBkYXRhYCwgZGF0YSk7XG5cblx0XHRyZXR1cm4gZGF0YTtcblxuXHR9O1xuXG5cdGNvbnN0IHdyYXAgPSAoY21kLCBkYXRhSW4pID0+IChbMHg5MCwgY21kLCAweDAwLCAweDAwLCBkYXRhSW4ubGVuZ3RoLCAuLi5kYXRhSW4sIDB4MDBdKTtcblxuXHRyZWFkZXIub24oJ2NhcmQnLCBhc3luYyBjYXJkID0+IHtcblxuXHRcdHByZXR0eS5pbmZvKGBjYXJkIGRldGVjdGVkYCwgcmVhZGVyLCBjYXJkKTtcblxuXHRcdGNvbnN0IHNlbGVjdEFwcGxpY2F0aW9uID0gYXN5bmMgKCkgPT4ge1xuXG5cdFx0XHQvLyAxOiBbMHg1QV0gU2VsZWN0QXBwbGljYXRpb24oYXBwSWQpIFs0IGJ5dGVzXSAtIFNlbGVjdHMgb25lIHNwZWNpZmljIGFwcGxpY2F0aW9uIGZvciBmdXJ0aGVyIGFjY2Vzc1xuXHRcdFx0Ly8gRGF0YUluOiBhcHBJZCAoMyBieXRlcylcblx0XHRcdGNvbnN0IHJlcyA9IGF3YWl0IHNlbmQod3JhcCgweDVhLCBkZXNmaXJlLmFwcElkKSwgJ3N0ZXAgMSAtIHNlbGVjdCBhcHAnKTtcblxuXHRcdFx0Ly8gc29tZXRoaW5nIHdlbnQgd3Jvbmdcblx0XHRcdGlmIChyZXMuc2xpY2UoLTEpWzBdICE9PSAweDAwKSB7XG5cdFx0XHRcdHRocm93IG5ldyBFcnJvcignZXJyb3IgaW4gc3RlcCAxJyk7XG5cdFx0XHR9XG5cblxuXHRcdH07XG5cblx0XHRjb25zdCBhdXRoZW50aWNhdGUgPSBhc3luYyAoa2V5KSA9PiB7XG5cblx0XHRcdC8vIDI6IFsweDBhXSBBdXRoZW50aWNhdGUoa2V5SWQpIFsyYnl0ZXNdXG5cdFx0XHQvLyBEYXRhSW46IGtleUlkICgxIGJ5dGUpXG5cdFx0XHRjb25zdCByZXMxID0gYXdhaXQgc2VuZCh3cmFwKDB4MGEsIGRlc2ZpcmUua2V5SWQpLCAnc3RlcCAyIC0gYXV0aGVudGljYXRlJyk7XG5cblx0XHRcdC8vIHNvbWV0aGluZyB3ZW50IHdyb25nXG5cdFx0XHRpZiAocmVzMS5zbGljZSgtMSlbMF0gIT09IDB4YWYpIHtcblx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKCdlcnJvciBpbiBzdGVwIDIgLSBhdXRoZW50aWNhdGUnKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gZW5jcnlwdGVkIFJuZEIgZnJvbSByZWFkZXJcblx0XHRcdC8vIGN1dCBvdXQgc3RhdHVzIGNvZGUgKGxhc3QgMiBieXRlcylcblx0XHRcdGNvbnN0IGVjUm5kQiA9IHJlczEuc2xpY2UoMCwgLTIpO1xuXG5cdFx0XHQvLyBkZWNyeXB0IGl0XG5cdFx0XHRjb25zdCBSbmRCID0gZGVjcnlwdChrZXksIGVjUm5kQik7XG5cblx0XHRcdC8vIHJvdGF0ZSBSbmRCXG5cdFx0XHRjb25zdCBSbmRCcCA9IEJ1ZmZlci5jb25jYXQoW1JuZEIuc2xpY2UoMSwgOCksIFJuZEIuc2xpY2UoMCwgMSldKTtcblxuXHRcdFx0Ly8gZ2VuZXJhdGUgYSA4IGJ5dGUgUmFuZG9tIE51bWJlciBBXG5cdFx0XHRjb25zdCBSbmRBID0gY3J5cHRvLnJhbmRvbUJ5dGVzKDgpO1xuXG5cdFx0XHQvLyBjb25jYXQgUm5kQSBhbmQgUm5kQnBcblx0XHRcdGNvbnN0IG1zZyA9IGVuY3J5cHQoa2V5LCBCdWZmZXIuY29uY2F0KFtSbmRBLCBSbmRCcF0pKTtcblxuXHRcdFx0Ly8gc2VuZCBpdCBiYWNrIHRvIHRoZSByZWFkZXJcblx0XHRcdGNvbnN0IHJlczIgPSBhd2FpdCBzZW5kKHdyYXAoMHhhZiwgbXNnKSwgJ3N0ZXAgMiAtIHNldCB1cCBSbmRBJyk7XG5cblx0XHRcdC8vIHNvbWV0aGluZyB3ZW50IHdyb25nXG5cdFx0XHRpZiAocmVzMi5zbGljZSgtMSlbMF0gIT09IDB4MDApIHtcblx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKCdlcnJvciBpbiBzdGVwIDIgLSBzZXQgdXAgUm5kQScpO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBlbmNyeXB0ZWQgUm5kQXAgZnJvbSByZWFkZXJcblx0XHRcdC8vIGN1dCBvdXQgc3RhdHVzIGNvZGUgKGxhc3QgMiBieXRlcylcblx0XHRcdGNvbnN0IGVjUm5kQXAgPSByZXMyLnNsaWNlKDAsIC0yKTtcblxuXHRcdFx0Ly8gZGVjcnlwdCB0byBnZXQgcm90YXRlZCB2YWx1ZSBvZiBSbmRBMlxuXHRcdFx0Y29uc3QgUm5kQXAgPSBkZWNyeXB0KGtleSwgZWNSbmRBcCk7XG5cblx0XHRcdC8vIHJvdGF0ZVxuXHRcdFx0Y29uc3QgUm5kQTIgPSBCdWZmZXIuY29uY2F0KFtSbmRBcC5zbGljZSg3LCA4KSwgUm5kQXAuc2xpY2UoMCwgNyldKTtcblxuXHRcdFx0Ly8gY29tcGFyZSBkZWNyeXB0ZWQgUm5kQTIgcmVzcG9uc2UgZnJvbSByZWFkZXIgd2l0aCBvdXIgUm5kQVxuXHRcdFx0Ly8gaWYgaXQgZXF1YWxzIGF1dGhlbnRpY2F0aW9uIHByb2Nlc3Mgd2FzIHN1Y2Nlc3NmdWxcblx0XHRcdGlmICghUm5kQS5lcXVhbHMoUm5kQTIpKSB7XG5cdFx0XHRcdHRocm93IG5ldyBFcnJvcignZXJyb3IgaW4gc3RlcCAyIC0gbWF0Y2ggUm5kQSByYW5kb20gYnl0ZXMnKTtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0Um5kQSxcblx0XHRcdFx0Um5kQixcblx0XHRcdH07XG5cblx0XHR9O1xuXG5cdFx0Y29uc3QgcmVhZERhdGEgPSBhc3luYyAoKSA9PiB7XG5cblx0XHRcdC8vIDM6IFsweEJEXSBSZWFkRGF0YShGaWxlTm8sT2Zmc2V0LExlbmd0aCkgWzhieXRlc10gLSBSZWFkcyBkYXRhIGZyb20gU3RhbmRhcmQgRGF0YSBGaWxlcyBvciBCYWNrdXAgRGF0YSBGaWxlc1xuXHRcdFx0Y29uc3QgcmVzID0gYXdhaXQgc2VuZCh3cmFwKDB4YmQsIFtkZXNmaXJlLnJlYWQuZmlsZUlkLCAuLi5kZXNmaXJlLnJlYWQub2Zmc2V0LCAuLi5kZXNmaXJlLnJlYWQubGVuZ3RoXSksICdzdGVwIDMgLSByZWFkJywgMjU1KTtcblxuXHRcdFx0Ly8gc29tZXRoaW5nIHdlbnQgd3Jvbmdcblx0XHRcdGlmIChyZXMuc2xpY2UoLTEpWzBdICE9PSAweDAwKSB7XG5cdFx0XHRcdHRocm93IG5ldyBFcnJvcignZXJyb3IgaW4gc3RlcCAzIC0gcmVhZCcpO1xuXHRcdFx0fVxuXG5cdFx0XHRjb25zb2xlLmxvZygnZGF0YScsIHJlcyk7XG5cblx0XHR9O1xuXG5cblx0XHR0cnkge1xuXG5cdFx0XHQvLyBzdGVwIDFcblx0XHRcdGF3YWl0IHNlbGVjdEFwcGxpY2F0aW9uKCk7XG5cblx0XHRcdC8vIHN0ZXAgMlxuXHRcdFx0Y29uc3Qga2V5ID0gQnVmZmVyLmZyb20oZGVzZmlyZS5rZXksICdoZXgnKTtcblx0XHRcdGF3YWl0IGF1dGhlbnRpY2F0ZShrZXkpO1xuXG5cdFx0XHQvLyBzdGVwIDNcblx0XHRcdGF3YWl0IHJlYWREYXRhKCk7XG5cblxuXHRcdH0gY2F0Y2ggKGVycikge1xuXHRcdFx0cHJldHR5LmVycm9yKGBlcnJvciBvY2N1cnJlZCBkdXJpbmcgcHJvY2Vzc2luZyBzdGVwc2AsIHJlYWRlciwgZXJyKTtcblx0XHR9XG5cblxuXHR9KTtcblxuXHRyZWFkZXIub24oJ2Vycm9yJywgZXJyID0+IHtcblx0XHRwcmV0dHkuZXJyb3IoYGFuIGVycm9yIG9jY3VycmVkYCwgcmVhZGVyLCBlcnIpO1xuXHR9KTtcblxuXHRyZWFkZXIub24oJ2VuZCcsICgpID0+IHtcblx0XHRwcmV0dHkuaW5mbyhgZGV2aWNlIHJlbW92ZWRgLCByZWFkZXIpO1xuXHR9KTtcblxuXG59KTtcblxubmZjLm9uKCdlcnJvcicsIGVyciA9PiB7XG5cdHByZXR0eS5lcnJvcihgYW4gZXJyb3Igb2NjdXJyZWRgLCBlcnIpO1xufSk7XG4iXX0=",
    "map": {
      "version": 3,
      "sources": [
        "mifare-desfire.js"
      ],
      "names": [
        "desfire",
        "key",
        "appId",
        "keyId",
        "read",
        "fileId",
        "offset",
        "length",
        "decrypt",
        "data",
        "iv",
        "Buffer",
        "alloc",
        "fill",
        "decipher",
        "crypto",
        "createDecipheriv",
        "setAutoPadding",
        "concat",
        "update",
        "final",
        "encrypt",
        "createCipheriv",
        "nfc",
        "NFC",
        "on",
        "reader",
        "pretty",
        "info",
        "autoProcessing",
        "send",
        "cmd",
        "comment",
        "responseMaxLength",
        "b",
        "from",
        "console",
        "log",
        "transmit",
        "wrap",
        "dataIn",
        "card",
        "selectApplication",
        "res",
        "slice",
        "Error",
        "authenticate",
        "res1",
        "ecRndB",
        "RndB",
        "RndBp",
        "RndA",
        "randomBytes",
        "msg",
        "res2",
        "ecRndAp",
        "RndAp",
        "RndA2",
        "equals",
        "readData",
        "err",
        "error"
      ],
      "mappings": "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",
      "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/",
      "sourcesContent": [
        "\"use strict\";\n\n// #############\n// Example: MIFARE DESFire\n// - what is covered:\n//   - 3DES authentication\n//   - reading data files\n// - known issue:\n//   - [mac0S Sierra and greater] when an error occurs during the authentication process,\n//     the NFC must be reinitialized or the reader reconnected\n//     in order to allow subsequent successful operations (TODO: add appropriate links, fix and test)\n// #############\n\nimport { NFC } from '../src/index';\nimport pretty from './pretty-logger';\nimport crypto from 'crypto';\n\n\n// config\nconst desfire = {\n\tkey: '00000000000000000000000000000000',\n\tappId: [0x00, 0x00, 0x00],\n\tkeyId: [0x00],\n\tread: { // supply location of an existing data\n\t\tfileId: [0x02],\n\t\toffset: [0x00, 0x00, 0x00],\n\t\tlength: [14, 0x00, 0x00],\n\t},\n};\n\n\nfunction decrypt(key, data, iv = Buffer.alloc(8).fill(0)) {\n\n\tconst decipher = crypto.createDecipheriv('DES-EDE-CBC', key, iv);\n\tdecipher.setAutoPadding(false);\n\n\treturn Buffer.concat([decipher.update(data), decipher.final()]);\n\n}\n\nfunction encrypt(key, data, iv = Buffer.alloc(8).fill(0)) {\n\n\tconst decipher = crypto.createCipheriv('DES-EDE-CBC', key, iv);\n\tdecipher.setAutoPadding(false);\n\n\treturn Buffer.concat([decipher.update(data), decipher.final()]);\n\n}\n\n\nconst nfc = new NFC();\n\nnfc.on('reader', async reader => {\n\n\tpretty.info(`device attached`, reader);\n\n\t// we have to handle MIFARE DESFire\n\treader.autoProcessing = false;\n\n\t// just handy shortcut to send data\n\tconst send = async (cmd, comment = null, responseMaxLength = 40) => {\n\n\t\tconst b = Buffer.from(cmd);\n\n\t\tconsole.log((comment ? `[${comment}] ` : '') + `sending`, b);\n\n\t\tconst data = await reader.transmit(b, responseMaxLength);\n\n\t\tconsole.log((comment ? `[${comment}] ` : '') + `received data`, data);\n\n\t\treturn data;\n\n\t};\n\n\tconst wrap = (cmd, dataIn) => ([0x90, cmd, 0x00, 0x00, dataIn.length, ...dataIn, 0x00]);\n\n\treader.on('card', async card => {\n\n\t\tpretty.info(`card detected`, reader, card);\n\n\t\tconst selectApplication = async () => {\n\n\t\t\t// 1: [0x5A] SelectApplication(appId) [4 bytes] - Selects one specific application for further access\n\t\t\t// DataIn: appId (3 bytes)\n\t\t\tconst res = await send(wrap(0x5a, desfire.appId), 'step 1 - select app');\n\n\t\t\t// something went wrong\n\t\t\tif (res.slice(-1)[0] !== 0x00) {\n\t\t\t\tthrow new Error('error in step 1');\n\t\t\t}\n\n\n\t\t};\n\n\t\tconst authenticate = async (key) => {\n\n\t\t\t// 2: [0x0a] Authenticate(keyId) [2bytes]\n\t\t\t// DataIn: keyId (1 byte)\n\t\t\tconst res1 = await send(wrap(0x0a, desfire.keyId), 'step 2 - authenticate');\n\n\t\t\t// something went wrong\n\t\t\tif (res1.slice(-1)[0] !== 0xaf) {\n\t\t\t\tthrow new Error('error in step 2 - authenticate');\n\t\t\t}\n\n\t\t\t// encrypted RndB from reader\n\t\t\t// cut out status code (last 2 bytes)\n\t\t\tconst ecRndB = res1.slice(0, -2);\n\n\t\t\t// decrypt it\n\t\t\tconst RndB = decrypt(key, ecRndB);\n\n\t\t\t// rotate RndB\n\t\t\tconst RndBp = Buffer.concat([RndB.slice(1, 8), RndB.slice(0, 1)]);\n\n\t\t\t// generate a 8 byte Random Number A\n\t\t\tconst RndA = crypto.randomBytes(8);\n\n\t\t\t// concat RndA and RndBp\n\t\t\tconst msg = encrypt(key, Buffer.concat([RndA, RndBp]));\n\n\t\t\t// send it back to the reader\n\t\t\tconst res2 = await send(wrap(0xaf, msg), 'step 2 - set up RndA');\n\n\t\t\t// something went wrong\n\t\t\tif (res2.slice(-1)[0] !== 0x00) {\n\t\t\t\tthrow new Error('error in step 2 - set up RndA');\n\t\t\t}\n\n\t\t\t// encrypted RndAp from reader\n\t\t\t// cut out status code (last 2 bytes)\n\t\t\tconst ecRndAp = res2.slice(0, -2);\n\n\t\t\t// decrypt to get rotated value of RndA2\n\t\t\tconst RndAp = decrypt(key, ecRndAp);\n\n\t\t\t// rotate\n\t\t\tconst RndA2 = Buffer.concat([RndAp.slice(7, 8), RndAp.slice(0, 7)]);\n\n\t\t\t// compare decrypted RndA2 response from reader with our RndA\n\t\t\t// if it equals authentication process was successful\n\t\t\tif (!RndA.equals(RndA2)) {\n\t\t\t\tthrow new Error('error in step 2 - match RndA random bytes');\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tRndA,\n\t\t\t\tRndB,\n\t\t\t};\n\n\t\t};\n\n\t\tconst readData = async () => {\n\n\t\t\t// 3: [0xBD] ReadData(FileNo,Offset,Length) [8bytes] - Reads data from Standard Data Files or Backup Data Files\n\t\t\tconst res = await send(wrap(0xbd, [desfire.read.fileId, ...desfire.read.offset, ...desfire.read.length]), 'step 3 - read', 255);\n\n\t\t\t// something went wrong\n\t\t\tif (res.slice(-1)[0] !== 0x00) {\n\t\t\t\tthrow new Error('error in step 3 - read');\n\t\t\t}\n\n\t\t\tconsole.log('data', res);\n\n\t\t};\n\n\n\t\ttry {\n\n\t\t\t// step 1\n\t\t\tawait selectApplication();\n\n\t\t\t// step 2\n\t\t\tconst key = Buffer.from(desfire.key, 'hex');\n\t\t\tawait authenticate(key);\n\n\t\t\t// step 3\n\t\t\tawait readData();\n\n\n\t\t} catch (err) {\n\t\t\tpretty.error(`error occurred during processing steps`, reader, err);\n\t\t}\n\n\n\t});\n\n\treader.on('error', err => {\n\t\tpretty.error(`an error occurred`, reader, err);\n\t});\n\n\treader.on('end', () => {\n\t\tpretty.info(`device removed`, reader);\n\t});\n\n\n});\n\nnfc.on('error', err => {\n\tpretty.error(`an error occurred`, err);\n});\n"
      ]
    },
    "sourceType": "script",
    "mtime": 1662229648498
  },
  "{\"sourceRoot\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc\",\"filename\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/mifare-ultralight-ntag.js\",\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{}},{\"key\":\"proposal-class-properties\",\"visitor\":{\"PrivateName\":{\"enter\":[null]},\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{}}],\"presets\":[]}:7.12.17": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/",
      "caller": {
        "name": "@babel/register"
      },
      "cwd": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc",
      "filename": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/mifare-ultralight-ntag.js",
      "cloneInputAst": true,
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {}
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {}
        },
        {
          "key": "proposal-class-properties",
          "visitor": {
            "PrivateName": {
              "enter": [
                null
              ]
            },
            "ExportDefaultDeclaration": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true,
            "ClassExpression": {
              "enter": [
                null
              ]
            },
            "ClassDeclaration": {
              "enter": [
                null
              ]
            }
          },
          "options": {}
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/mifare-ultralight-ntag.js",
        "plugins": [
          "objectRestSpread",
          "classProperties",
          "classPrivateProperties"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/mifare-ultralight-ntag.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/",
        "sourceFileName": "mifare-ultralight-ntag.js"
      }
    },
    "ast": null,
    "code": "'use strict'; // #############\n// Example: MIFARE Ultralight EV1 and NTAG 213/215/216 – implementation of card's specific commands\n// - note: for instructions on reading and writing the data,\n//   please see read-write.js, which is common for all ISO/IEC 14443-3 tags\n// - note: this guide applies to NTAG 213/215/216 cards as-well\n//   (the commands and configuration pages structure is same or very similar,\n//   the only difference is the location of the pages due to different user memory size)\n// - docs (descriptions of the commands and data structure):\n//   - MIFARE Ultralight EV1 – see https://www.nxp.com/docs/en/data-sheet/MF0ULX1.pdf\n//   - NTAG 213/215/216 – https://www.nxp.com/docs/en/data-sheet/NTAG213_215_216.pdf\n// - note: works ONLY on ACR122U reader or possibly any reader which uses NXP PN533 and similar NFC frontends\n// - what is covered:\n//   - password authentication – PWD_AUTH command\n//   - fast read – FAST_READ command\n//   - setting card configuration pages – set custom password and access conditions\n// #############\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.MifareUltralightFastReadError = exports.MifareUltralightPasswordAuthenticationError = void 0;\n\nvar _index = require(\"../src/index\");\n\nvar _prettyLogger = _interopRequireDefault(require(\"./pretty-logger\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nclass MifareUltralightPasswordAuthenticationError extends _index.TransmitError {\n  constructor(code, message, previousError) {\n    super(code, message, previousError);\n    this.name = 'MifareUltralightPasswordAuthenticationError';\n  }\n\n}\n\nexports.MifareUltralightPasswordAuthenticationError = MifareUltralightPasswordAuthenticationError;\n\nclass MifareUltralightFastReadError extends _index.TransmitError {\n  constructor(code, message, previousError) {\n    super(code, message, previousError);\n    this.name = 'MifareUltralightFastReadError';\n  }\n\n}\n\nexports.MifareUltralightFastReadError = MifareUltralightFastReadError;\n\nconst parseBytes = (name, data, length) => {\n  if (!(data instanceof Buffer) && typeof data !== 'string') {\n    throw new Error(`${name} must an instance of Buffer or a HEX string.`);\n  }\n\n  if (Buffer.isBuffer(data)) {\n    if (data.length !== length) {\n      throw new Error(`${name} must be ${length} bytes long.`);\n    }\n\n    return data;\n  }\n\n  if (typeof data === 'string') {\n    if (data.length !== length * 2) {\n      throw new Error(`${name} must be a ${length * 2} char HEX string.`);\n    }\n\n    return Buffer.from(data, 'hex');\n  }\n\n  throw new Error(`${name} must an instance of Buffer or a HEX string.`);\n};\n\nclass MifareUltralight {\n  constructor(reader) {\n    this.reader = reader;\n  } // PWD_AUTH\n\n\n  async passwordAuthenticate(password, pack) {\n    // PASSWORD (4 bytes) (stored on card in page 18)\n    // PACK (2 bytes) (stored in page 19 as first two bytes)\n    // PACK is the response from card in case of successful PWD_AUTH cmd\n    password = parseBytes('Password', password, 4);\n    pack = parseBytes('Pack', pack, 2); // CMD: PWD_AUTH via Direct Transmit (ACR122U) and Data Exchange (PN533)\n\n    const cmd = Buffer.from([0xff, // Class\n    0x00, // Direct Transmit (see ACR122U docs)\n    0x00, // ...\n    0x00, // ...\n    0x07, // Length of Direct Transmit payload\n    // Payload (7 bytes)\n    0xd4, // Data Exchange Command (see PN533 docs)\n    0x42, // InCommunicateThru\n    0x1b, // PWD_AUTH\n    ...password]);\n    this.reader.logger.debug('pwd_auth cmd', cmd);\n    const response = await this.reader.transmit(cmd, 7);\n    this.reader.logger.debug('pwd_auth response', response); // pwd_auth response should look like the following (7 bytes)\n    // d5 43 00 ab cd 90 00\n    // byte 0: d5 prefix for response of Data Exchange Command (see PN533 docs)\n    // byte 1: 43 prefix for response of Data Exchange Command (see PN533 docs)\n    // byte 2: Data Exchange Command Status 0x00 is success (see PN533 docs, Table 15. Error code list)\n    // bytes 3-4: Data Exchange Command Response – our PACK (set on card in page 19, in bytes 0-1) from card\n    // bytes 5-6: ACR122U success code\n\n    if (response.length < 5) {\n      throw new MifareUltralightPasswordAuthenticationError('invalid_response_length', `Invalid response length ${response.length}. Expected minimal length was 2 bytes.`);\n    }\n\n    if (response[2] !== 0x00 || response.length < 7) {\n      throw new MifareUltralightPasswordAuthenticationError('invalid_password', `Authentication failed. Might be invalid password or unsupported card.`);\n    }\n\n    if (!response.slice(3, 5).equals(pack)) {\n      throw new MifareUltralightPasswordAuthenticationError('pack_mismatch', `Pack mismatch.`);\n    }\n\n    return;\n  } // FAST_READ\n\n\n  async fastRead(startPage, endPage) {\n    // CMD: PWD_AUTH via Direct Transmit (ACR122U) and Data Exchange (PN533)\n    const cmd = Buffer.from([0xff, // Class\n    0x00, // Direct Transmit (see ACR122U docs)\n    0x00, // ...\n    0x00, // ...\n    0x07, // Length of Direct Transmit payload\n    // Payload (7 bytes)\n    0xd4, // Data Exchange Command (see PN533 docs)\n    0x42, // InCommunicateThru\n    0x3a, // PWD_AUTH\n    startPage, endPage]);\n    const length = 3 + (endPage - startPage + 1) * 4 + 2;\n    const response = await this.reader.transmit(cmd, length);\n\n    if (response < length) {\n      throw new MifareUltralightFastReadError('invalid_response_length', `Invalid response length ${response.length}. Expected length was ${length} bytes.`);\n    }\n\n    return response.slice(3, -2);\n  }\n\n}\n\nconst nfc = new _index.NFC(_prettyLogger.default); // const nfc = new NFC(pretty); // optionally you can pass logger to see internal debug logs\n\nnfc.on('reader', async reader => {\n  _prettyLogger.default.info(`device attached`, reader);\n\n  const ultralight = new MifareUltralight(reader);\n  reader.on('card', async card => {\n    _prettyLogger.default.info('card detected', reader, card);\n\n    const password = 'FFFFFFFF'; // default password\n\n    const pack = '0000'; // default pack\n\n    try {\n      await ultralight.passwordAuthenticate(password, pack);\n\n      _prettyLogger.default.info('passwordAuthenticate: successfully authenticated');\n    } catch (err) {\n      _prettyLogger.default.error('passwordAuthenticate error:', err);\n    }\n\n    try {\n      const data = await ultralight.fastRead(16, 19);\n\n      _prettyLogger.default.info('fastRead data:', data);\n    } catch (err) {\n      _prettyLogger.default.error('fastRead error:', err);\n\n      return;\n    } // Note! UPDATE locations of configuration pages according to the version of your card!\n    // (see memory layout in your card's docs)\n    // try {\n    //\n    // \t// set custom PASSWORD (4 bytes) (stored in page 18)\n    // \tawait reader.write(19, password);\n    //\n    // \t// set custom PACK (2 bytes) (stored in page 19 as first two bytes\n    // \tconst packPage = await reader.read(19, 4);\n    // \tpackPage[0] = pack[0];\n    // \tpackPage[1] = pack[1];\n    // \tawait reader.write(19, packPage);\n    //\n    // \t// read current configuration\n    // \tconst config = await reader.read(16, 8);\n    //\n    // \t// Configuration page 16\n    // \tconsole.log(config[0]);\n    // \tconsole.log(config[1]);\n    // \tconsole.log(config[2]);\n    // \tconsole.log(config[3]); // AUTH0 (default: 0xff)\n    //\n    // \t// Configuration page 17\n    // \tconsole.log(config[4]); // ACCESS\n    // \tconsole.log(config[5]); // VCTID (default: 0x05)\n    // \tconsole.log(config[6]);\n    // \tconsole.log(config[7]);\n    //\n    // \t// Protect everything (start with first data page)\n    // \tconfig[3] = 0x04;\n    //\n    // \t// set ACCESS bits\n    // \t// bit 7: PROT One bit inside the ACCESS byte defining the memory protection\n    // \t//          0b ... write access is protected by the password verification\n    // \t//          1b ... read and write access is protected by the password verification\n    // \t// bit 6: CFGLCK Write locking bit for the user configuration\n    // \t//        - 0b ... user configuration open to write access\n    // \t//        - 1b ... user configuration permanently locked against write access\n    // \t// bits 5-3: reserved\n    // \t// bits 2-0: AUTHLIM\n    // \t// bit number-76543210\n    // \t//            ||||||||\n    // \tconfig[4] = 0b10000000;\n    //\n    // \t// set custom access rules\n    // \tawait reader.write(16, config);\n    //\n    // } catch (err) {\n    // \tpretty.error('configuration write error:', err);\n    // }\n\n  });\n  reader.on('error', err => {\n    _prettyLogger.default.error(`an error occurred`, reader, err);\n  });\n  reader.on('end', () => {\n    _prettyLogger.default.info(`device removed`, reader);\n  });\n});\nnfc.on('error', err => {\n  _prettyLogger.default.error(`an error occurred`, err);\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1pZmFyZS11bHRyYWxpZ2h0LW50YWcuanMiXSwibmFtZXMiOlsiTWlmYXJlVWx0cmFsaWdodFBhc3N3b3JkQXV0aGVudGljYXRpb25FcnJvciIsIlRyYW5zbWl0RXJyb3IiLCJjb25zdHJ1Y3RvciIsImNvZGUiLCJtZXNzYWdlIiwicHJldmlvdXNFcnJvciIsIm5hbWUiLCJNaWZhcmVVbHRyYWxpZ2h0RmFzdFJlYWRFcnJvciIsInBhcnNlQnl0ZXMiLCJkYXRhIiwibGVuZ3RoIiwiQnVmZmVyIiwiRXJyb3IiLCJpc0J1ZmZlciIsImZyb20iLCJNaWZhcmVVbHRyYWxpZ2h0IiwicmVhZGVyIiwicGFzc3dvcmRBdXRoZW50aWNhdGUiLCJwYXNzd29yZCIsInBhY2siLCJjbWQiLCJsb2dnZXIiLCJkZWJ1ZyIsInJlc3BvbnNlIiwidHJhbnNtaXQiLCJzbGljZSIsImVxdWFscyIsImZhc3RSZWFkIiwic3RhcnRQYWdlIiwiZW5kUGFnZSIsIm5mYyIsIk5GQyIsInByZXR0eSIsIm9uIiwiaW5mbyIsInVsdHJhbGlnaHQiLCJjYXJkIiwiZXJyIiwiZXJyb3IiXSwibWFwcGluZ3MiOiJBQUFBLGEsQ0FFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7OztBQUVBOztBQUNBOzs7O0FBR08sTUFBTUEsMkNBQU4sU0FBMERDLG9CQUExRCxDQUF3RTtBQUU5RUMsRUFBQUEsV0FBVyxDQUFDQyxJQUFELEVBQU9DLE9BQVAsRUFBZ0JDLGFBQWhCLEVBQStCO0FBRXpDLFVBQU1GLElBQU4sRUFBWUMsT0FBWixFQUFxQkMsYUFBckI7QUFFQSxTQUFLQyxJQUFMLEdBQVksNkNBQVo7QUFFQTs7QUFSNkU7Ozs7QUFZeEUsTUFBTUMsNkJBQU4sU0FBNENOLG9CQUE1QyxDQUEwRDtBQUVoRUMsRUFBQUEsV0FBVyxDQUFDQyxJQUFELEVBQU9DLE9BQVAsRUFBZ0JDLGFBQWhCLEVBQStC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QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLEdBaEZEO0FBa0ZBckIsRUFBQUEsTUFBTSxDQUFDaUIsRUFBUCxDQUFVLE9BQVYsRUFBbUJJLEdBQUcsSUFBSTtBQUN6QkwsMEJBQU9NLEtBQVAsQ0FBYyxtQkFBZCxFQUFrQ3RCLE1BQWxDLEVBQTBDcUIsR0FBMUM7QUFDQSxHQUZEO0FBSUFyQixFQUFBQSxNQUFNLENBQUNpQixFQUFQLENBQVUsS0FBVixFQUFpQixNQUFNO0FBQ3RCRCwwQkFBT0UsSUFBUCxDQUFhLGdCQUFiLEVBQThCbEIsTUFBOUI7QUFDQSxHQUZEO0FBSUEsQ0FoR0Q7QUFrR0FjLEdBQUcsQ0FBQ0csRUFBSixDQUFPLE9BQVAsRUFBZ0JJLEdBQUcsSUFBSTtBQUN0Qkwsd0JBQU9NLEtBQVAsQ0FBYyxtQkFBZCxFQUFrQ0QsR0FBbEM7QUFDQSxDQUZEIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9oYXJyeWhvdy9Eb2N1bWVudHMvMjAyMi9QUk9KRUNUX01PQ0FfQVJUL05GQy9uZmMtcGNzYy9leGFtcGxlcy8iLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbi8vICMjIyMjIyMjIyMjIyNcbi8vIEV4YW1wbGU6IE1JRkFSRSBVbHRyYWxpZ2h0IEVWMSBhbmQgTlRBRyAyMTMvMjE1LzIxNiDigJMgaW1wbGVtZW50YXRpb24gb2YgY2FyZCdzIHNwZWNpZmljIGNvbW1hbmRzXG4vLyAtIG5vdGU6IGZvciBpbnN0cnVjdGlvbnMgb24gcmVhZGluZyBhbmQgd3JpdGluZyB0aGUgZGF0YSxcbi8vICAgcGxlYXNlIHNlZSByZWFkLXdyaXRlLmpzLCB3aGljaCBpcyBjb21tb24gZm9yIGFsbCBJU08vSUVDIDE0NDQzLTMgdGFnc1xuLy8gLSBub3RlOiB0aGlzIGd1aWRlIGFwcGxpZXMgdG8gTlRBRyAyMTMvMjE1LzIxNiBjYXJkcyBhcy13ZWxsXG4vLyAgICh0aGUgY29tbWFuZHMgYW5kIGNvbmZpZ3VyYXRpb24gcGFnZXMgc3RydWN0dXJlIGlzIHNhbWUgb3IgdmVyeSBzaW1pbGFyLFxuLy8gICB0aGUgb25seSBkaWZmZXJlbmNlIGlzIHRoZSBsb2NhdGlvbiBvZiB0aGUgcGFnZXMgZHVlIHRvIGRpZmZlcmVudCB1c2VyIG1lbW9yeSBzaXplKVxuLy8gLSBkb2NzIChkZXNjcmlwdGlvbnMgb2YgdGhlIGNvbW1hbmRzIGFuZCBkYXRhIHN0cnVjdHVyZSk6XG4vLyAgIC0gTUlGQVJFIFVsdHJhbGlnaHQgRVYxIOKAkyBzZWUgaHR0cHM6Ly93d3cubnhwLmNvbS9kb2NzL2VuL2RhdGEtc2hlZXQvTUYwVUxYMS5wZGZcbi8vICAgLSBOVEFHIDIxMy8yMTUvMjE2IOKAkyBodHRwczovL3d3dy5ueHAuY29tL2RvY3MvZW4vZGF0YS1zaGVldC9OVEFHMjEzXzIxNV8yMTYucGRmXG4vLyAtIG5vdGU6IHdvcmtzIE9OTFkgb24gQUNSMTIyVSByZWFkZXIgb3IgcG9zc2libHkgYW55IHJlYWRlciB3aGljaCB1c2VzIE5YUCBQTjUzMyBhbmQgc2ltaWxhciBORkMgZnJvbnRlbmRzXG4vLyAtIHdoYXQgaXMgY292ZXJlZDpcbi8vICAgLSBwYXNzd29yZCBhdXRoZW50aWNhdGlvbiDigJMgUFdEX0FVVEggY29tbWFuZFxuLy8gICAtIGZhc3QgcmVhZCDigJMgRkFTVF9SRUFEIGNvbW1hbmRcbi8vICAgLSBzZXR0aW5nIGNhcmQgY29uZmlndXJhdGlvbiBwYWdlcyDigJMgc2V0IGN1c3RvbSBwYXNzd29yZCBhbmQgYWNjZXNzIGNvbmRpdGlvbnNcbi8vICMjIyMjIyMjIyMjIyNcblxuaW1wb3J0IHsgTkZDLCBUQUdfSVNPXzE0NDQzXzMsIFRBR19JU09fMTQ0NDNfNCwgS0VZX1RZUEVfQSwgS0VZX1RZUEVfQiwgVHJhbnNtaXRFcnJvciB9IGZyb20gJy4uL3NyYy9pbmRleCc7XG5pbXBvcnQgcHJldHR5IGZyb20gJy4vcHJldHR5LWxvZ2dlcic7XG5cblxuZXhwb3J0IGNsYXNzIE1pZmFyZVVsdHJhbGlnaHRQYXNzd29yZEF1dGhlbnRpY2F0aW9uRXJyb3IgZXh0ZW5kcyBUcmFuc21pdEVycm9yIHtcblxuXHRjb25zdHJ1Y3Rvcihjb2RlLCBtZXNzYWdlLCBwcmV2aW91c0Vycm9yKSB7XG5cblx0XHRzdXBlcihjb2RlLCBtZXNzYWdlLCBwcmV2aW91c0Vycm9yKTtcblxuXHRcdHRoaXMubmFtZSA9ICdNaWZhcmVVbHRyYWxpZ2h0UGFzc3dvcmRBdXRoZW50aWNhdGlvbkVycm9yJztcblxuXHR9XG5cbn1cblxuZXhwb3J0IGNsYXNzIE1pZmFyZVVsdHJhbGlnaHRGYXN0UmVhZEVycm9yIGV4dGVuZHMgVHJhbnNtaXRFcnJvciB7XG5cblx0Y29uc3RydWN0b3IoY29kZSwgbWVzc2FnZSwgcHJldmlvdXNFcnJvcikge1xuXG5cdFx0c3VwZXIoY29kZSwgbWVzc2FnZSwgcHJldmlvdXNFcnJvcik7XG5cblx0XHR0aGlzLm5hbWUgPSAnTWlmYXJlVWx0cmFsaWdodEZhc3RSZWFkRXJyb3InO1xuXG5cdH1cblxufVxuXG5jb25zdCBwYXJzZUJ5dGVzID0gKG5hbWUsIGRhdGEsIGxlbmd0aCkgPT4ge1xuXG5cdGlmICghKGRhdGEgaW5zdGFuY2VvZiBCdWZmZXIpICYmIHR5cGVvZiBkYXRhICE9PSAnc3RyaW5nJykge1xuXHRcdHRocm93IG5ldyBFcnJvcihgJHtuYW1lfSBtdXN0IGFuIGluc3RhbmNlIG9mIEJ1ZmZlciBvciBhIEhFWCBzdHJpbmcuYCk7XG5cdH1cblxuXHRpZiAoQnVmZmVyLmlzQnVmZmVyKGRhdGEpKSB7XG5cblx0XHRpZiAoZGF0YS5sZW5ndGggIT09IGxlbmd0aCkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGAke25hbWV9IG11c3QgYmUgJHtsZW5ndGh9IGJ5dGVzIGxvbmcuYCk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGRhdGE7XG5cblx0fVxuXG5cdGlmICh0eXBlb2YgZGF0YSA9PT0gJ3N0cmluZycpIHtcblxuXHRcdGlmIChkYXRhLmxlbmd0aCAhPT0gbGVuZ3RoICogMikge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGAke25hbWV9IG11c3QgYmUgYSAke2xlbmd0aCAqIDJ9IGNoYXIgSEVYIHN0cmluZy5gKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gQnVmZmVyLmZyb20oZGF0YSwgJ2hleCcpO1xuXG5cdH1cblxuXHR0aHJvdyBuZXcgRXJyb3IoYCR7bmFtZX0gbXVzdCBhbiBpbnN0YW5jZSBvZiBCdWZmZXIgb3IgYSBIRVggc3RyaW5nLmApO1xuXG59O1xuXG5jbGFzcyBNaWZhcmVVbHRyYWxpZ2h0IHtcblxuXHRjb25zdHJ1Y3RvcihyZWFkZXIpIHtcblx0XHR0aGlzLnJlYWRlciA9IHJlYWRlcjtcblx0fVxuXG5cdC8vIFBXRF9BVVRIXG5cdGFzeW5jIHBhc3N3b3JkQXV0aGVudGljYXRlKHBhc3N3b3JkLCBwYWNrKSB7XG5cblx0XHQvLyBQQVNTV09SRCAoNCBieXRlcykgKHN0b3JlZCBvbiBjYXJkIGluIHBhZ2UgMTgpXG5cdFx0Ly8gUEFDSyAoMiBieXRlcykgKHN0b3JlZCBpbiBwYWdlIDE5IGFzIGZpcnN0IHR3byBieXRlcylcblx0XHQvLyBQQUNLIGlzIHRoZSByZXNwb25zZSBmcm9tIGNhcmQgaW4gY2FzZSBvZiBzdWNjZXNzZnVsIFBXRF9BVVRIIGNtZFxuXG5cdFx0cGFzc3dvcmQgPSBwYXJzZUJ5dGVzKCdQYXNzd29yZCcsIHBhc3N3b3JkLCA0KTtcblx0XHRwYWNrID0gcGFyc2VCeXRlcygnUGFjaycsIHBhY2ssIDIpO1xuXG5cdFx0Ly8gQ01EOiBQV0RfQVVUSCB2aWEgRGlyZWN0IFRyYW5zbWl0IChBQ1IxMjJVKSBhbmQgRGF0YSBFeGNoYW5nZSAoUE41MzMpXG5cdFx0Y29uc3QgY21kID0gQnVmZmVyLmZyb20oW1xuXHRcdFx0MHhmZiwgLy8gQ2xhc3Ncblx0XHRcdDB4MDAsIC8vIERpcmVjdCBUcmFuc21pdCAoc2VlIEFDUjEyMlUgZG9jcylcblx0XHRcdDB4MDAsIC8vIC4uLlxuXHRcdFx0MHgwMCwgLy8gLi4uXG5cdFx0XHQweDA3LCAvLyBMZW5ndGggb2YgRGlyZWN0IFRyYW5zbWl0IHBheWxvYWRcblx0XHRcdC8vIFBheWxvYWQgKDcgYnl0ZXMpXG5cdFx0XHQweGQ0LCAvLyBEYXRhIEV4Y2hhbmdlIENvbW1hbmQgKHNlZSBQTjUzMyBkb2NzKVxuXHRcdFx0MHg0MiwgLy8gSW5Db21tdW5pY2F0ZVRocnVcblx0XHRcdDB4MWIsIC8vIFBXRF9BVVRIXG5cdFx0XHQuLi5wYXNzd29yZCxcblx0XHRdKTtcblxuXHRcdHRoaXMucmVhZGVyLmxvZ2dlci5kZWJ1ZygncHdkX2F1dGggY21kJywgY21kKTtcblxuXG5cdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLnJlYWRlci50cmFuc21pdChjbWQsIDcpO1xuXG5cdFx0dGhpcy5yZWFkZXIubG9nZ2VyLmRlYnVnKCdwd2RfYXV0aCByZXNwb25zZScsIHJlc3BvbnNlKTtcblx0XHQvLyBwd2RfYXV0aCByZXNwb25zZSBzaG91bGQgbG9vayBsaWtlIHRoZSBmb2xsb3dpbmcgKDcgYnl0ZXMpXG5cdFx0Ly8gZDUgNDMgMDAgYWIgY2QgOTAgMDBcblx0XHQvLyBieXRlIDA6IGQ1IHByZWZpeCBmb3IgcmVzcG9uc2Ugb2YgRGF0YSBFeGNoYW5nZSBDb21tYW5kIChzZWUgUE41MzMgZG9jcylcblx0XHQvLyBieXRlIDE6IDQzIHByZWZpeCBmb3IgcmVzcG9uc2Ugb2YgRGF0YSBFeGNoYW5nZSBDb21tYW5kIChzZWUgUE41MzMgZG9jcylcblx0XHQvLyBieXRlIDI6IERhdGEgRXhjaGFuZ2UgQ29tbWFuZCBTdGF0dXMgMHgwMCBpcyBzdWNjZXNzIChzZWUgUE41MzMgZG9jcywgVGFibGUgMTUuIEVycm9yIGNvZGUgbGlzdClcblx0XHQvLyBieXRlcyAzLTQ6IERhdGEgRXhjaGFuZ2UgQ29tbWFuZCBSZXNwb25zZSDigJMgb3VyIFBBQ0sgKHNldCBvbiBjYXJkIGluIHBhZ2UgMTksIGluIGJ5dGVzIDAtMSkgZnJvbSBjYXJkXG5cdFx0Ly8gYnl0ZXMgNS02OiBBQ1IxMjJVIHN1Y2Nlc3MgY29kZVxuXG5cdFx0aWYgKHJlc3BvbnNlLmxlbmd0aCA8IDUpIHtcblx0XHRcdHRocm93IG5ldyBNaWZhcmVVbHRyYWxpZ2h0UGFzc3dvcmRBdXRoZW50aWNhdGlvbkVycm9yKCdpbnZhbGlkX3Jlc3BvbnNlX2xlbmd0aCcsIGBJbnZhbGlkIHJlc3BvbnNlIGxlbmd0aCAke3Jlc3BvbnNlLmxlbmd0aH0uIEV4cGVjdGVkIG1pbmltYWwgbGVuZ3RoIHdhcyAyIGJ5dGVzLmApXG5cdFx0fVxuXG5cdFx0aWYgKHJlc3BvbnNlWzJdICE9PSAweDAwIHx8IHJlc3BvbnNlLmxlbmd0aCA8IDcpIHtcblx0XHRcdHRocm93IG5ldyBNaWZhcmVVbHRyYWxpZ2h0UGFzc3dvcmRBdXRoZW50aWNhdGlvbkVycm9yKCdpbnZhbGlkX3Bhc3N3b3JkJywgYEF1dGhlbnRpY2F0aW9uIGZhaWxlZC4gTWlnaHQgYmUgaW52YWxpZCBwYXNzd29yZCBvciB1bnN1cHBvcnRlZCBjYXJkLmApO1xuXHRcdH1cblxuXHRcdGlmICghcmVzcG9uc2Uuc2xpY2UoMywgNSkuZXF1YWxzKHBhY2spKSB7XG5cdFx0XHR0aHJvdyBuZXcgTWlmYXJlVWx0cmFsaWdodFBhc3N3b3JkQXV0aGVudGljYXRpb25FcnJvcigncGFja19taXNtYXRjaCcsIGBQYWNrIG1pc21hdGNoLmApXG5cdFx0fVxuXG5cdFx0cmV0dXJuO1xuXG5cdH1cblxuXHQvLyBGQVNUX1JFQURcblx0YXN5bmMgZmFzdFJlYWQoc3RhcnRQYWdlLCBlbmRQYWdlKSB7XG5cblx0XHQvLyBDTUQ6IFBXRF9BVVRIIHZpYSBEaXJlY3QgVHJhbnNtaXQgKEFDUjEyMlUpIGFuZCBEYXRhIEV4Y2hhbmdlIChQTjUzMylcblx0XHRjb25zdCBjbWQgPSBCdWZmZXIuZnJvbShbXG5cdFx0XHQweGZmLCAvLyBDbGFzc1xuXHRcdFx0MHgwMCwgLy8gRGlyZWN0IFRyYW5zbWl0IChzZWUgQUNSMTIyVSBkb2NzKVxuXHRcdFx0MHgwMCwgLy8gLi4uXG5cdFx0XHQweDAwLCAvLyAuLi5cblx0XHRcdDB4MDcsIC8vIExlbmd0aCBvZiBEaXJlY3QgVHJhbnNtaXQgcGF5bG9hZFxuXHRcdFx0Ly8gUGF5bG9hZCAoNyBieXRlcylcblx0XHRcdDB4ZDQsIC8vIERhdGEgRXhjaGFuZ2UgQ29tbWFuZCAoc2VlIFBONTMzIGRvY3MpXG5cdFx0XHQweDQyLCAvLyBJbkNvbW11bmljYXRlVGhydVxuXHRcdFx0MHgzYSwgLy8gUFdEX0FVVEhcblx0XHRcdHN0YXJ0UGFnZSxcblx0XHRcdGVuZFBhZ2UsXG5cdFx0XSk7XG5cblx0XHRjb25zdCBsZW5ndGggPSAzICsgKChlbmRQYWdlIC0gc3RhcnRQYWdlICsgMSkgKiA0KSArIDI7XG5cblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMucmVhZGVyLnRyYW5zbWl0KGNtZCwgbGVuZ3RoKTtcblxuXHRcdGlmIChyZXNwb25zZSA8IGxlbmd0aCkge1xuXHRcdFx0dGhyb3cgbmV3IE1pZmFyZVVsdHJhbGlnaHRGYXN0UmVhZEVycm9yKCdpbnZhbGlkX3Jlc3BvbnNlX2xlbmd0aCcsIGBJbnZhbGlkIHJlc3BvbnNlIGxlbmd0aCAke3Jlc3BvbnNlLmxlbmd0aH0uIEV4cGVjdGVkIGxlbmd0aCB3YXMgJHtsZW5ndGh9IGJ5dGVzLmApXG5cdFx0fVxuXG5cdFx0cmV0dXJuIHJlc3BvbnNlLnNsaWNlKDMsIC0yKTtcblxuXHR9XG5cbn1cblxuY29uc3QgbmZjID0gbmV3IE5GQyhwcmV0dHkpOyAvLyBjb25zdCBuZmMgPSBuZXcgTkZDKHByZXR0eSk7IC8vIG9wdGlvbmFsbHkgeW91IGNhbiBwYXNzIGxvZ2dlciB0byBzZWUgaW50ZXJuYWwgZGVidWcgbG9nc1xuXG5uZmMub24oJ3JlYWRlcicsIGFzeW5jIHJlYWRlciA9PiB7XG5cblx0cHJldHR5LmluZm8oYGRldmljZSBhdHRhY2hlZGAsIHJlYWRlcik7XG5cblx0Y29uc3QgdWx0cmFsaWdodCA9IG5ldyBNaWZhcmVVbHRyYWxpZ2h0KHJlYWRlcik7XG5cblx0cmVhZGVyLm9uKCdjYXJkJywgYXN5bmMgY2FyZCA9PiB7XG5cblx0XHRwcmV0dHkuaW5mbygnY2FyZCBkZXRlY3RlZCcsIHJlYWRlciwgY2FyZCk7XG5cblx0XHRjb25zdCBwYXNzd29yZCA9ICdGRkZGRkZGRic7IC8vIGRlZmF1bHQgcGFzc3dvcmRcblx0XHRjb25zdCBwYWNrID0gJzAwMDAnOyAvLyBkZWZhdWx0IHBhY2tcblxuXHRcdHRyeSB7XG5cblx0XHRcdGF3YWl0IHVsdHJhbGlnaHQucGFzc3dvcmRBdXRoZW50aWNhdGUocGFzc3dvcmQsIHBhY2spO1xuXG5cdFx0XHRwcmV0dHkuaW5mbygncGFzc3dvcmRBdXRoZW50aWNhdGU6IHN1Y2Nlc3NmdWxseSBhdXRoZW50aWNhdGVkJyk7XG5cblx0XHR9IGNhdGNoIChlcnIpIHtcblx0XHRcdHByZXR0eS5lcnJvcigncGFzc3dvcmRBdXRoZW50aWNhdGUgZXJyb3I6JywgZXJyKTtcblx0XHR9XG5cblx0XHR0cnkge1xuXG5cdFx0XHRjb25zdCBkYXRhID0gYXdhaXQgdWx0cmFsaWdodC5mYXN0UmVhZCgxNiwgMTkpO1xuXG5cdFx0XHRwcmV0dHkuaW5mbygnZmFzdFJlYWQgZGF0YTonLCBkYXRhKTtcblxuXHRcdH0gY2F0Y2ggKGVycikge1xuXHRcdFx0cHJldHR5LmVycm9yKCdmYXN0UmVhZCBlcnJvcjonLCBlcnIpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdC8vIE5vdGUhIFVQREFURSBsb2NhdGlvbnMgb2YgY29uZmlndXJhdGlvbiBwYWdlcyBhY2NvcmRpbmcgdG8gdGhlIHZlcnNpb24gb2YgeW91ciBjYXJkIVxuXHRcdC8vIChzZWUgbWVtb3J5IGxheW91dCBpbiB5b3VyIGNhcmQncyBkb2NzKVxuXG5cdFx0Ly8gdHJ5IHtcblx0XHQvL1xuXHRcdC8vIFx0Ly8gc2V0IGN1c3RvbSBQQVNTV09SRCAoNCBieXRlcykgKHN0b3JlZCBpbiBwYWdlIDE4KVxuXHRcdC8vIFx0YXdhaXQgcmVhZGVyLndyaXRlKDE5LCBwYXNzd29yZCk7XG5cdFx0Ly9cblx0XHQvLyBcdC8vIHNldCBjdXN0b20gUEFDSyAoMiBieXRlcykgKHN0b3JlZCBpbiBwYWdlIDE5IGFzIGZpcnN0IHR3byBieXRlc1xuXHRcdC8vIFx0Y29uc3QgcGFja1BhZ2UgPSBhd2FpdCByZWFkZXIucmVhZCgxOSwgNCk7XG5cdFx0Ly8gXHRwYWNrUGFnZVswXSA9IHBhY2tbMF07XG5cdFx0Ly8gXHRwYWNrUGFnZVsxXSA9IHBhY2tbMV07XG5cdFx0Ly8gXHRhd2FpdCByZWFkZXIud3JpdGUoMTksIHBhY2tQYWdlKTtcblx0XHQvL1xuXHRcdC8vIFx0Ly8gcmVhZCBjdXJyZW50IGNvbmZpZ3VyYXRpb25cblx0XHQvLyBcdGNvbnN0IGNvbmZpZyA9IGF3YWl0IHJlYWRlci5yZWFkKDE2LCA4KTtcblx0XHQvL1xuXHRcdC8vIFx0Ly8gQ29uZmlndXJhdGlvbiBwYWdlIDE2XG5cdFx0Ly8gXHRjb25zb2xlLmxvZyhjb25maWdbMF0pO1xuXHRcdC8vIFx0Y29uc29sZS5sb2coY29uZmlnWzFdKTtcblx0XHQvLyBcdGNvbnNvbGUubG9nKGNvbmZpZ1syXSk7XG5cdFx0Ly8gXHRjb25zb2xlLmxvZyhjb25maWdbM10pOyAvLyBBVVRIMCAoZGVmYXVsdDogMHhmZilcblx0XHQvL1xuXHRcdC8vIFx0Ly8gQ29uZmlndXJhdGlvbiBwYWdlIDE3XG5cdFx0Ly8gXHRjb25zb2xlLmxvZyhjb25maWdbNF0pOyAvLyBBQ0NFU1Ncblx0XHQvLyBcdGNvbnNvbGUubG9nKGNvbmZpZ1s1XSk7IC8vIFZDVElEIChkZWZhdWx0OiAweDA1KVxuXHRcdC8vIFx0Y29uc29sZS5sb2coY29uZmlnWzZdKTtcblx0XHQvLyBcdGNvbnNvbGUubG9nKGNvbmZpZ1s3XSk7XG5cdFx0Ly9cblx0XHQvLyBcdC8vIFByb3RlY3QgZXZlcnl0aGluZyAoc3RhcnQgd2l0aCBmaXJzdCBkYXRhIHBhZ2UpXG5cdFx0Ly8gXHRjb25maWdbM10gPSAweDA0O1xuXHRcdC8vXG5cdFx0Ly8gXHQvLyBzZXQgQUNDRVNTIGJpdHNcblx0XHQvLyBcdC8vIGJpdCA3OiBQUk9UIE9uZSBiaXQgaW5zaWRlIHRoZSBBQ0NFU1MgYnl0ZSBkZWZpbmluZyB0aGUgbWVtb3J5IHByb3RlY3Rpb25cblx0XHQvLyBcdC8vICAgICAgICAgIDBiIC4uLiB3cml0ZSBhY2Nlc3MgaXMgcHJvdGVjdGVkIGJ5IHRoZSBwYXNzd29yZCB2ZXJpZmljYXRpb25cblx0XHQvLyBcdC8vICAgICAgICAgIDFiIC4uLiByZWFkIGFuZCB3cml0ZSBhY2Nlc3MgaXMgcHJvdGVjdGVkIGJ5IHRoZSBwYXNzd29yZCB2ZXJpZmljYXRpb25cblx0XHQvLyBcdC8vIGJpdCA2OiBDRkdMQ0sgV3JpdGUgbG9ja2luZyBiaXQgZm9yIHRoZSB1c2VyIGNvbmZpZ3VyYXRpb25cblx0XHQvLyBcdC8vICAgICAgICAtIDBiIC4uLiB1c2VyIGNvbmZpZ3VyYXRpb24gb3BlbiB0byB3cml0ZSBhY2Nlc3Ncblx0XHQvLyBcdC8vICAgICAgICAtIDFiIC4uLiB1c2VyIGNvbmZpZ3VyYXRpb24gcGVybWFuZW50bHkgbG9ja2VkIGFnYWluc3Qgd3JpdGUgYWNjZXNzXG5cdFx0Ly8gXHQvLyBiaXRzIDUtMzogcmVzZXJ2ZWRcblx0XHQvLyBcdC8vIGJpdHMgMi0wOiBBVVRITElNXG5cdFx0Ly8gXHQvLyBiaXQgbnVtYmVyLTc2NTQzMjEwXG5cdFx0Ly8gXHQvLyAgICAgICAgICAgIHx8fHx8fHx8XG5cdFx0Ly8gXHRjb25maWdbNF0gPSAwYjEwMDAwMDAwO1xuXHRcdC8vXG5cdFx0Ly8gXHQvLyBzZXQgY3VzdG9tIGFjY2VzcyBydWxlc1xuXHRcdC8vIFx0YXdhaXQgcmVhZGVyLndyaXRlKDE2LCBjb25maWcpO1xuXHRcdC8vXG5cdFx0Ly8gfSBjYXRjaCAoZXJyKSB7XG5cdFx0Ly8gXHRwcmV0dHkuZXJyb3IoJ2NvbmZpZ3VyYXRpb24gd3JpdGUgZXJyb3I6JywgZXJyKTtcblx0XHQvLyB9XG5cblx0fSk7XG5cblx0cmVhZGVyLm9uKCdlcnJvcicsIGVyciA9PiB7XG5cdFx0cHJldHR5LmVycm9yKGBhbiBlcnJvciBvY2N1cnJlZGAsIHJlYWRlciwgZXJyKTtcblx0fSk7XG5cblx0cmVhZGVyLm9uKCdlbmQnLCAoKSA9PiB7XG5cdFx0cHJldHR5LmluZm8oYGRldmljZSByZW1vdmVkYCwgcmVhZGVyKTtcblx0fSk7XG5cbn0pO1xuXG5uZmMub24oJ2Vycm9yJywgZXJyID0+IHtcblx0cHJldHR5LmVycm9yKGBhbiBlcnJvciBvY2N1cnJlZGAsIGVycik7XG59KTtcbiJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "mifare-ultralight-ntag.js"
      ],
      "names": [
        "MifareUltralightPasswordAuthenticationError",
        "TransmitError",
        "constructor",
        "code",
        "message",
        "previousError",
        "name",
        "MifareUltralightFastReadError",
        "parseBytes",
        "data",
        "length",
        "Buffer",
        "Error",
        "isBuffer",
        "from",
        "MifareUltralight",
        "reader",
        "passwordAuthenticate",
        "password",
        "pack",
        "cmd",
        "logger",
        "debug",
        "response",
        "transmit",
        "slice",
        "equals",
        "fastRead",
        "startPage",
        "endPage",
        "nfc",
        "NFC",
        "pretty",
        "on",
        "info",
        "ultralight",
        "card",
        "err",
        "error"
      ],
      "mappings": "AAAA,a,CAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;AAEA;;AACA;;;;AAGO,MAAMA,2CAAN,SAA0DC,oBAA1D,CAAwE;AAE9EC,EAAAA,WAAW,CAACC,IAAD,EAAOC,OAAP,EAAgBC,aAAhB,EAA+B;AAEzC,UAAMF,IAAN,EAAYC,OAAZ,EAAqBC,aAArB;AAEA,SAAKC,IAAL,GAAY,6CAAZ;AAEA;;AAR6E;;;;AAYxE,MAAMC,6BAAN,SAA4CN,oBAA5C,CAA0D;AAEhEC,EAAAA,WAAW,CAACC,IAAD,EAAOC,OAAP,EAAgBC,aAAhB,EAA+B;AAEzC,UAAMF,IAAN,EAAYC,OAAZ,EAAqBC,aAArB;AAEA,SAAKC,IAAL,GAAY,+BAAZ;AAEA;;AAR+D;;;;AAYjE,MAAME,UAAU,GAAG,CAACF,IAAD,EAAOG,IAAP,EAAaC,MAAb,KAAwB;AAE1C,MAAI,EAAED,IAAI,YAAYE,MAAlB,KAA6B,OAAOF,IAAP,KAAgB,QAAjD,EAA2D;AAC1D,UAAM,IAAIG,KAAJ,CAAW,GAAEN,IAAK,8CAAlB,CAAN;AACA;;AAED,MAAIK,MAAM,CAACE,QAAP,CAAgBJ,IAAhB,CAAJ,EAA2B;AAE1B,QAAIA,IAAI,CAACC,MAAL,KAAgBA,MAApB,EAA4B;AAC3B,YAAM,IAAIE,KAAJ,CAAW,GAAEN,IAAK,YAAWI,MAAO,cAApC,CAAN;AACA;;AAED,WAAOD,IAAP;AAEA;;AAED,MAAI,OAAOA,IAAP,KAAgB,QAApB,EAA8B;AAE7B,QAAIA,IAAI,CAACC,MAAL,KAAgBA,MAAM,GAAG,CAA7B,EAAgC;AAC/B,YAAM,IAAIE,KAAJ,CAAW,GAAEN,IAAK,cAAaI,MAAM,GAAG,CAAE,mBAA1C,CAAN;AACA;;AAED,WAAOC,MAAM,CAACG,IAAP,CAAYL,IAAZ,EAAkB,KAAlB,CAAP;AAEA;;AAED,QAAM,IAAIG,KAAJ,CAAW,GAAEN,IAAK,8CAAlB,CAAN;AAEA,CA5BD;;AA8BA,MAAMS,gBAAN,CAAuB;AAEtBb,EAAAA,WAAW,CAACc,MAAD,EAAS;AACnB,SAAKA,MAAL,GAAcA,MAAd;AACA,GAJqB,CAMtB;;;AAC0B,QAApBC,oBAAoB,CAACC,QAAD,EAAWC,IAAX,EAAiB;AAE1C;AACA;AACA;AAEAD,IAAAA,QAAQ,GAAGV,UAAU,CAAC,UAAD,EAAaU,QAAb,EAAuB,CAAvB,CAArB;AACAC,IAAAA,IAAI,GAAGX,UAAU,CAAC,MAAD,EAASW,IAAT,EAAe,CAAf,CAAjB,CAP0C,CAS1C;;AACA,UAAMC,GAAG,GAAGT,MAAM,CAACG,IAAP,CAAY,CACvB,IADuB,EACjB;AACN,QAFuB,EAEjB;AACN,QAHuB,EAGjB;AACN,QAJuB,EAIjB;AACN,QALuB,EAKjB;AACN;AACA,QAPuB,EAOjB;AACN,QARuB,EAQjB;AACN,QATuB,EASjB;AACN,OAAGI,QAVoB,CAAZ,CAAZ;AAaA,SAAKF,MAAL,CAAYK,MAAZ,CAAmBC,KAAnB,CAAyB,cAAzB,EAAyCF,GAAzC;AAGA,UAAMG,QAAQ,GAAG,MAAM,KAAKP,MAAL,CAAYQ,QAAZ,CAAqBJ,GAArB,EAA0B,CAA1B,CAAvB;AAEA,SAAKJ,MAAL,CAAYK,MAAZ,CAAmBC,KAAnB,CAAyB,mBAAzB,EAA8CC,QAA9C,EA5B0C,CA6B1C;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,QAAIA,QAAQ,CAACb,MAAT,GAAkB,CAAtB,EAAyB;AACxB,YAAM,IAAIV,2CAAJ,CAAgD,yBAAhD,EAA4E,2BAA0BuB,QAAQ,CAACb,MAAO,wCAAtH,CAAN;AACA;;AAED,QAAIa,QAAQ,CAAC,CAAD,CAAR,KAAgB,IAAhB,IAAwBA,QAAQ,CAACb,MAAT,GAAkB,CAA9C,EAAiD;AAChD,YAAM,IAAIV,2CAAJ,CAAgD,kBAAhD,EAAqE,uEAArE,CAAN;AACA;;AAED,QAAI,CAACuB,QAAQ,CAACE,KAAT,CAAe,CAAf,EAAkB,CAAlB,EAAqBC,MAArB,CAA4BP,IAA5B,CAAL,EAAwC;AACvC,YAAM,IAAInB,2CAAJ,CAAgD,eAAhD,EAAkE,gBAAlE,CAAN;AACA;;AAED;AAEA,GA1DqB,CA4DtB;;;AACc,QAAR2B,QAAQ,CAACC,SAAD,EAAYC,OAAZ,EAAqB;AAElC;AACA,UAAMT,GAAG,GAAGT,MAAM,CAACG,IAAP,CAAY,CACvB,IADuB,EACjB;AACN,QAFuB,EAEjB;AACN,QAHuB,EAGjB;AACN,QAJuB,EAIjB;AACN,QALuB,EAKjB;AACN;AACA,QAPuB,EAOjB;AACN,QARuB,EAQjB;AACN,QATuB,EASjB;AACNc,IAAAA,SAVuB,EAWvBC,OAXuB,CAAZ,CAAZ;AAcA,UAAMnB,MAAM,GAAG,IAAK,CAACmB,OAAO,GAAGD,SAAV,GAAsB,CAAvB,IAA4B,CAAjC,GAAsC,CAArD;AAEA,UAAML,QAAQ,GAAG,MAAM,KAAKP,MAAL,CAAYQ,QAAZ,CAAqBJ,GAArB,EAA0BV,MAA1B,CAAvB;;AAEA,QAAIa,QAAQ,GAAGb,MAAf,EAAuB;AACtB,YAAM,IAAIH,6BAAJ,CAAkC,yBAAlC,EAA8D,2BAA0BgB,QAAQ,CAACb,MAAO,yBAAwBA,MAAO,SAAvI,CAAN;AACA;;AAED,WAAOa,QAAQ,CAACE,KAAT,CAAe,CAAf,EAAkB,CAAC,CAAnB,CAAP;AAEA;;AAxFqB;;AA4FvB,MAAMK,GAAG,GAAG,IAAIC,UAAJ,CAAQC,qBAAR,CAAZ,C,CAA6B;;AAE7BF,GAAG,CAACG,EAAJ,CAAO,QAAP,EAAiB,MAAMjB,MAAN,IAAgB;AAEhCgB,wBAAOE,IAAP,CAAa,iBAAb,EAA+BlB,MAA/B;;AAEA,QAAMmB,UAAU,GAAG,IAAIpB,gBAAJ,CAAqBC,MAArB,CAAnB;AAEAA,EAAAA,MAAM,CAACiB,EAAP,CAAU,MAAV,EAAkB,MAAMG,IAAN,IAAc;AAE/BJ,0BAAOE,IAAP,CAAY,eAAZ,EAA6BlB,MAA7B,EAAqCoB,IAArC;;AAEA,UAAMlB,QAAQ,GAAG,UAAjB,CAJ+B,CAIF;;AAC7B,UAAMC,IAAI,GAAG,MAAb,CAL+B,CAKV;;AAErB,QAAI;AAEH,YAAMgB,UAAU,CAAClB,oBAAX,CAAgCC,QAAhC,EAA0CC,IAA1C,CAAN;;AAEAa,4BAAOE,IAAP,CAAY,kDAAZ;AAEA,KAND,CAME,OAAOG,GAAP,EAAY;AACbL,4BAAOM,KAAP,CAAa,6BAAb,EAA4CD,GAA5C;AACA;;AAED,QAAI;AAEH,YAAM5B,IAAI,GAAG,MAAM0B,UAAU,CAACR,QAAX,CAAoB,EAApB,EAAwB,EAAxB,CAAnB;;AAEAK,4BAAOE,IAAP,CAAY,gBAAZ,EAA8BzB,IAA9B;AAEA,KAND,CAME,OAAO4B,GAAP,EAAY;AACbL,4BAAOM,KAAP,CAAa,iBAAb,EAAgCD,GAAhC;;AACA;AACA,KA1B8B,CA4B/B;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,GAhFD;AAkFArB,EAAAA,MAAM,CAACiB,EAAP,CAAU,OAAV,EAAmBI,GAAG,IAAI;AACzBL,0BAAOM,KAAP,CAAc,mBAAd,EAAkCtB,MAAlC,EAA0CqB,GAA1C;AACA,GAFD;AAIArB,EAAAA,MAAM,CAACiB,EAAP,CAAU,KAAV,EAAiB,MAAM;AACtBD,0BAAOE,IAAP,CAAa,gBAAb,EAA8BlB,MAA9B;AACA,GAFD;AAIA,CAhGD;AAkGAc,GAAG,CAACG,EAAJ,CAAO,OAAP,EAAgBI,GAAG,IAAI;AACtBL,wBAAOM,KAAP,CAAc,mBAAd,EAAkCD,GAAlC;AACA,CAFD",
      "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/",
      "sourcesContent": [
        "'use strict';\n\n// #############\n// Example: MIFARE Ultralight EV1 and NTAG 213/215/216 – implementation of card's specific commands\n// - note: for instructions on reading and writing the data,\n//   please see read-write.js, which is common for all ISO/IEC 14443-3 tags\n// - note: this guide applies to NTAG 213/215/216 cards as-well\n//   (the commands and configuration pages structure is same or very similar,\n//   the only difference is the location of the pages due to different user memory size)\n// - docs (descriptions of the commands and data structure):\n//   - MIFARE Ultralight EV1 – see https://www.nxp.com/docs/en/data-sheet/MF0ULX1.pdf\n//   - NTAG 213/215/216 – https://www.nxp.com/docs/en/data-sheet/NTAG213_215_216.pdf\n// - note: works ONLY on ACR122U reader or possibly any reader which uses NXP PN533 and similar NFC frontends\n// - what is covered:\n//   - password authentication – PWD_AUTH command\n//   - fast read – FAST_READ command\n//   - setting card configuration pages – set custom password and access conditions\n// #############\n\nimport { NFC, TAG_ISO_14443_3, TAG_ISO_14443_4, KEY_TYPE_A, KEY_TYPE_B, TransmitError } from '../src/index';\nimport pretty from './pretty-logger';\n\n\nexport class MifareUltralightPasswordAuthenticationError extends TransmitError {\n\n\tconstructor(code, message, previousError) {\n\n\t\tsuper(code, message, previousError);\n\n\t\tthis.name = 'MifareUltralightPasswordAuthenticationError';\n\n\t}\n\n}\n\nexport class MifareUltralightFastReadError extends TransmitError {\n\n\tconstructor(code, message, previousError) {\n\n\t\tsuper(code, message, previousError);\n\n\t\tthis.name = 'MifareUltralightFastReadError';\n\n\t}\n\n}\n\nconst parseBytes = (name, data, length) => {\n\n\tif (!(data instanceof Buffer) && typeof data !== 'string') {\n\t\tthrow new Error(`${name} must an instance of Buffer or a HEX string.`);\n\t}\n\n\tif (Buffer.isBuffer(data)) {\n\n\t\tif (data.length !== length) {\n\t\t\tthrow new Error(`${name} must be ${length} bytes long.`);\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n\tif (typeof data === 'string') {\n\n\t\tif (data.length !== length * 2) {\n\t\t\tthrow new Error(`${name} must be a ${length * 2} char HEX string.`);\n\t\t}\n\n\t\treturn Buffer.from(data, 'hex');\n\n\t}\n\n\tthrow new Error(`${name} must an instance of Buffer or a HEX string.`);\n\n};\n\nclass MifareUltralight {\n\n\tconstructor(reader) {\n\t\tthis.reader = reader;\n\t}\n\n\t// PWD_AUTH\n\tasync passwordAuthenticate(password, pack) {\n\n\t\t// PASSWORD (4 bytes) (stored on card in page 18)\n\t\t// PACK (2 bytes) (stored in page 19 as first two bytes)\n\t\t// PACK is the response from card in case of successful PWD_AUTH cmd\n\n\t\tpassword = parseBytes('Password', password, 4);\n\t\tpack = parseBytes('Pack', pack, 2);\n\n\t\t// CMD: PWD_AUTH via Direct Transmit (ACR122U) and Data Exchange (PN533)\n\t\tconst cmd = Buffer.from([\n\t\t\t0xff, // Class\n\t\t\t0x00, // Direct Transmit (see ACR122U docs)\n\t\t\t0x00, // ...\n\t\t\t0x00, // ...\n\t\t\t0x07, // Length of Direct Transmit payload\n\t\t\t// Payload (7 bytes)\n\t\t\t0xd4, // Data Exchange Command (see PN533 docs)\n\t\t\t0x42, // InCommunicateThru\n\t\t\t0x1b, // PWD_AUTH\n\t\t\t...password,\n\t\t]);\n\n\t\tthis.reader.logger.debug('pwd_auth cmd', cmd);\n\n\n\t\tconst response = await this.reader.transmit(cmd, 7);\n\n\t\tthis.reader.logger.debug('pwd_auth response', response);\n\t\t// pwd_auth response should look like the following (7 bytes)\n\t\t// d5 43 00 ab cd 90 00\n\t\t// byte 0: d5 prefix for response of Data Exchange Command (see PN533 docs)\n\t\t// byte 1: 43 prefix for response of Data Exchange Command (see PN533 docs)\n\t\t// byte 2: Data Exchange Command Status 0x00 is success (see PN533 docs, Table 15. Error code list)\n\t\t// bytes 3-4: Data Exchange Command Response – our PACK (set on card in page 19, in bytes 0-1) from card\n\t\t// bytes 5-6: ACR122U success code\n\n\t\tif (response.length < 5) {\n\t\t\tthrow new MifareUltralightPasswordAuthenticationError('invalid_response_length', `Invalid response length ${response.length}. Expected minimal length was 2 bytes.`)\n\t\t}\n\n\t\tif (response[2] !== 0x00 || response.length < 7) {\n\t\t\tthrow new MifareUltralightPasswordAuthenticationError('invalid_password', `Authentication failed. Might be invalid password or unsupported card.`);\n\t\t}\n\n\t\tif (!response.slice(3, 5).equals(pack)) {\n\t\t\tthrow new MifareUltralightPasswordAuthenticationError('pack_mismatch', `Pack mismatch.`)\n\t\t}\n\n\t\treturn;\n\n\t}\n\n\t// FAST_READ\n\tasync fastRead(startPage, endPage) {\n\n\t\t// CMD: PWD_AUTH via Direct Transmit (ACR122U) and Data Exchange (PN533)\n\t\tconst cmd = Buffer.from([\n\t\t\t0xff, // Class\n\t\t\t0x00, // Direct Transmit (see ACR122U docs)\n\t\t\t0x00, // ...\n\t\t\t0x00, // ...\n\t\t\t0x07, // Length of Direct Transmit payload\n\t\t\t// Payload (7 bytes)\n\t\t\t0xd4, // Data Exchange Command (see PN533 docs)\n\t\t\t0x42, // InCommunicateThru\n\t\t\t0x3a, // PWD_AUTH\n\t\t\tstartPage,\n\t\t\tendPage,\n\t\t]);\n\n\t\tconst length = 3 + ((endPage - startPage + 1) * 4) + 2;\n\n\t\tconst response = await this.reader.transmit(cmd, length);\n\n\t\tif (response < length) {\n\t\t\tthrow new MifareUltralightFastReadError('invalid_response_length', `Invalid response length ${response.length}. Expected length was ${length} bytes.`)\n\t\t}\n\n\t\treturn response.slice(3, -2);\n\n\t}\n\n}\n\nconst nfc = new NFC(pretty); // const nfc = new NFC(pretty); // optionally you can pass logger to see internal debug logs\n\nnfc.on('reader', async reader => {\n\n\tpretty.info(`device attached`, reader);\n\n\tconst ultralight = new MifareUltralight(reader);\n\n\treader.on('card', async card => {\n\n\t\tpretty.info('card detected', reader, card);\n\n\t\tconst password = 'FFFFFFFF'; // default password\n\t\tconst pack = '0000'; // default pack\n\n\t\ttry {\n\n\t\t\tawait ultralight.passwordAuthenticate(password, pack);\n\n\t\t\tpretty.info('passwordAuthenticate: successfully authenticated');\n\n\t\t} catch (err) {\n\t\t\tpretty.error('passwordAuthenticate error:', err);\n\t\t}\n\n\t\ttry {\n\n\t\t\tconst data = await ultralight.fastRead(16, 19);\n\n\t\t\tpretty.info('fastRead data:', data);\n\n\t\t} catch (err) {\n\t\t\tpretty.error('fastRead error:', err);\n\t\t\treturn;\n\t\t}\n\n\t\t// Note! UPDATE locations of configuration pages according to the version of your card!\n\t\t// (see memory layout in your card's docs)\n\n\t\t// try {\n\t\t//\n\t\t// \t// set custom PASSWORD (4 bytes) (stored in page 18)\n\t\t// \tawait reader.write(19, password);\n\t\t//\n\t\t// \t// set custom PACK (2 bytes) (stored in page 19 as first two bytes\n\t\t// \tconst packPage = await reader.read(19, 4);\n\t\t// \tpackPage[0] = pack[0];\n\t\t// \tpackPage[1] = pack[1];\n\t\t// \tawait reader.write(19, packPage);\n\t\t//\n\t\t// \t// read current configuration\n\t\t// \tconst config = await reader.read(16, 8);\n\t\t//\n\t\t// \t// Configuration page 16\n\t\t// \tconsole.log(config[0]);\n\t\t// \tconsole.log(config[1]);\n\t\t// \tconsole.log(config[2]);\n\t\t// \tconsole.log(config[3]); // AUTH0 (default: 0xff)\n\t\t//\n\t\t// \t// Configuration page 17\n\t\t// \tconsole.log(config[4]); // ACCESS\n\t\t// \tconsole.log(config[5]); // VCTID (default: 0x05)\n\t\t// \tconsole.log(config[6]);\n\t\t// \tconsole.log(config[7]);\n\t\t//\n\t\t// \t// Protect everything (start with first data page)\n\t\t// \tconfig[3] = 0x04;\n\t\t//\n\t\t// \t// set ACCESS bits\n\t\t// \t// bit 7: PROT One bit inside the ACCESS byte defining the memory protection\n\t\t// \t//          0b ... write access is protected by the password verification\n\t\t// \t//          1b ... read and write access is protected by the password verification\n\t\t// \t// bit 6: CFGLCK Write locking bit for the user configuration\n\t\t// \t//        - 0b ... user configuration open to write access\n\t\t// \t//        - 1b ... user configuration permanently locked against write access\n\t\t// \t// bits 5-3: reserved\n\t\t// \t// bits 2-0: AUTHLIM\n\t\t// \t// bit number-76543210\n\t\t// \t//            ||||||||\n\t\t// \tconfig[4] = 0b10000000;\n\t\t//\n\t\t// \t// set custom access rules\n\t\t// \tawait reader.write(16, config);\n\t\t//\n\t\t// } catch (err) {\n\t\t// \tpretty.error('configuration write error:', err);\n\t\t// }\n\n\t});\n\n\treader.on('error', err => {\n\t\tpretty.error(`an error occurred`, reader, err);\n\t});\n\n\treader.on('end', () => {\n\t\tpretty.info(`device removed`, reader);\n\t});\n\n});\n\nnfc.on('error', err => {\n\tpretty.error(`an error occurred`, err);\n});\n"
      ]
    },
    "sourceType": "script",
    "mtime": 1662229648498
  },
  "{\"sourceRoot\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc\",\"filename\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/ndef.js\",\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{}},{\"key\":\"proposal-class-properties\",\"visitor\":{\"PrivateName\":{\"enter\":[null]},\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{}}],\"presets\":[]}:7.12.17": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/",
      "caller": {
        "name": "@babel/register"
      },
      "cwd": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc",
      "filename": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/ndef.js",
      "cloneInputAst": true,
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {}
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {}
        },
        {
          "key": "proposal-class-properties",
          "visitor": {
            "PrivateName": {
              "enter": [
                null
              ]
            },
            "ExportDefaultDeclaration": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true,
            "ClassExpression": {
              "enter": [
                null
              ]
            },
            "ClassDeclaration": {
              "enter": [
                null
              ]
            }
          },
          "options": {}
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/ndef.js",
        "plugins": [
          "objectRestSpread",
          "classProperties",
          "classPrivateProperties"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/ndef.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/",
        "sourceFileName": "ndef.js"
      }
    },
    "ast": null,
    "code": "\"use strict\"; // #############\n// example not finished, it in progress !!!\n// Read NDEF formatted data\n// #############\n\nvar _index = require(\"../src/index\");\n\nvar _pretty = _interopRequireDefault(require(\"./pretty\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5kZWYuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsYSxDQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUNBIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9oYXJyeWhvdy9Eb2N1bWVudHMvMjAyMi9QUk9KRUNUX01PQ0FfQVJUL05GQy9uZmMtcGNzYy9leGFtcGxlcy8iLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxuLy8gIyMjIyMjIyMjIyMjI1xuLy8gZXhhbXBsZSBub3QgZmluaXNoZWQsIGl0IGluIHByb2dyZXNzICEhIVxuLy8gUmVhZCBOREVGIGZvcm1hdHRlZCBkYXRhXG4vLyAjIyMjIyMjIyMjIyMjXG5cbmltcG9ydCB7IE5GQywgVEFHX0lTT18xNDQ0M18zLCBUQUdfSVNPXzE0NDQzXzQsIEtFWV9UWVBFX0EsIEtFWV9UWVBFX0IgfSBmcm9tICcuLi9zcmMvaW5kZXgnO1xuaW1wb3J0IHByZXR0eSBmcm9tICcuL3ByZXR0eSc7XG4iXX0=",
    "map": {
      "version": 3,
      "sources": [
        "ndef.js"
      ],
      "names": [],
      "mappings": "AAAA,a,CAEA;AACA;AACA;AACA;;AAEA;;AACA",
      "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/",
      "sourcesContent": [
        "\"use strict\";\n\n// #############\n// example not finished, it in progress !!!\n// Read NDEF formatted data\n// #############\n\nimport { NFC, TAG_ISO_14443_3, TAG_ISO_14443_4, KEY_TYPE_A, KEY_TYPE_B } from '../src/index';\nimport pretty from './pretty';\n"
      ]
    },
    "sourceType": "script",
    "mtime": 1662229648498
  },
  "{\"sourceRoot\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc\",\"filename\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/NFC.js\",\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{}},{\"key\":\"proposal-class-properties\",\"visitor\":{\"PrivateName\":{\"enter\":[null]},\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{}}],\"presets\":[]}:7.12.17": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/",
      "caller": {
        "name": "@babel/register"
      },
      "cwd": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc",
      "filename": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/NFC.js",
      "cloneInputAst": true,
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {}
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {}
        },
        {
          "key": "proposal-class-properties",
          "visitor": {
            "PrivateName": {
              "enter": [
                null
              ]
            },
            "ExportDefaultDeclaration": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true,
            "ClassExpression": {
              "enter": [
                null
              ]
            },
            "ClassDeclaration": {
              "enter": [
                null
              ]
            }
          },
          "options": {}
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/NFC.js",
        "plugins": [
          "objectRestSpread",
          "classProperties",
          "classPrivateProperties"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/NFC.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/",
        "sourceFileName": "NFC.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _pcsclite = _interopRequireDefault(require(\"@pokusew/pcsclite\"));\n\nvar _events = _interopRequireDefault(require(\"events\"));\n\nvar _Reader = _interopRequireDefault(require(\"./Reader\"));\n\nvar _ACR122Reader = _interopRequireDefault(require(\"./ACR122Reader\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nclass NFC extends _events.default {\n  constructor(logger) {\n    super();\n\n    _defineProperty(this, \"pcsc\", null);\n\n    _defineProperty(this, \"logger\", null);\n\n    this.pcsc = (0, _pcsclite.default)();\n\n    if (logger) {\n      this.logger = logger;\n    } else {\n      this.logger = {\n        log: function () {},\n        debug: function () {},\n        info: function () {},\n        warn: function () {},\n        error: function () {}\n      };\n    }\n\n    this.pcsc.on('reader', reader => {\n      this.logger.debug('new reader detected', reader.name); // create special object for ARC122U reader with commands specific to this reader\n\n      if ( // 'acr122' matches ARC122U\n      reader.name.toLowerCase().indexOf('acr122') !== -1 // 'acr125' matches ACR1252U reader because ACR1252U has some common commands with ARC122U\n      //   ACR1252U product page: https://www.acs.com.hk/en/products/342/acr1252u-usb-nfc-reader-iii-nfc-forum-certified-reader/\n      //   TODO: in the future, this should be refactored:\n      //         see discussion in PR#111 https://github.com/pokusew/nfc-pcsc/pull/111\n      || reader.name.toLowerCase().indexOf('acr125') !== -1) {\n        const device = new _ACR122Reader.default(reader, this.logger);\n        this.emit('reader', device);\n        return;\n      }\n\n      const device = new _Reader.default(reader, this.logger);\n      this.emit('reader', device);\n    });\n    this.pcsc.on('error', err => {\n      this.logger.error('PCSC error', err.message);\n      this.emit('error', err);\n    });\n  }\n\n  get readers() {\n    return this.pcsc.readers;\n  }\n\n  close() {\n    this.pcsc.close();\n  }\n\n}\n\nvar _default = NFC;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIk5GQy5qcyJdLCJuYW1lcyI6WyJORkMiLCJFdmVudEVtaXR0ZXIiLCJjb25zdHJ1Y3RvciIsImxvZ2dlciIsInBjc2MiLCJsb2ciLCJkZWJ1ZyIsImluZm8iLCJ3YXJuIiwiZXJyb3IiLCJvbiIsInJlYWRlciIsIm5hbWUiLCJ0b0xvd2VyQ2FzZSIsImluZGV4T2YiLCJkZXZpY2UiLCJBQ1IxMjJSZWFkZXIiLCJlbWl0IiwiUmVhZGVyIiwiZXJyIiwibWVzc2FnZSIsInJlYWRlcnMiLCJjbG9zZSJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7QUFFQTs7QUFDQTs7QUFDQTs7QUFDQTs7Ozs7O0FBR0EsTUFBTUEsR0FBTixTQUFrQkMsZUFBbEIsQ0FBK0I7QUFLOUJDLEVBQUFBLFdBQVcsQ0FBQ0MsTUFBRCxFQUFTO0FBQ25COztBQURtQixrQ0FIYixJQUdhOztBQUFBLG9DQUZYLElBRVc7O0FBR25CLFNBQUtDLElBQUwsR0FBWSx3QkFBWjs7QUFFQSxRQUFJRCxNQUFKLEVBQVk7QUFDWCxXQUFLQSxNQUFMLEdBQWNBLE1BQWQ7QUFDQSxLQUZELE1BR0s7QUFDSixXQUFLQSxNQUFMLEdBQWM7QUFDYkUsUUFBQUEsR0FBRyxFQUFFLFlBQVksQ0FDaEIsQ0FGWTtBQUdiQyxRQUFBQSxLQUFLLEVBQUUsWUFBWSxDQUNsQixDQUpZO0FBS2JDLFFBQUFBLElBQUksRUFBRSxZQUFZLENBQ2pCLENBTlk7QUFPYkMsUUFBQUEsSUFBSSxFQUFFLFlBQVksQ0FDakIsQ0FSWTtBQVNiQyxRQUFBQSxLQUFLLEVBQUUsWUFBWSxDQUNsQjtBQVZZLE9BQWQ7QUFZQTs7QUFFRCxTQUFLTCxJQUFMLENBQVVNLEVBQVYsQ0FBYSxRQUFiLEVBQXdCQyxNQUFELElBQVk7QUFFbEMsV0FBS1IsTUFBTCxDQUFZRyxLQUFaLENBQWtCLHFCQUFsQixFQUF5Q0ssTUFBTSxDQUFDQyxJQUFoRCxFQUZrQyxDQUlsQzs7QUFDQSxXQUVDO0FBQ0FELE1BQUFBLE1BQU0sQ0FBQ0MsSUFBUCxDQUFZQyxXQUFaLEdBQTBCQyxPQUExQixDQUFrQyxRQUFsQyxNQUFnRCxDQUFDLENBQWpELENBRUE7QUFDQTtBQUNBO0FBQ0E7QUFMQSxTQU1HSCxNQUFNLENBQUNDLElBQVAsQ0FBWUMsV0FBWixHQUEwQkMsT0FBMUIsQ0FBa0MsUUFBbEMsTUFBZ0QsQ0FBQyxDQVRyRCxFQVdFO0FBRUQsY0FBTUMsTUFBTSxHQUFHLElBQUlDLHFCQUFKLENBQWlCTCxNQUFqQixFQUF5QixLQUFLUixNQUE5QixDQUFmO0FBRUEsYUFBS2MsSUFBTCxDQUFVLFFBQVYsRUFBb0JGLE1BQXBCO0FBRUE7QUFFQTs7QUFFRCxZQUFNQSxNQUFNLEdBQUcsSUFBSUcsZUFBSixDQUFXUCxNQUFYLEVBQW1CLEtBQUtSLE1BQXhCLENBQWY7QUFFQSxXQUFLYyxJQUFMLENBQVUsUUFBVixFQUFvQkYsTUFBcEI7QUFFQSxLQTlCRDtBQWdDQSxTQUFLWCxJQUFMLENBQVVNLEVBQVYsQ0FBYSxPQUFiLEVBQXVCUyxHQUFELElBQVM7QUFFOUIsV0FBS2hCLE1BQUwsQ0FBWU0sS0FBWixDQUFrQixZQUFsQixFQUFnQ1UsR0FBRyxDQUFDQyxPQUFwQztBQUVBLFdBQUtILElBQUwsQ0FBVSxPQUFWLEVBQW1CRSxHQUFuQjtBQUVBLEtBTkQ7QUFRQTs7QUFFVSxNQUFQRSxPQUFPLEdBQUc7QUFDYixXQUFPLEtBQUtqQixJQUFMLENBQVVpQixPQUFqQjtBQUNBOztBQUVEQyxFQUFBQSxLQUFLLEdBQUc7QUFDUCxTQUFLbEIsSUFBTCxDQUFVa0IsS0FBVjtBQUNBOztBQTVFNkI7O2VBZ0ZoQnRCLEciLCJzb3VyY2VSb290IjoiL1VzZXJzL2hhcnJ5aG93L0RvY3VtZW50cy8yMDIyL1BST0pFQ1RfTU9DQV9BUlQvTkZDL25mYy1wY3NjL3NyYy8iLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxuaW1wb3J0IHBjc2NsaXRlIGZyb20gJ0Bwb2t1c2V3L3Bjc2NsaXRlJztcbmltcG9ydCBFdmVudEVtaXR0ZXIgZnJvbSAnZXZlbnRzJztcbmltcG9ydCBSZWFkZXIgZnJvbSAnLi9SZWFkZXInO1xuaW1wb3J0IEFDUjEyMlJlYWRlciBmcm9tICcuL0FDUjEyMlJlYWRlcic7XG5cblxuY2xhc3MgTkZDIGV4dGVuZHMgRXZlbnRFbWl0dGVyIHtcblxuXHRwY3NjID0gbnVsbDtcblx0bG9nZ2VyID0gbnVsbDtcblxuXHRjb25zdHJ1Y3Rvcihsb2dnZXIpIHtcblx0XHRzdXBlcigpO1xuXG5cdFx0dGhpcy5wY3NjID0gcGNzY2xpdGUoKTtcblxuXHRcdGlmIChsb2dnZXIpIHtcblx0XHRcdHRoaXMubG9nZ2VyID0gbG9nZ2VyO1xuXHRcdH1cblx0XHRlbHNlIHtcblx0XHRcdHRoaXMubG9nZ2VyID0ge1xuXHRcdFx0XHRsb2c6IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0fSxcblx0XHRcdFx0ZGVidWc6IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0fSxcblx0XHRcdFx0aW5mbzogZnVuY3Rpb24gKCkge1xuXHRcdFx0XHR9LFxuXHRcdFx0XHR3YXJuOiBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdH0sXG5cdFx0XHRcdGVycm9yOiBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdH0sXG5cdFx0XHR9O1xuXHRcdH1cblxuXHRcdHRoaXMucGNzYy5vbigncmVhZGVyJywgKHJlYWRlcikgPT4ge1xuXG5cdFx0XHR0aGlzLmxvZ2dlci5kZWJ1ZygnbmV3IHJlYWRlciBkZXRlY3RlZCcsIHJlYWRlci5uYW1lKTtcblxuXHRcdFx0Ly8gY3JlYXRlIHNwZWNpYWwgb2JqZWN0IGZvciBBUkMxMjJVIHJlYWRlciB3aXRoIGNvbW1hbmRzIHNwZWNpZmljIHRvIHRoaXMgcmVhZGVyXG5cdFx0XHRpZiAoXG5cblx0XHRcdFx0Ly8gJ2FjcjEyMicgbWF0Y2hlcyBBUkMxMjJVXG5cdFx0XHRcdHJlYWRlci5uYW1lLnRvTG93ZXJDYXNlKCkuaW5kZXhPZignYWNyMTIyJykgIT09IC0xXG5cblx0XHRcdFx0Ly8gJ2FjcjEyNScgbWF0Y2hlcyBBQ1IxMjUyVSByZWFkZXIgYmVjYXVzZSBBQ1IxMjUyVSBoYXMgc29tZSBjb21tb24gY29tbWFuZHMgd2l0aCBBUkMxMjJVXG5cdFx0XHRcdC8vICAgQUNSMTI1MlUgcHJvZHVjdCBwYWdlOiBodHRwczovL3d3dy5hY3MuY29tLmhrL2VuL3Byb2R1Y3RzLzM0Mi9hY3IxMjUydS11c2ItbmZjLXJlYWRlci1paWktbmZjLWZvcnVtLWNlcnRpZmllZC1yZWFkZXIvXG5cdFx0XHRcdC8vICAgVE9ETzogaW4gdGhlIGZ1dHVyZSwgdGhpcyBzaG91bGQgYmUgcmVmYWN0b3JlZDpcblx0XHRcdFx0Ly8gICAgICAgICBzZWUgZGlzY3Vzc2lvbiBpbiBQUiMxMTEgaHR0cHM6Ly9naXRodWIuY29tL3Bva3VzZXcvbmZjLXBjc2MvcHVsbC8xMTFcblx0XHRcdFx0fHwgcmVhZGVyLm5hbWUudG9Mb3dlckNhc2UoKS5pbmRleE9mKCdhY3IxMjUnKSAhPT0gLTFcblxuXHRcdFx0KSB7XG5cblx0XHRcdFx0Y29uc3QgZGV2aWNlID0gbmV3IEFDUjEyMlJlYWRlcihyZWFkZXIsIHRoaXMubG9nZ2VyKTtcblxuXHRcdFx0XHR0aGlzLmVtaXQoJ3JlYWRlcicsIGRldmljZSk7XG5cblx0XHRcdFx0cmV0dXJuO1xuXG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IGRldmljZSA9IG5ldyBSZWFkZXIocmVhZGVyLCB0aGlzLmxvZ2dlcik7XG5cblx0XHRcdHRoaXMuZW1pdCgncmVhZGVyJywgZGV2aWNlKTtcblxuXHRcdH0pO1xuXG5cdFx0dGhpcy5wY3NjLm9uKCdlcnJvcicsIChlcnIpID0+IHtcblxuXHRcdFx0dGhpcy5sb2dnZXIuZXJyb3IoJ1BDU0MgZXJyb3InLCBlcnIubWVzc2FnZSk7XG5cblx0XHRcdHRoaXMuZW1pdCgnZXJyb3InLCBlcnIpO1xuXG5cdFx0fSk7XG5cblx0fVxuXG5cdGdldCByZWFkZXJzKCkge1xuXHRcdHJldHVybiB0aGlzLnBjc2MucmVhZGVycztcblx0fVxuXG5cdGNsb3NlKCkge1xuXHRcdHRoaXMucGNzYy5jbG9zZSgpO1xuXHR9XG5cbn1cblxuZXhwb3J0IGRlZmF1bHQgTkZDO1xuIl19",
    "map": {
      "version": 3,
      "sources": [
        "NFC.js"
      ],
      "names": [
        "NFC",
        "EventEmitter",
        "constructor",
        "logger",
        "pcsc",
        "log",
        "debug",
        "info",
        "warn",
        "error",
        "on",
        "reader",
        "name",
        "toLowerCase",
        "indexOf",
        "device",
        "ACR122Reader",
        "emit",
        "Reader",
        "err",
        "message",
        "readers",
        "close"
      ],
      "mappings": "AAAA;;;;;;;AAEA;;AACA;;AACA;;AACA;;;;;;AAGA,MAAMA,GAAN,SAAkBC,eAAlB,CAA+B;AAK9BC,EAAAA,WAAW,CAACC,MAAD,EAAS;AACnB;;AADmB,kCAHb,IAGa;;AAAA,oCAFX,IAEW;;AAGnB,SAAKC,IAAL,GAAY,wBAAZ;;AAEA,QAAID,MAAJ,EAAY;AACX,WAAKA,MAAL,GAAcA,MAAd;AACA,KAFD,MAGK;AACJ,WAAKA,MAAL,GAAc;AACbE,QAAAA,GAAG,EAAE,YAAY,CAChB,CAFY;AAGbC,QAAAA,KAAK,EAAE,YAAY,CAClB,CAJY;AAKbC,QAAAA,IAAI,EAAE,YAAY,CACjB,CANY;AAObC,QAAAA,IAAI,EAAE,YAAY,CACjB,CARY;AASbC,QAAAA,KAAK,EAAE,YAAY,CAClB;AAVY,OAAd;AAYA;;AAED,SAAKL,IAAL,CAAUM,EAAV,CAAa,QAAb,EAAwBC,MAAD,IAAY;AAElC,WAAKR,MAAL,CAAYG,KAAZ,CAAkB,qBAAlB,EAAyCK,MAAM,CAACC,IAAhD,EAFkC,CAIlC;;AACA,WAEC;AACAD,MAAAA,MAAM,CAACC,IAAP,CAAYC,WAAZ,GAA0BC,OAA1B,CAAkC,QAAlC,MAAgD,CAAC,CAAjD,CAEA;AACA;AACA;AACA;AALA,SAMGH,MAAM,CAACC,IAAP,CAAYC,WAAZ,GAA0BC,OAA1B,CAAkC,QAAlC,MAAgD,CAAC,CATrD,EAWE;AAED,cAAMC,MAAM,GAAG,IAAIC,qBAAJ,CAAiBL,MAAjB,EAAyB,KAAKR,MAA9B,CAAf;AAEA,aAAKc,IAAL,CAAU,QAAV,EAAoBF,MAApB;AAEA;AAEA;;AAED,YAAMA,MAAM,GAAG,IAAIG,eAAJ,CAAWP,MAAX,EAAmB,KAAKR,MAAxB,CAAf;AAEA,WAAKc,IAAL,CAAU,QAAV,EAAoBF,MAApB;AAEA,KA9BD;AAgCA,SAAKX,IAAL,CAAUM,EAAV,CAAa,OAAb,EAAuBS,GAAD,IAAS;AAE9B,WAAKhB,MAAL,CAAYM,KAAZ,CAAkB,YAAlB,EAAgCU,GAAG,CAACC,OAApC;AAEA,WAAKH,IAAL,CAAU,OAAV,EAAmBE,GAAnB;AAEA,KAND;AAQA;;AAEU,MAAPE,OAAO,GAAG;AACb,WAAO,KAAKjB,IAAL,CAAUiB,OAAjB;AACA;;AAEDC,EAAAA,KAAK,GAAG;AACP,SAAKlB,IAAL,CAAUkB,KAAV;AACA;;AA5E6B;;eAgFhBtB,G",
      "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/",
      "sourcesContent": [
        "\"use strict\";\n\nimport pcsclite from '@pokusew/pcsclite';\nimport EventEmitter from 'events';\nimport Reader from './Reader';\nimport ACR122Reader from './ACR122Reader';\n\n\nclass NFC extends EventEmitter {\n\n\tpcsc = null;\n\tlogger = null;\n\n\tconstructor(logger) {\n\t\tsuper();\n\n\t\tthis.pcsc = pcsclite();\n\n\t\tif (logger) {\n\t\t\tthis.logger = logger;\n\t\t}\n\t\telse {\n\t\t\tthis.logger = {\n\t\t\t\tlog: function () {\n\t\t\t\t},\n\t\t\t\tdebug: function () {\n\t\t\t\t},\n\t\t\t\tinfo: function () {\n\t\t\t\t},\n\t\t\t\twarn: function () {\n\t\t\t\t},\n\t\t\t\terror: function () {\n\t\t\t\t},\n\t\t\t};\n\t\t}\n\n\t\tthis.pcsc.on('reader', (reader) => {\n\n\t\t\tthis.logger.debug('new reader detected', reader.name);\n\n\t\t\t// create special object for ARC122U reader with commands specific to this reader\n\t\t\tif (\n\n\t\t\t\t// 'acr122' matches ARC122U\n\t\t\t\treader.name.toLowerCase().indexOf('acr122') !== -1\n\n\t\t\t\t// 'acr125' matches ACR1252U reader because ACR1252U has some common commands with ARC122U\n\t\t\t\t//   ACR1252U product page: https://www.acs.com.hk/en/products/342/acr1252u-usb-nfc-reader-iii-nfc-forum-certified-reader/\n\t\t\t\t//   TODO: in the future, this should be refactored:\n\t\t\t\t//         see discussion in PR#111 https://github.com/pokusew/nfc-pcsc/pull/111\n\t\t\t\t|| reader.name.toLowerCase().indexOf('acr125') !== -1\n\n\t\t\t) {\n\n\t\t\t\tconst device = new ACR122Reader(reader, this.logger);\n\n\t\t\t\tthis.emit('reader', device);\n\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tconst device = new Reader(reader, this.logger);\n\n\t\t\tthis.emit('reader', device);\n\n\t\t});\n\n\t\tthis.pcsc.on('error', (err) => {\n\n\t\t\tthis.logger.error('PCSC error', err.message);\n\n\t\t\tthis.emit('error', err);\n\n\t\t});\n\n\t}\n\n\tget readers() {\n\t\treturn this.pcsc.readers;\n\t}\n\n\tclose() {\n\t\tthis.pcsc.close();\n\t}\n\n}\n\nexport default NFC;\n"
      ]
    },
    "sourceType": "script",
    "mtime": 1662229648499
  },
  "{\"sourceRoot\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc\",\"filename\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/Reader.js\",\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{}},{\"key\":\"proposal-class-properties\",\"visitor\":{\"PrivateName\":{\"enter\":[null]},\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{}}],\"presets\":[]}:7.12.17": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/",
      "caller": {
        "name": "@babel/register"
      },
      "cwd": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc",
      "filename": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/Reader.js",
      "cloneInputAst": true,
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {}
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {}
        },
        {
          "key": "proposal-class-properties",
          "visitor": {
            "PrivateName": {
              "enter": [
                null
              ]
            },
            "ExportDefaultDeclaration": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true,
            "ClassExpression": {
              "enter": [
                null
              ]
            },
            "ClassDeclaration": {
              "enter": [
                null
              ]
            }
          },
          "options": {}
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/Reader.js",
        "plugins": [
          "objectRestSpread",
          "classProperties",
          "classPrivateProperties"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/Reader.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/",
        "sourceFileName": "Reader.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = exports.CONNECT_MODE_CARD = exports.CONNECT_MODE_DIRECT = exports.KEY_TYPE_B = exports.KEY_TYPE_A = exports.TAG_ISO_14443_4 = exports.TAG_ISO_14443_3 = void 0;\n\nvar _events = _interopRequireDefault(require(\"events\"));\n\nvar _errors = require(\"./errors\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nconst TAG_ISO_14443_3 = 'TAG_ISO_14443_3'; // ISO/IEC 14443-3 tags\n\nexports.TAG_ISO_14443_3 = TAG_ISO_14443_3;\nconst TAG_ISO_14443_4 = 'TAG_ISO_14443_4'; // ISO/IEC 14443-4 tags\n\nexports.TAG_ISO_14443_4 = TAG_ISO_14443_4;\nconst KEY_TYPE_A = 0x60;\nexports.KEY_TYPE_A = KEY_TYPE_A;\nconst KEY_TYPE_B = 0x61;\nexports.KEY_TYPE_B = KEY_TYPE_B;\nconst CONNECT_MODE_DIRECT = 'CONNECT_MODE_DIRECT';\nexports.CONNECT_MODE_DIRECT = CONNECT_MODE_DIRECT;\nconst CONNECT_MODE_CARD = 'CONNECT_MODE_CARD';\nexports.CONNECT_MODE_CARD = CONNECT_MODE_CARD;\n\nclass Reader extends _events.default {\n  /**\n   * Reverses a copy of a given buffer\n   * Does NOT mutate the given buffer, returns a reversed COPY\n   * For mutating reverse use native .reverse() method on a buffer instance\n   * @param src {Buffer} a Buffer instance\n   * @returns {Buffer}\n   */\n  static reverseBuffer(src) {\n    const buffer = Buffer.allocUnsafe(src.length);\n\n    for (let i = 0, j = src.length - 1; i <= j; ++i, --j) {\n      buffer[i] = src[j];\n      buffer[j] = src[i];\n    }\n\n    return buffer;\n  }\n\n  static selectStandardByAtr(atr) {\n    // TODO: better detecting card types\n    if (atr[5] && atr[5] === 0x4f) {\n      return TAG_ISO_14443_3;\n    } else {\n      return TAG_ISO_14443_4;\n    }\n  }\n\n  get aid() {\n    return this._aid;\n  }\n\n  set aid(value) {\n    if (typeof value === 'function' || Buffer.isBuffer(value)) {\n      this._aid = value;\n      return;\n    }\n\n    if (typeof value !== 'string') {\n      throw new Error(`AID must be a HEX string or an instance of Buffer or a function.`);\n    }\n\n    this._aid = Buffer.from(value, 'hex');\n  }\n\n  get name() {\n    return this.reader.name;\n  }\n\n  constructor(reader, logger) {\n    super();\n\n    _defineProperty(this, \"reader\", null);\n\n    _defineProperty(this, \"logger\", null);\n\n    _defineProperty(this, \"connection\", null);\n\n    _defineProperty(this, \"card\", null);\n\n    _defineProperty(this, \"autoProcessing\", true);\n\n    _defineProperty(this, \"_aid\", null);\n\n    _defineProperty(this, \"keyStorage\", {\n      '0': null,\n      '1': null\n    });\n\n    _defineProperty(this, \"pendingLoadAuthenticationKey\", {});\n\n    this.reader = reader;\n\n    if (logger) {\n      this.logger = logger;\n    } else {\n      this.logger = {\n        log: function () {},\n        debug: function () {},\n        info: function () {},\n        warn: function () {},\n        error: function () {}\n      };\n    }\n\n    this.reader.on('error', err => {\n      this.logger.error(err);\n      this.emit('error', err);\n    });\n    this.reader.on('status', async status => {\n      this.logger.debug('status', status); // check what has changed\n\n      const changes = this.reader.state ^ status.state;\n      this.logger.debug('changes', changes);\n\n      if (changes) {\n        if (changes & this.reader.SCARD_STATE_EMPTY && status.state & this.reader.SCARD_STATE_EMPTY) {\n          this.logger.debug('card removed');\n\n          if (this.card) {\n            this.emit('card.off', { ...this.card\n            });\n          }\n\n          try {\n            this.card = null;\n\n            if (this.connection) {\n              await this.disconnect();\n            }\n          } catch (err) {\n            this.emit(err);\n          }\n        } else if (changes & this.reader.SCARD_STATE_PRESENT && status.state & this.reader.SCARD_STATE_PRESENT) {\n          const atr = status.atr;\n          this.logger.debug('card inserted', atr);\n          this.card = {};\n\n          if (atr) {\n            this.card.atr = atr;\n            this.card.standard = Reader.selectStandardByAtr(atr);\n            this.card.type = this.card.standard;\n          }\n\n          try {\n            await this.connect();\n\n            if (!this.autoProcessing) {\n              this.emit('card', { ...this.card\n              });\n              return;\n            }\n\n            this.handleTag();\n          } catch (err) {\n            this.emit(err);\n          }\n        }\n      }\n    });\n    this.reader.on('end', () => {\n      this.logger.debug('reader removed');\n      this.emit('end');\n    });\n  }\n\n  connect(mode = CONNECT_MODE_CARD) {\n    const modes = {\n      [CONNECT_MODE_DIRECT]: this.reader.SCARD_SHARE_DIRECT,\n      [CONNECT_MODE_CARD]: this.reader.SCARD_SHARE_SHARED\n    };\n\n    if (!modes[mode]) {\n      throw new _errors.ConnectError('invalid_mode', 'Invalid mode');\n    }\n\n    this.logger.debug('trying to connect', mode, modes[mode]);\n    return new Promise((resolve, reject) => {\n      // connect card\n      this.reader.connect({\n        share_mode: modes[mode] //protocol: this.reader.SCARD_PROTOCOL_UNDEFINED\n\n      }, (err, protocol) => {\n        if (err) {\n          const error = new _errors.ConnectError(_errors.FAILURE, 'An error occurred while connecting.', err);\n          this.logger.error(error);\n          return reject(error);\n        }\n\n        this.connection = {\n          type: modes[mode],\n          protocol: protocol\n        };\n        this.logger.debug('connected', this.connection);\n        return resolve(this.connection);\n      });\n    });\n  }\n\n  disconnect() {\n    if (!this.connection) {\n      throw new _errors.DisconnectError('not_connected', 'Reader in not connected. No need for disconnecting.');\n    }\n\n    this.logger.debug('trying to disconnect', this.connection);\n    return new Promise((resolve, reject) => {\n      // disconnect removed\n      this.reader.disconnect(this.reader.SCARD_LEAVE_CARD, err => {\n        if (err) {\n          const error = new _errors.DisconnectError(_errors.FAILURE, 'An error occurred while disconnecting.', err);\n          this.logger.error(error);\n          return reject(error);\n        }\n\n        this.connection = null;\n        this.logger.debug('disconnected');\n        return resolve(true);\n      });\n    });\n  }\n\n  transmit(data, responseMaxLength) {\n    if (!this.card || !this.connection) {\n      throw new _errors.TransmitError(_errors.CARD_NOT_CONNECTED, 'No card or connection available.');\n    }\n\n    return new Promise((resolve, reject) => {\n      this.logger.debug('transmitting', data, responseMaxLength);\n      this.reader.transmit(data, responseMaxLength, this.connection.protocol, (err, response) => {\n        if (err) {\n          const error = new _errors.TransmitError(_errors.FAILURE, 'An error occurred while transmitting.', err);\n          return reject(error);\n        }\n\n        this.logger.debug('transmit response received', response, response && response.length);\n        return resolve(response);\n      });\n    });\n  }\n\n  control(data, responseMaxLength) {\n    if (!this.connection) {\n      throw new _errors.ControlError('not_connected', 'No connection available.');\n    }\n\n    return new Promise((resolve, reject) => {\n      this.logger.debug('transmitting control', data, responseMaxLength);\n      this.reader.control(data, this.reader.IOCTL_CCID_ESCAPE, responseMaxLength, (err, response) => {\n        if (err) {\n          const error = new _errors.ControlError(_errors.FAILURE, 'An error occurred while transmitting control.', err);\n          return reject(error);\n        }\n\n        this.logger.debug('control response received', response, response && response.length);\n        return resolve(response);\n      });\n    });\n  }\n\n  async loadAuthenticationKey(keyNumber, key) {\n    if (!(keyNumber === 0 || keyNumber === 1)) {\n      throw new _errors.LoadAuthenticationKeyError('invalid_key_number');\n    }\n\n    if (!Buffer.isBuffer(key) && !Array.isArray(key)) {\n      if (typeof key !== 'string') {\n        throw new _errors.LoadAuthenticationKeyError('invalid_key', 'Key must an instance of Buffer or an array of bytes or a string.');\n      }\n\n      key = Buffer.from(key, 'hex');\n    }\n\n    if (key.length !== 6) {\n      throw new _errors.LoadAuthenticationKeyError('invalid_key', 'Key length must be 6 bytes.');\n    } // CMD: Load Authentication Keys\n\n\n    const packet = Buffer.from([0xff, // Class\n    0x82, // INS\n    0x00, // P1: Key Structure (0x00 = Key is loaded into the reader volatile memory.)\n    keyNumber, // P2: Key Number (00h ~ 01h = Key Location. The keys will disappear once the reader is disconnected from the PC)\n    key.length, // Lc: Length of the key (6)\n    ...key // Data In: Key (6 bytes)\n    ]);\n    let response = null;\n\n    try {\n      response = await this.transmit(packet, 2);\n    } catch (err) {\n      throw new _errors.LoadAuthenticationKeyError(null, null, err);\n    }\n\n    const statusCode = response.readUInt16BE(0);\n\n    if (statusCode !== 0x9000) {\n      throw new _errors.LoadAuthenticationKeyError(_errors.OPERATION_FAILED, `Load authentication key operation failed: Status code: ${statusCode}`);\n    }\n\n    this.keyStorage[keyNumber] = key;\n    return keyNumber;\n  } // for PC/SC V2.01 use obsolete = true\n  // for PC/SC V2.07 use obsolete = false [default]\n\n\n  async authenticate(blockNumber, keyType, key, obsolete = false) {\n    let keyNumber = Object.keys(this.keyStorage).find(n => this.keyStorage[n] === key); // key is not in the storage\n\n    if (!keyNumber) {\n      // If there isn't already an authentication process happening for this key, start it\n      if (!this.pendingLoadAuthenticationKey[key]) {\n        // set key number to first\n        keyNumber = Object.keys(this.keyStorage)[0]; // if this number is not free\n\n        if (this.keyStorage[keyNumber] !== null) {\n          // try to find any free number\n          const freeNumber = Object.keys(this.keyStorage).find(n => this.keyStorage[n] === null); // if we find, we use it, otherwise the first will be used and rewritten\n\n          if (freeNumber) {\n            keyNumber = freeNumber;\n          }\n        } // Store the authentication promise in case other blocks are in process of authentication\n\n\n        this.pendingLoadAuthenticationKey[key] = this.loadAuthenticationKey(parseInt(keyNumber), key);\n      }\n\n      try {\n        keyNumber = await this.pendingLoadAuthenticationKey[key];\n      } catch (err) {\n        throw new _errors.AuthenticationError('unable_to_load_key', 'Could not load authentication key into reader.', err);\n      } finally {\n        // remove the loadAuthenticationKey Promise from pendingLoadAuthenticationKey\n        // as it is already resolved or rejected at this point\n        delete this.pendingLoadAuthenticationKey[key];\n      }\n    }\n\n    const packet = !obsolete ? // CMD: Authentication\n    Buffer.from([0xff, // Class\n    0x86, // INS\n    0x00, // P1\n    0x00, // P2\n    0x05, // Lc\n    // Data In: Authenticate Data Bytes (5 bytes)\n    0x01, // Byte 1: Version\n    0x00, // Byte 2\n    blockNumber, // Byte 3: Block Number\n    keyType, // Byte 4: Key Type\n    keyNumber // Byte 5: Key Number\n    ]) : // CMD: Authentication (obsolete)\n    Buffer.from([0xff, // Class\n    0x88, // INS\n    0x00, // P1\n    blockNumber, // P2: Block Number\n    keyType, // P3: Key Type\n    keyNumber // Data In: Key Number\n    ]);\n    let response = null;\n\n    try {\n      response = await this.transmit(packet, 2);\n    } catch (err) {\n      throw new _errors.AuthenticationError(null, null, err);\n    }\n\n    const statusCode = response.readUInt16BE(0);\n\n    if (statusCode !== 0x9000) {\n      this.logger.error('[authentication operation failed][request packet]', packet);\n      throw new _errors.AuthenticationError(_errors.OPERATION_FAILED, `Authentication operation failed: Status code: 0x${statusCode.toString(16)}`);\n    }\n\n    return true;\n  }\n\n  async read(blockNumber, length, blockSize = 4, packetSize = 16, readClass = 0xff) {\n    if (!this.card) {\n      throw new _errors.ReadError(_errors.CARD_NOT_CONNECTED);\n    }\n\n    this.logger.debug('reading data from card', this.card);\n\n    if (length > packetSize) {\n      const p = Math.ceil(length / packetSize);\n      const commands = [];\n\n      for (let i = 0; i < p; i++) {\n        const block = blockNumber + i * packetSize / blockSize;\n        const size = (i + 1) * packetSize < length ? packetSize : length - i * packetSize; // console.log(i, block, size);\n\n        commands.push(this.read(block, size, blockSize, packetSize, readClass));\n      }\n\n      return Promise.all(commands).then(values => {\n        // console.log(values);\n        return Buffer.concat(values, length);\n      });\n    } // APDU CMD: Read Binary Blocks\n\n\n    const packet = Buffer.from([readClass, // Class\n    0xb0, // Ins\n    blockNumber >> 8 & 0xFF, // P1\n    blockNumber & 0xFF, // P2: Block Number\n    length // Le: Number of Bytes to Read (Maximum 16 bytes)\n    ]);\n    let response = null;\n\n    try {\n      response = await this.transmit(packet, length + 2);\n    } catch (err) {\n      throw new _errors.ReadError(null, null, err);\n    }\n\n    if (response.length < 2) {\n      throw new _errors.ReadError(_errors.OPERATION_FAILED, `Read operation failed: Invalid response length ${response.length}. Expected minimal length is 2 bytes.`);\n    }\n\n    const statusCode = response.slice(-2).readUInt16BE(0);\n\n    if (statusCode !== 0x9000) {\n      throw new _errors.ReadError(_errors.OPERATION_FAILED, `Read operation failed: Status code: 0x${statusCode.toString(16)}`);\n    }\n\n    const data = response.slice(0, -2);\n    this.logger.debug('data', data);\n    return data;\n  }\n\n  async write(blockNumber, data, blockSize = 4) {\n    if (!this.card) {\n      throw new _errors.WriteError(_errors.CARD_NOT_CONNECTED);\n    }\n\n    this.logger.debug('writing data to card', this.card);\n\n    if (data.length < blockSize || data.length % blockSize !== 0) {\n      throw new _errors.WriteError('invalid_data_length', 'Invalid data length. You can only update the entire data block(s).');\n    }\n\n    if (data.length > blockSize) {\n      const p = data.length / blockSize;\n      const commands = [];\n\n      for (let i = 0; i < p; i++) {\n        const block = blockNumber + i;\n        const start = i * blockSize;\n        const end = (i + 1) * blockSize;\n        const part = data.slice(start, end); // console.log(i, block, start, end, part);\n\n        commands.push(this.write(block, part, blockSize));\n      }\n\n      return Promise.all(commands).then(values => {\n        // console.log(values);\n        return values;\n      });\n    } // APDU CMD: Update Binary Block\n\n\n    const packetHeader = Buffer.from([0xff, // Class\n    0xd6, // Ins\n    0x00, // P1\n    blockNumber, // P2: Block Number\n    blockSize // Le: Number of Bytes to Update\n    ]);\n    const packet = Buffer.concat([packetHeader, data]);\n    let response = null;\n\n    try {\n      response = await this.transmit(packet, 2);\n    } catch (err) {\n      throw new _errors.WriteError(null, null, err);\n    }\n\n    if (response.length < 2) {\n      throw new _errors.WriteError(_errors.OPERATION_FAILED, `Write operation failed: Invalid response length ${response.length}. Expected minimal length is 2 bytes.`);\n    }\n\n    const statusCode = response.slice(-2).readUInt16BE(0);\n\n    if (statusCode !== 0x9000) {\n      throw new _errors.WriteError(_errors.OPERATION_FAILED, `Write operation failed: Status code: 0x${statusCode.toString(16)}`);\n    }\n\n    return true;\n  }\n\n  handleTag() {\n    if (!this.card) {\n      return false;\n    }\n\n    this.logger.debug('handling tag', this.card);\n\n    switch (this.card.standard) {\n      case TAG_ISO_14443_3:\n        return this.handle_Iso_14443_3_Tag();\n\n      case TAG_ISO_14443_4:\n        return this.handle_Iso_14443_4_Tag();\n\n      default:\n        return this.handle_Iso_14443_3_Tag();\n    }\n  } // TODO: improve error handling and debugging\n\n\n  async handle_Iso_14443_3_Tag() {\n    if (!this.card || !this.connection) {\n      return false;\n    }\n\n    this.logger.debug('processing ISO 14443-3 tag', this.card); // APDU CMD: Get Data\n\n    const packet = Buffer.from([0xff, // Class\n    0xca, // INS\n    0x00, // P1: Get current card UID\n    0x00, // P2\n    0x00 // Le: Full Length of UID\n    ]);\n\n    try {\n      const response = await this.transmit(packet, 12);\n\n      if (response.length < 2) {\n        const error = new _errors.GetUIDError('invalid_response', `Invalid response length ${response.length}. Expected minimal length is 2 bytes.`);\n        this.emit('error', error);\n        return;\n      } // last 2 bytes are the status code\n\n\n      const statusCode = response.slice(-2).readUInt16BE(0); // an error occurred\n\n      if (statusCode !== 0x9000) {\n        const error = new _errors.GetUIDError(_errors.OPERATION_FAILED, 'Could not get card UID.');\n        this.emit('error', error);\n        return;\n      } // strip out the status code (the rest is UID)\n\n\n      const uid = response.slice(0, -2).toString('hex'); // const uidReverse = Reader.reverseBuffer(response.slice(0, -2)).toString('hex');\n\n      this.card.uid = uid;\n      this.emit('card', { ...this.card\n      });\n    } catch (err) {\n      const error = new _errors.GetUIDError(null, null, err);\n      this.emit('error', error);\n    }\n  } // TODO: improve error handling and debugging\n\n\n  async handle_Iso_14443_4_Tag() {\n    if (!this.card || !this.connection) {\n      return false;\n    }\n\n    this.logger.debug('processing ISO 14443-4 tag', this.card);\n\n    if (!this.aid) {\n      this.emit('error', new Error('Cannot process ISO 14443-4 tag because AID was not set.'));\n      return;\n    }\n\n    const aid = typeof this.aid === 'function' ? this.aid(this.card) : this.aid;\n\n    if (!Buffer.isBuffer(aid)) {\n      this.emit('error', new Error('AID must be an instance of Buffer.'));\n      return;\n    } // APDU CMD: SELECT FILE\n    // see http://cardwerk.com/smart-card-standard-iso7816-4-section-6-basic-interindustry-commands/#chap6_11_3\n\n\n    const packet = Buffer.from([0x00, // Class\n    0xa4, // INS\n    0x04, // P1\n    0x00, // P2\n    aid.length, // Lc\n    ...aid, // AID\n    0x00 // Le\n    ]);\n\n    try {\n      const response = await this.transmit(packet, 40);\n\n      if (response.length === 2 && response.readUInt16BE(0) === 0x6a82) {\n        const err = new Error(`Not found response. Tag not compatible with AID ${aid.toString('hex').toUpperCase()}.`);\n        this.emit('error', err);\n        return;\n      }\n\n      if (response.length < 2) {\n        const err = new Error(`Invalid response length ${response.length}. Expected minimal length is 2 bytes.`);\n        this.emit('error', err);\n        return;\n      } // another possibility const statusCode = parseInt(response.slice(-2).toString('hex'), 16)\n\n\n      const statusCode = response.slice(-2).readUInt16BE(0); // an error occurred\n\n      if (statusCode !== 0x9000) {\n        const err = new Error(`Response status error.`);\n        this.emit('error', err);\n        return;\n      } // strip out the status code\n\n\n      const data = response.slice(0, -2);\n      this.logger.debug('Data cropped', data);\n      this.emit('card', { ...this.card,\n        data: data\n      });\n    } catch (err) {\n      const error = new _errors.GetUIDError(null, null, err);\n      this.emit('error', error);\n    }\n  }\n\n  close() {\n    this.reader.close();\n  }\n\n  toString() {\n    return this.name;\n  }\n\n}\n\nvar _default = Reader;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlJlYWRlci5qcyJdLCJuYW1lcyI6WyJUQUdfSVNPXzE0NDQzXzMiLCJUQUdfSVNPXzE0NDQzXzQiLCJLRVlfVFlQRV9BIiwiS0VZX1RZUEVfQiIsIkNPTk5FQ1RfTU9ERV9ESVJFQ1QiLCJDT05ORUNUX01PREVfQ0FSRCIsIlJlYWRlciIsIkV2ZW50RW1pdHRlciIsInJldmVyc2VCdWZmZXIiLCJzcmMiLCJidWZmZXIiLCJCdWZmZXIiLCJhbGxvY1Vuc2FmZSIsImxlbmd0aCIsImkiLCJqIiwic2VsZWN0U3RhbmRhcmRCeUF0ciIsImF0ciIsImFpZCIsIl9haWQiLCJ2YWx1ZSIsImlzQnVmZmVyIiwiRXJyb3IiLCJmcm9tIiwibmFtZSIsInJlYWRlciIsImNvbnN0cnVjdG9yIiwibG9nZ2VyIiwibG9nIiwiZGVidWciLCJpbmZvIiwid2FybiIsImVycm9yIiwib24iLCJlcnIiLCJlbWl0Iiwic3RhdHVzIiwiY2hhbmdlcyIsInN0YXRlIiwiU0NBUkRfU1RBVEVfRU1QVFkiLCJjYXJkIiwiY29ubmVjdGlvbiIsImRpc2Nvbm5lY3QiLCJTQ0FSRF9TVEFURV9QUkVTRU5UIiwic3RhbmRhcmQiLCJ0eXBlIiwiY29ubmVjdCIsImF1dG9Qcm9jZXNzaW5nIiwiaGFuZGxlVGFnIiwibW9kZSIsIm1vZGVzIiwiU0NBUkRfU0hBUkVfRElSRUNUIiwiU0NBUkRfU0hBUkVfU0hBUkVEIiwiQ29ubmVjdEVycm9yIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJzaGFyZV9tb2RlIiwicHJvdG9jb2wiLCJGQUlMVVJFIiwiRGlzY29ubmVjdEVycm9yIiwiU0NBUkRfTEVBVkVfQ0FSRCIsInRyYW5zbWl0IiwiZGF0YSIsInJlc3BvbnNlTWF4TGVuZ3RoIiwiVHJhbnNtaXRFcnJvciIsIkNBUkRfTk9UX0NPTk5FQ1RFRCIsInJlc3BvbnNlIiwiY29udHJvbCIsIkNvbnRyb2xFcnJvciIsIklPQ1RMX0NDSURfRVNDQVBFIiwibG9hZEF1dGhlbnRpY2F0aW9uS2V5Iiwia2V5TnVtYmVyIiwia2V5IiwiTG9hZEF1dGhlbnRpY2F0aW9uS2V5RXJyb3IiLCJBcnJheSIsImlzQXJyYXkiLCJwYWNrZXQiLCJzdGF0dXNDb2RlIiwicmVhZFVJbnQxNkJFIiwiT1BFUkFUSU9OX0ZBSUxFRCIsImtleVN0b3JhZ2UiLCJhdXRoZW50aWNhdGUiLCJibG9ja051bWJlciIsImtleVR5cGUiLCJvYnNvbGV0ZSIsIk9iamVjdCIsImtleXMiLCJmaW5kIiwibiIsInBlbmRpbmdMb2FkQXV0aGVudGljYXRpb25LZXkiLCJmcmVlTnVtYmVyIiwicGFyc2VJbnQiLCJBdXRoZW50aWNhdGlvbkVycm9yIiwidG9TdHJpbmciLCJyZWFkIiwiYmxvY2tTaXplIiwicGFja2V0U2l6ZSIsInJlYWRDbGFzcyIsIlJlYWRFcnJvciIsInAiLCJNYXRoIiwiY2VpbCIsImNvbW1hbmRzIiwiYmxvY2siLCJzaXplIiwicHVzaCIsImFsbCIsInRoZW4iLCJ2YWx1ZXMiLCJjb25jYXQiLCJzbGljZSIsIndyaXRlIiwiV3JpdGVFcnJvciIsInN0YXJ0IiwiZW5kIiwicGFydCIsInBhY2tldEhlYWRlciIsImhhbmRsZV9Jc29fMTQ0NDNfM19UYWciLCJoYW5kbGVfSXNvXzE0NDQzXzRfVGFnIiwiR2V0VUlERXJyb3IiLCJ1aWQiLCJ0b1VwcGVyQ2FzZSIsImNsb3NlIl0sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7OztBQUVBOztBQUNBOzs7Ozs7QUFpQk8sTUFBTUEsZUFBZSxHQUFHLGlCQUF4QixDLENBQTJDOzs7QUFDM0MsTUFBTUMsZUFBZSxHQUFHLGlCQUF4QixDLENBQTJDOzs7QUFFM0MsTUFBTUMsVUFBVSxHQUFHLElBQW5COztBQUNBLE1BQU1DLFVBQVUsR0FBRyxJQUFuQjs7QUFFQSxNQUFNQyxtQkFBbUIsR0FBRyxxQkFBNUI7O0FBQ0EsTUFBTUMsaUJBQWlCLEdBQUcsbUJBQTFCOzs7QUFHUCxNQUFNQyxNQUFOLFNBQXFCQyxlQUFyQixDQUFrQztBQWtCakM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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QUFZRSxLQUFaLENBQWtCLGNBQWxCLEVBQWtDa0MsSUFBbEM7QUFFQSxXQUFLNUIsSUFBTCxDQUFVLE1BQVYsRUFBa0IsRUFDakIsR0FBRyxLQUFLSyxJQURTO0FBRWpCdUIsUUFBQUEsSUFBSSxFQUFFQTtBQUZXLE9BQWxCO0FBS0EsS0ExQ0QsQ0EwQ0UsT0FBTzdCLEdBQVAsRUFBWTtBQUViLFlBQU1GLEtBQUssR0FBRyxJQUFJd0YsbUJBQUosQ0FBZ0IsSUFBaEIsRUFBc0IsSUFBdEIsRUFBNEJ0RixHQUE1QixDQUFkO0FBRUEsV0FBS0MsSUFBTCxDQUFVLE9BQVYsRUFBbUJILEtBQW5CO0FBRUE7QUFFRDs7QUFFRDJGLEVBQUFBLEtBQUssR0FBRztBQUNQLFNBQUtsRyxNQUFMLENBQVlrRyxLQUFaO0FBQ0E7O0FBRUQ3QixFQUFBQSxRQUFRLEdBQUc7QUFDVixXQUFPLEtBQUt0RSxJQUFaO0FBQ0E7O0FBcHhCZ0M7O2VBd3hCbkJsQixNIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9oYXJyeWhvdy9Eb2N1bWVudHMvMjAyMi9QUk9KRUNUX01PQ0FfQVJUL05GQy9uZmMtcGNzYy9zcmMvIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbmltcG9ydCBFdmVudEVtaXR0ZXIgZnJvbSAnZXZlbnRzJztcbmltcG9ydCB7XG5cdENvbm5lY3RFcnJvcixcblx0RGlzY29ubmVjdEVycm9yLFxuXHRUcmFuc21pdEVycm9yLFxuXHRDb250cm9sRXJyb3IsXG5cdEF1dGhlbnRpY2F0aW9uRXJyb3IsXG5cdExvYWRBdXRoZW50aWNhdGlvbktleUVycm9yLFxuXHRSZWFkRXJyb3IsXG5cdFdyaXRlRXJyb3IsXG5cdEdldFVJREVycm9yLFxuXHRDQVJEX05PVF9DT05ORUNURUQsXG5cdE9QRVJBVElPTl9GQUlMRUQsXG5cdFVOS05PV05fRVJST1IsXG5cdEZBSUxVUkUsXG59IGZyb20gJy4vZXJyb3JzJztcblxuXG5leHBvcnQgY29uc3QgVEFHX0lTT18xNDQ0M18zID0gJ1RBR19JU09fMTQ0NDNfMyc7IC8vIElTTy9JRUMgMTQ0NDMtMyB0YWdzXG5leHBvcnQgY29uc3QgVEFHX0lTT18xNDQ0M180ID0gJ1RBR19JU09fMTQ0NDNfNCc7IC8vIElTTy9JRUMgMTQ0NDMtNCB0YWdzXG5cbmV4cG9ydCBjb25zdCBLRVlfVFlQRV9BID0gMHg2MDtcbmV4cG9ydCBjb25zdCBLRVlfVFlQRV9CID0gMHg2MTtcblxuZXhwb3J0IGNvbnN0IENPTk5FQ1RfTU9ERV9ESVJFQ1QgPSAnQ09OTkVDVF9NT0RFX0RJUkVDVCc7XG5leHBvcnQgY29uc3QgQ09OTkVDVF9NT0RFX0NBUkQgPSAnQ09OTkVDVF9NT0RFX0NBUkQnO1xuXG5cbmNsYXNzIFJlYWRlciBleHRlbmRzIEV2ZW50RW1pdHRlciB7XG5cblx0cmVhZGVyID0gbnVsbDtcblx0bG9nZ2VyID0gbnVsbDtcblxuXHRjb25uZWN0aW9uID0gbnVsbDtcblx0Y2FyZCA9IG51bGw7XG5cblx0YXV0b1Byb2Nlc3NpbmcgPSB0cnVlO1xuXHRfYWlkID0gbnVsbDtcblxuXHRrZXlTdG9yYWdlID0ge1xuXHRcdCcwJzogbnVsbCxcblx0XHQnMSc6IG51bGwsXG5cdH07XG5cblx0cGVuZGluZ0xvYWRBdXRoZW50aWNhdGlvbktleSA9IHt9O1xuXG5cdC8qKlxuXHQgKiBSZXZlcnNlcyBhIGNvcHkgb2YgYSBnaXZlbiBidWZmZXJcblx0ICogRG9lcyBOT1QgbXV0YXRlIHRoZSBnaXZlbiBidWZmZXIsIHJldHVybnMgYSByZXZlcnNlZCBDT1BZXG5cdCAqIEZvciBtdXRhdGluZyByZXZlcnNlIHVzZSBuYXRpdmUgLnJldmVyc2UoKSBtZXRob2Qgb24gYSBidWZmZXIgaW5zdGFuY2Vcblx0ICogQHBhcmFtIHNyYyB7QnVmZmVyfSBhIEJ1ZmZlciBpbnN0YW5jZVxuXHQgKiBAcmV0dXJucyB7QnVmZmVyfVxuXHQgKi9cblx0c3RhdGljIHJldmVyc2VCdWZmZXIoc3JjKSB7XG5cblx0XHRjb25zdCBidWZmZXIgPSBCdWZmZXIuYWxsb2NVbnNhZmUoc3JjLmxlbmd0aCk7XG5cblx0XHRmb3IgKGxldCBpID0gMCwgaiA9IHNyYy5sZW5ndGggLSAxOyBpIDw9IGo7ICsraSwgLS1qKSB7XG5cdFx0XHRidWZmZXJbaV0gPSBzcmNbal07XG5cdFx0XHRidWZmZXJbal0gPSBzcmNbaV07XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGJ1ZmZlcjtcblxuXHR9XG5cblx0c3RhdGljIHNlbGVjdFN0YW5kYXJkQnlBdHIoYXRyKSB7XG5cblx0XHQvLyBUT0RPOiBiZXR0ZXIgZGV0ZWN0aW5nIGNhcmQgdHlwZXNcblx0XHRpZiAoYXRyWzVdICYmIGF0cls1XSA9PT0gMHg0Zikge1xuXHRcdFx0cmV0dXJuIFRBR19JU09fMTQ0NDNfMztcblx0XHR9XG5cdFx0ZWxzZSB7XG5cdFx0XHRyZXR1cm4gVEFHX0lTT18xNDQ0M180O1xuXHRcdH1cblxuXHR9XG5cblx0Z2V0IGFpZCgpIHtcblx0XHRyZXR1cm4gdGhpcy5fYWlkO1xuXHR9XG5cblx0c2V0IGFpZCh2YWx1ZSkge1xuXG5cdFx0aWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ2Z1bmN0aW9uJyB8fCBCdWZmZXIuaXNCdWZmZXIodmFsdWUpKSB7XG5cdFx0XHR0aGlzLl9haWQgPSB2YWx1ZTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRpZiAodHlwZW9mIHZhbHVlICE9PSAnc3RyaW5nJykge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBBSUQgbXVzdCBiZSBhIEhFWCBzdHJpbmcgb3IgYW4gaW5zdGFuY2Ugb2YgQnVmZmVyIG9yIGEgZnVuY3Rpb24uYCk7XG5cdFx0fVxuXG5cdFx0dGhpcy5fYWlkID0gQnVmZmVyLmZyb20odmFsdWUsICdoZXgnKTtcblxuXHR9XG5cblx0Z2V0IG5hbWUoKSB7XG5cdFx0cmV0dXJuIHRoaXMucmVhZGVyLm5hbWU7XG5cdH1cblxuXHRjb25zdHJ1Y3RvcihyZWFkZXIsIGxvZ2dlcikge1xuXG5cdFx0c3VwZXIoKTtcblxuXHRcdHRoaXMucmVhZGVyID0gcmVhZGVyO1xuXG5cdFx0aWYgKGxvZ2dlcikge1xuXHRcdFx0dGhpcy5sb2dnZXIgPSBsb2dnZXI7XG5cdFx0fVxuXHRcdGVsc2Uge1xuXHRcdFx0dGhpcy5sb2dnZXIgPSB7XG5cdFx0XHRcdGxvZzogZnVuY3Rpb24gKCkge1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRkZWJ1ZzogZnVuY3Rpb24gKCkge1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRpbmZvOiBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdH0sXG5cdFx0XHRcdHdhcm46IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0fSxcblx0XHRcdFx0ZXJyb3I6IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0fSxcblx0XHRcdH07XG5cdFx0fVxuXG5cdFx0dGhpcy5yZWFkZXIub24oJ2Vycm9yJywgKGVycikgPT4ge1xuXG5cdFx0XHR0aGlzLmxvZ2dlci5lcnJvcihlcnIpO1xuXG5cdFx0XHR0aGlzLmVtaXQoJ2Vycm9yJywgZXJyKTtcblxuXHRcdH0pO1xuXG5cdFx0dGhpcy5yZWFkZXIub24oJ3N0YXR1cycsIGFzeW5jIHN0YXR1cyA9PiB7XG5cblx0XHRcdHRoaXMubG9nZ2VyLmRlYnVnKCdzdGF0dXMnLCBzdGF0dXMpO1xuXG5cdFx0XHQvLyBjaGVjayB3aGF0IGhhcyBjaGFuZ2VkXG5cdFx0XHRjb25zdCBjaGFuZ2VzID0gdGhpcy5yZWFkZXIuc3RhdGUgXiBzdGF0dXMuc3RhdGU7XG5cblx0XHRcdHRoaXMubG9nZ2VyLmRlYnVnKCdjaGFuZ2VzJywgY2hhbmdlcyk7XG5cblx0XHRcdGlmIChjaGFuZ2VzKSB7XG5cblx0XHRcdFx0aWYgKChjaGFuZ2VzICYgdGhpcy5yZWFkZXIuU0NBUkRfU1RBVEVfRU1QVFkpICYmIChzdGF0dXMuc3RhdGUgJiB0aGlzLnJlYWRlci5TQ0FSRF9TVEFURV9FTVBUWSkpIHtcblxuXHRcdFx0XHRcdHRoaXMubG9nZ2VyLmRlYnVnKCdjYXJkIHJlbW92ZWQnKTtcblxuXHRcdFx0XHRcdGlmICh0aGlzLmNhcmQpIHtcblx0XHRcdFx0XHRcdHRoaXMuZW1pdCgnY2FyZC5vZmYnLCB7IC4uLnRoaXMuY2FyZCB9KTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHR0cnkge1xuXG5cdFx0XHRcdFx0XHR0aGlzLmNhcmQgPSBudWxsO1xuXHRcdFx0XHRcdFx0aWYgKHRoaXMuY29ubmVjdGlvbikge1xuXHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLmRpc2Nvbm5lY3QoKTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdH0gY2F0Y2ggKGVycikge1xuXG5cdFx0XHRcdFx0XHR0aGlzLmVtaXQoZXJyKTtcblxuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHR9XG5cdFx0XHRcdGVsc2UgaWYgKChjaGFuZ2VzICYgdGhpcy5yZWFkZXIuU0NBUkRfU1RBVEVfUFJFU0VOVCkgJiYgKHN0YXR1cy5zdGF0ZSAmIHRoaXMucmVhZGVyLlNDQVJEX1NUQVRFX1BSRVNFTlQpKSB7XG5cblx0XHRcdFx0XHRjb25zdCBhdHIgPSBzdGF0dXMuYXRyO1xuXG5cdFx0XHRcdFx0dGhpcy5sb2dnZXIuZGVidWcoJ2NhcmQgaW5zZXJ0ZWQnLCBhdHIpO1xuXG5cdFx0XHRcdFx0dGhpcy5jYXJkID0ge307XG5cblx0XHRcdFx0XHRpZiAoYXRyKSB7XG5cdFx0XHRcdFx0XHR0aGlzLmNhcmQuYXRyID0gYXRyO1xuXHRcdFx0XHRcdFx0dGhpcy5jYXJkLnN0YW5kYXJkID0gUmVhZGVyLnNlbGVjdFN0YW5kYXJkQnlBdHIoYXRyKTtcblx0XHRcdFx0XHRcdHRoaXMuY2FyZC50eXBlID0gdGhpcy5jYXJkLnN0YW5kYXJkO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHRyeSB7XG5cblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMuY29ubmVjdCgpO1xuXG5cdFx0XHRcdFx0XHRpZiAoIXRoaXMuYXV0b1Byb2Nlc3NpbmcpIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5lbWl0KCdjYXJkJywgeyAuLi50aGlzLmNhcmQgfSk7XG5cdFx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0dGhpcy5oYW5kbGVUYWcoKTtcblxuXHRcdFx0XHRcdH0gY2F0Y2ggKGVycikge1xuXG5cdFx0XHRcdFx0XHR0aGlzLmVtaXQoZXJyKTtcblxuXHRcdFx0XHRcdH1cblxuXG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHRoaXMucmVhZGVyLm9uKCdlbmQnLCAoKSA9PiB7XG5cblx0XHRcdHRoaXMubG9nZ2VyLmRlYnVnKCdyZWFkZXIgcmVtb3ZlZCcpO1xuXG5cdFx0XHR0aGlzLmVtaXQoJ2VuZCcpO1xuXG5cdFx0fSk7XG5cblx0fVxuXG5cdGNvbm5lY3QobW9kZSA9IENPTk5FQ1RfTU9ERV9DQVJEKSB7XG5cblx0XHRjb25zdCBtb2RlcyA9IHtcblx0XHRcdFtDT05ORUNUX01PREVfRElSRUNUXTogdGhpcy5yZWFkZXIuU0NBUkRfU0hBUkVfRElSRUNULFxuXHRcdFx0W0NPTk5FQ1RfTU9ERV9DQVJEXTogdGhpcy5yZWFkZXIuU0NBUkRfU0hBUkVfU0hBUkVELFxuXHRcdH07XG5cblx0XHRpZiAoIW1vZGVzW21vZGVdKSB7XG5cdFx0XHR0aHJvdyBuZXcgQ29ubmVjdEVycm9yKCdpbnZhbGlkX21vZGUnLCAnSW52YWxpZCBtb2RlJylcblx0XHR9XG5cblx0XHR0aGlzLmxvZ2dlci5kZWJ1ZygndHJ5aW5nIHRvIGNvbm5lY3QnLCBtb2RlLCBtb2Rlc1ttb2RlXSk7XG5cblx0XHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuXG5cdFx0XHQvLyBjb25uZWN0IGNhcmRcblx0XHRcdHRoaXMucmVhZGVyLmNvbm5lY3Qoe1xuXHRcdFx0XHRzaGFyZV9tb2RlOiBtb2Rlc1ttb2RlXSxcblx0XHRcdFx0Ly9wcm90b2NvbDogdGhpcy5yZWFkZXIuU0NBUkRfUFJPVE9DT0xfVU5ERUZJTkVEXG5cdFx0XHR9LCAoZXJyLCBwcm90b2NvbCkgPT4ge1xuXG5cdFx0XHRcdGlmIChlcnIpIHtcblx0XHRcdFx0XHRjb25zdCBlcnJvciA9IG5ldyBDb25uZWN0RXJyb3IoRkFJTFVSRSwgJ0FuIGVycm9yIG9jY3VycmVkIHdoaWxlIGNvbm5lY3RpbmcuJywgZXJyKTtcblx0XHRcdFx0XHR0aGlzLmxvZ2dlci5lcnJvcihlcnJvcik7XG5cdFx0XHRcdFx0cmV0dXJuIHJlamVjdChlcnJvcik7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR0aGlzLmNvbm5lY3Rpb24gPSB7XG5cdFx0XHRcdFx0dHlwZTogbW9kZXNbbW9kZV0sXG5cdFx0XHRcdFx0cHJvdG9jb2w6IHByb3RvY29sLFxuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdHRoaXMubG9nZ2VyLmRlYnVnKCdjb25uZWN0ZWQnLCB0aGlzLmNvbm5lY3Rpb24pO1xuXG5cdFx0XHRcdHJldHVybiByZXNvbHZlKHRoaXMuY29ubmVjdGlvbik7XG5cblx0XHRcdH0pO1xuXG5cdFx0fSk7XG5cblx0fVxuXG5cdGRpc2Nvbm5lY3QoKSB7XG5cblx0XHRpZiAoIXRoaXMuY29ubmVjdGlvbikge1xuXHRcdFx0dGhyb3cgbmV3IERpc2Nvbm5lY3RFcnJvcignbm90X2Nvbm5lY3RlZCcsICdSZWFkZXIgaW4gbm90IGNvbm5lY3RlZC4gTm8gbmVlZCBmb3IgZGlzY29ubmVjdGluZy4nKVxuXHRcdH1cblxuXHRcdHRoaXMubG9nZ2VyLmRlYnVnKCd0cnlpbmcgdG8gZGlzY29ubmVjdCcsIHRoaXMuY29ubmVjdGlvbik7XG5cblx0XHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuXG5cdFx0XHQvLyBkaXNjb25uZWN0IHJlbW92ZWRcblx0XHRcdHRoaXMucmVhZGVyLmRpc2Nvbm5lY3QodGhpcy5yZWFkZXIuU0NBUkRfTEVBVkVfQ0FSRCwgKGVycikgPT4ge1xuXG5cdFx0XHRcdGlmIChlcnIpIHtcblx0XHRcdFx0XHRjb25zdCBlcnJvciA9IG5ldyBEaXNjb25uZWN0RXJyb3IoRkFJTFVSRSwgJ0FuIGVycm9yIG9jY3VycmVkIHdoaWxlIGRpc2Nvbm5lY3RpbmcuJywgZXJyKTtcblx0XHRcdFx0XHR0aGlzLmxvZ2dlci5lcnJvcihlcnJvcik7XG5cdFx0XHRcdFx0cmV0dXJuIHJlamVjdChlcnJvcik7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR0aGlzLmNvbm5lY3Rpb24gPSBudWxsO1xuXG5cdFx0XHRcdHRoaXMubG9nZ2VyLmRlYnVnKCdkaXNjb25uZWN0ZWQnKTtcblxuXHRcdFx0XHRyZXR1cm4gcmVzb2x2ZSh0cnVlKTtcblxuXHRcdFx0fSk7XG5cblx0XHR9KTtcblxuXHR9XG5cblx0dHJhbnNtaXQoZGF0YSwgcmVzcG9uc2VNYXhMZW5ndGgpIHtcblxuXHRcdGlmICghdGhpcy5jYXJkIHx8ICF0aGlzLmNvbm5lY3Rpb24pIHtcblx0XHRcdHRocm93IG5ldyBUcmFuc21pdEVycm9yKENBUkRfTk9UX0NPTk5FQ1RFRCwgJ05vIGNhcmQgb3IgY29ubmVjdGlvbiBhdmFpbGFibGUuJyk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcblxuXHRcdFx0dGhpcy5sb2dnZXIuZGVidWcoJ3RyYW5zbWl0dGluZycsIGRhdGEsIHJlc3BvbnNlTWF4TGVuZ3RoKTtcblxuXHRcdFx0dGhpcy5yZWFkZXIudHJhbnNtaXQoZGF0YSwgcmVzcG9uc2VNYXhMZW5ndGgsIHRoaXMuY29ubmVjdGlvbi5wcm90b2NvbCwgKGVyciwgcmVzcG9uc2UpID0+IHtcblxuXHRcdFx0XHRpZiAoZXJyKSB7XG5cdFx0XHRcdFx0Y29uc3QgZXJyb3IgPSBuZXcgVHJhbnNtaXRFcnJvcihGQUlMVVJFLCAnQW4gZXJyb3Igb2NjdXJyZWQgd2hpbGUgdHJhbnNtaXR0aW5nLicsIGVycik7XG5cdFx0XHRcdFx0cmV0dXJuIHJlamVjdChlcnJvcik7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR0aGlzLmxvZ2dlci5kZWJ1ZygndHJhbnNtaXQgcmVzcG9uc2UgcmVjZWl2ZWQnLCByZXNwb25zZSwgcmVzcG9uc2UgJiYgcmVzcG9uc2UubGVuZ3RoKTtcblxuXHRcdFx0XHRyZXR1cm4gcmVzb2x2ZShyZXNwb25zZSk7XG5cblx0XHRcdH0pO1xuXG5cdFx0fSk7XG5cblx0fVxuXG5cdGNvbnRyb2woZGF0YSwgcmVzcG9uc2VNYXhMZW5ndGgpIHtcblxuXHRcdGlmICghdGhpcy5jb25uZWN0aW9uKSB7XG5cdFx0XHR0aHJvdyBuZXcgQ29udHJvbEVycm9yKCdub3RfY29ubmVjdGVkJywgJ05vIGNvbm5lY3Rpb24gYXZhaWxhYmxlLicpO1xuXHRcdH1cblxuXHRcdHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG5cblx0XHRcdHRoaXMubG9nZ2VyLmRlYnVnKCd0cmFuc21pdHRpbmcgY29udHJvbCcsIGRhdGEsIHJlc3BvbnNlTWF4TGVuZ3RoKTtcblxuXHRcdFx0dGhpcy5yZWFkZXIuY29udHJvbChkYXRhLCB0aGlzLnJlYWRlci5JT0NUTF9DQ0lEX0VTQ0FQRSwgcmVzcG9uc2VNYXhMZW5ndGgsIChlcnIsIHJlc3BvbnNlKSA9PiB7XG5cblx0XHRcdFx0aWYgKGVycikge1xuXHRcdFx0XHRcdGNvbnN0IGVycm9yID0gbmV3IENvbnRyb2xFcnJvcihGQUlMVVJFLCAnQW4gZXJyb3Igb2NjdXJyZWQgd2hpbGUgdHJhbnNtaXR0aW5nIGNvbnRyb2wuJywgZXJyKTtcblx0XHRcdFx0XHRyZXR1cm4gcmVqZWN0KGVycm9yKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHRoaXMubG9nZ2VyLmRlYnVnKCdjb250cm9sIHJlc3BvbnNlIHJlY2VpdmVkJywgcmVzcG9uc2UsIHJlc3BvbnNlICYmIHJlc3BvbnNlLmxlbmd0aCk7XG5cblx0XHRcdFx0cmV0dXJuIHJlc29sdmUocmVzcG9uc2UpO1xuXG5cdFx0XHR9KTtcblxuXHRcdH0pO1xuXG5cdH1cblxuXHRhc3luYyBsb2FkQXV0aGVudGljYXRpb25LZXkoa2V5TnVtYmVyLCBrZXkpIHtcblxuXHRcdGlmICghKGtleU51bWJlciA9PT0gMCB8fCBrZXlOdW1iZXIgPT09IDEpKSB7XG5cdFx0XHR0aHJvdyBuZXcgTG9hZEF1dGhlbnRpY2F0aW9uS2V5RXJyb3IoJ2ludmFsaWRfa2V5X251bWJlcicpO1xuXHRcdH1cblxuXHRcdGlmICghQnVmZmVyLmlzQnVmZmVyKGtleSkgJiYgIUFycmF5LmlzQXJyYXkoa2V5KSkge1xuXG5cdFx0XHRpZiAodHlwZW9mIGtleSAhPT0gJ3N0cmluZycpIHtcblx0XHRcdFx0dGhyb3cgbmV3IExvYWRBdXRoZW50aWNhdGlvbktleUVycm9yKFxuXHRcdFx0XHRcdCdpbnZhbGlkX2tleScsXG5cdFx0XHRcdFx0J0tleSBtdXN0IGFuIGluc3RhbmNlIG9mIEJ1ZmZlciBvciBhbiBhcnJheSBvZiBieXRlcyBvciBhIHN0cmluZy4nLFxuXHRcdFx0XHQpO1xuXHRcdFx0fVxuXG5cdFx0XHRrZXkgPSBCdWZmZXIuZnJvbShrZXksICdoZXgnKTtcblxuXHRcdH1cblxuXHRcdGlmIChrZXkubGVuZ3RoICE9PSA2KSB7XG5cdFx0XHR0aHJvdyBuZXcgTG9hZEF1dGhlbnRpY2F0aW9uS2V5RXJyb3IoJ2ludmFsaWRfa2V5JywgJ0tleSBsZW5ndGggbXVzdCBiZSA2IGJ5dGVzLicpO1xuXHRcdH1cblxuXHRcdC8vIENNRDogTG9hZCBBdXRoZW50aWNhdGlvbiBLZXlzXG5cdFx0Y29uc3QgcGFja2V0ID0gQnVmZmVyLmZyb20oW1xuXHRcdFx0MHhmZiwgLy8gQ2xhc3Ncblx0XHRcdDB4ODIsIC8vIElOU1xuXHRcdFx0MHgwMCwgLy8gUDE6IEtleSBTdHJ1Y3R1cmUgKDB4MDAgPSBLZXkgaXMgbG9hZGVkIGludG8gdGhlIHJlYWRlciB2b2xhdGlsZSBtZW1vcnkuKVxuXHRcdFx0a2V5TnVtYmVyLCAvLyBQMjogS2V5IE51bWJlciAoMDBoIH4gMDFoID0gS2V5IExvY2F0aW9uLiBUaGUga2V5cyB3aWxsIGRpc2FwcGVhciBvbmNlIHRoZSByZWFkZXIgaXMgZGlzY29ubmVjdGVkIGZyb20gdGhlIFBDKVxuXHRcdFx0a2V5Lmxlbmd0aCwgLy8gTGM6IExlbmd0aCBvZiB0aGUga2V5ICg2KVxuXHRcdFx0Li4ua2V5LCAvLyBEYXRhIEluOiBLZXkgKDYgYnl0ZXMpXG5cdFx0XSk7XG5cblx0XHRsZXQgcmVzcG9uc2UgPSBudWxsO1xuXG5cdFx0dHJ5IHtcblxuXHRcdFx0cmVzcG9uc2UgPSBhd2FpdCB0aGlzLnRyYW5zbWl0KHBhY2tldCwgMik7XG5cblxuXHRcdH0gY2F0Y2ggKGVycikge1xuXG5cdFx0XHR0aHJvdyBuZXcgTG9hZEF1dGhlbnRpY2F0aW9uS2V5RXJyb3IobnVsbCwgbnVsbCwgZXJyKTtcblxuXHRcdH1cblxuXHRcdGNvbnN0IHN0YXR1c0NvZGUgPSByZXNwb25zZS5yZWFkVUludDE2QkUoMCk7XG5cblx0XHRpZiAoc3RhdHVzQ29kZSAhPT0gMHg5MDAwKSB7XG5cdFx0XHR0aHJvdyBuZXcgTG9hZEF1dGhlbnRpY2F0aW9uS2V5RXJyb3IoT1BFUkFUSU9OX0ZBSUxFRCwgYExvYWQgYXV0aGVudGljYXRpb24ga2V5IG9wZXJhdGlvbiBmYWlsZWQ6IFN0YXR1cyBjb2RlOiAke3N0YXR1c0NvZGV9YCk7XG5cdFx0fVxuXG5cdFx0dGhpcy5rZXlTdG9yYWdlW2tleU51bWJlcl0gPSBrZXk7XG5cblx0XHRyZXR1cm4ga2V5TnVtYmVyO1xuXG5cdH1cblxuXHQvLyBmb3IgUEMvU0MgVjIuMDEgdXNlIG9ic29sZXRlID0gdHJ1ZVxuXHQvLyBmb3IgUEMvU0MgVjIuMDcgdXNlIG9ic29sZXRlID0gZmFsc2UgW2RlZmF1bHRdXG5cdGFzeW5jIGF1dGhlbnRpY2F0ZShibG9ja051bWJlciwga2V5VHlwZSwga2V5LCBvYnNvbGV0ZSA9IGZhbHNlKSB7XG5cblx0XHRsZXQga2V5TnVtYmVyID0gT2JqZWN0LmtleXModGhpcy5rZXlTdG9yYWdlKS5maW5kKG4gPT4gdGhpcy5rZXlTdG9yYWdlW25dID09PSBrZXkpO1xuXG5cdFx0Ly8ga2V5IGlzIG5vdCBpbiB0aGUgc3RvcmFnZVxuXHRcdGlmICgha2V5TnVtYmVyKSB7XG5cblx0XHRcdC8vIElmIHRoZXJlIGlzbid0IGFscmVhZHkgYW4gYXV0aGVudGljYXRpb24gcHJvY2VzcyBoYXBwZW5pbmcgZm9yIHRoaXMga2V5LCBzdGFydCBpdFxuXHRcdFx0aWYgKCF0aGlzLnBlbmRpbmdMb2FkQXV0aGVudGljYXRpb25LZXlba2V5XSkge1xuXG5cdFx0XHRcdC8vIHNldCBrZXkgbnVtYmVyIHRvIGZpcnN0XG5cdFx0XHRcdGtleU51bWJlciA9IE9iamVjdC5rZXlzKHRoaXMua2V5U3RvcmFnZSlbMF07XG5cblx0XHRcdFx0Ly8gaWYgdGhpcyBudW1iZXIgaXMgbm90IGZyZWVcblx0XHRcdFx0aWYgKHRoaXMua2V5U3RvcmFnZVtrZXlOdW1iZXJdICE9PSBudWxsKSB7XG5cdFx0XHRcdFx0Ly8gdHJ5IHRvIGZpbmQgYW55IGZyZWUgbnVtYmVyXG5cdFx0XHRcdFx0Y29uc3QgZnJlZU51bWJlciA9IE9iamVjdC5rZXlzKHRoaXMua2V5U3RvcmFnZSkuZmluZChuID0+IHRoaXMua2V5U3RvcmFnZVtuXSA9PT0gbnVsbCk7XG5cdFx0XHRcdFx0Ly8gaWYgd2UgZmluZCwgd2UgdXNlIGl0LCBvdGhlcndpc2UgdGhlIGZpcnN0IHdpbGwgYmUgdXNlZCBhbmQgcmV3cml0dGVuXG5cdFx0XHRcdFx0aWYgKGZyZWVOdW1iZXIpIHtcblx0XHRcdFx0XHRcdGtleU51bWJlciA9IGZyZWVOdW1iZXI7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gU3RvcmUgdGhlIGF1dGhlbnRpY2F0aW9uIHByb21pc2UgaW4gY2FzZSBvdGhlciBibG9ja3MgYXJlIGluIHByb2Nlc3Mgb2YgYXV0aGVudGljYXRpb25cblx0XHRcdFx0dGhpcy5wZW5kaW5nTG9hZEF1dGhlbnRpY2F0aW9uS2V5W2tleV0gPSB0aGlzLmxvYWRBdXRoZW50aWNhdGlvbktleShwYXJzZUludChrZXlOdW1iZXIpLCBrZXkpO1xuXG5cdFx0XHR9XG5cblx0XHRcdHRyeSB7XG5cdFx0XHRcdGtleU51bWJlciA9IGF3YWl0IHRoaXMucGVuZGluZ0xvYWRBdXRoZW50aWNhdGlvbktleVtrZXldO1xuXHRcdFx0fSBjYXRjaCAoZXJyKSB7XG5cdFx0XHRcdHRocm93IG5ldyBBdXRoZW50aWNhdGlvbkVycm9yKCd1bmFibGVfdG9fbG9hZF9rZXknLCAnQ291bGQgbm90IGxvYWQgYXV0aGVudGljYXRpb24ga2V5IGludG8gcmVhZGVyLicsIGVycik7XG5cdFx0XHR9IGZpbmFsbHkge1xuXHRcdFx0XHQvLyByZW1vdmUgdGhlIGxvYWRBdXRoZW50aWNhdGlvbktleSBQcm9taXNlIGZyb20gcGVuZGluZ0xvYWRBdXRoZW50aWNhdGlvbktleVxuXHRcdFx0XHQvLyBhcyBpdCBpcyBhbHJlYWR5IHJlc29sdmVkIG9yIHJlamVjdGVkIGF0IHRoaXMgcG9pbnRcblx0XHRcdFx0ZGVsZXRlIHRoaXMucGVuZGluZ0xvYWRBdXRoZW50aWNhdGlvbktleVtrZXldO1xuXHRcdFx0fVxuXG5cdFx0fVxuXG5cdFx0Y29uc3QgcGFja2V0ID0gIW9ic29sZXRlID8gKFxuXHRcdFx0Ly8gQ01EOiBBdXRoZW50aWNhdGlvblxuXHRcdFx0QnVmZmVyLmZyb20oW1xuXHRcdFx0XHQweGZmLCAvLyBDbGFzc1xuXHRcdFx0XHQweDg2LCAvLyBJTlNcblx0XHRcdFx0MHgwMCwgLy8gUDFcblx0XHRcdFx0MHgwMCwgLy8gUDJcblx0XHRcdFx0MHgwNSwgLy8gTGNcblx0XHRcdFx0Ly8gRGF0YSBJbjogQXV0aGVudGljYXRlIERhdGEgQnl0ZXMgKDUgYnl0ZXMpXG5cdFx0XHRcdDB4MDEsIC8vIEJ5dGUgMTogVmVyc2lvblxuXHRcdFx0XHQweDAwLCAvLyBCeXRlIDJcblx0XHRcdFx0YmxvY2tOdW1iZXIsIC8vIEJ5dGUgMzogQmxvY2sgTnVtYmVyXG5cdFx0XHRcdGtleVR5cGUsIC8vIEJ5dGUgNDogS2V5IFR5cGVcblx0XHRcdFx0a2V5TnVtYmVyLCAvLyBCeXRlIDU6IEtleSBOdW1iZXJcblx0XHRcdF0pXG5cdFx0KSA6IChcblx0XHRcdC8vIENNRDogQXV0aGVudGljYXRpb24gKG9ic29sZXRlKVxuXHRcdFx0QnVmZmVyLmZyb20oW1xuXHRcdFx0XHQweGZmLCAvLyBDbGFzc1xuXHRcdFx0XHQweDg4LCAvLyBJTlNcblx0XHRcdFx0MHgwMCwgLy8gUDFcblx0XHRcdFx0YmxvY2tOdW1iZXIsIC8vIFAyOiBCbG9jayBOdW1iZXJcblx0XHRcdFx0a2V5VHlwZSwgLy8gUDM6IEtleSBUeXBlXG5cdFx0XHRcdGtleU51bWJlciwgLy8gRGF0YSBJbjogS2V5IE51bWJlclxuXHRcdFx0XSlcblx0XHQpO1xuXG5cdFx0bGV0IHJlc3BvbnNlID0gbnVsbDtcblxuXHRcdHRyeSB7XG5cblx0XHRcdHJlc3BvbnNlID0gYXdhaXQgdGhpcy50cmFuc21pdChwYWNrZXQsIDIpO1xuXG5cdFx0fSBjYXRjaCAoZXJyKSB7XG5cblx0XHRcdHRocm93IG5ldyBBdXRoZW50aWNhdGlvbkVycm9yKG51bGwsIG51bGwsIGVycik7XG5cblx0XHR9XG5cblx0XHRjb25zdCBzdGF0dXNDb2RlID0gcmVzcG9uc2UucmVhZFVJbnQxNkJFKDApO1xuXG5cdFx0aWYgKHN0YXR1c0NvZGUgIT09IDB4OTAwMCkge1xuXHRcdFx0dGhpcy5sb2dnZXIuZXJyb3IoJ1thdXRoZW50aWNhdGlvbiBvcGVyYXRpb24gZmFpbGVkXVtyZXF1ZXN0IHBhY2tldF0nLCBwYWNrZXQpO1xuXHRcdFx0dGhyb3cgbmV3IEF1dGhlbnRpY2F0aW9uRXJyb3IoT1BFUkFUSU9OX0ZBSUxFRCwgYEF1dGhlbnRpY2F0aW9uIG9wZXJhdGlvbiBmYWlsZWQ6IFN0YXR1cyBjb2RlOiAweCR7c3RhdHVzQ29kZS50b1N0cmluZygxNil9YCk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRydWU7XG5cblx0fVxuXG5cdGFzeW5jIHJlYWQoYmxvY2tOdW1iZXIsIGxlbmd0aCwgYmxvY2tTaXplID0gNCwgcGFja2V0U2l6ZSA9IDE2LCByZWFkQ2xhc3MgPSAweGZmKSB7XG5cblx0XHRpZiAoIXRoaXMuY2FyZCkge1xuXHRcdFx0dGhyb3cgbmV3IFJlYWRFcnJvcihDQVJEX05PVF9DT05ORUNURUQpO1xuXHRcdH1cblxuXHRcdHRoaXMubG9nZ2VyLmRlYnVnKCdyZWFkaW5nIGRhdGEgZnJvbSBjYXJkJywgdGhpcy5jYXJkKTtcblxuXHRcdGlmIChsZW5ndGggPiBwYWNrZXRTaXplKSB7XG5cblx0XHRcdGNvbnN0IHAgPSBNYXRoLmNlaWwobGVuZ3RoIC8gcGFja2V0U2l6ZSk7XG5cblx0XHRcdGNvbnN0IGNvbW1hbmRzID0gW107XG5cblx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgcDsgaSsrKSB7XG5cblx0XHRcdFx0Y29uc3QgYmxvY2sgPSBibG9ja051bWJlciArICgoaSAqIHBhY2tldFNpemUpIC8gYmxvY2tTaXplKTtcblxuXHRcdFx0XHRjb25zdCBzaXplID0gKChpICsgMSkgKiBwYWNrZXRTaXplKSA8IGxlbmd0aCA/IHBhY2tldFNpemUgOiBsZW5ndGggLSAoKGkpICogcGFja2V0U2l6ZSk7XG5cblx0XHRcdFx0Ly8gY29uc29sZS5sb2coaSwgYmxvY2ssIHNpemUpO1xuXG5cdFx0XHRcdGNvbW1hbmRzLnB1c2godGhpcy5yZWFkKGJsb2NrLCBzaXplLCBibG9ja1NpemUsIHBhY2tldFNpemUsIHJlYWRDbGFzcykpO1xuXG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiBQcm9taXNlLmFsbChjb21tYW5kcylcblx0XHRcdFx0LnRoZW4odmFsdWVzID0+IHtcblx0XHRcdFx0XHQvLyBjb25zb2xlLmxvZyh2YWx1ZXMpO1xuXHRcdFx0XHRcdHJldHVybiBCdWZmZXIuY29uY2F0KHZhbHVlcywgbGVuZ3RoKTtcblx0XHRcdFx0fSk7XG5cblx0XHR9XG5cblx0XHQvLyBBUERVIENNRDogUmVhZCBCaW5hcnkgQmxvY2tzXG5cdFx0Y29uc3QgcGFja2V0ID0gQnVmZmVyLmZyb20oW1xuXHRcdFx0cmVhZENsYXNzLCAvLyBDbGFzc1xuXHRcdFx0MHhiMCwgLy8gSW5zXG5cdFx0XHQoYmxvY2tOdW1iZXIgPj4gOCkgJiAweEZGLCAvLyBQMVxuXHRcdFx0YmxvY2tOdW1iZXIgJiAweEZGLCAvLyBQMjogQmxvY2sgTnVtYmVyXG5cdFx0XHRsZW5ndGgsICAvLyBMZTogTnVtYmVyIG9mIEJ5dGVzIHRvIFJlYWQgKE1heGltdW0gMTYgYnl0ZXMpXG5cdFx0XSk7XG5cblx0XHRsZXQgcmVzcG9uc2UgPSBudWxsO1xuXG5cdFx0dHJ5IHtcblxuXHRcdFx0cmVzcG9uc2UgPSBhd2FpdCB0aGlzLnRyYW5zbWl0KHBhY2tldCwgbGVuZ3RoICsgMik7XG5cblx0XHR9IGNhdGNoIChlcnIpIHtcblxuXHRcdFx0dGhyb3cgbmV3IFJlYWRFcnJvcihudWxsLCBudWxsLCBlcnIpO1xuXG5cdFx0fVxuXG5cdFx0aWYgKHJlc3BvbnNlLmxlbmd0aCA8IDIpIHtcblx0XHRcdHRocm93IG5ldyBSZWFkRXJyb3IoT1BFUkFUSU9OX0ZBSUxFRCwgYFJlYWQgb3BlcmF0aW9uIGZhaWxlZDogSW52YWxpZCByZXNwb25zZSBsZW5ndGggJHtyZXNwb25zZS5sZW5ndGh9LiBFeHBlY3RlZCBtaW5pbWFsIGxlbmd0aCBpcyAyIGJ5dGVzLmApO1xuXHRcdH1cblxuXHRcdGNvbnN0IHN0YXR1c0NvZGUgPSByZXNwb25zZS5zbGljZSgtMikucmVhZFVJbnQxNkJFKDApO1xuXG5cdFx0aWYgKHN0YXR1c0NvZGUgIT09IDB4OTAwMCkge1xuXHRcdFx0dGhyb3cgbmV3IFJlYWRFcnJvcihPUEVSQVRJT05fRkFJTEVELCBgUmVhZCBvcGVyYXRpb24gZmFpbGVkOiBTdGF0dXMgY29kZTogMHgke3N0YXR1c0NvZGUudG9TdHJpbmcoMTYpfWApO1xuXHRcdH1cblxuXHRcdGNvbnN0IGRhdGEgPSByZXNwb25zZS5zbGljZSgwLCAtMik7XG5cblx0XHR0aGlzLmxvZ2dlci5kZWJ1ZygnZGF0YScsIGRhdGEpO1xuXG5cdFx0cmV0dXJuIGRhdGE7XG5cblx0fVxuXG5cdGFzeW5jIHdyaXRlKGJsb2NrTnVtYmVyLCBkYXRhLCBibG9ja1NpemUgPSA0KSB7XG5cblx0XHRpZiAoIXRoaXMuY2FyZCkge1xuXHRcdFx0dGhyb3cgbmV3IFdyaXRlRXJyb3IoQ0FSRF9OT1RfQ09OTkVDVEVEKTtcblx0XHR9XG5cblx0XHR0aGlzLmxvZ2dlci5kZWJ1Zygnd3JpdGluZyBkYXRhIHRvIGNhcmQnLCB0aGlzLmNhcmQpO1xuXG5cdFx0aWYgKGRhdGEubGVuZ3RoIDwgYmxvY2tTaXplIHx8IGRhdGEubGVuZ3RoICUgYmxvY2tTaXplICE9PSAwKSB7XG5cdFx0XHR0aHJvdyBuZXcgV3JpdGVFcnJvcignaW52YWxpZF9kYXRhX2xlbmd0aCcsICdJbnZhbGlkIGRhdGEgbGVuZ3RoLiBZb3UgY2FuIG9ubHkgdXBkYXRlIHRoZSBlbnRpcmUgZGF0YSBibG9jayhzKS4nKTtcblx0XHR9XG5cblx0XHRpZiAoZGF0YS5sZW5ndGggPiBibG9ja1NpemUpIHtcblxuXHRcdFx0Y29uc3QgcCA9IGRhdGEubGVuZ3RoIC8gYmxvY2tTaXplO1xuXG5cdFx0XHRjb25zdCBjb21tYW5kcyA9IFtdO1xuXG5cdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHA7IGkrKykge1xuXG5cdFx0XHRcdGNvbnN0IGJsb2NrID0gYmxvY2tOdW1iZXIgKyBpO1xuXG5cdFx0XHRcdGNvbnN0IHN0YXJ0ID0gaSAqIGJsb2NrU2l6ZTtcblx0XHRcdFx0Y29uc3QgZW5kID0gKGkgKyAxKSAqIGJsb2NrU2l6ZTtcblxuXHRcdFx0XHRjb25zdCBwYXJ0ID0gZGF0YS5zbGljZShzdGFydCwgZW5kKTtcblxuXHRcdFx0XHQvLyBjb25zb2xlLmxvZyhpLCBibG9jaywgc3RhcnQsIGVuZCwgcGFydCk7XG5cblx0XHRcdFx0Y29tbWFuZHMucHVzaCh0aGlzLndyaXRlKGJsb2NrLCBwYXJ0LCBibG9ja1NpemUpKTtcblxuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gUHJvbWlzZS5hbGwoY29tbWFuZHMpXG5cdFx0XHRcdC50aGVuKHZhbHVlcyA9PiB7XG5cdFx0XHRcdFx0Ly8gY29uc29sZS5sb2codmFsdWVzKTtcblx0XHRcdFx0XHRyZXR1cm4gdmFsdWVzO1xuXHRcdFx0XHR9KTtcblxuXHRcdH1cblxuXHRcdC8vIEFQRFUgQ01EOiBVcGRhdGUgQmluYXJ5IEJsb2NrXG5cdFx0Y29uc3QgcGFja2V0SGVhZGVyID0gQnVmZmVyLmZyb20oW1xuXHRcdFx0MHhmZiwgLy8gQ2xhc3Ncblx0XHRcdDB4ZDYsIC8vIEluc1xuXHRcdFx0MHgwMCwgLy8gUDFcblx0XHRcdGJsb2NrTnVtYmVyLCAvLyBQMjogQmxvY2sgTnVtYmVyXG5cdFx0XHRibG9ja1NpemUsIC8vIExlOiBOdW1iZXIgb2YgQnl0ZXMgdG8gVXBkYXRlXG5cdFx0XSk7XG5cblx0XHRjb25zdCBwYWNrZXQgPSBCdWZmZXIuY29uY2F0KFtwYWNrZXRIZWFkZXIsIGRhdGFdKTtcblxuXHRcdGxldCByZXNwb25zZSA9IG51bGw7XG5cblx0XHR0cnkge1xuXG5cdFx0XHRyZXNwb25zZSA9IGF3YWl0IHRoaXMudHJhbnNtaXQocGFja2V0LCAyKTtcblxuXHRcdH0gY2F0Y2ggKGVycikge1xuXG5cdFx0XHR0aHJvdyBuZXcgV3JpdGVFcnJvcihudWxsLCBudWxsLCBlcnIpO1xuXG5cdFx0fVxuXG5cdFx0aWYgKHJlc3BvbnNlLmxlbmd0aCA8IDIpIHtcblx0XHRcdHRocm93IG5ldyBXcml0ZUVycm9yKE9QRVJBVElPTl9GQUlMRUQsIGBXcml0ZSBvcGVyYXRpb24gZmFpbGVkOiBJbnZhbGlkIHJlc3BvbnNlIGxlbmd0aCAke3Jlc3BvbnNlLmxlbmd0aH0uIEV4cGVjdGVkIG1pbmltYWwgbGVuZ3RoIGlzIDIgYnl0ZXMuYCk7XG5cdFx0fVxuXG5cdFx0Y29uc3Qgc3RhdHVzQ29kZSA9IHJlc3BvbnNlLnNsaWNlKC0yKS5yZWFkVUludDE2QkUoMCk7XG5cblx0XHRpZiAoc3RhdHVzQ29kZSAhPT0gMHg5MDAwKSB7XG5cdFx0XHR0aHJvdyBuZXcgV3JpdGVFcnJvcihPUEVSQVRJT05fRkFJTEVELCBgV3JpdGUgb3BlcmF0aW9uIGZhaWxlZDogU3RhdHVzIGNvZGU6IDB4JHtzdGF0dXNDb2RlLnRvU3RyaW5nKDE2KX1gKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gdHJ1ZTtcblxuXHR9XG5cblx0aGFuZGxlVGFnKCkge1xuXG5cdFx0aWYgKCF0aGlzLmNhcmQpIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cblx0XHR0aGlzLmxvZ2dlci5kZWJ1ZygnaGFuZGxpbmcgdGFnJywgdGhpcy5jYXJkKTtcblxuXHRcdHN3aXRjaCAodGhpcy5jYXJkLnN0YW5kYXJkKSB7XG5cblx0XHRcdGNhc2UgVEFHX0lTT18xNDQ0M18zOlxuXHRcdFx0XHRyZXR1cm4gdGhpcy5oYW5kbGVfSXNvXzE0NDQzXzNfVGFnKCk7XG5cblx0XHRcdGNhc2UgVEFHX0lTT18xNDQ0M180OlxuXHRcdFx0XHRyZXR1cm4gdGhpcy5oYW5kbGVfSXNvXzE0NDQzXzRfVGFnKCk7XG5cblx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdHJldHVybiB0aGlzLmhhbmRsZV9Jc29fMTQ0NDNfM19UYWcoKTtcblxuXHRcdH1cblxuXHR9XG5cblx0Ly8gVE9ETzogaW1wcm92ZSBlcnJvciBoYW5kbGluZyBhbmQgZGVidWdnaW5nXG5cdGFzeW5jIGhhbmRsZV9Jc29fMTQ0NDNfM19UYWcoKSB7XG5cblx0XHRpZiAoIXRoaXMuY2FyZCB8fCAhdGhpcy5jb25uZWN0aW9uKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXG5cdFx0dGhpcy5sb2dnZXIuZGVidWcoJ3Byb2Nlc3NpbmcgSVNPIDE0NDQzLTMgdGFnJywgdGhpcy5jYXJkKTtcblxuXHRcdC8vIEFQRFUgQ01EOiBHZXQgRGF0YVxuXHRcdGNvbnN0IHBhY2tldCA9IEJ1ZmZlci5mcm9tKFtcblx0XHRcdDB4ZmYsIC8vIENsYXNzXG5cdFx0XHQweGNhLCAvLyBJTlNcblx0XHRcdDB4MDAsIC8vIFAxOiBHZXQgY3VycmVudCBjYXJkIFVJRFxuXHRcdFx0MHgwMCwgLy8gUDJcblx0XHRcdDB4MDAsIC8vIExlOiBGdWxsIExlbmd0aCBvZiBVSURcblx0XHRdKTtcblxuXHRcdHRyeSB7XG5cblx0XHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy50cmFuc21pdChwYWNrZXQsIDEyKTtcblxuXHRcdFx0aWYgKHJlc3BvbnNlLmxlbmd0aCA8IDIpIHtcblxuXHRcdFx0XHRjb25zdCBlcnJvciA9IG5ldyBHZXRVSURFcnJvcignaW52YWxpZF9yZXNwb25zZScsIGBJbnZhbGlkIHJlc3BvbnNlIGxlbmd0aCAke3Jlc3BvbnNlLmxlbmd0aH0uIEV4cGVjdGVkIG1pbmltYWwgbGVuZ3RoIGlzIDIgYnl0ZXMuYCk7XG5cdFx0XHRcdHRoaXMuZW1pdCgnZXJyb3InLCBlcnJvcik7XG5cblx0XHRcdFx0cmV0dXJuO1xuXG5cdFx0XHR9XG5cblx0XHRcdC8vIGxhc3QgMiBieXRlcyBhcmUgdGhlIHN0YXR1cyBjb2RlXG5cdFx0XHRjb25zdCBzdGF0dXNDb2RlID0gcmVzcG9uc2Uuc2xpY2UoLTIpLnJlYWRVSW50MTZCRSgwKTtcblxuXHRcdFx0Ly8gYW4gZXJyb3Igb2NjdXJyZWRcblx0XHRcdGlmIChzdGF0dXNDb2RlICE9PSAweDkwMDApIHtcblxuXHRcdFx0XHRjb25zdCBlcnJvciA9IG5ldyBHZXRVSURFcnJvcihPUEVSQVRJT05fRkFJTEVELCAnQ291bGQgbm90IGdldCBjYXJkIFVJRC4nKTtcblx0XHRcdFx0dGhpcy5lbWl0KCdlcnJvcicsIGVycm9yKTtcblxuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdC8vIHN0cmlwIG91dCB0aGUgc3RhdHVzIGNvZGUgKHRoZSByZXN0IGlzIFVJRClcblx0XHRcdGNvbnN0IHVpZCA9IHJlc3BvbnNlLnNsaWNlKDAsIC0yKS50b1N0cmluZygnaGV4Jyk7XG5cdFx0XHQvLyBjb25zdCB1aWRSZXZlcnNlID0gUmVhZGVyLnJldmVyc2VCdWZmZXIocmVzcG9uc2Uuc2xpY2UoMCwgLTIpKS50b1N0cmluZygnaGV4Jyk7XG5cblx0XHRcdHRoaXMuY2FyZC51aWQgPSB1aWQ7XG5cblx0XHRcdHRoaXMuZW1pdCgnY2FyZCcsIHsgLi4udGhpcy5jYXJkIH0pO1xuXG5cblx0XHR9IGNhdGNoIChlcnIpIHtcblxuXHRcdFx0Y29uc3QgZXJyb3IgPSBuZXcgR2V0VUlERXJyb3IobnVsbCwgbnVsbCwgZXJyKTtcblxuXHRcdFx0dGhpcy5lbWl0KCdlcnJvcicsIGVycm9yKTtcblxuXHRcdH1cblxuXHR9XG5cblx0Ly8gVE9ETzogaW1wcm92ZSBlcnJvciBoYW5kbGluZyBhbmQgZGVidWdnaW5nXG5cdGFzeW5jIGhhbmRsZV9Jc29fMTQ0NDNfNF9UYWcoKSB7XG5cblx0XHRpZiAoIXRoaXMuY2FyZCB8fCAhdGhpcy5jb25uZWN0aW9uKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXG5cdFx0dGhpcy5sb2dnZXIuZGVidWcoJ3Byb2Nlc3NpbmcgSVNPIDE0NDQzLTQgdGFnJywgdGhpcy5jYXJkKTtcblxuXHRcdGlmICghdGhpcy5haWQpIHtcblx0XHRcdHRoaXMuZW1pdCgnZXJyb3InLCBuZXcgRXJyb3IoJ0Nhbm5vdCBwcm9jZXNzIElTTyAxNDQ0My00IHRhZyBiZWNhdXNlIEFJRCB3YXMgbm90IHNldC4nKSk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Y29uc3QgYWlkID0gdHlwZW9mIHRoaXMuYWlkID09PSAnZnVuY3Rpb24nID8gdGhpcy5haWQodGhpcy5jYXJkKSA6IHRoaXMuYWlkO1xuXG5cdFx0aWYgKCFCdWZmZXIuaXNCdWZmZXIoYWlkKSkge1xuXHRcdFx0dGhpcy5lbWl0KCdlcnJvcicsIG5ldyBFcnJvcignQUlEIG11c3QgYmUgYW4gaW5zdGFuY2Ugb2YgQnVmZmVyLicpKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBBUERVIENNRDogU0VMRUNUIEZJTEVcblx0XHQvLyBzZWUgaHR0cDovL2NhcmR3ZXJrLmNvbS9zbWFydC1jYXJkLXN0YW5kYXJkLWlzbzc4MTYtNC1zZWN0aW9uLTYtYmFzaWMtaW50ZXJpbmR1c3RyeS1jb21tYW5kcy8jY2hhcDZfMTFfM1xuXHRcdGNvbnN0IHBhY2tldCA9IEJ1ZmZlci5mcm9tKFtcblx0XHRcdDB4MDAsIC8vIENsYXNzXG5cdFx0XHQweGE0LCAvLyBJTlNcblx0XHRcdDB4MDQsIC8vIFAxXG5cdFx0XHQweDAwLCAvLyBQMlxuXHRcdFx0YWlkLmxlbmd0aCwgLy8gTGNcblx0XHRcdC4uLmFpZCwgLy8gQUlEXG5cdFx0XHQweDAwLCAvLyBMZVxuXHRcdF0pO1xuXG5cdFx0dHJ5IHtcblxuXHRcdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLnRyYW5zbWl0KHBhY2tldCwgNDApO1xuXG5cdFx0XHRpZiAocmVzcG9uc2UubGVuZ3RoID09PSAyICYmIHJlc3BvbnNlLnJlYWRVSW50MTZCRSgwKSA9PT0gMHg2YTgyKSB7XG5cblx0XHRcdFx0Y29uc3QgZXJyID0gbmV3IEVycm9yKGBOb3QgZm91bmQgcmVzcG9uc2UuIFRhZyBub3QgY29tcGF0aWJsZSB3aXRoIEFJRCAke2FpZC50b1N0cmluZygnaGV4JykudG9VcHBlckNhc2UoKX0uYCk7XG5cdFx0XHRcdHRoaXMuZW1pdCgnZXJyb3InLCBlcnIpO1xuXG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0aWYgKHJlc3BvbnNlLmxlbmd0aCA8IDIpIHtcblxuXHRcdFx0XHRjb25zdCBlcnIgPSBuZXcgRXJyb3IoYEludmFsaWQgcmVzcG9uc2UgbGVuZ3RoICR7cmVzcG9uc2UubGVuZ3RofS4gRXhwZWN0ZWQgbWluaW1hbCBsZW5ndGggaXMgMiBieXRlcy5gKTtcblx0XHRcdFx0dGhpcy5lbWl0KCdlcnJvcicsIGVycik7XG5cblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBhbm90aGVyIHBvc3NpYmlsaXR5IGNvbnN0IHN0YXR1c0NvZGUgPSBwYXJzZUludChyZXNwb25zZS5zbGljZSgtMikudG9TdHJpbmcoJ2hleCcpLCAxNilcblx0XHRcdGNvbnN0IHN0YXR1c0NvZGUgPSByZXNwb25zZS5zbGljZSgtMikucmVhZFVJbnQxNkJFKDApO1xuXG5cdFx0XHQvLyBhbiBlcnJvciBvY2N1cnJlZFxuXHRcdFx0aWYgKHN0YXR1c0NvZGUgIT09IDB4OTAwMCkge1xuXG5cdFx0XHRcdGNvbnN0IGVyciA9IG5ldyBFcnJvcihgUmVzcG9uc2Ugc3RhdHVzIGVycm9yLmApO1xuXHRcdFx0XHR0aGlzLmVtaXQoJ2Vycm9yJywgZXJyKTtcblxuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdC8vIHN0cmlwIG91dCB0aGUgc3RhdHVzIGNvZGVcblx0XHRcdGNvbnN0IGRhdGEgPSByZXNwb25zZS5zbGljZSgwLCAtMik7XG5cblx0XHRcdHRoaXMubG9nZ2VyLmRlYnVnKCdEYXRhIGNyb3BwZWQnLCBkYXRhKTtcblxuXHRcdFx0dGhpcy5lbWl0KCdjYXJkJywge1xuXHRcdFx0XHQuLi50aGlzLmNhcmQsXG5cdFx0XHRcdGRhdGE6IGRhdGEsXG5cdFx0XHR9KTtcblxuXHRcdH0gY2F0Y2ggKGVycikge1xuXG5cdFx0XHRjb25zdCBlcnJvciA9IG5ldyBHZXRVSURFcnJvcihudWxsLCBudWxsLCBlcnIpO1xuXG5cdFx0XHR0aGlzLmVtaXQoJ2Vycm9yJywgZXJyb3IpO1xuXG5cdFx0fVxuXG5cdH1cblxuXHRjbG9zZSgpIHtcblx0XHR0aGlzLnJlYWRlci5jbG9zZSgpO1xuXHR9XG5cblx0dG9TdHJpbmcoKSB7XG5cdFx0cmV0dXJuIHRoaXMubmFtZTtcblx0fVxuXG59XG5cbmV4cG9ydCBkZWZhdWx0IFJlYWRlcjtcbiJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "Reader.js"
      ],
      "names": [
        "TAG_ISO_14443_3",
        "TAG_ISO_14443_4",
        "KEY_TYPE_A",
        "KEY_TYPE_B",
        "CONNECT_MODE_DIRECT",
        "CONNECT_MODE_CARD",
        "Reader",
        "EventEmitter",
        "reverseBuffer",
        "src",
        "buffer",
        "Buffer",
        "allocUnsafe",
        "length",
        "i",
        "j",
        "selectStandardByAtr",
        "atr",
        "aid",
        "_aid",
        "value",
        "isBuffer",
        "Error",
        "from",
        "name",
        "reader",
        "constructor",
        "logger",
        "log",
        "debug",
        "info",
        "warn",
        "error",
        "on",
        "err",
        "emit",
        "status",
        "changes",
        "state",
        "SCARD_STATE_EMPTY",
        "card",
        "connection",
        "disconnect",
        "SCARD_STATE_PRESENT",
        "standard",
        "type",
        "connect",
        "autoProcessing",
        "handleTag",
        "mode",
        "modes",
        "SCARD_SHARE_DIRECT",
        "SCARD_SHARE_SHARED",
        "ConnectError",
        "Promise",
        "resolve",
        "reject",
        "share_mode",
        "protocol",
        "FAILURE",
        "DisconnectError",
        "SCARD_LEAVE_CARD",
        "transmit",
        "data",
        "responseMaxLength",
        "TransmitError",
        "CARD_NOT_CONNECTED",
        "response",
        "control",
        "ControlError",
        "IOCTL_CCID_ESCAPE",
        "loadAuthenticationKey",
        "keyNumber",
        "key",
        "LoadAuthenticationKeyError",
        "Array",
        "isArray",
        "packet",
        "statusCode",
        "readUInt16BE",
        "OPERATION_FAILED",
        "keyStorage",
        "authenticate",
        "blockNumber",
        "keyType",
        "obsolete",
        "Object",
        "keys",
        "find",
        "n",
        "pendingLoadAuthenticationKey",
        "freeNumber",
        "parseInt",
        "AuthenticationError",
        "toString",
        "read",
        "blockSize",
        "packetSize",
        "readClass",
        "ReadError",
        "p",
        "Math",
        "ceil",
        "commands",
        "block",
        "size",
        "push",
        "all",
        "then",
        "values",
        "concat",
        "slice",
        "write",
        "WriteError",
        "start",
        "end",
        "part",
        "packetHeader",
        "handle_Iso_14443_3_Tag",
        "handle_Iso_14443_4_Tag",
        "GetUIDError",
        "uid",
        "toUpperCase",
        "close"
      ],
      "mappings": "AAAA;;;;;;;AAEA;;AACA;;;;;;AAiBO,MAAMA,eAAe,GAAG,iBAAxB,C,CAA2C;;;AAC3C,MAAMC,eAAe,GAAG,iBAAxB,C,CAA2C;;;AAE3C,MAAMC,UAAU,GAAG,IAAnB;;AACA,MAAMC,UAAU,GAAG,IAAnB;;AAEA,MAAMC,mBAAmB,GAAG,qBAA5B;;AACA,MAAMC,iBAAiB,GAAG,mBAA1B;;;AAGP,MAAMC,MAAN,SAAqBC,eAArB,CAAkC;AAkBjC;AACD;AACA;AACA;AACA;AACA;AACA;AACqB,SAAbC,aAAa,CAACC,GAAD,EAAM;AAEzB,UAAMC,MAAM,GAAGC,MAAM,CAACC,WAAP,CAAmBH,GAAG,CAACI,MAAvB,CAAf;;AAEA,SAAK,IAAIC,CAAC,GAAG,CAAR,EAAWC,CAAC,GAAGN,GAAG,CAACI,MAAJ,GAAa,CAAjC,EAAoCC,CAAC,IAAIC,CAAzC,EAA4C,EAAED,CAAF,EAAK,EAAEC,CAAnD,EAAsD;AACrDL,MAAAA,MAAM,CAACI,CAAD,CAAN,GAAYL,GAAG,CAACM,CAAD,CAAf;AACAL,MAAAA,MAAM,CAACK,CAAD,CAAN,GAAYN,GAAG,CAACK,CAAD,CAAf;AACA;;AAED,WAAOJ,MAAP;AAEA;;AAEyB,SAAnBM,mBAAmB,CAACC,GAAD,EAAM;AAE/B;AACA,QAAIA,GAAG,CAAC,CAAD,CAAH,IAAUA,GAAG,CAAC,CAAD,CAAH,KAAW,IAAzB,EAA+B;AAC9B,aAAOjB,eAAP;AACA,KAFD,MAGK;AACJ,aAAOC,eAAP;AACA;AAED;;AAEM,MAAHiB,GAAG,GAAG;AACT,WAAO,KAAKC,IAAZ;AACA;;AAEM,MAAHD,GAAG,CAACE,KAAD,EAAQ;AAEd,QAAI,OAAOA,KAAP,KAAiB,UAAjB,IAA+BT,MAAM,CAACU,QAAP,CAAgBD,KAAhB,CAAnC,EAA2D;AAC1D,WAAKD,IAAL,GAAYC,KAAZ;AACA;AACA;;AAED,QAAI,OAAOA,KAAP,KAAiB,QAArB,EAA+B;AAC9B,YAAM,IAAIE,KAAJ,CAAW,kEAAX,CAAN;AACA;;AAED,SAAKH,IAAL,GAAYR,MAAM,CAACY,IAAP,CAAYH,KAAZ,EAAmB,KAAnB,CAAZ;AAEA;;AAEO,MAAJI,IAAI,GAAG;AACV,WAAO,KAAKC,MAAL,CAAYD,IAAnB;AACA;;AAEDE,EAAAA,WAAW,CAACD,MAAD,EAASE,MAAT,EAAiB;AAE3B;;AAF2B,oCAvEnB,IAuEmB;;AAAA,oCAtEnB,IAsEmB;;AAAA,wCApEf,IAoEe;;AAAA,kCAnErB,IAmEqB;;AAAA,4CAjEX,IAiEW;;AAAA,kCAhErB,IAgEqB;;AAAA,wCA9Df;AACZ,WAAK,IADO;AAEZ,WAAK;AAFO,KA8De;;AAAA,0DAzDG,EAyDH;;AAI3B,SAAKF,MAAL,GAAcA,MAAd;;AAEA,QAAIE,MAAJ,EAAY;AACX,WAAKA,MAAL,GAAcA,MAAd;AACA,KAFD,MAGK;AACJ,WAAKA,MAAL,GAAc;AACbC,QAAAA,GAAG,EAAE,YAAY,CAChB,CAFY;AAGbC,QAAAA,KAAK,EAAE,YAAY,CAClB,CAJY;AAKbC,QAAAA,IAAI,EAAE,YAAY,CACjB,CANY;AAObC,QAAAA,IAAI,EAAE,YAAY,CACjB,CARY;AASbC,QAAAA,KAAK,EAAE,YAAY,CAClB;AAVY,OAAd;AAYA;;AAED,SAAKP,MAAL,CAAYQ,EAAZ,CAAe,OAAf,EAAyBC,GAAD,IAAS;AAEhC,WAAKP,MAAL,CAAYK,KAAZ,CAAkBE,GAAlB;AAEA,WAAKC,IAAL,CAAU,OAAV,EAAmBD,GAAnB;AAEA,KAND;AAQA,SAAKT,MAAL,CAAYQ,EAAZ,CAAe,QAAf,EAAyB,MAAMG,MAAN,IAAgB;AAExC,WAAKT,MAAL,CAAYE,KAAZ,CAAkB,QAAlB,EAA4BO,MAA5B,EAFwC,CAIxC;;AACA,YAAMC,OAAO,GAAG,KAAKZ,MAAL,CAAYa,KAAZ,GAAoBF,MAAM,CAACE,KAA3C;AAEA,WAAKX,MAAL,CAAYE,KAAZ,CAAkB,SAAlB,EAA6BQ,OAA7B;;AAEA,UAAIA,OAAJ,EAAa;AAEZ,YAAKA,OAAO,GAAG,KAAKZ,MAAL,CAAYc,iBAAvB,IAA8CH,MAAM,CAACE,KAAP,GAAe,KAAKb,MAAL,CAAYc,iBAA7E,EAAiG;AAEhG,eAAKZ,MAAL,CAAYE,KAAZ,CAAkB,cAAlB;;AAEA,cAAI,KAAKW,IAAT,EAAe;AACd,iBAAKL,IAAL,CAAU,UAAV,EAAsB,EAAE,GAAG,KAAKK;AAAV,aAAtB;AACA;;AAED,cAAI;AAEH,iBAAKA,IAAL,GAAY,IAAZ;;AACA,gBAAI,KAAKC,UAAT,EAAqB;AACpB,oBAAM,KAAKC,UAAL,EAAN;AACA;AAED,WAPD,CAOE,OAAOR,GAAP,EAAY;AAEb,iBAAKC,IAAL,CAAUD,GAAV;AAEA;AAED,SArBD,MAsBK,IAAKG,OAAO,GAAG,KAAKZ,MAAL,CAAYkB,mBAAvB,IAAgDP,MAAM,CAACE,KAAP,GAAe,KAAKb,MAAL,CAAYkB,mBAA/E,EAAqG;AAEzG,gBAAM1B,GAAG,GAAGmB,MAAM,CAACnB,GAAnB;AAEA,eAAKU,MAAL,CAAYE,KAAZ,CAAkB,eAAlB,EAAmCZ,GAAnC;AAEA,eAAKuB,IAAL,GAAY,EAAZ;;AAEA,cAAIvB,GAAJ,EAAS;AACR,iBAAKuB,IAAL,CAAUvB,GAAV,GAAgBA,GAAhB;AACA,iBAAKuB,IAAL,CAAUI,QAAV,GAAqBtC,MAAM,CAACU,mBAAP,CAA2BC,GAA3B,CAArB;AACA,iBAAKuB,IAAL,CAAUK,IAAV,GAAiB,KAAKL,IAAL,CAAUI,QAA3B;AACA;;AAED,cAAI;AAEH,kBAAM,KAAKE,OAAL,EAAN;;AAEA,gBAAI,CAAC,KAAKC,cAAV,EAA0B;AACzB,mBAAKZ,IAAL,CAAU,MAAV,EAAkB,EAAE,GAAG,KAAKK;AAAV,eAAlB;AACA;AACA;;AAED,iBAAKQ,SAAL;AAEA,WAXD,CAWE,OAAOd,GAAP,EAAY;AAEb,iBAAKC,IAAL,CAAUD,GAAV;AAEA;AAGD;AACD;AACD,KAnED;AAqEA,SAAKT,MAAL,CAAYQ,EAAZ,CAAe,KAAf,EAAsB,MAAM;AAE3B,WAAKN,MAAL,CAAYE,KAAZ,CAAkB,gBAAlB;AAEA,WAAKM,IAAL,CAAU,KAAV;AAEA,KAND;AAQA;;AAEDW,EAAAA,OAAO,CAACG,IAAI,GAAG5C,iBAAR,EAA2B;AAEjC,UAAM6C,KAAK,GAAG;AACb,OAAC9C,mBAAD,GAAuB,KAAKqB,MAAL,CAAY0B,kBADtB;AAEb,OAAC9C,iBAAD,GAAqB,KAAKoB,MAAL,CAAY2B;AAFpB,KAAd;;AAKA,QAAI,CAACF,KAAK,CAACD,IAAD,CAAV,EAAkB;AACjB,YAAM,IAAII,oBAAJ,CAAiB,cAAjB,EAAiC,cAAjC,CAAN;AACA;;AAED,SAAK1B,MAAL,CAAYE,KAAZ,CAAkB,mBAAlB,EAAuCoB,IAAvC,EAA6CC,KAAK,CAACD,IAAD,CAAlD;AAEA,WAAO,IAAIK,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AAEvC;AACA,WAAK/B,MAAL,CAAYqB,OAAZ,CAAoB;AACnBW,QAAAA,UAAU,EAAEP,KAAK,CAACD,IAAD,CADE,CAEnB;;AAFmB,OAApB,EAGG,CAACf,GAAD,EAAMwB,QAAN,KAAmB;AAErB,YAAIxB,GAAJ,EAAS;AACR,gBAAMF,KAAK,GAAG,IAAIqB,oBAAJ,CAAiBM,eAAjB,EAA0B,qCAA1B,EAAiEzB,GAAjE,CAAd;AACA,eAAKP,MAAL,CAAYK,KAAZ,CAAkBA,KAAlB;AACA,iBAAOwB,MAAM,CAACxB,KAAD,CAAb;AACA;;AAED,aAAKS,UAAL,GAAkB;AACjBI,UAAAA,IAAI,EAAEK,KAAK,CAACD,IAAD,CADM;AAEjBS,UAAAA,QAAQ,EAAEA;AAFO,SAAlB;AAKA,aAAK/B,MAAL,CAAYE,KAAZ,CAAkB,WAAlB,EAA+B,KAAKY,UAApC;AAEA,eAAOc,OAAO,CAAC,KAAKd,UAAN,CAAd;AAEA,OApBD;AAsBA,KAzBM,CAAP;AA2BA;;AAEDC,EAAAA,UAAU,GAAG;AAEZ,QAAI,CAAC,KAAKD,UAAV,EAAsB;AACrB,YAAM,IAAImB,uBAAJ,CAAoB,eAApB,EAAqC,qDAArC,CAAN;AACA;;AAED,SAAKjC,MAAL,CAAYE,KAAZ,CAAkB,sBAAlB,EAA0C,KAAKY,UAA/C;AAEA,WAAO,IAAIa,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AAEvC;AACA,WAAK/B,MAAL,CAAYiB,UAAZ,CAAuB,KAAKjB,MAAL,CAAYoC,gBAAnC,EAAsD3B,GAAD,IAAS;AAE7D,YAAIA,GAAJ,EAAS;AACR,gBAAMF,KAAK,GAAG,IAAI4B,uBAAJ,CAAoBD,eAApB,EAA6B,wCAA7B,EAAuEzB,GAAvE,CAAd;AACA,eAAKP,MAAL,CAAYK,KAAZ,CAAkBA,KAAlB;AACA,iBAAOwB,MAAM,CAACxB,KAAD,CAAb;AACA;;AAED,aAAKS,UAAL,GAAkB,IAAlB;AAEA,aAAKd,MAAL,CAAYE,KAAZ,CAAkB,cAAlB;AAEA,eAAO0B,OAAO,CAAC,IAAD,CAAd;AAEA,OAdD;AAgBA,KAnBM,CAAP;AAqBA;;AAEDO,EAAAA,QAAQ,CAACC,IAAD,EAAOC,iBAAP,EAA0B;AAEjC,QAAI,CAAC,KAAKxB,IAAN,IAAc,CAAC,KAAKC,UAAxB,EAAoC;AACnC,YAAM,IAAIwB,qBAAJ,CAAkBC,0BAAlB,EAAsC,kCAAtC,CAAN;AACA;;AAED,WAAO,IAAIZ,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AAEvC,WAAK7B,MAAL,CAAYE,KAAZ,CAAkB,cAAlB,EAAkCkC,IAAlC,EAAwCC,iBAAxC;AAEA,WAAKvC,MAAL,CAAYqC,QAAZ,CAAqBC,IAArB,EAA2BC,iBAA3B,EAA8C,KAAKvB,UAAL,CAAgBiB,QAA9D,EAAwE,CAACxB,GAAD,EAAMiC,QAAN,KAAmB;AAE1F,YAAIjC,GAAJ,EAAS;AACR,gBAAMF,KAAK,GAAG,IAAIiC,qBAAJ,CAAkBN,eAAlB,EAA2B,uCAA3B,EAAoEzB,GAApE,CAAd;AACA,iBAAOsB,MAAM,CAACxB,KAAD,CAAb;AACA;;AAED,aAAKL,MAAL,CAAYE,KAAZ,CAAkB,4BAAlB,EAAgDsC,QAAhD,EAA0DA,QAAQ,IAAIA,QAAQ,CAACtD,MAA/E;AAEA,eAAO0C,OAAO,CAACY,QAAD,CAAd;AAEA,OAXD;AAaA,KAjBM,CAAP;AAmBA;;AAEDC,EAAAA,OAAO,CAACL,IAAD,EAAOC,iBAAP,EAA0B;AAEhC,QAAI,CAAC,KAAKvB,UAAV,EAAsB;AACrB,YAAM,IAAI4B,oBAAJ,CAAiB,eAAjB,EAAkC,0BAAlC,CAAN;AACA;;AAED,WAAO,IAAIf,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AAEvC,WAAK7B,MAAL,CAAYE,KAAZ,CAAkB,sBAAlB,EAA0CkC,IAA1C,EAAgDC,iBAAhD;AAEA,WAAKvC,MAAL,CAAY2C,OAAZ,CAAoBL,IAApB,EAA0B,KAAKtC,MAAL,CAAY6C,iBAAtC,EAAyDN,iBAAzD,EAA4E,CAAC9B,GAAD,EAAMiC,QAAN,KAAmB;AAE9F,YAAIjC,GAAJ,EAAS;AACR,gBAAMF,KAAK,GAAG,IAAIqC,oBAAJ,CAAiBV,eAAjB,EAA0B,+CAA1B,EAA2EzB,GAA3E,CAAd;AACA,iBAAOsB,MAAM,CAACxB,KAAD,CAAb;AACA;;AAED,aAAKL,MAAL,CAAYE,KAAZ,CAAkB,2BAAlB,EAA+CsC,QAA/C,EAAyDA,QAAQ,IAAIA,QAAQ,CAACtD,MAA9E;AAEA,eAAO0C,OAAO,CAACY,QAAD,CAAd;AAEA,OAXD;AAaA,KAjBM,CAAP;AAmBA;;AAE0B,QAArBI,qBAAqB,CAACC,SAAD,EAAYC,GAAZ,EAAiB;AAE3C,QAAI,EAAED,SAAS,KAAK,CAAd,IAAmBA,SAAS,KAAK,CAAnC,CAAJ,EAA2C;AAC1C,YAAM,IAAIE,kCAAJ,CAA+B,oBAA/B,CAAN;AACA;;AAED,QAAI,CAAC/D,MAAM,CAACU,QAAP,CAAgBoD,GAAhB,CAAD,IAAyB,CAACE,KAAK,CAACC,OAAN,CAAcH,GAAd,CAA9B,EAAkD;AAEjD,UAAI,OAAOA,GAAP,KAAe,QAAnB,EAA6B;AAC5B,cAAM,IAAIC,kCAAJ,CACL,aADK,EAEL,kEAFK,CAAN;AAIA;;AAEDD,MAAAA,GAAG,GAAG9D,MAAM,CAACY,IAAP,CAAYkD,GAAZ,EAAiB,KAAjB,CAAN;AAEA;;AAED,QAAIA,GAAG,CAAC5D,MAAJ,KAAe,CAAnB,EAAsB;AACrB,YAAM,IAAI6D,kCAAJ,CAA+B,aAA/B,EAA8C,6BAA9C,CAAN;AACA,KArB0C,CAuB3C;;;AACA,UAAMG,MAAM,GAAGlE,MAAM,CAACY,IAAP,CAAY,CAC1B,IAD0B,EACpB;AACN,QAF0B,EAEpB;AACN,QAH0B,EAGpB;AACNiD,IAAAA,SAJ0B,EAIf;AACXC,IAAAA,GAAG,CAAC5D,MALsB,EAKd;AACZ,OAAG4D,GANuB,CAMlB;AANkB,KAAZ,CAAf;AASA,QAAIN,QAAQ,GAAG,IAAf;;AAEA,QAAI;AAEHA,MAAAA,QAAQ,GAAG,MAAM,KAAKL,QAAL,CAAce,MAAd,EAAsB,CAAtB,CAAjB;AAGA,KALD,CAKE,OAAO3C,GAAP,EAAY;AAEb,YAAM,IAAIwC,kCAAJ,CAA+B,IAA/B,EAAqC,IAArC,EAA2CxC,GAA3C,CAAN;AAEA;;AAED,UAAM4C,UAAU,GAAGX,QAAQ,CAACY,YAAT,CAAsB,CAAtB,CAAnB;;AAEA,QAAID,UAAU,KAAK,MAAnB,EAA2B;AAC1B,YAAM,IAAIJ,kCAAJ,CAA+BM,wBAA/B,EAAkD,0DAAyDF,UAAW,EAAtH,CAAN;AACA;;AAED,SAAKG,UAAL,CAAgBT,SAAhB,IAA6BC,GAA7B;AAEA,WAAOD,SAAP;AAEA,GA/WgC,CAiXjC;AACA;;;AACkB,QAAZU,YAAY,CAACC,WAAD,EAAcC,OAAd,EAAuBX,GAAvB,EAA4BY,QAAQ,GAAG,KAAvC,EAA8C;AAE/D,QAAIb,SAAS,GAAGc,MAAM,CAACC,IAAP,CAAY,KAAKN,UAAjB,EAA6BO,IAA7B,CAAkCC,CAAC,IAAI,KAAKR,UAAL,CAAgBQ,CAAhB,MAAuBhB,GAA9D,CAAhB,CAF+D,CAI/D;;AACA,QAAI,CAACD,SAAL,EAAgB;AAEf;AACA,UAAI,CAAC,KAAKkB,4BAAL,CAAkCjB,GAAlC,CAAL,EAA6C;AAE5C;AACAD,QAAAA,SAAS,GAAGc,MAAM,CAACC,IAAP,CAAY,KAAKN,UAAjB,EAA6B,CAA7B,CAAZ,CAH4C,CAK5C;;AACA,YAAI,KAAKA,UAAL,CAAgBT,SAAhB,MAA+B,IAAnC,EAAyC;AACxC;AACA,gBAAMmB,UAAU,GAAGL,MAAM,CAACC,IAAP,CAAY,KAAKN,UAAjB,EAA6BO,IAA7B,CAAkCC,CAAC,IAAI,KAAKR,UAAL,CAAgBQ,CAAhB,MAAuB,IAA9D,CAAnB,CAFwC,CAGxC;;AACA,cAAIE,UAAJ,EAAgB;AACfnB,YAAAA,SAAS,GAAGmB,UAAZ;AACA;AACD,SAb2C,CAe5C;;;AACA,aAAKD,4BAAL,CAAkCjB,GAAlC,IAAyC,KAAKF,qBAAL,CAA2BqB,QAAQ,CAACpB,SAAD,CAAnC,EAAgDC,GAAhD,CAAzC;AAEA;;AAED,UAAI;AACHD,QAAAA,SAAS,GAAG,MAAM,KAAKkB,4BAAL,CAAkCjB,GAAlC,CAAlB;AACA,OAFD,CAEE,OAAOvC,GAAP,EAAY;AACb,cAAM,IAAI2D,2BAAJ,CAAwB,oBAAxB,EAA8C,gDAA9C,EAAgG3D,GAAhG,CAAN;AACA,OAJD,SAIU;AACT;AACA;AACA,eAAO,KAAKwD,4BAAL,CAAkCjB,GAAlC,CAAP;AACA;AAED;;AAED,UAAMI,MAAM,GAAG,CAACQ,QAAD,GACd;AACA1E,IAAAA,MAAM,CAACY,IAAP,CAAY,CACX,IADW,EACL;AACN,QAFW,EAEL;AACN,QAHW,EAGL;AACN,QAJW,EAIL;AACN,QALW,EAKL;AACN;AACA,QAPW,EAOL;AACN,QARW,EAQL;AACN4D,IAAAA,WATW,EASE;AACbC,IAAAA,OAVW,EAUF;AACTZ,IAAAA,SAXW,CAWA;AAXA,KAAZ,CAFc,GAgBd;AACA7D,IAAAA,MAAM,CAACY,IAAP,CAAY,CACX,IADW,EACL;AACN,QAFW,EAEL;AACN,QAHW,EAGL;AACN4D,IAAAA,WAJW,EAIE;AACbC,IAAAA,OALW,EAKF;AACTZ,IAAAA,SANW,CAMA;AANA,KAAZ,CAjBD;AA2BA,QAAIL,QAAQ,GAAG,IAAf;;AAEA,QAAI;AAEHA,MAAAA,QAAQ,GAAG,MAAM,KAAKL,QAAL,CAAce,MAAd,EAAsB,CAAtB,CAAjB;AAEA,KAJD,CAIE,OAAO3C,GAAP,EAAY;AAEb,YAAM,IAAI2D,2BAAJ,CAAwB,IAAxB,EAA8B,IAA9B,EAAoC3D,GAApC,CAAN;AAEA;;AAED,UAAM4C,UAAU,GAAGX,QAAQ,CAACY,YAAT,CAAsB,CAAtB,CAAnB;;AAEA,QAAID,UAAU,KAAK,MAAnB,EAA2B;AAC1B,WAAKnD,MAAL,CAAYK,KAAZ,CAAkB,mDAAlB,EAAuE6C,MAAvE;AACA,YAAM,IAAIgB,2BAAJ,CAAwBb,wBAAxB,EAA2C,mDAAkDF,UAAU,CAACgB,QAAX,CAAoB,EAApB,CAAwB,EAArH,CAAN;AACA;;AAED,WAAO,IAAP;AAEA;;AAES,QAAJC,IAAI,CAACZ,WAAD,EAActE,MAAd,EAAsBmF,SAAS,GAAG,CAAlC,EAAqCC,UAAU,GAAG,EAAlD,EAAsDC,SAAS,GAAG,IAAlE,EAAwE;AAEjF,QAAI,CAAC,KAAK1D,IAAV,EAAgB;AACf,YAAM,IAAI2D,iBAAJ,CAAcjC,0BAAd,CAAN;AACA;;AAED,SAAKvC,MAAL,CAAYE,KAAZ,CAAkB,wBAAlB,EAA4C,KAAKW,IAAjD;;AAEA,QAAI3B,MAAM,GAAGoF,UAAb,EAAyB;AAExB,YAAMG,CAAC,GAAGC,IAAI,CAACC,IAAL,CAAUzF,MAAM,GAAGoF,UAAnB,CAAV;AAEA,YAAMM,QAAQ,GAAG,EAAjB;;AAEA,WAAK,IAAIzF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGsF,CAApB,EAAuBtF,CAAC,EAAxB,EAA4B;AAE3B,cAAM0F,KAAK,GAAGrB,WAAW,GAAKrE,CAAC,GAAGmF,UAAL,GAAmBD,SAAhD;AAEA,cAAMS,IAAI,GAAI,CAAC3F,CAAC,GAAG,CAAL,IAAUmF,UAAX,GAAyBpF,MAAzB,GAAkCoF,UAAlC,GAA+CpF,MAAM,GAAKC,CAAD,GAAMmF,UAA5E,CAJ2B,CAM3B;;AAEAM,QAAAA,QAAQ,CAACG,IAAT,CAAc,KAAKX,IAAL,CAAUS,KAAV,EAAiBC,IAAjB,EAAuBT,SAAvB,EAAkCC,UAAlC,EAA8CC,SAA9C,CAAd;AAEA;;AAED,aAAO5C,OAAO,CAACqD,GAAR,CAAYJ,QAAZ,EACLK,IADK,CACAC,MAAM,IAAI;AACf;AACA,eAAOlG,MAAM,CAACmG,MAAP,CAAcD,MAAd,EAAsBhG,MAAtB,CAAP;AACA,OAJK,CAAP;AAMA,KAhCgF,CAkCjF;;;AACA,UAAMgE,MAAM,GAAGlE,MAAM,CAACY,IAAP,CAAY,CAC1B2E,SAD0B,EACf;AACX,QAF0B,EAEpB;AACLf,IAAAA,WAAW,IAAI,CAAhB,GAAqB,IAHK,EAGC;AAC3BA,IAAAA,WAAW,GAAG,IAJY,EAIN;AACpBtE,IAAAA,MAL0B,CAKjB;AALiB,KAAZ,CAAf;AAQA,QAAIsD,QAAQ,GAAG,IAAf;;AAEA,QAAI;AAEHA,MAAAA,QAAQ,GAAG,MAAM,KAAKL,QAAL,CAAce,MAAd,EAAsBhE,MAAM,GAAG,CAA/B,CAAjB;AAEA,KAJD,CAIE,OAAOqB,GAAP,EAAY;AAEb,YAAM,IAAIiE,iBAAJ,CAAc,IAAd,EAAoB,IAApB,EAA0BjE,GAA1B,CAAN;AAEA;;AAED,QAAIiC,QAAQ,CAACtD,MAAT,GAAkB,CAAtB,EAAyB;AACxB,YAAM,IAAIsF,iBAAJ,CAAcnB,wBAAd,EAAiC,kDAAiDb,QAAQ,CAACtD,MAAO,uCAAlG,CAAN;AACA;;AAED,UAAMiE,UAAU,GAAGX,QAAQ,CAAC4C,KAAT,CAAe,CAAC,CAAhB,EAAmBhC,YAAnB,CAAgC,CAAhC,CAAnB;;AAEA,QAAID,UAAU,KAAK,MAAnB,EAA2B;AAC1B,YAAM,IAAIqB,iBAAJ,CAAcnB,wBAAd,EAAiC,yCAAwCF,UAAU,CAACgB,QAAX,CAAoB,EAApB,CAAwB,EAAjG,CAAN;AACA;;AAED,UAAM/B,IAAI,GAAGI,QAAQ,CAAC4C,KAAT,CAAe,CAAf,EAAkB,CAAC,CAAnB,CAAb;AAEA,SAAKpF,MAAL,CAAYE,KAAZ,CAAkB,MAAlB,EAA0BkC,IAA1B;AAEA,WAAOA,IAAP;AAEA;;AAEU,QAALiD,KAAK,CAAC7B,WAAD,EAAcpB,IAAd,EAAoBiC,SAAS,GAAG,CAAhC,EAAmC;AAE7C,QAAI,CAAC,KAAKxD,IAAV,EAAgB;AACf,YAAM,IAAIyE,kBAAJ,CAAe/C,0BAAf,CAAN;AACA;;AAED,SAAKvC,MAAL,CAAYE,KAAZ,CAAkB,sBAAlB,EAA0C,KAAKW,IAA/C;;AAEA,QAAIuB,IAAI,CAAClD,MAAL,GAAcmF,SAAd,IAA2BjC,IAAI,CAAClD,MAAL,GAAcmF,SAAd,KAA4B,CAA3D,EAA8D;AAC7D,YAAM,IAAIiB,kBAAJ,CAAe,qBAAf,EAAsC,oEAAtC,CAAN;AACA;;AAED,QAAIlD,IAAI,CAAClD,MAAL,GAAcmF,SAAlB,EAA6B;AAE5B,YAAMI,CAAC,GAAGrC,IAAI,CAAClD,MAAL,GAAcmF,SAAxB;AAEA,YAAMO,QAAQ,GAAG,EAAjB;;AAEA,WAAK,IAAIzF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGsF,CAApB,EAAuBtF,CAAC,EAAxB,EAA4B;AAE3B,cAAM0F,KAAK,GAAGrB,WAAW,GAAGrE,CAA5B;AAEA,cAAMoG,KAAK,GAAGpG,CAAC,GAAGkF,SAAlB;AACA,cAAMmB,GAAG,GAAG,CAACrG,CAAC,GAAG,CAAL,IAAUkF,SAAtB;AAEA,cAAMoB,IAAI,GAAGrD,IAAI,CAACgD,KAAL,CAAWG,KAAX,EAAkBC,GAAlB,CAAb,CAP2B,CAS3B;;AAEAZ,QAAAA,QAAQ,CAACG,IAAT,CAAc,KAAKM,KAAL,CAAWR,KAAX,EAAkBY,IAAlB,EAAwBpB,SAAxB,CAAd;AAEA;;AAED,aAAO1C,OAAO,CAACqD,GAAR,CAAYJ,QAAZ,EACLK,IADK,CACAC,MAAM,IAAI;AACf;AACA,eAAOA,MAAP;AACA,OAJK,CAAP;AAMA,KAvC4C,CAyC7C;;;AACA,UAAMQ,YAAY,GAAG1G,MAAM,CAACY,IAAP,CAAY,CAChC,IADgC,EAC1B;AACN,QAFgC,EAE1B;AACN,QAHgC,EAG1B;AACN4D,IAAAA,WAJgC,EAInB;AACba,IAAAA,SALgC,CAKrB;AALqB,KAAZ,CAArB;AAQA,UAAMnB,MAAM,GAAGlE,MAAM,CAACmG,MAAP,CAAc,CAACO,YAAD,EAAetD,IAAf,CAAd,CAAf;AAEA,QAAII,QAAQ,GAAG,IAAf;;AAEA,QAAI;AAEHA,MAAAA,QAAQ,GAAG,MAAM,KAAKL,QAAL,CAAce,MAAd,EAAsB,CAAtB,CAAjB;AAEA,KAJD,CAIE,OAAO3C,GAAP,EAAY;AAEb,YAAM,IAAI+E,kBAAJ,CAAe,IAAf,EAAqB,IAArB,EAA2B/E,GAA3B,CAAN;AAEA;;AAED,QAAIiC,QAAQ,CAACtD,MAAT,GAAkB,CAAtB,EAAyB;AACxB,YAAM,IAAIoG,kBAAJ,CAAejC,wBAAf,EAAkC,mDAAkDb,QAAQ,CAACtD,MAAO,uCAApG,CAAN;AACA;;AAED,UAAMiE,UAAU,GAAGX,QAAQ,CAAC4C,KAAT,CAAe,CAAC,CAAhB,EAAmBhC,YAAnB,CAAgC,CAAhC,CAAnB;;AAEA,QAAID,UAAU,KAAK,MAAnB,EAA2B;AAC1B,YAAM,IAAImC,kBAAJ,CAAejC,wBAAf,EAAkC,0CAAyCF,UAAU,CAACgB,QAAX,CAAoB,EAApB,CAAwB,EAAnG,CAAN;AACA;;AAED,WAAO,IAAP;AAEA;;AAED9C,EAAAA,SAAS,GAAG;AAEX,QAAI,CAAC,KAAKR,IAAV,EAAgB;AACf,aAAO,KAAP;AACA;;AAED,SAAKb,MAAL,CAAYE,KAAZ,CAAkB,cAAlB,EAAkC,KAAKW,IAAvC;;AAEA,YAAQ,KAAKA,IAAL,CAAUI,QAAlB;AAEC,WAAK5C,eAAL;AACC,eAAO,KAAKsH,sBAAL,EAAP;;AAED,WAAKrH,eAAL;AACC,eAAO,KAAKsH,sBAAL,EAAP;;AAED;AACC,eAAO,KAAKD,sBAAL,EAAP;AATF;AAaA,GAznBgC,CA2nBjC;;;AAC4B,QAAtBA,sBAAsB,GAAG;AAE9B,QAAI,CAAC,KAAK9E,IAAN,IAAc,CAAC,KAAKC,UAAxB,EAAoC;AACnC,aAAO,KAAP;AACA;;AAED,SAAKd,MAAL,CAAYE,KAAZ,CAAkB,4BAAlB,EAAgD,KAAKW,IAArD,EAN8B,CAQ9B;;AACA,UAAMqC,MAAM,GAAGlE,MAAM,CAACY,IAAP,CAAY,CAC1B,IAD0B,EACpB;AACN,QAF0B,EAEpB;AACN,QAH0B,EAGpB;AACN,QAJ0B,EAIpB;AACN,QAL0B,CAKpB;AALoB,KAAZ,CAAf;;AAQA,QAAI;AAEH,YAAM4C,QAAQ,GAAG,MAAM,KAAKL,QAAL,CAAce,MAAd,EAAsB,EAAtB,CAAvB;;AAEA,UAAIV,QAAQ,CAACtD,MAAT,GAAkB,CAAtB,EAAyB;AAExB,cAAMmB,KAAK,GAAG,IAAIwF,mBAAJ,CAAgB,kBAAhB,EAAqC,2BAA0BrD,QAAQ,CAACtD,MAAO,uCAA/E,CAAd;AACA,aAAKsB,IAAL,CAAU,OAAV,EAAmBH,KAAnB;AAEA;AAEA,OAXE,CAaH;;;AACA,YAAM8C,UAAU,GAAGX,QAAQ,CAAC4C,KAAT,CAAe,CAAC,CAAhB,EAAmBhC,YAAnB,CAAgC,CAAhC,CAAnB,CAdG,CAgBH;;AACA,UAAID,UAAU,KAAK,MAAnB,EAA2B;AAE1B,cAAM9C,KAAK,GAAG,IAAIwF,mBAAJ,CAAgBxC,wBAAhB,EAAkC,yBAAlC,CAAd;AACA,aAAK7C,IAAL,CAAU,OAAV,EAAmBH,KAAnB;AAEA;AACA,OAvBE,CAyBH;;;AACA,YAAMyF,GAAG,GAAGtD,QAAQ,CAAC4C,KAAT,CAAe,CAAf,EAAkB,CAAC,CAAnB,EAAsBjB,QAAtB,CAA+B,KAA/B,CAAZ,CA1BG,CA2BH;;AAEA,WAAKtD,IAAL,CAAUiF,GAAV,GAAgBA,GAAhB;AAEA,WAAKtF,IAAL,CAAU,MAAV,EAAkB,EAAE,GAAG,KAAKK;AAAV,OAAlB;AAGA,KAlCD,CAkCE,OAAON,GAAP,EAAY;AAEb,YAAMF,KAAK,GAAG,IAAIwF,mBAAJ,CAAgB,IAAhB,EAAsB,IAAtB,EAA4BtF,GAA5B,CAAd;AAEA,WAAKC,IAAL,CAAU,OAAV,EAAmBH,KAAnB;AAEA;AAED,GAvrBgC,CAyrBjC;;;AAC4B,QAAtBuF,sBAAsB,GAAG;AAE9B,QAAI,CAAC,KAAK/E,IAAN,IAAc,CAAC,KAAKC,UAAxB,EAAoC;AACnC,aAAO,KAAP;AACA;;AAED,SAAKd,MAAL,CAAYE,KAAZ,CAAkB,4BAAlB,EAAgD,KAAKW,IAArD;;AAEA,QAAI,CAAC,KAAKtB,GAAV,EAAe;AACd,WAAKiB,IAAL,CAAU,OAAV,EAAmB,IAAIb,KAAJ,CAAU,yDAAV,CAAnB;AACA;AACA;;AAED,UAAMJ,GAAG,GAAG,OAAO,KAAKA,GAAZ,KAAoB,UAApB,GAAiC,KAAKA,GAAL,CAAS,KAAKsB,IAAd,CAAjC,GAAuD,KAAKtB,GAAxE;;AAEA,QAAI,CAACP,MAAM,CAACU,QAAP,CAAgBH,GAAhB,CAAL,EAA2B;AAC1B,WAAKiB,IAAL,CAAU,OAAV,EAAmB,IAAIb,KAAJ,CAAU,oCAAV,CAAnB;AACA;AACA,KAlB6B,CAoB9B;AACA;;;AACA,UAAMuD,MAAM,GAAGlE,MAAM,CAACY,IAAP,CAAY,CAC1B,IAD0B,EACpB;AACN,QAF0B,EAEpB;AACN,QAH0B,EAGpB;AACN,QAJ0B,EAIpB;AACNL,IAAAA,GAAG,CAACL,MALsB,EAKd;AACZ,OAAGK,GANuB,EAMlB;AACR,QAP0B,CAOpB;AAPoB,KAAZ,CAAf;;AAUA,QAAI;AAEH,YAAMiD,QAAQ,GAAG,MAAM,KAAKL,QAAL,CAAce,MAAd,EAAsB,EAAtB,CAAvB;;AAEA,UAAIV,QAAQ,CAACtD,MAAT,KAAoB,CAApB,IAAyBsD,QAAQ,CAACY,YAAT,CAAsB,CAAtB,MAA6B,MAA1D,EAAkE;AAEjE,cAAM7C,GAAG,GAAG,IAAIZ,KAAJ,CAAW,mDAAkDJ,GAAG,CAAC4E,QAAJ,CAAa,KAAb,EAAoB4B,WAApB,EAAkC,GAA/F,CAAZ;AACA,aAAKvF,IAAL,CAAU,OAAV,EAAmBD,GAAnB;AAEA;AACA;;AAED,UAAIiC,QAAQ,CAACtD,MAAT,GAAkB,CAAtB,EAAyB;AAExB,cAAMqB,GAAG,GAAG,IAAIZ,KAAJ,CAAW,2BAA0B6C,QAAQ,CAACtD,MAAO,uCAArD,CAAZ;AACA,aAAKsB,IAAL,CAAU,OAAV,EAAmBD,GAAnB;AAEA;AACA,OAlBE,CAoBH;;;AACA,YAAM4C,UAAU,GAAGX,QAAQ,CAAC4C,KAAT,CAAe,CAAC,CAAhB,EAAmBhC,YAAnB,CAAgC,CAAhC,CAAnB,CArBG,CAuBH;;AACA,UAAID,UAAU,KAAK,MAAnB,EAA2B;AAE1B,cAAM5C,GAAG,GAAG,IAAIZ,KAAJ,CAAW,wBAAX,CAAZ;AACA,aAAKa,IAAL,CAAU,OAAV,EAAmBD,GAAnB;AAEA;AACA,OA9BE,CAgCH;;;AACA,YAAM6B,IAAI,GAAGI,QAAQ,CAAC4C,KAAT,CAAe,CAAf,EAAkB,CAAC,CAAnB,CAAb;AAEA,WAAKpF,MAAL,CAAYE,KAAZ,CAAkB,cAAlB,EAAkCkC,IAAlC;AAEA,WAAK5B,IAAL,CAAU,MAAV,EAAkB,EACjB,GAAG,KAAKK,IADS;AAEjBuB,QAAAA,IAAI,EAAEA;AAFW,OAAlB;AAKA,KA1CD,CA0CE,OAAO7B,GAAP,EAAY;AAEb,YAAMF,KAAK,GAAG,IAAIwF,mBAAJ,CAAgB,IAAhB,EAAsB,IAAtB,EAA4BtF,GAA5B,CAAd;AAEA,WAAKC,IAAL,CAAU,OAAV,EAAmBH,KAAnB;AAEA;AAED;;AAED2F,EAAAA,KAAK,GAAG;AACP,SAAKlG,MAAL,CAAYkG,KAAZ;AACA;;AAED7B,EAAAA,QAAQ,GAAG;AACV,WAAO,KAAKtE,IAAZ;AACA;;AApxBgC;;eAwxBnBlB,M",
      "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/",
      "sourcesContent": [
        "\"use strict\";\n\nimport EventEmitter from 'events';\nimport {\n\tConnectError,\n\tDisconnectError,\n\tTransmitError,\n\tControlError,\n\tAuthenticationError,\n\tLoadAuthenticationKeyError,\n\tReadError,\n\tWriteError,\n\tGetUIDError,\n\tCARD_NOT_CONNECTED,\n\tOPERATION_FAILED,\n\tUNKNOWN_ERROR,\n\tFAILURE,\n} from './errors';\n\n\nexport const TAG_ISO_14443_3 = 'TAG_ISO_14443_3'; // ISO/IEC 14443-3 tags\nexport const TAG_ISO_14443_4 = 'TAG_ISO_14443_4'; // ISO/IEC 14443-4 tags\n\nexport const KEY_TYPE_A = 0x60;\nexport const KEY_TYPE_B = 0x61;\n\nexport const CONNECT_MODE_DIRECT = 'CONNECT_MODE_DIRECT';\nexport const CONNECT_MODE_CARD = 'CONNECT_MODE_CARD';\n\n\nclass Reader extends EventEmitter {\n\n\treader = null;\n\tlogger = null;\n\n\tconnection = null;\n\tcard = null;\n\n\tautoProcessing = true;\n\t_aid = null;\n\n\tkeyStorage = {\n\t\t'0': null,\n\t\t'1': null,\n\t};\n\n\tpendingLoadAuthenticationKey = {};\n\n\t/**\n\t * Reverses a copy of a given buffer\n\t * Does NOT mutate the given buffer, returns a reversed COPY\n\t * For mutating reverse use native .reverse() method on a buffer instance\n\t * @param src {Buffer} a Buffer instance\n\t * @returns {Buffer}\n\t */\n\tstatic reverseBuffer(src) {\n\n\t\tconst buffer = Buffer.allocUnsafe(src.length);\n\n\t\tfor (let i = 0, j = src.length - 1; i <= j; ++i, --j) {\n\t\t\tbuffer[i] = src[j];\n\t\t\tbuffer[j] = src[i];\n\t\t}\n\n\t\treturn buffer;\n\n\t}\n\n\tstatic selectStandardByAtr(atr) {\n\n\t\t// TODO: better detecting card types\n\t\tif (atr[5] && atr[5] === 0x4f) {\n\t\t\treturn TAG_ISO_14443_3;\n\t\t}\n\t\telse {\n\t\t\treturn TAG_ISO_14443_4;\n\t\t}\n\n\t}\n\n\tget aid() {\n\t\treturn this._aid;\n\t}\n\n\tset aid(value) {\n\n\t\tif (typeof value === 'function' || Buffer.isBuffer(value)) {\n\t\t\tthis._aid = value;\n\t\t\treturn;\n\t\t}\n\n\t\tif (typeof value !== 'string') {\n\t\t\tthrow new Error(`AID must be a HEX string or an instance of Buffer or a function.`);\n\t\t}\n\n\t\tthis._aid = Buffer.from(value, 'hex');\n\n\t}\n\n\tget name() {\n\t\treturn this.reader.name;\n\t}\n\n\tconstructor(reader, logger) {\n\n\t\tsuper();\n\n\t\tthis.reader = reader;\n\n\t\tif (logger) {\n\t\t\tthis.logger = logger;\n\t\t}\n\t\telse {\n\t\t\tthis.logger = {\n\t\t\t\tlog: function () {\n\t\t\t\t},\n\t\t\t\tdebug: function () {\n\t\t\t\t},\n\t\t\t\tinfo: function () {\n\t\t\t\t},\n\t\t\t\twarn: function () {\n\t\t\t\t},\n\t\t\t\terror: function () {\n\t\t\t\t},\n\t\t\t};\n\t\t}\n\n\t\tthis.reader.on('error', (err) => {\n\n\t\t\tthis.logger.error(err);\n\n\t\t\tthis.emit('error', err);\n\n\t\t});\n\n\t\tthis.reader.on('status', async status => {\n\n\t\t\tthis.logger.debug('status', status);\n\n\t\t\t// check what has changed\n\t\t\tconst changes = this.reader.state ^ status.state;\n\n\t\t\tthis.logger.debug('changes', changes);\n\n\t\t\tif (changes) {\n\n\t\t\t\tif ((changes & this.reader.SCARD_STATE_EMPTY) && (status.state & this.reader.SCARD_STATE_EMPTY)) {\n\n\t\t\t\t\tthis.logger.debug('card removed');\n\n\t\t\t\t\tif (this.card) {\n\t\t\t\t\t\tthis.emit('card.off', { ...this.card });\n\t\t\t\t\t}\n\n\t\t\t\t\ttry {\n\n\t\t\t\t\t\tthis.card = null;\n\t\t\t\t\t\tif (this.connection) {\n\t\t\t\t\t\t\tawait this.disconnect();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} catch (err) {\n\n\t\t\t\t\t\tthis.emit(err);\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\telse if ((changes & this.reader.SCARD_STATE_PRESENT) && (status.state & this.reader.SCARD_STATE_PRESENT)) {\n\n\t\t\t\t\tconst atr = status.atr;\n\n\t\t\t\t\tthis.logger.debug('card inserted', atr);\n\n\t\t\t\t\tthis.card = {};\n\n\t\t\t\t\tif (atr) {\n\t\t\t\t\t\tthis.card.atr = atr;\n\t\t\t\t\t\tthis.card.standard = Reader.selectStandardByAtr(atr);\n\t\t\t\t\t\tthis.card.type = this.card.standard;\n\t\t\t\t\t}\n\n\t\t\t\t\ttry {\n\n\t\t\t\t\t\tawait this.connect();\n\n\t\t\t\t\t\tif (!this.autoProcessing) {\n\t\t\t\t\t\t\tthis.emit('card', { ...this.card });\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.handleTag();\n\n\t\t\t\t\t} catch (err) {\n\n\t\t\t\t\t\tthis.emit(err);\n\n\t\t\t\t\t}\n\n\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis.reader.on('end', () => {\n\n\t\t\tthis.logger.debug('reader removed');\n\n\t\t\tthis.emit('end');\n\n\t\t});\n\n\t}\n\n\tconnect(mode = CONNECT_MODE_CARD) {\n\n\t\tconst modes = {\n\t\t\t[CONNECT_MODE_DIRECT]: this.reader.SCARD_SHARE_DIRECT,\n\t\t\t[CONNECT_MODE_CARD]: this.reader.SCARD_SHARE_SHARED,\n\t\t};\n\n\t\tif (!modes[mode]) {\n\t\t\tthrow new ConnectError('invalid_mode', 'Invalid mode')\n\t\t}\n\n\t\tthis.logger.debug('trying to connect', mode, modes[mode]);\n\n\t\treturn new Promise((resolve, reject) => {\n\n\t\t\t// connect card\n\t\t\tthis.reader.connect({\n\t\t\t\tshare_mode: modes[mode],\n\t\t\t\t//protocol: this.reader.SCARD_PROTOCOL_UNDEFINED\n\t\t\t}, (err, protocol) => {\n\n\t\t\t\tif (err) {\n\t\t\t\t\tconst error = new ConnectError(FAILURE, 'An error occurred while connecting.', err);\n\t\t\t\t\tthis.logger.error(error);\n\t\t\t\t\treturn reject(error);\n\t\t\t\t}\n\n\t\t\t\tthis.connection = {\n\t\t\t\t\ttype: modes[mode],\n\t\t\t\t\tprotocol: protocol,\n\t\t\t\t};\n\n\t\t\t\tthis.logger.debug('connected', this.connection);\n\n\t\t\t\treturn resolve(this.connection);\n\n\t\t\t});\n\n\t\t});\n\n\t}\n\n\tdisconnect() {\n\n\t\tif (!this.connection) {\n\t\t\tthrow new DisconnectError('not_connected', 'Reader in not connected. No need for disconnecting.')\n\t\t}\n\n\t\tthis.logger.debug('trying to disconnect', this.connection);\n\n\t\treturn new Promise((resolve, reject) => {\n\n\t\t\t// disconnect removed\n\t\t\tthis.reader.disconnect(this.reader.SCARD_LEAVE_CARD, (err) => {\n\n\t\t\t\tif (err) {\n\t\t\t\t\tconst error = new DisconnectError(FAILURE, 'An error occurred while disconnecting.', err);\n\t\t\t\t\tthis.logger.error(error);\n\t\t\t\t\treturn reject(error);\n\t\t\t\t}\n\n\t\t\t\tthis.connection = null;\n\n\t\t\t\tthis.logger.debug('disconnected');\n\n\t\t\t\treturn resolve(true);\n\n\t\t\t});\n\n\t\t});\n\n\t}\n\n\ttransmit(data, responseMaxLength) {\n\n\t\tif (!this.card || !this.connection) {\n\t\t\tthrow new TransmitError(CARD_NOT_CONNECTED, 'No card or connection available.');\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => {\n\n\t\t\tthis.logger.debug('transmitting', data, responseMaxLength);\n\n\t\t\tthis.reader.transmit(data, responseMaxLength, this.connection.protocol, (err, response) => {\n\n\t\t\t\tif (err) {\n\t\t\t\t\tconst error = new TransmitError(FAILURE, 'An error occurred while transmitting.', err);\n\t\t\t\t\treturn reject(error);\n\t\t\t\t}\n\n\t\t\t\tthis.logger.debug('transmit response received', response, response && response.length);\n\n\t\t\t\treturn resolve(response);\n\n\t\t\t});\n\n\t\t});\n\n\t}\n\n\tcontrol(data, responseMaxLength) {\n\n\t\tif (!this.connection) {\n\t\t\tthrow new ControlError('not_connected', 'No connection available.');\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => {\n\n\t\t\tthis.logger.debug('transmitting control', data, responseMaxLength);\n\n\t\t\tthis.reader.control(data, this.reader.IOCTL_CCID_ESCAPE, responseMaxLength, (err, response) => {\n\n\t\t\t\tif (err) {\n\t\t\t\t\tconst error = new ControlError(FAILURE, 'An error occurred while transmitting control.', err);\n\t\t\t\t\treturn reject(error);\n\t\t\t\t}\n\n\t\t\t\tthis.logger.debug('control response received', response, response && response.length);\n\n\t\t\t\treturn resolve(response);\n\n\t\t\t});\n\n\t\t});\n\n\t}\n\n\tasync loadAuthenticationKey(keyNumber, key) {\n\n\t\tif (!(keyNumber === 0 || keyNumber === 1)) {\n\t\t\tthrow new LoadAuthenticationKeyError('invalid_key_number');\n\t\t}\n\n\t\tif (!Buffer.isBuffer(key) && !Array.isArray(key)) {\n\n\t\t\tif (typeof key !== 'string') {\n\t\t\t\tthrow new LoadAuthenticationKeyError(\n\t\t\t\t\t'invalid_key',\n\t\t\t\t\t'Key must an instance of Buffer or an array of bytes or a string.',\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tkey = Buffer.from(key, 'hex');\n\n\t\t}\n\n\t\tif (key.length !== 6) {\n\t\t\tthrow new LoadAuthenticationKeyError('invalid_key', 'Key length must be 6 bytes.');\n\t\t}\n\n\t\t// CMD: Load Authentication Keys\n\t\tconst packet = Buffer.from([\n\t\t\t0xff, // Class\n\t\t\t0x82, // INS\n\t\t\t0x00, // P1: Key Structure (0x00 = Key is loaded into the reader volatile memory.)\n\t\t\tkeyNumber, // P2: Key Number (00h ~ 01h = Key Location. The keys will disappear once the reader is disconnected from the PC)\n\t\t\tkey.length, // Lc: Length of the key (6)\n\t\t\t...key, // Data In: Key (6 bytes)\n\t\t]);\n\n\t\tlet response = null;\n\n\t\ttry {\n\n\t\t\tresponse = await this.transmit(packet, 2);\n\n\n\t\t} catch (err) {\n\n\t\t\tthrow new LoadAuthenticationKeyError(null, null, err);\n\n\t\t}\n\n\t\tconst statusCode = response.readUInt16BE(0);\n\n\t\tif (statusCode !== 0x9000) {\n\t\t\tthrow new LoadAuthenticationKeyError(OPERATION_FAILED, `Load authentication key operation failed: Status code: ${statusCode}`);\n\t\t}\n\n\t\tthis.keyStorage[keyNumber] = key;\n\n\t\treturn keyNumber;\n\n\t}\n\n\t// for PC/SC V2.01 use obsolete = true\n\t// for PC/SC V2.07 use obsolete = false [default]\n\tasync authenticate(blockNumber, keyType, key, obsolete = false) {\n\n\t\tlet keyNumber = Object.keys(this.keyStorage).find(n => this.keyStorage[n] === key);\n\n\t\t// key is not in the storage\n\t\tif (!keyNumber) {\n\n\t\t\t// If there isn't already an authentication process happening for this key, start it\n\t\t\tif (!this.pendingLoadAuthenticationKey[key]) {\n\n\t\t\t\t// set key number to first\n\t\t\t\tkeyNumber = Object.keys(this.keyStorage)[0];\n\n\t\t\t\t// if this number is not free\n\t\t\t\tif (this.keyStorage[keyNumber] !== null) {\n\t\t\t\t\t// try to find any free number\n\t\t\t\t\tconst freeNumber = Object.keys(this.keyStorage).find(n => this.keyStorage[n] === null);\n\t\t\t\t\t// if we find, we use it, otherwise the first will be used and rewritten\n\t\t\t\t\tif (freeNumber) {\n\t\t\t\t\t\tkeyNumber = freeNumber;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Store the authentication promise in case other blocks are in process of authentication\n\t\t\t\tthis.pendingLoadAuthenticationKey[key] = this.loadAuthenticationKey(parseInt(keyNumber), key);\n\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tkeyNumber = await this.pendingLoadAuthenticationKey[key];\n\t\t\t} catch (err) {\n\t\t\t\tthrow new AuthenticationError('unable_to_load_key', 'Could not load authentication key into reader.', err);\n\t\t\t} finally {\n\t\t\t\t// remove the loadAuthenticationKey Promise from pendingLoadAuthenticationKey\n\t\t\t\t// as it is already resolved or rejected at this point\n\t\t\t\tdelete this.pendingLoadAuthenticationKey[key];\n\t\t\t}\n\n\t\t}\n\n\t\tconst packet = !obsolete ? (\n\t\t\t// CMD: Authentication\n\t\t\tBuffer.from([\n\t\t\t\t0xff, // Class\n\t\t\t\t0x86, // INS\n\t\t\t\t0x00, // P1\n\t\t\t\t0x00, // P2\n\t\t\t\t0x05, // Lc\n\t\t\t\t// Data In: Authenticate Data Bytes (5 bytes)\n\t\t\t\t0x01, // Byte 1: Version\n\t\t\t\t0x00, // Byte 2\n\t\t\t\tblockNumber, // Byte 3: Block Number\n\t\t\t\tkeyType, // Byte 4: Key Type\n\t\t\t\tkeyNumber, // Byte 5: Key Number\n\t\t\t])\n\t\t) : (\n\t\t\t// CMD: Authentication (obsolete)\n\t\t\tBuffer.from([\n\t\t\t\t0xff, // Class\n\t\t\t\t0x88, // INS\n\t\t\t\t0x00, // P1\n\t\t\t\tblockNumber, // P2: Block Number\n\t\t\t\tkeyType, // P3: Key Type\n\t\t\t\tkeyNumber, // Data In: Key Number\n\t\t\t])\n\t\t);\n\n\t\tlet response = null;\n\n\t\ttry {\n\n\t\t\tresponse = await this.transmit(packet, 2);\n\n\t\t} catch (err) {\n\n\t\t\tthrow new AuthenticationError(null, null, err);\n\n\t\t}\n\n\t\tconst statusCode = response.readUInt16BE(0);\n\n\t\tif (statusCode !== 0x9000) {\n\t\t\tthis.logger.error('[authentication operation failed][request packet]', packet);\n\t\t\tthrow new AuthenticationError(OPERATION_FAILED, `Authentication operation failed: Status code: 0x${statusCode.toString(16)}`);\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tasync read(blockNumber, length, blockSize = 4, packetSize = 16, readClass = 0xff) {\n\n\t\tif (!this.card) {\n\t\t\tthrow new ReadError(CARD_NOT_CONNECTED);\n\t\t}\n\n\t\tthis.logger.debug('reading data from card', this.card);\n\n\t\tif (length > packetSize) {\n\n\t\t\tconst p = Math.ceil(length / packetSize);\n\n\t\t\tconst commands = [];\n\n\t\t\tfor (let i = 0; i < p; i++) {\n\n\t\t\t\tconst block = blockNumber + ((i * packetSize) / blockSize);\n\n\t\t\t\tconst size = ((i + 1) * packetSize) < length ? packetSize : length - ((i) * packetSize);\n\n\t\t\t\t// console.log(i, block, size);\n\n\t\t\t\tcommands.push(this.read(block, size, blockSize, packetSize, readClass));\n\n\t\t\t}\n\n\t\t\treturn Promise.all(commands)\n\t\t\t\t.then(values => {\n\t\t\t\t\t// console.log(values);\n\t\t\t\t\treturn Buffer.concat(values, length);\n\t\t\t\t});\n\n\t\t}\n\n\t\t// APDU CMD: Read Binary Blocks\n\t\tconst packet = Buffer.from([\n\t\t\treadClass, // Class\n\t\t\t0xb0, // Ins\n\t\t\t(blockNumber >> 8) & 0xFF, // P1\n\t\t\tblockNumber & 0xFF, // P2: Block Number\n\t\t\tlength,  // Le: Number of Bytes to Read (Maximum 16 bytes)\n\t\t]);\n\n\t\tlet response = null;\n\n\t\ttry {\n\n\t\t\tresponse = await this.transmit(packet, length + 2);\n\n\t\t} catch (err) {\n\n\t\t\tthrow new ReadError(null, null, err);\n\n\t\t}\n\n\t\tif (response.length < 2) {\n\t\t\tthrow new ReadError(OPERATION_FAILED, `Read operation failed: Invalid response length ${response.length}. Expected minimal length is 2 bytes.`);\n\t\t}\n\n\t\tconst statusCode = response.slice(-2).readUInt16BE(0);\n\n\t\tif (statusCode !== 0x9000) {\n\t\t\tthrow new ReadError(OPERATION_FAILED, `Read operation failed: Status code: 0x${statusCode.toString(16)}`);\n\t\t}\n\n\t\tconst data = response.slice(0, -2);\n\n\t\tthis.logger.debug('data', data);\n\n\t\treturn data;\n\n\t}\n\n\tasync write(blockNumber, data, blockSize = 4) {\n\n\t\tif (!this.card) {\n\t\t\tthrow new WriteError(CARD_NOT_CONNECTED);\n\t\t}\n\n\t\tthis.logger.debug('writing data to card', this.card);\n\n\t\tif (data.length < blockSize || data.length % blockSize !== 0) {\n\t\t\tthrow new WriteError('invalid_data_length', 'Invalid data length. You can only update the entire data block(s).');\n\t\t}\n\n\t\tif (data.length > blockSize) {\n\n\t\t\tconst p = data.length / blockSize;\n\n\t\t\tconst commands = [];\n\n\t\t\tfor (let i = 0; i < p; i++) {\n\n\t\t\t\tconst block = blockNumber + i;\n\n\t\t\t\tconst start = i * blockSize;\n\t\t\t\tconst end = (i + 1) * blockSize;\n\n\t\t\t\tconst part = data.slice(start, end);\n\n\t\t\t\t// console.log(i, block, start, end, part);\n\n\t\t\t\tcommands.push(this.write(block, part, blockSize));\n\n\t\t\t}\n\n\t\t\treturn Promise.all(commands)\n\t\t\t\t.then(values => {\n\t\t\t\t\t// console.log(values);\n\t\t\t\t\treturn values;\n\t\t\t\t});\n\n\t\t}\n\n\t\t// APDU CMD: Update Binary Block\n\t\tconst packetHeader = Buffer.from([\n\t\t\t0xff, // Class\n\t\t\t0xd6, // Ins\n\t\t\t0x00, // P1\n\t\t\tblockNumber, // P2: Block Number\n\t\t\tblockSize, // Le: Number of Bytes to Update\n\t\t]);\n\n\t\tconst packet = Buffer.concat([packetHeader, data]);\n\n\t\tlet response = null;\n\n\t\ttry {\n\n\t\t\tresponse = await this.transmit(packet, 2);\n\n\t\t} catch (err) {\n\n\t\t\tthrow new WriteError(null, null, err);\n\n\t\t}\n\n\t\tif (response.length < 2) {\n\t\t\tthrow new WriteError(OPERATION_FAILED, `Write operation failed: Invalid response length ${response.length}. Expected minimal length is 2 bytes.`);\n\t\t}\n\n\t\tconst statusCode = response.slice(-2).readUInt16BE(0);\n\n\t\tif (statusCode !== 0x9000) {\n\t\t\tthrow new WriteError(OPERATION_FAILED, `Write operation failed: Status code: 0x${statusCode.toString(16)}`);\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\thandleTag() {\n\n\t\tif (!this.card) {\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.logger.debug('handling tag', this.card);\n\n\t\tswitch (this.card.standard) {\n\n\t\t\tcase TAG_ISO_14443_3:\n\t\t\t\treturn this.handle_Iso_14443_3_Tag();\n\n\t\t\tcase TAG_ISO_14443_4:\n\t\t\t\treturn this.handle_Iso_14443_4_Tag();\n\n\t\t\tdefault:\n\t\t\t\treturn this.handle_Iso_14443_3_Tag();\n\n\t\t}\n\n\t}\n\n\t// TODO: improve error handling and debugging\n\tasync handle_Iso_14443_3_Tag() {\n\n\t\tif (!this.card || !this.connection) {\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.logger.debug('processing ISO 14443-3 tag', this.card);\n\n\t\t// APDU CMD: Get Data\n\t\tconst packet = Buffer.from([\n\t\t\t0xff, // Class\n\t\t\t0xca, // INS\n\t\t\t0x00, // P1: Get current card UID\n\t\t\t0x00, // P2\n\t\t\t0x00, // Le: Full Length of UID\n\t\t]);\n\n\t\ttry {\n\n\t\t\tconst response = await this.transmit(packet, 12);\n\n\t\t\tif (response.length < 2) {\n\n\t\t\t\tconst error = new GetUIDError('invalid_response', `Invalid response length ${response.length}. Expected minimal length is 2 bytes.`);\n\t\t\t\tthis.emit('error', error);\n\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\t// last 2 bytes are the status code\n\t\t\tconst statusCode = response.slice(-2).readUInt16BE(0);\n\n\t\t\t// an error occurred\n\t\t\tif (statusCode !== 0x9000) {\n\n\t\t\t\tconst error = new GetUIDError(OPERATION_FAILED, 'Could not get card UID.');\n\t\t\t\tthis.emit('error', error);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// strip out the status code (the rest is UID)\n\t\t\tconst uid = response.slice(0, -2).toString('hex');\n\t\t\t// const uidReverse = Reader.reverseBuffer(response.slice(0, -2)).toString('hex');\n\n\t\t\tthis.card.uid = uid;\n\n\t\t\tthis.emit('card', { ...this.card });\n\n\n\t\t} catch (err) {\n\n\t\t\tconst error = new GetUIDError(null, null, err);\n\n\t\t\tthis.emit('error', error);\n\n\t\t}\n\n\t}\n\n\t// TODO: improve error handling and debugging\n\tasync handle_Iso_14443_4_Tag() {\n\n\t\tif (!this.card || !this.connection) {\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.logger.debug('processing ISO 14443-4 tag', this.card);\n\n\t\tif (!this.aid) {\n\t\t\tthis.emit('error', new Error('Cannot process ISO 14443-4 tag because AID was not set.'));\n\t\t\treturn;\n\t\t}\n\n\t\tconst aid = typeof this.aid === 'function' ? this.aid(this.card) : this.aid;\n\n\t\tif (!Buffer.isBuffer(aid)) {\n\t\t\tthis.emit('error', new Error('AID must be an instance of Buffer.'));\n\t\t\treturn;\n\t\t}\n\n\t\t// APDU CMD: SELECT FILE\n\t\t// see http://cardwerk.com/smart-card-standard-iso7816-4-section-6-basic-interindustry-commands/#chap6_11_3\n\t\tconst packet = Buffer.from([\n\t\t\t0x00, // Class\n\t\t\t0xa4, // INS\n\t\t\t0x04, // P1\n\t\t\t0x00, // P2\n\t\t\taid.length, // Lc\n\t\t\t...aid, // AID\n\t\t\t0x00, // Le\n\t\t]);\n\n\t\ttry {\n\n\t\t\tconst response = await this.transmit(packet, 40);\n\n\t\t\tif (response.length === 2 && response.readUInt16BE(0) === 0x6a82) {\n\n\t\t\t\tconst err = new Error(`Not found response. Tag not compatible with AID ${aid.toString('hex').toUpperCase()}.`);\n\t\t\t\tthis.emit('error', err);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (response.length < 2) {\n\n\t\t\t\tconst err = new Error(`Invalid response length ${response.length}. Expected minimal length is 2 bytes.`);\n\t\t\t\tthis.emit('error', err);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// another possibility const statusCode = parseInt(response.slice(-2).toString('hex'), 16)\n\t\t\tconst statusCode = response.slice(-2).readUInt16BE(0);\n\n\t\t\t// an error occurred\n\t\t\tif (statusCode !== 0x9000) {\n\n\t\t\t\tconst err = new Error(`Response status error.`);\n\t\t\t\tthis.emit('error', err);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// strip out the status code\n\t\t\tconst data = response.slice(0, -2);\n\n\t\t\tthis.logger.debug('Data cropped', data);\n\n\t\t\tthis.emit('card', {\n\t\t\t\t...this.card,\n\t\t\t\tdata: data,\n\t\t\t});\n\n\t\t} catch (err) {\n\n\t\t\tconst error = new GetUIDError(null, null, err);\n\n\t\t\tthis.emit('error', error);\n\n\t\t}\n\n\t}\n\n\tclose() {\n\t\tthis.reader.close();\n\t}\n\n\ttoString() {\n\t\treturn this.name;\n\t}\n\n}\n\nexport default Reader;\n"
      ]
    },
    "sourceType": "script",
    "mtime": 1662229648499
  },
  "{\"sourceRoot\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc\",\"filename\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/my-nfc-emitter.js\",\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{}},{\"key\":\"proposal-class-properties\",\"visitor\":{\"PrivateName\":{\"enter\":[null]},\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{}}],\"presets\":[]}:7.12.17": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/",
      "caller": {
        "name": "@babel/register"
      },
      "cwd": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc",
      "filename": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/my-nfc-emitter.js",
      "cloneInputAst": true,
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {}
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {}
        },
        {
          "key": "proposal-class-properties",
          "visitor": {
            "PrivateName": {
              "enter": [
                null
              ]
            },
            "ExportDefaultDeclaration": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true,
            "ClassExpression": {
              "enter": [
                null
              ]
            },
            "ClassDeclaration": {
              "enter": [
                null
              ]
            }
          },
          "options": {}
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/my-nfc-emitter.js",
        "plugins": [
          "objectRestSpread",
          "classProperties",
          "classPrivateProperties"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/my-nfc-emitter.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/",
        "sourceFileName": "my-nfc-emitter.js"
      }
    },
    "ast": null,
    "code": "\"use strict\"; // #############\n// Logs cards' uid\n// #############\n\nvar _index = require(\"../src/index\");\n\nvar _withCsv = require(\"with-csv\");\n\n// Server setup\nvar express = require('express');\n\nvar app = express();\nvar server = app.listen(3000);\napp.use(express.static('../../app'));\nconsole.log(\"Server is running\"); //\n// Setup socket\n\nvar socket = require('socket.io');\n\nvar io = socket(server);\nio.sockets.on('connection', NewConnection); /// Handle connection\n\nfunction NewConnection(socket) {\n  console.log(\"New connection connected: \" + socket.id); //console.log(socket);f\n  // Receive from client\n  // socket.on('fullscreen', handleEvent);\n  // function handleEvent(data){\n  //     console.log(data);\n  // }\n} //\n\n\nconst nfc = new _index.NFC();\nnfc.on('reader', reader => {\n  console.log(reader.name + ' reader attached, waiting for cards ...');\n  reader.on('card', card => {\n    //socket.broadcast.emit('card_id', card.uid); // emit to specifi socket\n    io.sockets.emit('card_id', card.uid); // emit globally\n    // Handle file\n\n    var dateTime = require('node-datetime');\n\n    var dt = dateTime.create(); //var timeFormatted = dt.format('Ymd_HMS');\n\n    var timeFormatted = dt.format('HMS'); //io.sockets.emit('card_id', timeFormatted); // emit globally\n    // ////////////////////////////\n    // // read csv record\n    // ///////////////////////////\n\n    let fs = require('fs'); // const records = withCSV('scan-record.csv')\n    //     .query(['id'])\n    //     .map(row => row.id)\n    //     .includes(card.uid);\n    // console.log(records);\n    //csvData = 'Time, ID\\n1111, 2222\\n3333, 4444\\n';\n    // let lookupCSV = require('lookup-csv');\n    // const lookupTable = lookupCSV('scan-record.csv', ['ID']);\n    // var matchingRows;\n    // Get rows matching lookup value\n    //matchingRows = lookupTable.get(card.uid);\n    //console.log(matchingRows);\n    // var csvData = require(\"fs\").readFileSync(\"scan-record.csv\", \"utf8\")\n    // console.log(csvData);\n    // console.log(\"Found: \" + findInCSV(csvData, card.uid, 'ID'));\n    //console.log(csvData.filter(data => data.ID === card.uid)[0].ID);\n    //function findEmailByName(name) {\n    //    return csvData.filter(data => data.Name === name)[0].Email\n    //}\n    // Parse CSV string\n    // var data = Papa.parse(csv);\n    // // Parse local CSV file\n    // Papa.parse(file, {\n    //     complete: function(results) {\n    //         console.log(\"Finished:\", results.data);\n    //     }\n    // });\n    //////////////////////\n    // write csv record\n    ////////////////////////\n\n\n    var scanData = [[timeFormatted, card.uid]];\n    const stream = fs.createWriteStream(\"../../app/scan-record.csv\", {\n      flags: 'a'\n    });\n\n    for (let i of scanData) {\n      stream.write(i.join(\",\") + \"\\r\\n\");\n    }\n\n    stream.end();\n    console.log(\"Record written! \" + card.uid);\n  });\n  reader.on('error', err => {\n    console.error('reader error', err);\n  });\n  reader.on('end', () => {\n    console.log(reader.name + ' reader disconnected.');\n  });\n});\nnfc.on('error', err => {\n  console.error(err);\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm15LW5mYy1lbWl0dGVyLmpzIl0sIm5hbWVzIjpbImV4cHJlc3MiLCJyZXF1aXJlIiwiYXBwIiwic2VydmVyIiwibGlzdGVuIiwidXNlIiwic3RhdGljIiwiY29uc29sZSIsImxvZyIsInNvY2tldCIsImlvIiwic29ja2V0cyIsIm9uIiwiTmV3Q29ubmVjdGlvbiIsImlkIiwibmZjIiwiTkZDIiwicmVhZGVyIiwibmFtZSIsImNhcmQiLCJlbWl0IiwidWlkIiwiZGF0ZVRpbWUiLCJkdCIsImNyZWF0ZSIsInRpbWVGb3JtYXR0ZWQiLCJmb3JtYXQiLCJmcyIsInNjYW5EYXRhIiwic3RyZWFtIiwiY3JlYXRlV3JpdGVTdHJlYW0iLCJmbGFncyIsImkiLCJ3cml0ZSIsImpvaW4iLCJlbmQiLCJlcnIiLCJlcnJvciJdLCJtYXBwaW5ncyI6IkFBQUEsYSxDQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFDQTs7QUFFQTtBQUNBLElBQUlBLE9BQU8sR0FBR0MsT0FBTyxDQUFDLFNBQUQsQ0FBckI7O0FBQ0EsSUFBSUMsR0FBRyxHQUFHRixPQUFPLEVBQWpCO0FBQ0EsSUFBSUcsTUFBTSxHQUFHRCxHQUFHLENBQUNFLE1BQUosQ0FBVyxJQUFYLENBQWI7QUFFQUYsR0FBRyxDQUFDRyxHQUFKLENBQVFMLE9BQU8sQ0FBQ00sTUFBUixDQUFlLFdBQWYsQ0FBUjtBQUNBQyxPQUFPLENBQUNDLEdBQVIsQ0FBWSxtQkFBWixFLENBQ0E7QUFFQTs7QUFDQSxJQUFJQyxNQUFNLEdBQUdSLE9BQU8sQ0FBQyxXQUFELENBQXBCOztBQUNBLElBQUlTLEVBQUUsR0FBR0QsTUFBTSxDQUFDTixNQUFELENBQWY7QUFDQU8sRUFBRSxDQUFDQyxPQUFILENBQVdDLEVBQVgsQ0FBYyxZQUFkLEVBQTRCQyxhQUE1QixFLENBRUE7O0FBQ0EsU0FBU0EsYUFBVCxDQUF1QkosTUFBdkIsRUFBOEI7QUFDMUJGLEVBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLCtCQUErQkMsTUFBTSxDQUFDSyxFQUFsRCxFQUQwQixDQUUxQjtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDSCxDLENBQ0Q7OztBQUtBLE1BQU1DLEdBQUcsR0FBRyxJQUFJQyxVQUFKLEVBQVo7QUFFQUQsR0FBRyxDQUFDSCxFQUFKLENBQU8sUUFBUCxFQUFpQkssTUFBTSxJQUFJO0FBRTFCVixFQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBWVMsTUFBTSxDQUFDQyxJQUFQLEdBQWMseUNBQTFCO0FBRUFELEVBQUFBLE1BQU0sQ0FBQ0wsRUFBUCxDQUFVLE1BQVYsRUFBa0JPLElBQUksSUFBSTtBQUNuQjtBQUNBVCxJQUFBQSxFQUFFLENBQUNDLE9BQUgsQ0FBV1MsSUFBWCxDQUFnQixTQUFoQixFQUEyQkQsSUFBSSxDQUFDRSxHQUFoQyxFQUZtQixDQUVtQjtBQUV0Qzs7QUFDQSxRQUFJQyxRQUFRLEdBQUdyQixPQUFPLENBQUMsZUFBRCxDQUF0Qjs7QUFDQSxRQUFJc0IsRUFBRSxHQUFHRCxRQUFRLENBQUNFLE1BQVQsRUFBVCxDQU5tQixDQU9uQjs7QUFDQSxRQUFJQyxhQUFhLEdBQUdGLEVBQUUsQ0FBQ0csTUFBSCxDQUFVLEtBQVYsQ0FBcEIsQ0FSbUIsQ0FTbkI7QUFFQTtBQUNBO0FBQ0E7O0FBQ0EsUUFBSUMsRUFBRSxHQUFHMUIsT0FBTyxDQUFDLElBQUQsQ0FBaEIsQ0FkbUIsQ0FnQm5CO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTs7O0FBRUEsUUFBSTJCLFFBQVEsR0FBRyxDQUNYLENBQUNILGFBQUQsRUFBZ0JOLElBQUksQ0FBQ0UsR0FBckIsQ0FEVyxDQUFmO0FBSUEsVUFBTVEsTUFBTSxHQUFHRixFQUFFLENBQUNHLGlCQUFILENBQXFCLDJCQUFyQixFQUFrRDtBQUFFQyxNQUFBQSxLQUFLLEVBQUU7QUFBVCxLQUFsRCxDQUFmOztBQUNBLFNBQUssSUFBSUMsQ0FBVCxJQUFjSixRQUFkLEVBQXdCO0FBQUVDLE1BQUFBLE1BQU0sQ0FBQ0ksS0FBUCxDQUFhRCxDQUFDLENBQUNFLElBQUYsQ0FBTyxHQUFQLElBQWMsTUFBM0I7QUFBcUM7O0FBQy9ETCxJQUFBQSxNQUFNLENBQUNNLEdBQVA7QUFDQTVCLElBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLHFCQUFxQlcsSUFBSSxDQUFDRSxHQUF0QztBQUNOLEdBbkVEO0FBcUVBSixFQUFBQSxNQUFNLENBQUNMLEVBQVAsQ0FBVSxPQUFWLEVBQW1Cd0IsR0FBRyxJQUFJO0FBQ3pCN0IsSUFBQUEsT0FBTyxDQUFDOEIsS0FBUixDQUFjLGNBQWQsRUFBOEJELEdBQTlCO0FBQ0EsR0FGRDtBQUlBbkIsRUFBQUEsTUFBTSxDQUFDTCxFQUFQLENBQVUsS0FBVixFQUFpQixNQUFNO0FBQ3RCTCxJQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBWVMsTUFBTSxDQUFDQyxJQUFQLEdBQWMsdUJBQTFCO0FBQ0EsR0FGRDtBQUtBLENBbEZEO0FBb0ZBSCxHQUFHLENBQUNILEVBQUosQ0FBTyxPQUFQLEVBQWdCd0IsR0FBRyxJQUFJO0FBQ3RCN0IsRUFBQUEsT0FBTyxDQUFDOEIsS0FBUixDQUFjRCxHQUFkO0FBQ0EsQ0FGRCIsInNvdXJjZVJvb3QiOiIvVXNlcnMvaGFycnlob3cvRG9jdW1lbnRzLzIwMjIvUFJPSkVDVF9NT0NBX0FSVC9ORkMvbmZjLXBjc2MvZXhhbXBsZXMvIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbi8vICMjIyMjIyMjIyMjIyNcbi8vIExvZ3MgY2FyZHMnIHVpZFxuLy8gIyMjIyMjIyMjIyMjI1xuXG5pbXBvcnQgeyBORkMgfSBmcm9tICcuLi9zcmMvaW5kZXgnO1xuaW1wb3J0IHt3aXRoQ1NWfSBmcm9tICd3aXRoLWNzdic7XG5cbi8vIFNlcnZlciBzZXR1cFxudmFyIGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNzJyk7XG52YXIgYXBwID0gZXhwcmVzcygpO1xudmFyIHNlcnZlciA9IGFwcC5saXN0ZW4oMzAwMCk7XG5cbmFwcC51c2UoZXhwcmVzcy5zdGF0aWMoJy4uLy4uL2FwcCcpKTtcbmNvbnNvbGUubG9nKFwiU2VydmVyIGlzIHJ1bm5pbmdcIik7XG4vL1xuXG4vLyBTZXR1cCBzb2NrZXRcbnZhciBzb2NrZXQgPSByZXF1aXJlKCdzb2NrZXQuaW8nKTtcbnZhciBpbyA9IHNvY2tldChzZXJ2ZXIpO1xuaW8uc29ja2V0cy5vbignY29ubmVjdGlvbicsIE5ld0Nvbm5lY3Rpb24pO1xuXG4vLy8gSGFuZGxlIGNvbm5lY3Rpb25cbmZ1bmN0aW9uIE5ld0Nvbm5lY3Rpb24oc29ja2V0KXtcbiAgICBjb25zb2xlLmxvZyhcIk5ldyBjb25uZWN0aW9uIGNvbm5lY3RlZDogXCIgKyBzb2NrZXQuaWQpO1xuICAgIC8vY29uc29sZS5sb2coc29ja2V0KTtmXG4gICAgLy8gUmVjZWl2ZSBmcm9tIGNsaWVudFxuICAgIC8vIHNvY2tldC5vbignZnVsbHNjcmVlbicsIGhhbmRsZUV2ZW50KTtcblxuICAgIC8vIGZ1bmN0aW9uIGhhbmRsZUV2ZW50KGRhdGEpe1xuICAgIC8vICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAvLyB9XG59XG4vL1xuXG5cblxuXG5jb25zdCBuZmMgPSBuZXcgTkZDKCk7XG5cbm5mYy5vbigncmVhZGVyJywgcmVhZGVyID0+IHtcblxuXHRjb25zb2xlLmxvZyhyZWFkZXIubmFtZSArICcgcmVhZGVyIGF0dGFjaGVkLCB3YWl0aW5nIGZvciBjYXJkcyAuLi4nKTtcblxuXHRyZWFkZXIub24oJ2NhcmQnLCBjYXJkID0+IHtcbiAgICAgICAgLy9zb2NrZXQuYnJvYWRjYXN0LmVtaXQoJ2NhcmRfaWQnLCBjYXJkLnVpZCk7IC8vIGVtaXQgdG8gc3BlY2lmaSBzb2NrZXRcbiAgICAgICAgaW8uc29ja2V0cy5lbWl0KCdjYXJkX2lkJywgY2FyZC51aWQpOyAvLyBlbWl0IGdsb2JhbGx5XG4gICAgICAgXG4gICAgICAgIC8vIEhhbmRsZSBmaWxlXG4gICAgICAgIHZhciBkYXRlVGltZSA9IHJlcXVpcmUoJ25vZGUtZGF0ZXRpbWUnKTtcbiAgICAgICAgdmFyIGR0ID0gZGF0ZVRpbWUuY3JlYXRlKCk7XG4gICAgICAgIC8vdmFyIHRpbWVGb3JtYXR0ZWQgPSBkdC5mb3JtYXQoJ1ltZF9ITVMnKTtcbiAgICAgICAgdmFyIHRpbWVGb3JtYXR0ZWQgPSBkdC5mb3JtYXQoJ0hNUycpO1xuICAgICAgICAvL2lvLnNvY2tldHMuZW1pdCgnY2FyZF9pZCcsIHRpbWVGb3JtYXR0ZWQpOyAvLyBlbWl0IGdsb2JhbGx5XG5cbiAgICAgICAgLy8gLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAgICAgICAvLyAvLyByZWFkIGNzdiByZWNvcmRcbiAgICAgICAgLy8gLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gICAgICAgIGxldCBmcyA9IHJlcXVpcmUoJ2ZzJyk7XG5cbiAgICAgICAgLy8gY29uc3QgcmVjb3JkcyA9IHdpdGhDU1YoJ3NjYW4tcmVjb3JkLmNzdicpXG4gICAgICAgIC8vICAgICAucXVlcnkoWydpZCddKVxuICAgICAgICAvLyAgICAgLm1hcChyb3cgPT4gcm93LmlkKVxuICAgICAgICAvLyAgICAgLmluY2x1ZGVzKGNhcmQudWlkKTtcbiAgICAgICAgXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKHJlY29yZHMpO1xuICAgICAgIFxuICAgICAgICAvL2NzdkRhdGEgPSAnVGltZSwgSURcXG4xMTExLCAyMjIyXFxuMzMzMywgNDQ0NFxcbic7XG4gICAgICAgIC8vIGxldCBsb29rdXBDU1YgPSByZXF1aXJlKCdsb29rdXAtY3N2Jyk7XG4gICAgICAgIC8vIGNvbnN0IGxvb2t1cFRhYmxlID0gbG9va3VwQ1NWKCdzY2FuLXJlY29yZC5jc3YnLCBbJ0lEJ10pO1xuICAgICAgICAvLyB2YXIgbWF0Y2hpbmdSb3dzO1xuXG4gICAgICAgIC8vIEdldCByb3dzIG1hdGNoaW5nIGxvb2t1cCB2YWx1ZVxuICAgICAgICAvL21hdGNoaW5nUm93cyA9IGxvb2t1cFRhYmxlLmdldChjYXJkLnVpZCk7XG4gICAgICAgIC8vY29uc29sZS5sb2cobWF0Y2hpbmdSb3dzKTtcblxuICAgICAgICAvLyB2YXIgY3N2RGF0YSA9IHJlcXVpcmUoXCJmc1wiKS5yZWFkRmlsZVN5bmMoXCJzY2FuLXJlY29yZC5jc3ZcIiwgXCJ1dGY4XCIpXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKGNzdkRhdGEpO1xuICAgICAgICAvLyBjb25zb2xlLmxvZyhcIkZvdW5kOiBcIiArIGZpbmRJbkNTVihjc3ZEYXRhLCBjYXJkLnVpZCwgJ0lEJykpO1xuICAgICAgICBcbiAgICAgICAgLy9jb25zb2xlLmxvZyhjc3ZEYXRhLmZpbHRlcihkYXRhID0+IGRhdGEuSUQgPT09IGNhcmQudWlkKVswXS5JRCk7XG4gICAgICAgIFxuICAgICAgICAvL2Z1bmN0aW9uIGZpbmRFbWFpbEJ5TmFtZShuYW1lKSB7XG4gICAgICAgIC8vICAgIHJldHVybiBjc3ZEYXRhLmZpbHRlcihkYXRhID0+IGRhdGEuTmFtZSA9PT0gbmFtZSlbMF0uRW1haWxcbiAgICAgICAgLy99XG5cblxuXG4gICAgICAgIC8vIFBhcnNlIENTViBzdHJpbmdcbiAgICAgICAgLy8gdmFyIGRhdGEgPSBQYXBhLnBhcnNlKGNzdik7XG4gICAgICAgIFxuICAgICAgICAvLyAvLyBQYXJzZSBsb2NhbCBDU1YgZmlsZVxuICAgICAgICAvLyBQYXBhLnBhcnNlKGZpbGUsIHtcbiAgICAgICAgLy8gICAgIGNvbXBsZXRlOiBmdW5jdGlvbihyZXN1bHRzKSB7XG4gICAgICAgIC8vICAgICAgICAgY29uc29sZS5sb2coXCJGaW5pc2hlZDpcIiwgcmVzdWx0cy5kYXRhKTtcbiAgICAgICAgLy8gICAgIH1cbiAgICAgICAgLy8gfSk7XG5cblxuICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gICAgICAgIC8vIHdyaXRlIGNzdiByZWNvcmRcbiAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgICAgICAgdmFyIHNjYW5EYXRhID0gW1xuICAgICAgICAgICAgW3RpbWVGb3JtYXR0ZWQsIGNhcmQudWlkXSxcbiAgICAgICAgXTtcblxuICAgICAgICBjb25zdCBzdHJlYW0gPSBmcy5jcmVhdGVXcml0ZVN0cmVhbShcIi4uLy4uL2FwcC9zY2FuLXJlY29yZC5jc3ZcIiwgeyBmbGFnczogJ2EnfSk7XG4gICAgICAgIGZvciAobGV0IGkgb2Ygc2NhbkRhdGEpIHsgc3RyZWFtLndyaXRlKGkuam9pbihcIixcIikgKyBcIlxcclxcblwiKTsgfVxuICAgICAgICBzdHJlYW0uZW5kKCk7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiUmVjb3JkIHdyaXR0ZW4hIFwiICsgY2FyZC51aWQpO1xuXHR9KTtcblxuXHRyZWFkZXIub24oJ2Vycm9yJywgZXJyID0+IHtcblx0XHRjb25zb2xlLmVycm9yKCdyZWFkZXIgZXJyb3InLCBlcnIpO1xuXHR9KTtcblxuXHRyZWFkZXIub24oJ2VuZCcsICgpID0+IHtcblx0XHRjb25zb2xlLmxvZyhyZWFkZXIubmFtZSArICcgcmVhZGVyIGRpc2Nvbm5lY3RlZC4nKTtcblx0fSk7XG5cblxufSk7XG5cbm5mYy5vbignZXJyb3InLCBlcnIgPT4ge1xuXHRjb25zb2xlLmVycm9yKGVycik7XG59KTtcbiJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "my-nfc-emitter.js"
      ],
      "names": [
        "express",
        "require",
        "app",
        "server",
        "listen",
        "use",
        "static",
        "console",
        "log",
        "socket",
        "io",
        "sockets",
        "on",
        "NewConnection",
        "id",
        "nfc",
        "NFC",
        "reader",
        "name",
        "card",
        "emit",
        "uid",
        "dateTime",
        "dt",
        "create",
        "timeFormatted",
        "format",
        "fs",
        "scanData",
        "stream",
        "createWriteStream",
        "flags",
        "i",
        "write",
        "join",
        "end",
        "err",
        "error"
      ],
      "mappings": "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",
      "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/examples/",
      "sourcesContent": [
        "\"use strict\";\n\n// #############\n// Logs cards' uid\n// #############\n\nimport { NFC } from '../src/index';\nimport {withCSV} from 'with-csv';\n\n// Server setup\nvar express = require('express');\nvar app = express();\nvar server = app.listen(3000);\n\napp.use(express.static('../../app'));\nconsole.log(\"Server is running\");\n//\n\n// Setup socket\nvar socket = require('socket.io');\nvar io = socket(server);\nio.sockets.on('connection', NewConnection);\n\n/// Handle connection\nfunction NewConnection(socket){\n    console.log(\"New connection connected: \" + socket.id);\n    //console.log(socket);f\n    // Receive from client\n    // socket.on('fullscreen', handleEvent);\n\n    // function handleEvent(data){\n    //     console.log(data);\n    // }\n}\n//\n\n\n\n\nconst nfc = new NFC();\n\nnfc.on('reader', reader => {\n\n\tconsole.log(reader.name + ' reader attached, waiting for cards ...');\n\n\treader.on('card', card => {\n        //socket.broadcast.emit('card_id', card.uid); // emit to specifi socket\n        io.sockets.emit('card_id', card.uid); // emit globally\n       \n        // Handle file\n        var dateTime = require('node-datetime');\n        var dt = dateTime.create();\n        //var timeFormatted = dt.format('Ymd_HMS');\n        var timeFormatted = dt.format('HMS');\n        //io.sockets.emit('card_id', timeFormatted); // emit globally\n\n        // ////////////////////////////\n        // // read csv record\n        // ///////////////////////////\n        let fs = require('fs');\n\n        // const records = withCSV('scan-record.csv')\n        //     .query(['id'])\n        //     .map(row => row.id)\n        //     .includes(card.uid);\n        \n        // console.log(records);\n       \n        //csvData = 'Time, ID\\n1111, 2222\\n3333, 4444\\n';\n        // let lookupCSV = require('lookup-csv');\n        // const lookupTable = lookupCSV('scan-record.csv', ['ID']);\n        // var matchingRows;\n\n        // Get rows matching lookup value\n        //matchingRows = lookupTable.get(card.uid);\n        //console.log(matchingRows);\n\n        // var csvData = require(\"fs\").readFileSync(\"scan-record.csv\", \"utf8\")\n        // console.log(csvData);\n        // console.log(\"Found: \" + findInCSV(csvData, card.uid, 'ID'));\n        \n        //console.log(csvData.filter(data => data.ID === card.uid)[0].ID);\n        \n        //function findEmailByName(name) {\n        //    return csvData.filter(data => data.Name === name)[0].Email\n        //}\n\n\n\n        // Parse CSV string\n        // var data = Papa.parse(csv);\n        \n        // // Parse local CSV file\n        // Papa.parse(file, {\n        //     complete: function(results) {\n        //         console.log(\"Finished:\", results.data);\n        //     }\n        // });\n\n\n        //////////////////////\n        // write csv record\n        ////////////////////////\n\n        var scanData = [\n            [timeFormatted, card.uid],\n        ];\n\n        const stream = fs.createWriteStream(\"../../app/scan-record.csv\", { flags: 'a'});\n        for (let i of scanData) { stream.write(i.join(\",\") + \"\\r\\n\"); }\n        stream.end();\n        console.log(\"Record written! \" + card.uid);\n\t});\n\n\treader.on('error', err => {\n\t\tconsole.error('reader error', err);\n\t});\n\n\treader.on('end', () => {\n\t\tconsole.log(reader.name + ' reader disconnected.');\n\t});\n\n\n});\n\nnfc.on('error', err => {\n\tconsole.error(err);\n});\n"
      ]
    },
    "sourceType": "script",
    "mtime": 1662834152946
  },
  "{\"sourceRoot\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc\",\"filename\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/errors.js\",\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{}},{\"key\":\"proposal-class-properties\",\"visitor\":{\"PrivateName\":{\"enter\":[null]},\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{}}],\"presets\":[]}:7.12.17": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/",
      "caller": {
        "name": "@babel/register"
      },
      "cwd": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc",
      "filename": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/errors.js",
      "cloneInputAst": true,
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {}
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {}
        },
        {
          "key": "proposal-class-properties",
          "visitor": {
            "PrivateName": {
              "enter": [
                null
              ]
            },
            "ExportDefaultDeclaration": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true,
            "ClassExpression": {
              "enter": [
                null
              ]
            },
            "ClassDeclaration": {
              "enter": [
                null
              ]
            }
          },
          "options": {}
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/errors.js",
        "plugins": [
          "objectRestSpread",
          "classProperties",
          "classPrivateProperties"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/errors.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/",
        "sourceFileName": "errors.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.GetUIDError = exports.DisconnectError = exports.ConnectError = exports.AuthenticationError = exports.LoadAuthenticationKeyError = exports.WriteError = exports.ReadError = exports.ControlError = exports.TransmitError = exports.OPERATION_FAILED = exports.CARD_NOT_CONNECTED = exports.FAILURE = exports.BaseError = exports.UNKNOWN_ERROR = void 0;\nconst UNKNOWN_ERROR = 'unknown_error';\nexports.UNKNOWN_ERROR = UNKNOWN_ERROR;\n\nclass BaseError extends Error {\n  constructor(code, message, previousError) {\n    super(message);\n    Error.captureStackTrace(this, this.constructor);\n    this.name = 'BaseError';\n\n    if (!message && previousError) {\n      this.message = previousError.message;\n    }\n\n    this.code = code;\n\n    if (previousError) {\n      this.previous = previousError;\n    }\n  }\n\n}\n\nexports.BaseError = BaseError;\nconst FAILURE = 'failure';\nexports.FAILURE = FAILURE;\nconst CARD_NOT_CONNECTED = 'card_not_connected';\nexports.CARD_NOT_CONNECTED = CARD_NOT_CONNECTED;\nconst OPERATION_FAILED = 'operation_failed';\nexports.OPERATION_FAILED = OPERATION_FAILED;\n\nclass TransmitError extends BaseError {\n  constructor(code, message, previousError) {\n    super(code, message, previousError);\n    this.name = 'TransmitError';\n  }\n\n}\n\nexports.TransmitError = TransmitError;\n\nclass ControlError extends BaseError {\n  constructor(code, message, previousError) {\n    super(code, message, previousError);\n    this.name = 'ControlError';\n  }\n\n}\n\nexports.ControlError = ControlError;\n\nclass ReadError extends BaseError {\n  constructor(code, message, previousError) {\n    super(code, message, previousError);\n    this.name = 'ReadError';\n  }\n\n}\n\nexports.ReadError = ReadError;\n\nclass WriteError extends BaseError {\n  constructor(code, message, previousError) {\n    super(code, message, previousError);\n    this.name = 'WriteError';\n  }\n\n}\n\nexports.WriteError = WriteError;\n\nclass LoadAuthenticationKeyError extends BaseError {\n  constructor(code, message, previousError) {\n    super(code, message, previousError);\n    this.name = 'LoadAuthenticationKeyError';\n  }\n\n}\n\nexports.LoadAuthenticationKeyError = LoadAuthenticationKeyError;\n\nclass AuthenticationError extends BaseError {\n  constructor(code, message, previousError) {\n    super(code, message, previousError);\n    this.name = 'AuthenticationError';\n  }\n\n}\n\nexports.AuthenticationError = AuthenticationError;\n\nclass ConnectError extends BaseError {\n  constructor(code, message, previousError) {\n    super(code, message, previousError);\n    this.name = 'ConnectError';\n  }\n\n}\n\nexports.ConnectError = ConnectError;\n\nclass DisconnectError extends BaseError {\n  constructor(code, message, previousError) {\n    super(code, message, previousError);\n    this.name = 'DisconnectError';\n  }\n\n}\n\nexports.DisconnectError = DisconnectError;\n\nclass GetUIDError extends BaseError {\n  constructor(code, message, previousError) {\n    super(code, message, previousError);\n    this.name = 'GetUIDError';\n  }\n\n}\n\nexports.GetUIDError = GetUIDError;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImVycm9ycy5qcyJdLCJuYW1lcyI6WyJVTktOT1dOX0VSUk9SIiwiQmFzZUVycm9yIiwiRXJyb3IiLCJjb25zdHJ1Y3RvciIsImNvZGUiLCJtZXNzYWdlIiwicHJldmlvdXNFcnJvciIsImNhcHR1cmVTdGFja1RyYWNlIiwibmFtZSIsInByZXZpb3VzIiwiRkFJTFVSRSIsIkNBUkRfTk9UX0NPTk5FQ1RFRCIsIk9QRVJBVElPTl9GQUlMRUQiLCJUcmFuc21pdEVycm9yIiwiQ29udHJvbEVycm9yIiwiUmVhZEVycm9yIiwiV3JpdGVFcnJvciIsIkxvYWRBdXRoZW50aWNhdGlvbktleUVycm9yIiwiQXV0aGVudGljYXRpb25FcnJvciIsIkNvbm5lY3RFcnJvciIsIkRpc2Nvbm5lY3RFcnJvciIsIkdldFVJREVycm9yIl0sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7O0FBR08sTUFBTUEsYUFBYSxHQUFHLGVBQXRCOzs7QUFFQSxNQUFNQyxTQUFOLFNBQXdCQyxLQUF4QixDQUE4QjtBQUVwQ0MsRUFBQUEsV0FBVyxDQUFDQyxJQUFELEVBQU9DLE9BQVAsRUFBZ0JDLGFBQWhCLEVBQStCO0FBRXpDLFVBQU1ELE9BQU47QUFFQUgsSUFBQUEsS0FBSyxDQUFDSyxpQkFBTixDQUF3QixJQUF4QixFQUE4QixLQUFLSixXQUFuQztBQUVBLFNBQUtLLElBQUwsR0FBWSxXQUFaOztBQUVBLFFBQUksQ0FBQ0gsT0FBRCxJQUFZQyxhQUFoQixFQUErQjtBQUM5QixXQUFLRCxPQUFMLEdBQWVDLGFBQWEsQ0FBQ0QsT0FBN0I7QUFDQTs7QUFFRCxTQUFLRCxJQUFMLEdBQVlBLElBQVo7O0FBRUEsUUFBSUUsYUFBSixFQUFtQjtBQUNsQixXQUFLRyxRQUFMLEdBQWdCSCxhQUFoQjtBQUNBO0FBRUQ7O0FBcEJtQzs7O0FBd0I5QixNQUFNSSxPQUFPLEdBQUcsU0FBaEI7O0FBQ0EsTUFBTUMsa0JBQWtCLEdBQUcsb0JBQTNCOztBQUNBLE1BQU1DLGdCQUFnQixHQUFHLGtCQUF6Qjs7O0FBRUEsTUFBTUMsYUFBTixTQUE0QlosU0FBNUIsQ0FBc0M7QUFFNUNFLEVBQUFBLFdBQVcsQ0FBQ0MsSUFBRCxFQUFPQyxPQUFQLEVBQWdCQyxhQUFoQixFQUErQjtBQUV6QyxVQUFNRixJQUFOLEVBQVlDLE9BQVosRUFBcUJDLGFBQXJCO0FBRUEsU0FBS0UsSUFBTCxHQUFZLGVBQVo7QUFFQTs7QUFSMkM7Ozs7QUFZdEMsTUFBTU0sWUFBTixTQUEyQmIsU0FBM0IsQ0FBcUM7QUFFM0NFLEVBQUFBLFdBQVcsQ0FBQ0MsSUFBRCxFQUFPQyxPQUFQLEVBQWdCQyxhQUFoQixFQUErQjtBQUV6QyxVQUFNRixJQUFOLEVBQVlDLE9BQVosRUFBcUJDLGFBQXJCO0FBRUEsU0FBS0UsSUFBTCxHQUFZLGNBQVo7QUFFQTs7QUFSMEM7Ozs7QUFZckMsTUFBTU8sU0FBTixTQUF3QmQsU0FBeEIsQ0FBa0M7QUFFeENFLEVBQUFBLFdBQVcsQ0FBQ0MsSUFBRCxFQUFPQyxPQUFQLEVBQWdCQyxhQUFoQixFQUErQjtBQUV6QyxVQUFNRixJQUFOLEVBQVlDLE9BQVosRUFBcUJDLGFBQXJCO0FBRUEsU0FBS0UsSUFBTCxHQUFZLFdBQVo7QUFFQTs7QUFSdUM7Ozs7QUFZbEMsTUFBTVEsVUFBTixTQUF5QmYsU0FBekIsQ0FBbUM7QUFFekNFLEVBQUFBLFdBQVcsQ0FBQ0MsSUFBRCxFQUFPQyxPQUFQLEVBQWdCQyxhQUFoQixFQUErQjtBQUV6QyxVQUFNRixJQUFOLEVBQVlDLE9BQVosRUFBcUJDLGFBQXJCO0FBRUEsU0FBS0UsSUFBTCxHQUFZLFlBQVo7QUFFQTs7QUFSd0M7Ozs7QUFZbkMsTUFBTVMsMEJBQU4sU0FBeUNoQixTQUF6QyxDQUFtRDtBQUV6REUsRUFBQUEsV0FBVyxDQUFDQyxJQUFELEVBQU9DLE9BQVAsRUFBZ0JDLGFBQWhCLEVBQStCO0FBRXpDLFVBQU1GLElBQU4sRUFBWUMsT0FBWixFQUFxQkMsYUFBckI7QUFFQSxTQUFLRSxJQUFMLEdBQVksNEJBQVo7QUFFQTs7QUFSd0Q7Ozs7QUFZbkQsTUFBTVUsbUJBQU4sU0FBa0NqQixTQUFsQyxDQUE0QztBQUVsREUsRUFBQUEsV0FBVyxDQUFDQyxJQUFELEVBQU9DLE9BQVAsRUFBZ0JDLGFBQWhCLEVBQStCO0FBRXpDLFVBQU1GLElBQU4sRUFBWUMsT0FBWixFQUFxQkMsYUFBckI7QUFFQSxTQUFLRSxJQUFMLEdBQVkscUJBQVo7QUFFQTs7QUFSaUQ7Ozs7QUFZNUMsTUFBTVcsWUFBTixTQUEyQmxCLFNBQTNCLENBQXFDO0FBRTNDRSxFQUFBQSxXQUFXLENBQUNDLElBQUQsRUFBT0MsT0FBUCxFQUFnQkMsYUFBaEIsRUFBK0I7QUFFekMsVUFBTUYsSUFBTixFQUFZQyxPQUFaLEVBQXFCQyxhQUFyQjtBQUVBLFNBQUtFLElBQUwsR0FBWSxjQUFaO0FBRUE7O0FBUjBDOzs7O0FBWXJDLE1BQU1ZLGVBQU4sU0FBOEJuQixTQUE5QixDQUF3QztBQUU5Q0UsRUFBQUEsV0FBVyxDQUFDQyxJQUFELEVBQU9DLE9BQVAsRUFBZ0JDLGFBQWhCLEVBQStCO0FBRXpDLFVBQU1GLElBQU4sRUFBWUMsT0FBWixFQUFxQkMsYUFBckI7QUFFQSxTQUFLRSxJQUFMLEdBQVksaUJBQVo7QUFFQTs7QUFSNkM7Ozs7QUFZeEMsTUFBTWEsV0FBTixTQUEwQnBCLFNBQTFCLENBQW9DO0FBRTFDRSxFQUFBQSxXQUFXLENBQUNDLElBQUQsRUFBT0MsT0FBUCxFQUFnQkMsYUFBaEIsRUFBK0I7QUFFekMsVUFBTUYsSUFBTixFQUFZQyxPQUFaLEVBQXFCQyxhQUFyQjtBQUVBLFNBQUtFLElBQUwsR0FBWSxhQUFaO0FBRUE7O0FBUnlDIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9oYXJyeWhvdy9Eb2N1bWVudHMvMjAyMi9QUk9KRUNUX01PQ0FfQVJUL05GQy9uZmMtcGNzYy9zcmMvIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cblxuZXhwb3J0IGNvbnN0IFVOS05PV05fRVJST1IgPSAndW5rbm93bl9lcnJvcic7XG5cbmV4cG9ydCBjbGFzcyBCYXNlRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG5cblx0Y29uc3RydWN0b3IoY29kZSwgbWVzc2FnZSwgcHJldmlvdXNFcnJvcikge1xuXG5cdFx0c3VwZXIobWVzc2FnZSk7XG5cblx0XHRFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSh0aGlzLCB0aGlzLmNvbnN0cnVjdG9yKTtcblxuXHRcdHRoaXMubmFtZSA9ICdCYXNlRXJyb3InO1xuXG5cdFx0aWYgKCFtZXNzYWdlICYmIHByZXZpb3VzRXJyb3IpIHtcblx0XHRcdHRoaXMubWVzc2FnZSA9IHByZXZpb3VzRXJyb3IubWVzc2FnZTtcblx0XHR9XG5cblx0XHR0aGlzLmNvZGUgPSBjb2RlO1xuXG5cdFx0aWYgKHByZXZpb3VzRXJyb3IpIHtcblx0XHRcdHRoaXMucHJldmlvdXMgPSBwcmV2aW91c0Vycm9yO1xuXHRcdH1cblxuXHR9XG5cbn1cblxuZXhwb3J0IGNvbnN0IEZBSUxVUkUgPSAnZmFpbHVyZSc7XG5leHBvcnQgY29uc3QgQ0FSRF9OT1RfQ09OTkVDVEVEID0gJ2NhcmRfbm90X2Nvbm5lY3RlZCc7XG5leHBvcnQgY29uc3QgT1BFUkFUSU9OX0ZBSUxFRCA9ICdvcGVyYXRpb25fZmFpbGVkJztcblxuZXhwb3J0IGNsYXNzIFRyYW5zbWl0RXJyb3IgZXh0ZW5kcyBCYXNlRXJyb3Ige1xuXG5cdGNvbnN0cnVjdG9yKGNvZGUsIG1lc3NhZ2UsIHByZXZpb3VzRXJyb3IpIHtcblxuXHRcdHN1cGVyKGNvZGUsIG1lc3NhZ2UsIHByZXZpb3VzRXJyb3IpO1xuXG5cdFx0dGhpcy5uYW1lID0gJ1RyYW5zbWl0RXJyb3InO1xuXG5cdH1cblxufVxuXG5leHBvcnQgY2xhc3MgQ29udHJvbEVycm9yIGV4dGVuZHMgQmFzZUVycm9yIHtcblxuXHRjb25zdHJ1Y3Rvcihjb2RlLCBtZXNzYWdlLCBwcmV2aW91c0Vycm9yKSB7XG5cblx0XHRzdXBlcihjb2RlLCBtZXNzYWdlLCBwcmV2aW91c0Vycm9yKTtcblxuXHRcdHRoaXMubmFtZSA9ICdDb250cm9sRXJyb3InO1xuXG5cdH1cblxufVxuXG5leHBvcnQgY2xhc3MgUmVhZEVycm9yIGV4dGVuZHMgQmFzZUVycm9yIHtcblxuXHRjb25zdHJ1Y3Rvcihjb2RlLCBtZXNzYWdlLCBwcmV2aW91c0Vycm9yKSB7XG5cblx0XHRzdXBlcihjb2RlLCBtZXNzYWdlLCBwcmV2aW91c0Vycm9yKTtcblxuXHRcdHRoaXMubmFtZSA9ICdSZWFkRXJyb3InO1xuXG5cdH1cblxufVxuXG5leHBvcnQgY2xhc3MgV3JpdGVFcnJvciBleHRlbmRzIEJhc2VFcnJvciB7XG5cblx0Y29uc3RydWN0b3IoY29kZSwgbWVzc2FnZSwgcHJldmlvdXNFcnJvcikge1xuXG5cdFx0c3VwZXIoY29kZSwgbWVzc2FnZSwgcHJldmlvdXNFcnJvcik7XG5cblx0XHR0aGlzLm5hbWUgPSAnV3JpdGVFcnJvcic7XG5cblx0fVxuXG59XG5cbmV4cG9ydCBjbGFzcyBMb2FkQXV0aGVudGljYXRpb25LZXlFcnJvciBleHRlbmRzIEJhc2VFcnJvciB7XG5cblx0Y29uc3RydWN0b3IoY29kZSwgbWVzc2FnZSwgcHJldmlvdXNFcnJvcikge1xuXG5cdFx0c3VwZXIoY29kZSwgbWVzc2FnZSwgcHJldmlvdXNFcnJvcik7XG5cblx0XHR0aGlzLm5hbWUgPSAnTG9hZEF1dGhlbnRpY2F0aW9uS2V5RXJyb3InO1xuXG5cdH1cblxufVxuXG5leHBvcnQgY2xhc3MgQXV0aGVudGljYXRpb25FcnJvciBleHRlbmRzIEJhc2VFcnJvciB7XG5cblx0Y29uc3RydWN0b3IoY29kZSwgbWVzc2FnZSwgcHJldmlvdXNFcnJvcikge1xuXG5cdFx0c3VwZXIoY29kZSwgbWVzc2FnZSwgcHJldmlvdXNFcnJvcik7XG5cblx0XHR0aGlzLm5hbWUgPSAnQXV0aGVudGljYXRpb25FcnJvcic7XG5cblx0fVxuXG59XG5cbmV4cG9ydCBjbGFzcyBDb25uZWN0RXJyb3IgZXh0ZW5kcyBCYXNlRXJyb3Ige1xuXG5cdGNvbnN0cnVjdG9yKGNvZGUsIG1lc3NhZ2UsIHByZXZpb3VzRXJyb3IpIHtcblxuXHRcdHN1cGVyKGNvZGUsIG1lc3NhZ2UsIHByZXZpb3VzRXJyb3IpO1xuXG5cdFx0dGhpcy5uYW1lID0gJ0Nvbm5lY3RFcnJvcic7XG5cblx0fVxuXG59XG5cbmV4cG9ydCBjbGFzcyBEaXNjb25uZWN0RXJyb3IgZXh0ZW5kcyBCYXNlRXJyb3Ige1xuXG5cdGNvbnN0cnVjdG9yKGNvZGUsIG1lc3NhZ2UsIHByZXZpb3VzRXJyb3IpIHtcblxuXHRcdHN1cGVyKGNvZGUsIG1lc3NhZ2UsIHByZXZpb3VzRXJyb3IpO1xuXG5cdFx0dGhpcy5uYW1lID0gJ0Rpc2Nvbm5lY3RFcnJvcic7XG5cblx0fVxuXG59XG5cbmV4cG9ydCBjbGFzcyBHZXRVSURFcnJvciBleHRlbmRzIEJhc2VFcnJvciB7XG5cblx0Y29uc3RydWN0b3IoY29kZSwgbWVzc2FnZSwgcHJldmlvdXNFcnJvcikge1xuXG5cdFx0c3VwZXIoY29kZSwgbWVzc2FnZSwgcHJldmlvdXNFcnJvcik7XG5cblx0XHR0aGlzLm5hbWUgPSAnR2V0VUlERXJyb3InO1xuXG5cdH1cblxufVxuIl19",
    "map": {
      "version": 3,
      "sources": [
        "errors.js"
      ],
      "names": [
        "UNKNOWN_ERROR",
        "BaseError",
        "Error",
        "constructor",
        "code",
        "message",
        "previousError",
        "captureStackTrace",
        "name",
        "previous",
        "FAILURE",
        "CARD_NOT_CONNECTED",
        "OPERATION_FAILED",
        "TransmitError",
        "ControlError",
        "ReadError",
        "WriteError",
        "LoadAuthenticationKeyError",
        "AuthenticationError",
        "ConnectError",
        "DisconnectError",
        "GetUIDError"
      ],
      "mappings": "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",
      "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/",
      "sourcesContent": [
        "\"use strict\";\n\n\nexport const UNKNOWN_ERROR = 'unknown_error';\n\nexport class BaseError extends Error {\n\n\tconstructor(code, message, previousError) {\n\n\t\tsuper(message);\n\n\t\tError.captureStackTrace(this, this.constructor);\n\n\t\tthis.name = 'BaseError';\n\n\t\tif (!message && previousError) {\n\t\t\tthis.message = previousError.message;\n\t\t}\n\n\t\tthis.code = code;\n\n\t\tif (previousError) {\n\t\t\tthis.previous = previousError;\n\t\t}\n\n\t}\n\n}\n\nexport const FAILURE = 'failure';\nexport const CARD_NOT_CONNECTED = 'card_not_connected';\nexport const OPERATION_FAILED = 'operation_failed';\n\nexport class TransmitError extends BaseError {\n\n\tconstructor(code, message, previousError) {\n\n\t\tsuper(code, message, previousError);\n\n\t\tthis.name = 'TransmitError';\n\n\t}\n\n}\n\nexport class ControlError extends BaseError {\n\n\tconstructor(code, message, previousError) {\n\n\t\tsuper(code, message, previousError);\n\n\t\tthis.name = 'ControlError';\n\n\t}\n\n}\n\nexport class ReadError extends BaseError {\n\n\tconstructor(code, message, previousError) {\n\n\t\tsuper(code, message, previousError);\n\n\t\tthis.name = 'ReadError';\n\n\t}\n\n}\n\nexport class WriteError extends BaseError {\n\n\tconstructor(code, message, previousError) {\n\n\t\tsuper(code, message, previousError);\n\n\t\tthis.name = 'WriteError';\n\n\t}\n\n}\n\nexport class LoadAuthenticationKeyError extends BaseError {\n\n\tconstructor(code, message, previousError) {\n\n\t\tsuper(code, message, previousError);\n\n\t\tthis.name = 'LoadAuthenticationKeyError';\n\n\t}\n\n}\n\nexport class AuthenticationError extends BaseError {\n\n\tconstructor(code, message, previousError) {\n\n\t\tsuper(code, message, previousError);\n\n\t\tthis.name = 'AuthenticationError';\n\n\t}\n\n}\n\nexport class ConnectError extends BaseError {\n\n\tconstructor(code, message, previousError) {\n\n\t\tsuper(code, message, previousError);\n\n\t\tthis.name = 'ConnectError';\n\n\t}\n\n}\n\nexport class DisconnectError extends BaseError {\n\n\tconstructor(code, message, previousError) {\n\n\t\tsuper(code, message, previousError);\n\n\t\tthis.name = 'DisconnectError';\n\n\t}\n\n}\n\nexport class GetUIDError extends BaseError {\n\n\tconstructor(code, message, previousError) {\n\n\t\tsuper(code, message, previousError);\n\n\t\tthis.name = 'GetUIDError';\n\n\t}\n\n}\n"
      ]
    },
    "sourceType": "script",
    "mtime": 1662229648500
  },
  "{\"sourceRoot\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc\",\"filename\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/ACR122Reader.js\",\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc\",\"plugins\":[{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{}},{\"key\":\"proposal-class-properties\",\"visitor\":{\"PrivateName\":{\"enter\":[null]},\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{}}],\"presets\":[]}:7.12.17": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/",
      "caller": {
        "name": "@babel/register"
      },
      "cwd": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc",
      "filename": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/ACR122Reader.js",
      "cloneInputAst": true,
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {}
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {}
        },
        {
          "key": "proposal-class-properties",
          "visitor": {
            "PrivateName": {
              "enter": [
                null
              ]
            },
            "ExportDefaultDeclaration": {
              "enter": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true,
            "ClassExpression": {
              "enter": [
                null
              ]
            },
            "ClassDeclaration": {
              "enter": [
                null
              ]
            }
          },
          "options": {}
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/ACR122Reader.js",
        "plugins": [
          "objectRestSpread",
          "classProperties",
          "classPrivateProperties"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/ACR122Reader.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/",
        "sourceFileName": "ACR122Reader.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _Reader = _interopRequireDefault(require(\"./Reader\"));\n\nvar _errors = require(\"./errors\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nclass ACR122Reader extends _Reader.default {\n  async inAutoPoll() {\n    const payload = [0xD4, 0x60, 0xFF, // PollNr (0xFF = Endless polling)\n    0x01, // Period (0x01 – 0x0F) indicates the polling period in units of 150 ms\n    0x00 // Type 1 0x00 = Generic passive 106 kbps (ISO/IEC14443-4A, Mifare and DEP)\n    ]; // CMD: Direct Transmit (to inner PN532 chip InAutoPoll CMD)\n\n    const packet = Buffer.from([0xff, // Class\n    0x00, // INS\n    0x00, // P1\n    0x00, // P2\n    payload.length, // Lc: Number of Bytes to send (Maximum 255 bytes)\n    ...payload]);\n    console.log(packet);\n    let response = null;\n\n    try {\n      response = await this.control(packet, 2);\n      this.logger.debug('response received', response); // Red OFF Green OFF  0x00\n      // Red ON  Green OFF  0x01\n      // Red OFF Green ON   0x02\n      // Red ON  Green ON   0x03\n\n      console.log(response.slice(1));\n    } catch (err) {\n      throw err;\n    } // const statusCode = response.readUInt16BE(0);\n    //\n    // if (statusCode !== 0x9000) {\n    // \t//throw new LoadAuthenticationKeyError(OPERATION_FAILED, `Load authentication key operation failed: Status code: ${statusCode}`);\n    // }\n\n  }\n\n  async led(led, blinking) {\n    // P2: LED State Control (1 byte = 8 bits)\n    // format:\n\n    /*\n     +-----+----------------------------------+-------------------------------------+\n     | Bit |               Item               |             Description             |\n     +-----+----------------------------------+-------------------------------------+\n     |   0 | Final Red LED State              | 1 = On; 0 = Off                     |\n     |   1 | Final Green LED State            | 1 = On; 0 = Off                     |\n     |   2 | Red LED State Mask               | 1 = Update the State; 0 = No change |\n     |   3 | Green LED State Mask             | 1 = Update the State; 0 = No change |\n     |   4 | Initial Red LED Blinking State   | 1 = On; 0 = Off                     |\n     |   5 | Initial Green LED Blinking State | 1 = On; 0 = Off                     |\n     |   6 | Red LED Blinking Mask            | 1 = Blink; 0 = Not Blink            |\n     |   7 | Green LED Blinking Mask          | 1 = Blink; 0 = Not Blink            |\n     +-----+----------------------------------+-------------------------------------+\n     */\n    //const led = 0b00001111;\n    //const led = 0x50;\n    // Data In: Blinking Duration Control (4 bytes)\n    // Byte 0: T1 Duration Initial Blinking State (Unit = 100 ms)\n    // Byte 1: T2 Duration Toggle Blinking State (Unit = 100 ms)\n    // Byte 2: Number of repetition\n    // Byte 3: Link to Buzzer\n    // - 00: The buzzer will not turn on\n    // - 01: The buzzer will turn on during the T1 Duration\n    // - 02: The buzzer will turn on during the T2 Duration\n    // - 03: The buzzer will turn on during the T1 and T2 Duration\n    // const blinking = [\n    // \t0x00,\n    // \t0x00,\n    // \t0x00,\n    // \t0x00\n    // ];\n    // CMD: Bi-Color LED and Buzzer Control\n    const packet = Buffer.from([0xff, // Class\n    0x00, // INS\n    0x40, // P1\n    led, // P2: LED State Control\n    0x04, // Lc\n    ...blinking // Data In: Blinking Duration Control (4 bytes)\n    ]);\n    console.log(packet);\n    let response = null;\n\n    try {\n      response = await this.control(packet, 2);\n      this.logger.debug('response received', response); // Red OFF Green OFF  0x00\n      // Red ON  Green OFF  0x01\n      // Red OFF Green ON   0x02\n      // Red ON  Green ON   0x03\n\n      console.log(response.slice(1));\n    } catch (err) {\n      throw err;\n    } // const statusCode = response.readUInt16BE(0);\n    //\n    // if (statusCode !== 0x9000) {\n    // \t//throw new LoadAuthenticationKeyError(OPERATION_FAILED, `Load authentication key operation failed: Status code: ${statusCode}`);\n    // }\n\n  }\n\n  async setBuzzerOutput(enabled = true) {\n    // CMD: Set Buzzer Output Enable for Card Detection\n    const packet = Buffer.from([0xff, // Class\n    0x00, // INS\n    0x52, // P1\n    enabled ? 0xff : 0x00, // P2: PollBuzzStatus\n    0x00 // Le\n    ]);\n    console.log(packet);\n    let response = null;\n\n    try {\n      response = await this.control(packet, 2);\n      this.logger.debug('response received', response);\n    } catch (err) {\n      throw err;\n    }\n\n    const statusCode = response.readUInt16BE(0);\n\n    if (statusCode !== 0x9000) {//throw new LoadAuthenticationKeyError(OPERATION_FAILED, `Load authentication key operation failed: Status code: ${statusCode}`);\n    }\n  }\n\n  async setPICC(picc) {\n    // just enable Auto ATS Generation\n    // const picc = 0b01000000;\n    // CMD: Set PICC Operating Parameter\n    const packet = Buffer.from([0xff, // Class\n    0x00, // INS\n    0x51, // P1\n    picc, // P2: New PICC Operating Parameter\n    0x00 // Le\n    ]);\n    console.log(packet);\n    let response = null;\n\n    try {\n      response = await this.control(packet, 1);\n      this.logger.debug('response received', response);\n    } catch (err) {\n      throw err;\n    } // const statusCode = response.readUInt16BE(0);\n    //\n    // if (statusCode !== 0x9000) {\n    // \t//throw new LoadAuthenticationKeyError(OPERATION_FAILED, `Load authentication key operation failed: Status code: ${statusCode}`);\n    // }\n\n  }\n\n}\n\nvar _default = ACR122Reader;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkFDUjEyMlJlYWRlci5qcyJdLCJuYW1lcyI6WyJBQ1IxMjJSZWFkZXIiLCJSZWFkZXIiLCJpbkF1dG9Qb2xsIiwicGF5bG9hZCIsInBhY2tldCIsIkJ1ZmZlciIsImZyb20iLCJsZW5ndGgiLCJjb25zb2xlIiwibG9nIiwicmVzcG9uc2UiLCJjb250cm9sIiwibG9nZ2VyIiwiZGVidWciLCJzbGljZSIsImVyciIsImxlZCIsImJsaW5raW5nIiwic2V0QnV6emVyT3V0cHV0IiwiZW5hYmxlZCIsInN0YXR1c0NvZGUiLCJyZWFkVUludDE2QkUiLCJzZXRQSUNDIiwicGljYyJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7QUFFQTs7QUFDQTs7OztBQWlCQSxNQUFNQSxZQUFOLFNBQTJCQyxlQUEzQixDQUFrQztBQUVqQixRQUFWQyxVQUFVLEdBQUc7QUFFbEIsVUFBTUMsT0FBTyxHQUFHLENBQ2YsSUFEZSxFQUVmLElBRmUsRUFHZixJQUhlLEVBR1Q7QUFDTixRQUplLEVBSVQ7QUFDTixRQUxlLENBS1Q7QUFMUyxLQUFoQixDQUZrQixDQVVsQjs7QUFDQSxVQUFNQyxNQUFNLEdBQUdDLE1BQU0sQ0FBQ0MsSUFBUCxDQUFZLENBQzFCLElBRDBCLEVBQ3BCO0FBQ04sUUFGMEIsRUFFcEI7QUFDTixRQUgwQixFQUdwQjtBQUNOLFFBSjBCLEVBSXBCO0FBQ05ILElBQUFBLE9BQU8sQ0FBQ0ksTUFMa0IsRUFLVjtBQUNoQixPQUFHSixPQU51QixDQUFaLENBQWY7QUFTQUssSUFBQUEsT0FBTyxDQUFDQyxHQUFSLENBQVlMLE1BQVo7QUFFQSxRQUFJTSxRQUFRLEdBQUcsSUFBZjs7QUFFQSxRQUFJO0FBRUhBLE1BQUFBLFFBQVEsR0FBRyxNQUFNLEtBQUtDLE9BQUwsQ0FBYVAsTUFBYixFQUFxQixDQUFyQixDQUFqQjtBQUVBLFdBQUtRLE1BQUwsQ0FBWUMsS0FBWixDQUFrQixtQkFBbEIsRUFBdUNILFFBQXZDLEVBSkcsQ0FNSDtBQUNBO0FBQ0E7QUFDQTs7QUFFQUYs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QU0sS0FBS0MsT0FBTCxDQUFhUCxNQUFiLEVBQXFCLENBQXJCLENBQWpCO0FBRUEsV0FBS1EsTUFBTCxDQUFZQyxLQUFaLENBQWtCLG1CQUFsQixFQUF1Q0gsUUFBdkM7QUFHQSxLQVBELENBT0UsT0FBT0ssR0FBUCxFQUFZO0FBRWIsWUFBTUEsR0FBTjtBQUVBLEtBN0JrQixDQStCbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFsTmdDOztlQXNObkJmLFkiLCJzb3VyY2VSb290IjoiL1VzZXJzL2hhcnJ5aG93L0RvY3VtZW50cy8yMDIyL1BST0pFQ1RfTU9DQV9BUlQvTkZDL25mYy1wY3NjL3NyYy8iLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxuaW1wb3J0IFJlYWRlciBmcm9tICcuL1JlYWRlcic7XG5pbXBvcnQge1xuXHRDb25uZWN0RXJyb3IsXG5cdERpc2Nvbm5lY3RFcnJvcixcblx0VHJhbnNtaXRFcnJvcixcblx0Q29udHJvbEVycm9yLFxuXHRBdXRoZW50aWNhdGlvbkVycm9yLFxuXHRMb2FkQXV0aGVudGljYXRpb25LZXlFcnJvcixcblx0UmVhZEVycm9yLFxuXHRXcml0ZUVycm9yLFxuXHRHZXRVSURFcnJvcixcblx0Q0FSRF9OT1RfQ09OTkVDVEVELFxuXHRPUEVSQVRJT05fRkFJTEVELFxuXHRVTktOT1dOX0VSUk9SLFxuXHRGQUlMVVJFLFxufSBmcm9tICcuL2Vycm9ycyc7XG5cblxuY2xhc3MgQUNSMTIyUmVhZGVyIGV4dGVuZHMgUmVhZGVyIHtcblxuXHRhc3luYyBpbkF1dG9Qb2xsKCkge1xuXG5cdFx0Y29uc3QgcGF5bG9hZCA9IFtcblx0XHRcdDB4RDQsXG5cdFx0XHQweDYwLFxuXHRcdFx0MHhGRiwgLy8gUG9sbE5yICgweEZGID0gRW5kbGVzcyBwb2xsaW5nKVxuXHRcdFx0MHgwMSwgLy8gUGVyaW9kICgweDAxIOKAkyAweDBGKSBpbmRpY2F0ZXMgdGhlIHBvbGxpbmcgcGVyaW9kIGluIHVuaXRzIG9mIDE1MCBtc1xuXHRcdFx0MHgwMCwgLy8gVHlwZSAxIDB4MDAgPSBHZW5lcmljIHBhc3NpdmUgMTA2IGticHMgKElTTy9JRUMxNDQ0My00QSwgTWlmYXJlIGFuZCBERVApXG5cdFx0XTtcblxuXHRcdC8vIENNRDogRGlyZWN0IFRyYW5zbWl0ICh0byBpbm5lciBQTjUzMiBjaGlwIEluQXV0b1BvbGwgQ01EKVxuXHRcdGNvbnN0IHBhY2tldCA9IEJ1ZmZlci5mcm9tKFtcblx0XHRcdDB4ZmYsIC8vIENsYXNzXG5cdFx0XHQweDAwLCAvLyBJTlNcblx0XHRcdDB4MDAsIC8vIFAxXG5cdFx0XHQweDAwLCAvLyBQMlxuXHRcdFx0cGF5bG9hZC5sZW5ndGgsIC8vIExjOiBOdW1iZXIgb2YgQnl0ZXMgdG8gc2VuZCAoTWF4aW11bSAyNTUgYnl0ZXMpXG5cdFx0XHQuLi5wYXlsb2FkLFxuXHRcdF0pO1xuXG5cdFx0Y29uc29sZS5sb2cocGFja2V0KTtcblxuXHRcdGxldCByZXNwb25zZSA9IG51bGw7XG5cblx0XHR0cnkge1xuXG5cdFx0XHRyZXNwb25zZSA9IGF3YWl0IHRoaXMuY29udHJvbChwYWNrZXQsIDIpO1xuXG5cdFx0XHR0aGlzLmxvZ2dlci5kZWJ1ZygncmVzcG9uc2UgcmVjZWl2ZWQnLCByZXNwb25zZSk7XG5cblx0XHRcdC8vIFJlZCBPRkYgR3JlZW4gT0ZGICAweDAwXG5cdFx0XHQvLyBSZWQgT04gIEdyZWVuIE9GRiAgMHgwMVxuXHRcdFx0Ly8gUmVkIE9GRiBHcmVlbiBPTiAgIDB4MDJcblx0XHRcdC8vIFJlZCBPTiAgR3JlZW4gT04gICAweDAzXG5cblx0XHRcdGNvbnNvbGUubG9nKHJlc3BvbnNlLnNsaWNlKDEpKTtcblxuXG5cdFx0fSBjYXRjaCAoZXJyKSB7XG5cblx0XHRcdHRocm93IGVycjtcblxuXHRcdH1cblxuXHRcdC8vIGNvbnN0IHN0YXR1c0NvZGUgPSByZXNwb25zZS5yZWFkVUludDE2QkUoMCk7XG5cdFx0Ly9cblx0XHQvLyBpZiAoc3RhdHVzQ29kZSAhPT0gMHg5MDAwKSB7XG5cdFx0Ly8gXHQvL3Rocm93IG5ldyBMb2FkQXV0aGVudGljYXRpb25LZXlFcnJvcihPUEVSQVRJT05fRkFJTEVELCBgTG9hZCBhdXRoZW50aWNhdGlvbiBrZXkgb3BlcmF0aW9uIGZhaWxlZDogU3RhdHVzIGNvZGU6ICR7c3RhdHVzQ29kZX1gKTtcblx0XHQvLyB9XG5cblx0fVxuXG5cdGFzeW5jIGxlZChsZWQsIGJsaW5raW5nKSB7XG5cblx0XHQvLyBQMjogTEVEIFN0YXRlIENvbnRyb2wgKDEgYnl0ZSA9IDggYml0cylcblx0XHQvLyBmb3JtYXQ6XG5cdFx0Lypcblx0XHQgKy0tLS0tKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLStcblx0XHQgfCBCaXQgfCAgICAgICAgICAgICAgIEl0ZW0gICAgICAgICAgICAgICB8ICAgICAgICAgICAgIERlc2NyaXB0aW9uICAgICAgICAgICAgIHxcblx0XHQgKy0tLS0tKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLStcblx0XHQgfCAgIDAgfCBGaW5hbCBSZWQgTEVEIFN0YXRlICAgICAgICAgICAgICB8IDEgPSBPbjsgMCA9IE9mZiAgICAgICAgICAgICAgICAgICAgIHxcblx0XHQgfCAgIDEgfCBGaW5hbCBHcmVlbiBMRUQgU3RhdGUgICAgICAgICAgICB8IDEgPSBPbjsgMCA9IE9mZiAgICAgICAgICAgICAgICAgICAgIHxcblx0XHQgfCAgIDIgfCBSZWQgTEVEIFN0YXRlIE1hc2sgICAgICAgICAgICAgICB8IDEgPSBVcGRhdGUgdGhlIFN0YXRlOyAwID0gTm8gY2hhbmdlIHxcblx0XHQgfCAgIDMgfCBHcmVlbiBMRUQgU3RhdGUgTWFzayAgICAgICAgICAgICB8IDEgPSBVcGRhdGUgdGhlIFN0YXRlOyAwID0gTm8gY2hhbmdlIHxcblx0XHQgfCAgIDQgfCBJbml0aWFsIFJlZCBMRUQgQmxpbmtpbmcgU3RhdGUgICB8IDEgPSBPbjsgMCA9IE9mZiAgICAgICAgICAgICAgICAgICAgIHxcblx0XHQgfCAgIDUgfCBJbml0aWFsIEdyZWVuIExFRCBCbGlua2luZyBTdGF0ZSB8IDEgPSBPbjsgMCA9IE9mZiAgICAgICAgICAgICAgICAgICAgIHxcblx0XHQgfCAgIDYgfCBSZWQgTEVEIEJsaW5raW5nIE1hc2sgICAgICAgICAgICB8IDEgPSBCbGluazsgMCA9IE5vdCBCbGluayAgICAgICAgICAgIHxcblx0XHQgfCAgIDcgfCBHcmVlbiBMRUQgQmxpbmtpbmcgTWFzayAgICAgICAgICB8IDEgPSBCbGluazsgMCA9IE5vdCBCbGluayAgICAgICAgICAgIHxcblx0XHQgKy0tLS0tKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLStcblx0XHQgKi9cblxuXHRcdC8vY29uc3QgbGVkID0gMGIwMDAwMTExMTtcblx0XHQvL2NvbnN0IGxlZCA9IDB4NTA7XG5cblx0XHQvLyBEYXRhIEluOiBCbGlua2luZyBEdXJhdGlvbiBDb250cm9sICg0IGJ5dGVzKVxuXHRcdC8vIEJ5dGUgMDogVDEgRHVyYXRpb24gSW5pdGlhbCBCbGlua2luZyBTdGF0ZSAoVW5pdCA9IDEwMCBtcylcblx0XHQvLyBCeXRlIDE6IFQyIER1cmF0aW9uIFRvZ2dsZSBCbGlua2luZyBTdGF0ZSAoVW5pdCA9IDEwMCBtcylcblx0XHQvLyBCeXRlIDI6IE51bWJlciBvZiByZXBldGl0aW9uXG5cdFx0Ly8gQnl0ZSAzOiBMaW5rIHRvIEJ1enplclxuXHRcdC8vIC0gMDA6IFRoZSBidXp6ZXIgd2lsbCBub3QgdHVybiBvblxuXHRcdC8vIC0gMDE6IFRoZSBidXp6ZXIgd2lsbCB0dXJuIG9uIGR1cmluZyB0aGUgVDEgRHVyYXRpb25cblx0XHQvLyAtIDAyOiBUaGUgYnV6emVyIHdpbGwgdHVybiBvbiBkdXJpbmcgdGhlIFQyIER1cmF0aW9uXG5cdFx0Ly8gLSAwMzogVGhlIGJ1enplciB3aWxsIHR1cm4gb24gZHVyaW5nIHRoZSBUMSBhbmQgVDIgRHVyYXRpb25cblxuXHRcdC8vIGNvbnN0IGJsaW5raW5nID0gW1xuXHRcdC8vIFx0MHgwMCxcblx0XHQvLyBcdDB4MDAsXG5cdFx0Ly8gXHQweDAwLFxuXHRcdC8vIFx0MHgwMFxuXHRcdC8vIF07XG5cblxuXHRcdC8vIENNRDogQmktQ29sb3IgTEVEIGFuZCBCdXp6ZXIgQ29udHJvbFxuXHRcdGNvbnN0IHBhY2tldCA9IEJ1ZmZlci5mcm9tKFtcblx0XHRcdDB4ZmYsIC8vIENsYXNzXG5cdFx0XHQweDAwLCAvLyBJTlNcblx0XHRcdDB4NDAsIC8vIFAxXG5cdFx0XHRsZWQsIC8vIFAyOiBMRUQgU3RhdGUgQ29udHJvbFxuXHRcdFx0MHgwNCwgLy8gTGNcblx0XHRcdC4uLmJsaW5raW5nLCAvLyBEYXRhIEluOiBCbGlua2luZyBEdXJhdGlvbiBDb250cm9sICg0IGJ5dGVzKVxuXHRcdF0pO1xuXG5cdFx0Y29uc29sZS5sb2cocGFja2V0KTtcblxuXHRcdGxldCByZXNwb25zZSA9IG51bGw7XG5cblx0XHR0cnkge1xuXG5cdFx0XHRyZXNwb25zZSA9IGF3YWl0IHRoaXMuY29udHJvbChwYWNrZXQsIDIpO1xuXG5cdFx0XHR0aGlzLmxvZ2dlci5kZWJ1ZygncmVzcG9uc2UgcmVjZWl2ZWQnLCByZXNwb25zZSk7XG5cblx0XHRcdC8vIFJlZCBPRkYgR3JlZW4gT0ZGICAweDAwXG5cdFx0XHQvLyBSZWQgT04gIEdyZWVuIE9GRiAgMHgwMVxuXHRcdFx0Ly8gUmVkIE9GRiBHcmVlbiBPTiAgIDB4MDJcblx0XHRcdC8vIFJlZCBPTiAgR3JlZW4gT04gICAweDAzXG5cblx0XHRcdGNvbnNvbGUubG9nKHJlc3BvbnNlLnNsaWNlKDEpKTtcblxuXG5cdFx0fSBjYXRjaCAoZXJyKSB7XG5cblx0XHRcdHRocm93IGVycjtcblxuXHRcdH1cblxuXHRcdC8vIGNvbnN0IHN0YXR1c0NvZGUgPSByZXNwb25zZS5yZWFkVUludDE2QkUoMCk7XG5cdFx0Ly9cblx0XHQvLyBpZiAoc3RhdHVzQ29kZSAhPT0gMHg5MDAwKSB7XG5cdFx0Ly8gXHQvL3Rocm93IG5ldyBMb2FkQXV0aGVudGljYXRpb25LZXlFcnJvcihPUEVSQVRJT05fRkFJTEVELCBgTG9hZCBhdXRoZW50aWNhdGlvbiBrZXkgb3BlcmF0aW9uIGZhaWxlZDogU3RhdHVzIGNvZGU6ICR7c3RhdHVzQ29kZX1gKTtcblx0XHQvLyB9XG5cblx0fVxuXG5cdGFzeW5jIHNldEJ1enplck91dHB1dChlbmFibGVkID0gdHJ1ZSkge1xuXG5cblx0XHQvLyBDTUQ6IFNldCBCdXp6ZXIgT3V0cHV0IEVuYWJsZSBmb3IgQ2FyZCBEZXRlY3Rpb25cblx0XHRjb25zdCBwYWNrZXQgPSBCdWZmZXIuZnJvbShbXG5cdFx0XHQweGZmLCAvLyBDbGFzc1xuXHRcdFx0MHgwMCwgLy8gSU5TXG5cdFx0XHQweDUyLCAvLyBQMVxuXHRcdFx0ZW5hYmxlZCA/IDB4ZmYgOiAweDAwLCAvLyBQMjogUG9sbEJ1enpTdGF0dXNcblx0XHRcdDB4MDAsIC8vIExlXG5cdFx0XSk7XG5cblx0XHRjb25zb2xlLmxvZyhwYWNrZXQpO1xuXG5cdFx0bGV0IHJlc3BvbnNlID0gbnVsbDtcblxuXHRcdHRyeSB7XG5cblx0XHRcdHJlc3BvbnNlID0gYXdhaXQgdGhpcy5jb250cm9sKHBhY2tldCwgMik7XG5cblx0XHRcdHRoaXMubG9nZ2VyLmRlYnVnKCdyZXNwb25zZSByZWNlaXZlZCcsIHJlc3BvbnNlKTtcblxuXG5cdFx0fSBjYXRjaCAoZXJyKSB7XG5cblx0XHRcdHRocm93IGVycjtcblxuXHRcdH1cblxuXHRcdGNvbnN0IHN0YXR1c0NvZGUgPSByZXNwb25zZS5yZWFkVUludDE2QkUoMCk7XG5cblx0XHRpZiAoc3RhdHVzQ29kZSAhPT0gMHg5MDAwKSB7XG5cdFx0XHQvL3Rocm93IG5ldyBMb2FkQXV0aGVudGljYXRpb25LZXlFcnJvcihPUEVSQVRJT05fRkFJTEVELCBgTG9hZCBhdXRoZW50aWNhdGlvbiBrZXkgb3BlcmF0aW9uIGZhaWxlZDogU3RhdHVzIGNvZGU6ICR7c3RhdHVzQ29kZX1gKTtcblx0XHR9XG5cblx0fVxuXG5cdGFzeW5jIHNldFBJQ0MocGljYykge1xuXG5cdFx0Ly8ganVzdCBlbmFibGUgQXV0byBBVFMgR2VuZXJhdGlvblxuXHRcdC8vIGNvbnN0IHBpY2MgPSAwYjAxMDAwMDAwO1xuXG5cdFx0Ly8gQ01EOiBTZXQgUElDQyBPcGVyYXRpbmcgUGFyYW1ldGVyXG5cdFx0Y29uc3QgcGFja2V0ID0gQnVmZmVyLmZyb20oW1xuXHRcdFx0MHhmZiwgLy8gQ2xhc3Ncblx0XHRcdDB4MDAsIC8vIElOU1xuXHRcdFx0MHg1MSwgLy8gUDFcblx0XHRcdHBpY2MsIC8vIFAyOiBOZXcgUElDQyBPcGVyYXRpbmcgUGFyYW1ldGVyXG5cdFx0XHQweDAwLCAvLyBMZVxuXHRcdF0pO1xuXG5cdFx0Y29uc29sZS5sb2cocGFja2V0KTtcblxuXHRcdGxldCByZXNwb25zZSA9IG51bGw7XG5cblx0XHR0cnkge1xuXG5cdFx0XHRyZXNwb25zZSA9IGF3YWl0IHRoaXMuY29udHJvbChwYWNrZXQsIDEpO1xuXG5cdFx0XHR0aGlzLmxvZ2dlci5kZWJ1ZygncmVzcG9uc2UgcmVjZWl2ZWQnLCByZXNwb25zZSk7XG5cblxuXHRcdH0gY2F0Y2ggKGVycikge1xuXG5cdFx0XHR0aHJvdyBlcnI7XG5cblx0XHR9XG5cblx0XHQvLyBjb25zdCBzdGF0dXNDb2RlID0gcmVzcG9uc2UucmVhZFVJbnQxNkJFKDApO1xuXHRcdC8vXG5cdFx0Ly8gaWYgKHN0YXR1c0NvZGUgIT09IDB4OTAwMCkge1xuXHRcdC8vIFx0Ly90aHJvdyBuZXcgTG9hZEF1dGhlbnRpY2F0aW9uS2V5RXJyb3IoT1BFUkFUSU9OX0ZBSUxFRCwgYExvYWQgYXV0aGVudGljYXRpb24ga2V5IG9wZXJhdGlvbiBmYWlsZWQ6IFN0YXR1cyBjb2RlOiAke3N0YXR1c0NvZGV9YCk7XG5cdFx0Ly8gfVxuXG5cdH1cblxufVxuXG5leHBvcnQgZGVmYXVsdCBBQ1IxMjJSZWFkZXI7XG4iXX0=",
    "map": {
      "version": 3,
      "sources": [
        "ACR122Reader.js"
      ],
      "names": [
        "ACR122Reader",
        "Reader",
        "inAutoPoll",
        "payload",
        "packet",
        "Buffer",
        "from",
        "length",
        "console",
        "log",
        "response",
        "control",
        "logger",
        "debug",
        "slice",
        "err",
        "led",
        "blinking",
        "setBuzzerOutput",
        "enabled",
        "statusCode",
        "readUInt16BE",
        "setPICC",
        "picc"
      ],
      "mappings": "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",
      "sourceRoot": "/Users/harryhow/Documents/2022/PROJECT_MOCA_ART/NFC/nfc-pcsc/src/",
      "sourcesContent": [
        "\"use strict\";\n\nimport Reader from './Reader';\nimport {\n\tConnectError,\n\tDisconnectError,\n\tTransmitError,\n\tControlError,\n\tAuthenticationError,\n\tLoadAuthenticationKeyError,\n\tReadError,\n\tWriteError,\n\tGetUIDError,\n\tCARD_NOT_CONNECTED,\n\tOPERATION_FAILED,\n\tUNKNOWN_ERROR,\n\tFAILURE,\n} from './errors';\n\n\nclass ACR122Reader extends Reader {\n\n\tasync inAutoPoll() {\n\n\t\tconst payload = [\n\t\t\t0xD4,\n\t\t\t0x60,\n\t\t\t0xFF, // PollNr (0xFF = Endless polling)\n\t\t\t0x01, // Period (0x01 – 0x0F) indicates the polling period in units of 150 ms\n\t\t\t0x00, // Type 1 0x00 = Generic passive 106 kbps (ISO/IEC14443-4A, Mifare and DEP)\n\t\t];\n\n\t\t// CMD: Direct Transmit (to inner PN532 chip InAutoPoll CMD)\n\t\tconst packet = Buffer.from([\n\t\t\t0xff, // Class\n\t\t\t0x00, // INS\n\t\t\t0x00, // P1\n\t\t\t0x00, // P2\n\t\t\tpayload.length, // Lc: Number of Bytes to send (Maximum 255 bytes)\n\t\t\t...payload,\n\t\t]);\n\n\t\tconsole.log(packet);\n\n\t\tlet response = null;\n\n\t\ttry {\n\n\t\t\tresponse = await this.control(packet, 2);\n\n\t\t\tthis.logger.debug('response received', response);\n\n\t\t\t// Red OFF Green OFF  0x00\n\t\t\t// Red ON  Green OFF  0x01\n\t\t\t// Red OFF Green ON   0x02\n\t\t\t// Red ON  Green ON   0x03\n\n\t\t\tconsole.log(response.slice(1));\n\n\n\t\t} catch (err) {\n\n\t\t\tthrow err;\n\n\t\t}\n\n\t\t// const statusCode = response.readUInt16BE(0);\n\t\t//\n\t\t// if (statusCode !== 0x9000) {\n\t\t// \t//throw new LoadAuthenticationKeyError(OPERATION_FAILED, `Load authentication key operation failed: Status code: ${statusCode}`);\n\t\t// }\n\n\t}\n\n\tasync led(led, blinking) {\n\n\t\t// P2: LED State Control (1 byte = 8 bits)\n\t\t// format:\n\t\t/*\n\t\t +-----+----------------------------------+-------------------------------------+\n\t\t | Bit |               Item               |             Description             |\n\t\t +-----+----------------------------------+-------------------------------------+\n\t\t |   0 | Final Red LED State              | 1 = On; 0 = Off                     |\n\t\t |   1 | Final Green LED State            | 1 = On; 0 = Off                     |\n\t\t |   2 | Red LED State Mask               | 1 = Update the State; 0 = No change |\n\t\t |   3 | Green LED State Mask             | 1 = Update the State; 0 = No change |\n\t\t |   4 | Initial Red LED Blinking State   | 1 = On; 0 = Off                     |\n\t\t |   5 | Initial Green LED Blinking State | 1 = On; 0 = Off                     |\n\t\t |   6 | Red LED Blinking Mask            | 1 = Blink; 0 = Not Blink            |\n\t\t |   7 | Green LED Blinking Mask          | 1 = Blink; 0 = Not Blink            |\n\t\t +-----+----------------------------------+-------------------------------------+\n\t\t */\n\n\t\t//const led = 0b00001111;\n\t\t//const led = 0x50;\n\n\t\t// Data In: Blinking Duration Control (4 bytes)\n\t\t// Byte 0: T1 Duration Initial Blinking State (Unit = 100 ms)\n\t\t// Byte 1: T2 Duration Toggle Blinking State (Unit = 100 ms)\n\t\t// Byte 2: Number of repetition\n\t\t// Byte 3: Link to Buzzer\n\t\t// - 00: The buzzer will not turn on\n\t\t// - 01: The buzzer will turn on during the T1 Duration\n\t\t// - 02: The buzzer will turn on during the T2 Duration\n\t\t// - 03: The buzzer will turn on during the T1 and T2 Duration\n\n\t\t// const blinking = [\n\t\t// \t0x00,\n\t\t// \t0x00,\n\t\t// \t0x00,\n\t\t// \t0x00\n\t\t// ];\n\n\n\t\t// CMD: Bi-Color LED and Buzzer Control\n\t\tconst packet = Buffer.from([\n\t\t\t0xff, // Class\n\t\t\t0x00, // INS\n\t\t\t0x40, // P1\n\t\t\tled, // P2: LED State Control\n\t\t\t0x04, // Lc\n\t\t\t...blinking, // Data In: Blinking Duration Control (4 bytes)\n\t\t]);\n\n\t\tconsole.log(packet);\n\n\t\tlet response = null;\n\n\t\ttry {\n\n\t\t\tresponse = await this.control(packet, 2);\n\n\t\t\tthis.logger.debug('response received', response);\n\n\t\t\t// Red OFF Green OFF  0x00\n\t\t\t// Red ON  Green OFF  0x01\n\t\t\t// Red OFF Green ON   0x02\n\t\t\t// Red ON  Green ON   0x03\n\n\t\t\tconsole.log(response.slice(1));\n\n\n\t\t} catch (err) {\n\n\t\t\tthrow err;\n\n\t\t}\n\n\t\t// const statusCode = response.readUInt16BE(0);\n\t\t//\n\t\t// if (statusCode !== 0x9000) {\n\t\t// \t//throw new LoadAuthenticationKeyError(OPERATION_FAILED, `Load authentication key operation failed: Status code: ${statusCode}`);\n\t\t// }\n\n\t}\n\n\tasync setBuzzerOutput(enabled = true) {\n\n\n\t\t// CMD: Set Buzzer Output Enable for Card Detection\n\t\tconst packet = Buffer.from([\n\t\t\t0xff, // Class\n\t\t\t0x00, // INS\n\t\t\t0x52, // P1\n\t\t\tenabled ? 0xff : 0x00, // P2: PollBuzzStatus\n\t\t\t0x00, // Le\n\t\t]);\n\n\t\tconsole.log(packet);\n\n\t\tlet response = null;\n\n\t\ttry {\n\n\t\t\tresponse = await this.control(packet, 2);\n\n\t\t\tthis.logger.debug('response received', response);\n\n\n\t\t} catch (err) {\n\n\t\t\tthrow err;\n\n\t\t}\n\n\t\tconst statusCode = response.readUInt16BE(0);\n\n\t\tif (statusCode !== 0x9000) {\n\t\t\t//throw new LoadAuthenticationKeyError(OPERATION_FAILED, `Load authentication key operation failed: Status code: ${statusCode}`);\n\t\t}\n\n\t}\n\n\tasync setPICC(picc) {\n\n\t\t// just enable Auto ATS Generation\n\t\t// const picc = 0b01000000;\n\n\t\t// CMD: Set PICC Operating Parameter\n\t\tconst packet = Buffer.from([\n\t\t\t0xff, // Class\n\t\t\t0x00, // INS\n\t\t\t0x51, // P1\n\t\t\tpicc, // P2: New PICC Operating Parameter\n\t\t\t0x00, // Le\n\t\t]);\n\n\t\tconsole.log(packet);\n\n\t\tlet response = null;\n\n\t\ttry {\n\n\t\t\tresponse = await this.control(packet, 1);\n\n\t\t\tthis.logger.debug('response received', response);\n\n\n\t\t} catch (err) {\n\n\t\t\tthrow err;\n\n\t\t}\n\n\t\t// const statusCode = response.readUInt16BE(0);\n\t\t//\n\t\t// if (statusCode !== 0x9000) {\n\t\t// \t//throw new LoadAuthenticationKeyError(OPERATION_FAILED, `Load authentication key operation failed: Status code: ${statusCode}`);\n\t\t// }\n\n\t}\n\n}\n\nexport default ACR122Reader;\n"
      ]
    },
    "sourceType": "script",
    "mtime": 1662229648499
  }
}